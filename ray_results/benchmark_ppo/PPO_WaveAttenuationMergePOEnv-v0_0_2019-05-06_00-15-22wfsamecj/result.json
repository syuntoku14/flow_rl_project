{"iterations_since_restore": 1, "training_iteration": 1, "episodes_total": 30, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 30000, "default": {"vf_explained_var": 0.00011212550452910364, "policy_loss": -0.005021856166422367, "cur_kl_coeff": 0.20000004768371582, "entropy": 7.075112819671631, "kl": 0.007942392490804195, "vf_loss": 14.934235572814941, "total_loss": 14.930801391601562, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 4545.811, "sample_time_ms": 35832.403, "load_time_ms": 45.146, "update_time_ms": 761.853, "num_steps_sampled": 30000}, "done": false, "timestamp": 1557101785, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 184.7355608176271, "policy_reward_mean": {}, "episode_len_mean": 750.0, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769358>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 30000, "timesteps_this_iter": 30000, "time_total_s": 41.29323935508728, "node_ip": "10.138.0.2", "time_this_iter_s": 41.29323935508728, "episode_reward_mean": 131.21343190220358, "custom_metrics": {"cost2_min": -1.0, "system_level_velocity_mean": 3.846811860894461, "outflow_rate_mean": 368.62035436184203, "cost1_mean": 131.2155789921801, "cost2_max": 0.0, "outflow_rate_max": 609.8649280647605, "outflow_rate_min": 206.15428212663863, "system_level_velocity_min": 2.6104052295456337, "system_level_velocity_max": 5.366724752346299, "cost1_min": 83.75602475704424, "cost1_max": 184.73556081762712, "cost2_mean": -0.04245979629708947}, "episode_reward_min": 83.75602475704436, "hostname": "flow-main", "episodes_this_iter": 30, "timesteps_total": 30000, "date": "2019-05-06_00-16-25", "time_since_restore": 41.29323935508728, "pid": 6439}
{"iterations_since_restore": 2, "training_iteration": 2, "episodes_total": 74, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 60000, "default": {"vf_explained_var": 0.7571654915809631, "policy_loss": -0.00494806282222271, "cur_kl_coeff": 0.20000004768371582, "entropy": 7.059694290161133, "kl": 0.0077030411921441555, "vf_loss": 4.157177925109863, "total_loss": 4.153770923614502, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 5423.974, "sample_time_ms": 28845.114, "load_time_ms": 24.903, "update_time_ms": 383.773, "num_steps_sampled": 60000}, "done": false, "timestamp": 1557101813, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 209.88875041080246, "policy_reward_mean": {}, "episode_len_mean": 750.0, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769da0>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 60000, "timesteps_this_iter": 30000, "time_total_s": 69.51541924476624, "node_ip": "10.138.0.2", "time_this_iter_s": 28.222179889678955, "episode_reward_mean": 141.17971740370623, "custom_metrics": {"cost2_min": -1.0, "system_level_velocity_mean": 4.108540185932924, "outflow_rate_mean": 410.7678439444972, "cost1_mean": 141.18189744163595, "cost2_max": 0.0, "outflow_rate_max": 789.0546690965738, "outflow_rate_min": 196.35106845620095, "system_level_velocity_min": 2.6104052295456337, "system_level_velocity_max": 5.924645696078449, "cost1_min": 83.75602475704424, "cost1_max": 209.88875041080257, "cost2_mean": -0.030309391404476773}, "episode_reward_min": 83.75602475704436, "hostname": "flow-main", "episodes_this_iter": 44, "timesteps_total": 60000, "date": "2019-05-06_00-16-53", "time_since_restore": 69.51541924476624, "pid": 6439}
{"iterations_since_restore": 3, "training_iteration": 3, "episodes_total": 112, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 90000, "default": {"vf_explained_var": 0.9478718042373657, "policy_loss": -0.00626733573153615, "cur_kl_coeff": 0.20000004768371582, "entropy": 7.016695499420166, "kl": 0.011456758715212345, "vf_loss": 2.414196252822876, "total_loss": 2.4102203845977783, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 5845.056, "sample_time_ms": 26229.256, "load_time_ms": 18.559, "update_time_ms": 257.975, "num_steps_sampled": 90000}, "done": false, "timestamp": 1557101841, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 262.65780906534826, "policy_reward_mean": {}, "episode_len_mean": 750.0, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a828>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 90000, "timesteps_this_iter": 30000, "time_total_s": 97.27193307876587, "node_ip": "10.138.0.2", "time_this_iter_s": 27.756513833999634, "episode_reward_mean": 154.17870757757197, "custom_metrics": {"cost2_min": -4.0, "system_level_velocity_mean": 4.4585533922414164, "outflow_rate_mean": 473.7535300640646, "cost1_mean": 154.18633164982236, "cost2_max": 0.0, "outflow_rate_max": 934.0445333948509, "outflow_rate_min": 196.35106845620095, "system_level_velocity_min": 2.6104052295456337, "system_level_velocity_max": 7.427864361264226, "cost1_min": 83.75602475704424, "cost1_max": 262.65780906534843, "cost2_mean": -0.09108168139954348}, "episode_reward_min": 83.75602475704436, "hostname": "flow-main", "episodes_this_iter": 38, "timesteps_total": 90000, "date": "2019-05-06_00-17-21", "time_since_restore": 97.27193307876587, "pid": 6439}
{"iterations_since_restore": 4, "training_iteration": 4, "episodes_total": 154, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 120000, "default": {"vf_explained_var": 0.9619874358177185, "policy_loss": -0.009797950275242329, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.946845054626465, "kl": 0.015396157279610634, "vf_loss": 3.3429086208343506, "total_loss": 3.3361895084381104, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 5781.84, "sample_time_ms": 25141.28, "load_time_ms": 14.996, "update_time_ms": 195.083, "num_steps_sampled": 120000}, "done": false, "timestamp": 1557101868, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 288.36940204678797, "policy_reward_mean": {}, "episode_len_mean": 750.0, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769e10>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 120000, "timesteps_this_iter": 30000, "time_total_s": 124.80801725387573, "node_ip": "10.138.0.2", "time_this_iter_s": 27.536084175109863, "episode_reward_mean": 176.69700018027356, "custom_metrics": {"cost2_min": -7.122670723746762, "system_level_velocity_mean": 5.068995157652717, "outflow_rate_mean": 575.8002036695638, "cost1_mean": 176.7191409243752, "cost2_max": 0.0, "outflow_rate_max": 1093.901465518169, "outflow_rate_min": 196.35106845620095, "system_level_velocity_min": 3.218648935125285, "system_level_velocity_max": 8.077849435268861, "cost1_min": 108.87842832503077, "cost1_max": 288.3694020467882, "cost2_mean": -0.24716776225829273}, "episode_reward_min": 108.87842832503094, "hostname": "flow-main", "episodes_this_iter": 42, "timesteps_total": 120000, "date": "2019-05-06_00-17-48", "time_since_restore": 124.80801725387573, "pid": 6439}
{"iterations_since_restore": 5, "training_iteration": 5, "episodes_total": 191, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 150000, "default": {"vf_explained_var": 0.9621289968490601, "policy_loss": -0.009658556431531906, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.880066394805908, "kl": 0.01432118471711874, "vf_loss": 4.96412992477417, "total_loss": 4.957335472106934, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 5893.763, "sample_time_ms": 24249.98, "load_time_ms": 12.873, "update_time_ms": 157.44, "num_steps_sampled": 150000}, "done": false, "timestamp": 1557101895, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 331.2108243927229, "policy_reward_mean": {}, "episode_len_mean": 750.0, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578ac88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a5c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a6d8>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 150000, "timesteps_this_iter": 30000, "time_total_s": 151.89926171302795, "node_ip": "10.138.0.2", "time_this_iter_s": 27.09124445915222, "episode_reward_mean": 213.0608948958636, "custom_metrics": {"cost2_min": -7.122670723746762, "system_level_velocity_mean": 6.079515676796551, "outflow_rate_mean": 721.9488410446838, "cost1_mean": 213.09111376428183, "cost2_max": 0.0, "outflow_rate_max": 1154.168031732426, "outflow_rate_min": 204.28738710089345, "system_level_velocity_min": 3.5659440672831444, "system_level_velocity_max": 9.49173472293895, "cost1_min": 119.44346096252077, "cost1_max": 331.2108243927224, "cost2_mean": -0.32794900542392746}, "episode_reward_min": 119.44346096252089, "hostname": "flow-main", "episodes_this_iter": 37, "timesteps_total": 150000, "date": "2019-05-06_00-18-15", "time_since_restore": 151.89926171302795, "pid": 6439}
{"iterations_since_restore": 6, "training_iteration": 6, "episodes_total": 232, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 180000, "default": {"vf_explained_var": 0.9608665108680725, "policy_loss": -0.008214621804654598, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.8786773681640625, "kl": 0.012314031831920147, "vf_loss": 7.024253845214844, "total_loss": 7.018502235412598, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 5982.878, "sample_time_ms": 23874.571, "load_time_ms": 11.549, "update_time_ms": 132.254, "num_steps_sampled": 180000}, "done": false, "timestamp": 1557101924, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 435.05645223673486, "policy_reward_mean": {}, "episode_len_mean": 750.0, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a9b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a7b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578add8>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 180000, "timesteps_this_iter": 30000, "time_total_s": 180.38863253593445, "node_ip": "10.138.0.2", "time_this_iter_s": 28.489370822906494, "episode_reward_mean": 250.57628207985147, "custom_metrics": {"cost2_min": -7.122670723746762, "system_level_velocity_mean": 7.137488639065295, "outflow_rate_mean": 868.8728093936078, "cost1_mean": 250.60160449802862, "cost2_max": 0.0, "outflow_rate_max": 1340.3897971691024, "outflow_rate_min": 263.6610150454169, "system_level_velocity_min": 3.716031445770301, "system_level_velocity_max": 12.20708109695221, "cost1_min": 129.01384529658236, "cost1_max": 435.0733896142754, "cost2_mean": -0.26643515006797996}, "episode_reward_min": 129.0138452965824, "hostname": "flow-main", "episodes_this_iter": 41, "timesteps_total": 180000, "date": "2019-05-06_00-18-44", "time_since_restore": 180.38863253593445, "pid": 6439}
{"iterations_since_restore": 7, "training_iteration": 7, "episodes_total": 272, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 210000, "default": {"vf_explained_var": 0.9527735710144043, "policy_loss": -0.008504628203809261, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.844909191131592, "kl": 0.013637831434607506, "vf_loss": 9.836678504943848, "total_loss": 9.830901145935059, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 5918.39, "sample_time_ms": 24025.228, "load_time_ms": 11.319, "update_time_ms": 114.317, "num_steps_sampled": 210000}, "done": false, "timestamp": 1557101954, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 435.05645223673486, "policy_reward_mean": {}, "episode_len_mean": 750.0, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a2e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a438>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 210000, "timesteps_this_iter": 30000, "time_total_s": 210.93361067771912, "node_ip": "10.138.0.2", "time_this_iter_s": 30.544978141784668, "episode_reward_mean": 277.20531440313266, "custom_metrics": {"cost2_min": -7.0, "system_level_velocity_mean": 7.919053399604371, "outflow_rate_mean": 977.3930076434262, "cost1_mean": 277.2256344984351, "cost2_max": 0.0, "outflow_rate_max": 1340.3897971691024, "outflow_rate_min": 669.7760969007848, "system_level_velocity_min": 5.829331475366705, "system_level_velocity_max": 12.20708109695221, "cost1_min": 205.54221730508698, "cost1_max": 435.0733896142754, "cost2_mean": -0.20554380369580982}, "episode_reward_min": 205.54221730508704, "hostname": "flow-main", "episodes_this_iter": 40, "timesteps_total": 210000, "date": "2019-05-06_00-19-14", "time_since_restore": 210.93361067771912, "pid": 6439}
{"iterations_since_restore": 8, "training_iteration": 8, "episodes_total": 315, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 240000, "default": {"vf_explained_var": 0.9342328310012817, "policy_loss": -0.007683005649596453, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.847332954406738, "kl": 0.011675904504954815, "vf_loss": 14.378098487854004, "total_loss": 14.372750282287598, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6172.719, "sample_time_ms": 24356.094, "load_time_ms": 10.641, "update_time_ms": 100.815, "num_steps_sampled": 240000}, "done": false, "timestamp": 1557101989, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 407.70467824806883, "policy_reward_mean": {}, "episode_len_mean": 750.0, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a7b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a8d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a9b0>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 240000, "timesteps_this_iter": 30000, "time_total_s": 245.66792225837708, "node_ip": "10.138.0.2", "time_this_iter_s": 34.73431158065796, "episode_reward_mean": 294.16343773455105, "custom_metrics": {"cost2_min": -3.0, "system_level_velocity_mean": 8.4476134339717, "outflow_rate_mean": 1030.699437221118, "cost1_mean": 294.1882043924036, "cost2_max": 0.0, "outflow_rate_max": 1356.285585244054, "outflow_rate_min": 744.3091469340591, "system_level_velocity_min": 6.41435074228676, "system_level_velocity_max": 11.49653237736937, "cost1_min": 223.23564848252465, "cost1_max": 407.7684711043273, "cost2_mean": -0.24766657852532392}, "episode_reward_min": 223.2356484825247, "hostname": "flow-main", "episodes_this_iter": 43, "timesteps_total": 240000, "date": "2019-05-06_00-19-49", "time_since_restore": 245.66792225837708, "pid": 6439}
{"iterations_since_restore": 9, "training_iteration": 9, "episodes_total": 351, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 270000, "default": {"vf_explained_var": 0.9471701383590698, "policy_loss": -0.008644167333841324, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.829258441925049, "kl": 0.013969626277685165, "vf_loss": 12.290875434875488, "total_loss": 12.285024642944336, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6353.532, "sample_time_ms": 24959.521, "load_time_ms": 10.007, "update_time_ms": 90.623, "num_steps_sampled": 270000}, "done": false, "timestamp": 1557102027, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 407.70467824806883, "policy_reward_mean": {}, "episode_len_mean": 750.0, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a7f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578abe0>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 270000, "timesteps_this_iter": 30000, "time_total_s": 283.3529460430145, "node_ip": "10.138.0.2", "time_this_iter_s": 37.68502378463745, "episode_reward_mean": 305.36673066563105, "custom_metrics": {"cost2_min": -3.0, "system_level_velocity_mean": 8.803082533525844, "outflow_rate_mean": 1064.2384027096775, "cost1_mean": 305.3979770551289, "cost2_max": 0.0, "outflow_rate_max": 1356.285585244054, "outflow_rate_min": 835.5799789853753, "system_level_velocity_min": 6.996382219835641, "system_level_velocity_max": 11.49653237736937, "cost1_min": 240.3833655260225, "cost1_max": 407.7684711043273, "cost2_mean": -0.3124638949785268}, "episode_reward_min": 240.38166769147648, "hostname": "flow-main", "episodes_this_iter": 36, "timesteps_total": 270000, "date": "2019-05-06_00-20-27", "time_since_restore": 283.3529460430145, "pid": 6439}
{"iterations_since_restore": 10, "training_iteration": 10, "episodes_total": 394, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 300000, "default": {"vf_explained_var": 0.9373074173927307, "policy_loss": -0.005662752315402031, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.806118965148926, "kl": 0.010518078692257404, "vf_loss": 14.722512245178223, "total_loss": 14.718954086303711, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6310.417, "sample_time_ms": 25215.416, "load_time_ms": 9.951, "update_time_ms": 82.624, "num_steps_sampled": 300000}, "done": false, "timestamp": 1557102060, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 439.0766264599689, "policy_reward_mean": {}, "episode_len_mean": 750.0, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a7b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f57cc748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a470>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 300000, "timesteps_this_iter": 30000, "time_total_s": 316.881103515625, "node_ip": "10.138.0.2", "time_this_iter_s": 33.528157472610474, "episode_reward_mean": 313.20022055740117, "custom_metrics": {"cost2_min": -6.0, "system_level_velocity_mean": 9.059185372762192, "outflow_rate_mean": 1089.92255451451, "cost1_mean": 313.23779280954136, "cost2_max": 0.0, "outflow_rate_max": 1429.2232039232945, "outflow_rate_min": 835.5799789853753, "system_level_velocity_min": 7.118365949399723, "system_level_velocity_max": 12.593687660191618, "cost1_min": 248.80029452200992, "cost1_max": 439.07662645996874, "cost2_mean": -0.3757225214010829}, "episode_reward_min": 248.8002945220098, "hostname": "flow-main", "episodes_this_iter": 43, "timesteps_total": 300000, "date": "2019-05-06_00-21-00", "time_since_restore": 316.881103515625, "pid": 6439}
{"iterations_since_restore": 11, "training_iteration": 11, "episodes_total": 433, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 330000, "default": {"vf_explained_var": 0.9458429217338562, "policy_loss": -0.0057950615882873535, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.781262397766113, "kl": 0.01123790256679058, "vf_loss": 14.238228797912598, "total_loss": 14.234682083129883, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6377.098, "sample_time_ms": 24137.586, "load_time_ms": 5.906, "update_time_ms": 7.026, "num_steps_sampled": 330000}, "done": false, "timestamp": 1557102091, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 475.6353024417157, "policy_reward_mean": {}, "episode_len_mean": 750.0, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a2b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578ac18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578af60>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 330000, "timesteps_this_iter": 30000, "time_total_s": 347.22181010246277, "node_ip": "10.138.0.2", "time_this_iter_s": 30.34070658683777, "episode_reward_mean": 320.32377160266265, "custom_metrics": {"cost2_min": -6.0, "system_level_velocity_mean": 9.286632725660088, "outflow_rate_mean": 1106.552712005235, "cost1_mean": 320.36156757416177, "cost2_max": 0.0, "outflow_rate_max": 1513.1116425035314, "outflow_rate_min": 814.5216133874294, "system_level_velocity_min": 7.212875690637409, "system_level_velocity_max": 14.050613479441042, "cost1_min": 248.80333005671486, "cost1_max": 475.8424021802958, "cost2_mean": -0.3779597149915621}, "episode_reward_min": 248.80333005671486, "hostname": "flow-main", "episodes_this_iter": 39, "timesteps_total": 330000, "date": "2019-05-06_00-21-31", "time_since_restore": 347.22181010246277, "pid": 6439}
{"iterations_since_restore": 12, "training_iteration": 12, "episodes_total": 476, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 360000, "default": {"vf_explained_var": 0.9363224506378174, "policy_loss": -0.0068349940702319145, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.790378093719482, "kl": 0.011868706904351711, "vf_loss": 15.45266342163086, "total_loss": 15.448202133178711, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6468.268, "sample_time_ms": 24629.25, "load_time_ms": 5.94, "update_time_ms": 7.15, "num_steps_sampled": 360000}, "done": false, "timestamp": 1557102125, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 475.6353024417157, "policy_reward_mean": {}, "episode_len_mean": 750.0, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a7b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578ada0>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 360000, "timesteps_this_iter": 30000, "time_total_s": 381.3083324432373, "node_ip": "10.138.0.2", "time_this_iter_s": 34.086522340774536, "episode_reward_mean": 325.00061555307065, "custom_metrics": {"cost2_min": -4.557512378353273, "system_level_velocity_mean": 9.441711750061586, "outflow_rate_mean": 1119.8080641456847, "cost1_mean": 325.03343054690606, "cost2_max": 0.0, "outflow_rate_max": 1513.1116425035314, "outflow_rate_min": 814.5216133874294, "system_level_velocity_min": 7.212875690637409, "system_level_velocity_max": 14.050613479441042, "cost1_min": 248.80333005671486, "cost1_max": 475.8424021802958, "cost2_mean": -0.32814993835413175}, "episode_reward_min": 248.80333005671486, "hostname": "flow-main", "episodes_this_iter": 43, "timesteps_total": 360000, "date": "2019-05-06_00-22-05", "time_since_restore": 381.3083324432373, "pid": 6439}
{"iterations_since_restore": 13, "training_iteration": 13, "episodes_total": 511, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 390000, "default": {"vf_explained_var": 0.948095440864563, "policy_loss": -0.0056999605149030685, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.75063419342041, "kl": 0.011916182935237885, "vf_loss": 15.736536979675293, "total_loss": 15.733219146728516, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6403.138, "sample_time_ms": 25075.87, "load_time_ms": 5.929, "update_time_ms": 7.245, "num_steps_sampled": 390000}, "done": false, "timestamp": 1557102157, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 523.3236091092806, "policy_reward_mean": {}, "episode_len_mean": 750.0, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578aa90>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 390000, "timesteps_this_iter": 30000, "time_total_s": 412.89195704460144, "node_ip": "10.138.0.2", "time_this_iter_s": 31.583624601364136, "episode_reward_mean": 330.2326335599328, "custom_metrics": {"cost2_min": -4.557512378353273, "system_level_velocity_mean": 9.615846278167135, "outflow_rate_mean": 1140.418046812748, "cost1_mean": 330.270275264031, "cost2_max": 0.0, "outflow_rate_max": 1529.143686363605, "outflow_rate_min": 814.5216133874294, "system_level_velocity_min": 7.212875690637409, "system_level_velocity_max": 14.99938370684739, "cost1_min": 248.80333005671486, "cost1_max": 523.3998201029221, "cost2_mean": -0.376417040981429}, "episode_reward_min": 248.80333005671486, "hostname": "flow-main", "episodes_this_iter": 35, "timesteps_total": 390000, "date": "2019-05-06_00-22-37", "time_since_restore": 412.89195704460144, "pid": 6439}
{"iterations_since_restore": 14, "training_iteration": 14, "episodes_total": 553, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 420000, "default": {"vf_explained_var": 0.9330568313598633, "policy_loss": -0.0061360932886600494, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.746758460998535, "kl": 0.012216459959745407, "vf_loss": 18.81953239440918, "total_loss": 18.815837860107422, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6514.762, "sample_time_ms": 25522.883, "load_time_ms": 5.939, "update_time_ms": 7.246, "num_steps_sampled": 420000}, "done": false, "timestamp": 1557102190, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 543.111455640281, "policy_reward_mean": {}, "episode_len_mean": 750.0, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f57699e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769ac8>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 420000, "timesteps_this_iter": 30000, "time_total_s": 446.0715055465698, "node_ip": "10.138.0.2", "time_this_iter_s": 33.179548501968384, "episode_reward_mean": 336.77027788814695, "custom_metrics": {"cost2_min": -3.8272608083877513, "system_level_velocity_mean": 9.855279078545157, "outflow_rate_mean": 1168.1712286258469, "cost1_mean": 336.8064908126212, "cost2_max": 0.0, "outflow_rate_max": 1587.6478813609547, "outflow_rate_min": 924.369009077609, "system_level_velocity_min": 7.5534341088986015, "system_level_velocity_max": 16.15126799208975, "cost1_min": 258.3808037802312, "cost1_max": 543.1114556402813, "cost2_mean": -0.3621292447416501}, "episode_reward_min": 258.380803780231, "hostname": "flow-main", "episodes_this_iter": 42, "timesteps_total": 420000, "date": "2019-05-06_00-23-10", "time_since_restore": 446.0715055465698, "pid": 6439}
{"iterations_since_restore": 15, "training_iteration": 15, "episodes_total": 594, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 450000, "default": {"vf_explained_var": 0.941412091255188, "policy_loss": -0.005563308950513601, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.760200500488281, "kl": 0.010966107249259949, "vf_loss": 17.153879165649414, "total_loss": 17.150508880615234, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6555.835, "sample_time_ms": 26146.795, "load_time_ms": 6.836, "update_time_ms": 7.882, "num_steps_sampled": 450000}, "done": false, "timestamp": 1557102224, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 543.111455640281, "policy_reward_mean": {}, "episode_len_mean": 746.06, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769978>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 450000, "timesteps_this_iter": 30000, "time_total_s": 479.83922958374023, "node_ip": "10.138.0.2", "time_this_iter_s": 33.76772403717041, "episode_reward_mean": 340.37547647244406, "custom_metrics": {"cost2_min": -3.8272608083877513, "system_level_velocity_mean": 10.084909041940625, "outflow_rate_mean": 1183.1460708279658, "cost1_mean": 340.41941170854557, "cost2_max": 0.0, "outflow_rate_max": 1587.6478813609547, "outflow_rate_min": 836.8989151092347, "system_level_velocity_min": 7.763680465479757, "system_level_velocity_max": 16.15126799208975, "cost1_min": 249.88434115082623, "cost1_max": 543.1114556402813, "cost2_mean": -0.4393523610152912}, "episode_reward_min": 249.84746293328934, "hostname": "flow-main", "episodes_this_iter": 41, "timesteps_total": 450000, "date": "2019-05-06_00-23-44", "time_since_restore": 479.83922958374023, "pid": 6439}
{"iterations_since_restore": 16, "training_iteration": 16, "episodes_total": 635, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 480000, "default": {"vf_explained_var": 0.9368087649345398, "policy_loss": -0.007702170871198177, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.762435436248779, "kl": 0.013258708640933037, "vf_loss": 15.721611022949219, "total_loss": 15.716561317443848, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6490.09, "sample_time_ms": 26655.327, "load_time_ms": 6.819, "update_time_ms": 8.027, "num_steps_sampled": 480000}, "done": false, "timestamp": 1557102257, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 477.08203668718994, "policy_reward_mean": {}, "episode_len_mean": 746.06, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769d68>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 480000, "timesteps_this_iter": 30000, "time_total_s": 512.7880108356476, "node_ip": "10.138.0.2", "time_this_iter_s": 32.94878125190735, "episode_reward_mean": 335.6671169819134, "custom_metrics": {"cost2_min": -2.385641978353537, "system_level_velocity_mean": 9.93875671643317, "outflow_rate_mean": 1167.428710604611, "cost1_mean": 335.70139998267257, "cost2_max": 0.0, "outflow_rate_max": 1506.799868013282, "outflow_rate_min": 836.8989151092347, "system_level_velocity_min": 7.877428452059115, "system_level_velocity_max": 15.652120810040516, "cost1_min": 249.88434115082623, "cost1_max": 477.2223102175875, "cost2_mean": -0.3428300075919389}, "episode_reward_min": 249.84746293328934, "hostname": "flow-main", "episodes_this_iter": 41, "timesteps_total": 480000, "date": "2019-05-06_00-24-17", "time_since_restore": 512.7880108356476, "pid": 6439}
{"iterations_since_restore": 17, "training_iteration": 17, "episodes_total": 673, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 510000, "default": {"vf_explained_var": 0.9320810437202454, "policy_loss": -0.006533936597406864, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.724471569061279, "kl": 0.011594746261835098, "vf_loss": 20.69427490234375, "total_loss": 20.6900577545166, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6653.122, "sample_time_ms": 26642.178, "load_time_ms": 6.354, "update_time_ms": 8.089, "num_steps_sampled": 510000}, "done": false, "timestamp": 1557102289, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 560.4061514181368, "policy_reward_mean": {}, "episode_len_mean": 743.72, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769f98>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 510000, "timesteps_this_iter": 30000, "time_total_s": 544.8448927402496, "node_ip": "10.138.0.2", "time_this_iter_s": 32.05688190460205, "episode_reward_mean": 344.57693002318206, "custom_metrics": {"cost2_min": -4.232231714891143, "system_level_velocity_mean": 10.23136186298357, "outflow_rate_mean": 1186.9376713233755, "cost1_mean": 344.6177232794065, "cost2_max": 0.0, "outflow_rate_max": 1521.7031398065506, "outflow_rate_min": 256.36533499233343, "system_level_velocity_min": 8.064490142538403, "system_level_velocity_max": 16.812266807596426, "cost1_min": 73.11865062188234, "cost1_max": 560.5478257119187, "cost2_mean": -0.40793256224486363}, "episode_reward_min": 73.11865062188234, "hostname": "flow-main", "episodes_this_iter": 38, "timesteps_total": 510000, "date": "2019-05-06_00-24-49", "time_since_restore": 544.8448927402496, "pid": 6439}
{"iterations_since_restore": 18, "training_iteration": 18, "episodes_total": 717, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 540000, "default": {"vf_explained_var": 0.9328113794326782, "policy_loss": -0.009215970523655415, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.744797706604004, "kl": 0.013500655069947243, "vf_loss": 18.853071212768555, "total_loss": 18.846553802490234, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6499.955, "sample_time_ms": 26713.374, "load_time_ms": 7.283, "update_time_ms": 8.362, "num_steps_sampled": 540000}, "done": false, "timestamp": 1557102323, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 560.4061514181368, "policy_reward_mean": {}, "episode_len_mean": 743.72, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f56174a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769978>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 540000, "timesteps_this_iter": 30000, "time_total_s": 578.7417447566986, "node_ip": "10.138.0.2", "time_this_iter_s": 33.896852016448975, "episode_reward_mean": 343.9326968420727, "custom_metrics": {"cost2_min": -4.232231714891143, "system_level_velocity_mean": 10.21465441224479, "outflow_rate_mean": 1194.1538382126203, "cost1_mean": 343.96884010789165, "cost2_max": 0.0, "outflow_rate_max": 1521.7031398065506, "outflow_rate_min": 256.36533499233343, "system_level_velocity_min": 7.703133663039582, "system_level_velocity_max": 16.812266807596426, "cost1_min": 73.11865062188234, "cost1_max": 560.5478257119187, "cost2_mean": -0.3614326581911938}, "episode_reward_min": 73.11865062188234, "hostname": "flow-main", "episodes_this_iter": 44, "timesteps_total": 540000, "date": "2019-05-06_00-25-23", "time_since_restore": 578.7417447566986, "pid": 6439}
{"iterations_since_restore": 19, "training_iteration": 19, "episodes_total": 756, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 570000, "default": {"vf_explained_var": 0.9408663511276245, "policy_loss": -0.004960888065397739, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.728816986083984, "kl": 0.011184094473719597, "vf_loss": 16.61486053466797, "total_loss": 16.612136840820312, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6369.121, "sample_time_ms": 26238.628, "load_time_ms": 7.364, "update_time_ms": 8.164, "num_steps_sampled": 570000}, "done": false, "timestamp": 1557102354, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 455.3090505529789, "policy_reward_mean": {}, "episode_len_mean": 750.0, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a4e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578ab70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a470>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 570000, "timesteps_this_iter": 30000, "time_total_s": 610.3529946804047, "node_ip": "10.138.0.2", "time_this_iter_s": 31.611249923706055, "episode_reward_mean": 340.8708862651737, "custom_metrics": {"cost2_min": -4.232231714891143, "system_level_velocity_mean": 10.012761142445942, "outflow_rate_mean": 1193.0266288391492, "cost1_mean": 340.9189774077455, "cost2_max": 0.0, "outflow_rate_max": 1514.2018280208645, "outflow_rate_min": 913.1688297305291, "system_level_velocity_min": 7.703133663039582, "system_level_velocity_max": 13.537942591122235, "cost1_min": 261.24721714275177, "cost1_max": 455.3090505529792, "cost2_mean": -0.4809114257176031}, "episode_reward_min": 261.24721714275137, "hostname": "flow-main", "episodes_this_iter": 39, "timesteps_total": 570000, "date": "2019-05-06_00-25-54", "time_since_restore": 610.3529946804047, "pid": 6439}
{"iterations_since_restore": 20, "training_iteration": 20, "episodes_total": 796, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 600000, "default": {"vf_explained_var": 0.9335577487945557, "policy_loss": -0.006760095711797476, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.70742130279541, "kl": 0.012486881576478481, "vf_loss": 18.159067153930664, "total_loss": 18.154802322387695, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6466.553, "sample_time_ms": 26054.492, "load_time_ms": 7.897, "update_time_ms": 7.788, "num_steps_sampled": 600000}, "done": false, "timestamp": 1557102387, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 464.8073021965454, "policy_reward_mean": {}, "episode_len_mean": 750.0, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578afd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a5f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a518>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 600000, "timesteps_this_iter": 30000, "time_total_s": 643.0190582275391, "node_ip": "10.138.0.2", "time_this_iter_s": 32.6660635471344, "episode_reward_mean": 341.0281292810051, "custom_metrics": {"cost2_min": -4.0, "system_level_velocity_mean": 10.032648249636003, "outflow_rate_mean": 1194.2273808383848, "cost1_mean": 341.0735448571005, "cost2_max": 0.0, "outflow_rate_max": 1521.4523285852408, "outflow_rate_min": 933.6162898359415, "system_level_velocity_min": 7.740474265471978, "system_level_velocity_max": 13.537942591122235, "cost1_min": 259.1266332677054, "cost1_max": 464.80730219654487, "cost2_mean": -0.45415576095366406}, "episode_reward_min": 259.08865965108316, "hostname": "flow-main", "episodes_this_iter": 40, "timesteps_total": 600000, "date": "2019-05-06_00-26-27", "time_since_restore": 643.0190582275391, "pid": 6439}
{"iterations_since_restore": 21, "training_iteration": 21, "episodes_total": 835, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 630000, "default": {"vf_explained_var": 0.9363202452659607, "policy_loss": -0.005947388242930174, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.695729732513428, "kl": 0.012268221005797386, "vf_loss": 16.78411102294922, "total_loss": 16.78061866760254, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6538.794, "sample_time_ms": 26061.575, "load_time_ms": 7.889, "update_time_ms": 7.947, "num_steps_sampled": 630000}, "done": false, "timestamp": 1557102418, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 464.8073021965454, "policy_reward_mean": {}, "episode_len_mean": 750.0, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578af28>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 630000, "timesteps_this_iter": 30000, "time_total_s": 674.1635990142822, "node_ip": "10.138.0.2", "time_this_iter_s": 31.144540786743164, "episode_reward_mean": 342.2118855776242, "custom_metrics": {"cost2_min": -4.0, "system_level_velocity_mean": 10.06419446055791, "outflow_rate_mean": 1189.6705132550217, "cost1_mean": 342.24772281460605, "cost2_max": 0.0, "outflow_rate_max": 1521.4523285852408, "outflow_rate_min": 933.6162898359415, "system_level_velocity_min": 7.740474265471978, "system_level_velocity_max": 13.453895435857484, "cost1_min": 259.1266332677054, "cost1_max": 464.80730219654487, "cost2_mean": -0.3583723698174001}, "episode_reward_min": 259.08865965108316, "hostname": "flow-main", "episodes_this_iter": 39, "timesteps_total": 630000, "date": "2019-05-06_00-26-58", "time_since_restore": 674.1635990142822, "pid": 6439}
{"iterations_since_restore": 22, "training_iteration": 22, "episodes_total": 877, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 660000, "default": {"vf_explained_var": 0.910714864730835, "policy_loss": -0.006473461166024208, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.669674396514893, "kl": 0.01200628187507391, "vf_loss": 23.638648986816406, "total_loss": 23.634578704833984, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6525.786, "sample_time_ms": 26021.222, "load_time_ms": 7.945, "update_time_ms": 7.988, "num_steps_sampled": 660000}, "done": false, "timestamp": 1557102452, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 450.2187835853252, "policy_reward_mean": {}, "episode_len_mean": 738.81, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578afd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578ac88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578aef0>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 660000, "timesteps_this_iter": 30000, "time_total_s": 707.7167465686798, "node_ip": "10.138.0.2", "time_this_iter_s": 33.55314755439758, "episode_reward_mean": 340.9742960205776, "custom_metrics": {"cost2_min": -4.0, "system_level_velocity_mean": 10.267098193178679, "outflow_rate_mean": 1184.3692927914983, "cost1_mean": 341.00489961018474, "cost2_max": 0.0, "outflow_rate_max": 1494.8140257443151, "outflow_rate_min": 303.78326948593167, "system_level_velocity_min": 7.740474265471978, "system_level_velocity_max": 15.291216865735102, "cost1_min": 82.78673996929194, "cost1_max": 450.2187835853251, "cost2_mean": -0.3060358960711429}, "episode_reward_min": 82.78673996929193, "hostname": "flow-main", "episodes_this_iter": 42, "timesteps_total": 660000, "date": "2019-05-06_00-27-32", "time_since_restore": 707.7167465686798, "pid": 6439}
{"iterations_since_restore": 23, "training_iteration": 23, "episodes_total": 915, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 690000, "default": {"vf_explained_var": 0.9396766424179077, "policy_loss": -0.005879971664398909, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.6496124267578125, "kl": 0.012551028281450272, "vf_loss": 17.525949478149414, "total_loss": 17.522579193115234, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6559.881, "sample_time_ms": 25955.619, "load_time_ms": 7.921, "update_time_ms": 8.111, "num_steps_sampled": 690000}, "done": false, "timestamp": 1557102483, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 541.1514412875858, "policy_reward_mean": {}, "episode_len_mean": 738.81, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578ada0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a0f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a438>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 690000, "timesteps_this_iter": 30000, "time_total_s": 738.9733221530914, "node_ip": "10.138.0.2", "time_this_iter_s": 31.25657558441162, "episode_reward_mean": 348.77011726864964, "custom_metrics": {"cost2_min": -4.538382812372038, "system_level_velocity_mean": 10.51442949974515, "outflow_rate_mean": 1208.0826770780247, "cost1_mean": 348.79520903735886, "cost2_max": 0.0, "outflow_rate_max": 1582.9050392349889, "outflow_rate_min": 303.78326948593167, "system_level_velocity_min": 8.072261753575052, "system_level_velocity_max": 16.101340000192078, "cost1_min": 82.78673996929194, "cost1_max": 541.1825603928332, "cost2_mean": -0.25091768709216433}, "episode_reward_min": 82.78673996929193, "hostname": "flow-main", "episodes_this_iter": 38, "timesteps_total": 690000, "date": "2019-05-06_00-28-03", "time_since_restore": 738.9733221530914, "pid": 6439}
{"iterations_since_restore": 24, "training_iteration": 24, "episodes_total": 957, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 720000, "default": {"vf_explained_var": 0.9301871061325073, "policy_loss": -0.006061806343495846, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.657351970672607, "kl": 0.0119872335344553, "vf_loss": 19.34918975830078, "total_loss": 19.345523834228516, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6534.334, "sample_time_ms": 25843.892, "load_time_ms": 8.008, "update_time_ms": 8.069, "num_steps_sampled": 720000}, "done": false, "timestamp": 1557102515, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 541.1514412875858, "policy_reward_mean": {}, "episode_len_mean": 738.81, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769828>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 720000, "timesteps_this_iter": 30000, "time_total_s": 770.739988565445, "node_ip": "10.138.0.2", "time_this_iter_s": 31.766666412353516, "episode_reward_mean": 355.51413940937545, "custom_metrics": {"cost2_min": -5.965421009677272, "system_level_velocity_mean": 10.72061358265637, "outflow_rate_mean": 1226.9332714543661, "cost1_mean": 355.5526126876494, "cost2_max": 0.0, "outflow_rate_max": 1599.2047780655034, "outflow_rate_min": 303.78326948593167, "system_level_velocity_min": 8.130722071184715, "system_level_velocity_max": 16.101340000192078, "cost1_min": 82.78673996929194, "cost1_max": 541.1825603928332, "cost2_mean": -0.3847327827396835}, "episode_reward_min": 82.78673996929193, "hostname": "flow-main", "episodes_this_iter": 42, "timesteps_total": 720000, "date": "2019-05-06_00-28-35", "time_since_restore": 770.739988565445, "pid": 6439}
{"iterations_since_restore": 25, "training_iteration": 25, "episodes_total": 997, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 750000, "default": {"vf_explained_var": 0.9227879047393799, "policy_loss": -0.007073739543557167, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.733646392822266, "kl": 0.011856433004140854, "vf_loss": 19.850780487060547, "total_loss": 19.846078872680664, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6572.738, "sample_time_ms": 25721.849, "load_time_ms": 7.295, "update_time_ms": 7.815, "num_steps_sampled": 750000}, "done": false, "timestamp": 1557102548, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 534.5439394144036, "policy_reward_mean": {}, "episode_len_mean": 737.67, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f57696d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769f98>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 750000, "timesteps_this_iter": 30000, "time_total_s": 803.6701216697693, "node_ip": "10.138.0.2", "time_this_iter_s": 32.93013310432434, "episode_reward_mean": 349.1119699108619, "custom_metrics": {"cost2_min": -5.965421009677272, "system_level_velocity_mean": 10.528800969849213, "outflow_rate_mean": 1207.337068982308, "cost1_mean": 349.152337761843, "cost2_max": 0.0, "outflow_rate_max": 1599.2047780655034, "outflow_rate_min": 277.10666077925106, "system_level_velocity_min": 7.702587666930704, "system_level_velocity_max": 15.978060315955693, "cost1_min": 78.75231435510727, "cost1_max": 534.565498067936, "cost2_mean": -0.40367850981144615}, "episode_reward_min": 78.75231435510725, "hostname": "flow-main", "episodes_this_iter": 40, "timesteps_total": 750000, "date": "2019-05-06_00-29-08", "time_since_restore": 803.6701216697693, "pid": 6439}
{"iterations_since_restore": 26, "training_iteration": 26, "episodes_total": 1039, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 780000, "default": {"vf_explained_var": 0.926369309425354, "policy_loss": -0.008081363514065742, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.693212985992432, "kl": 0.013973427005112171, "vf_loss": 19.677038192749023, "total_loss": 19.671749114990234, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6498.444, "sample_time_ms": 25583.114, "load_time_ms": 7.334, "update_time_ms": 7.684, "num_steps_sampled": 780000}, "done": false, "timestamp": 1557102579, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 527.2056071537335, "policy_reward_mean": {}, "episode_len_mean": 731.56, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578af60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e0f0>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 780000, "timesteps_this_iter": 30000, "time_total_s": 834.4643566608429, "node_ip": "10.138.0.2", "time_this_iter_s": 30.79423499107361, "episode_reward_mean": 345.12269931907764, "custom_metrics": {"cost2_min": -3.0347370749439735, "system_level_velocity_mean": 10.522792568305702, "outflow_rate_mean": 1193.5173882055817, "cost1_mean": 345.15619823614753, "cost2_max": 0.0, "outflow_rate_max": 1576.0801668753143, "outflow_rate_min": 277.10666077925106, "system_level_velocity_min": 7.702587666930704, "system_level_velocity_max": 15.706927082685633, "cost1_min": 78.75231435510727, "cost1_max": 527.2056071537336, "cost2_mean": -0.33498917069953926}, "episode_reward_min": 78.75231435510725, "hostname": "flow-main", "episodes_this_iter": 42, "timesteps_total": 780000, "date": "2019-05-06_00-29-39", "time_since_restore": 834.4643566608429, "pid": 6439}
{"iterations_since_restore": 27, "training_iteration": 27, "episodes_total": 1076, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 810000, "default": {"vf_explained_var": 0.9285086393356323, "policy_loss": -0.006216839887201786, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.725050926208496, "kl": 0.013310017064213753, "vf_loss": 17.826688766479492, "total_loss": 17.82313346862793, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6549.348, "sample_time_ms": 25668.244, "load_time_ms": 7.309, "update_time_ms": 7.545, "num_steps_sampled": 810000}, "done": false, "timestamp": 1557102612, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 528.8398688465991, "policy_reward_mean": {}, "episode_len_mean": 737.76, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e7b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e7f0>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 810000, "timesteps_this_iter": 30000, "time_total_s": 867.869491815567, "node_ip": "10.138.0.2", "time_this_iter_s": 33.40513515472412, "episode_reward_mean": 350.1929791979826, "custom_metrics": {"cost2_min": -3.0, "system_level_velocity_mean": 10.54954308472104, "outflow_rate_mean": 1204.922200258903, "cost1_mean": 350.23142788812555, "cost2_max": 0.0, "outflow_rate_max": 1576.0801668753143, "outflow_rate_min": 300.4031933595519, "system_level_velocity_min": 7.702587666930704, "system_level_velocity_max": 15.706927082685633, "cost1_min": 82.34457654039565, "cost1_max": 529.0198009466231, "cost2_mean": -0.38448690142973513}, "episode_reward_min": 82.34457654039564, "hostname": "flow-main", "episodes_this_iter": 37, "timesteps_total": 810000, "date": "2019-05-06_00-30-12", "time_since_restore": 867.869491815567, "pid": 6439}
{"iterations_since_restore": 28, "training_iteration": 28, "episodes_total": 1119, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 840000, "default": {"vf_explained_var": 0.9378101229667664, "policy_loss": -0.007546515204012394, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.703360080718994, "kl": 0.013134271837770939, "vf_loss": 16.68314552307129, "total_loss": 16.678224563598633, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6447.786, "sample_time_ms": 25521.618, "load_time_ms": 6.315, "update_time_ms": 7.658, "num_steps_sampled": 840000}, "done": false, "timestamp": 1557102643, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 528.8398688465991, "policy_reward_mean": {}, "episode_len_mean": 743.89, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e9b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e4a8>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 840000, "timesteps_this_iter": 30000, "time_total_s": 899.2726683616638, "node_ip": "10.138.0.2", "time_this_iter_s": 31.4031765460968, "episode_reward_mean": 358.5727059149852, "custom_metrics": {"cost2_min": -3.552772819579102, "system_level_velocity_mean": 10.696937575059321, "outflow_rate_mean": 1228.9077140547847, "cost1_mean": 358.6098196704589, "cost2_max": 0.0, "outflow_rate_max": 1576.0801668753143, "outflow_rate_min": 302.2204953153365, "system_level_velocity_min": 8.025051825099778, "system_level_velocity_max": 15.706927082685633, "cost1_min": 84.72757333344867, "cost1_max": 529.0198009466231, "cost2_mean": -0.3711375547368301}, "episode_reward_min": 84.72757333344867, "hostname": "flow-main", "episodes_this_iter": 43, "timesteps_total": 840000, "date": "2019-05-06_00-30-43", "time_since_restore": 899.2726683616638, "pid": 6439}
{"iterations_since_restore": 29, "training_iteration": 29, "episodes_total": 1158, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 870000, "default": {"vf_explained_var": 0.9271066784858704, "policy_loss": -0.008773919194936752, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.671982288360596, "kl": 0.01339142769575119, "vf_loss": 19.829343795776367, "total_loss": 19.823246002197266, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6520.846, "sample_time_ms": 25587.76, "load_time_ms": 6.184, "update_time_ms": 7.619, "num_steps_sampled": 870000}, "done": false, "timestamp": 1557102676, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 528.8398688465991, "policy_reward_mean": {}, "episode_len_mean": 750.0, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e4e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e5c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578ec18>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 870000, "timesteps_this_iter": 30000, "time_total_s": 932.282107591629, "node_ip": "10.138.0.2", "time_this_iter_s": 33.00943922996521, "episode_reward_mean": 364.6170914484304, "custom_metrics": {"cost2_min": -3.552772819579102, "system_level_velocity_mean": 10.770970254636403, "outflow_rate_mean": 1251.9773514224007, "cost1_mean": 364.6557494775183, "cost2_max": 0.0, "outflow_rate_max": 1569.2077830560956, "outflow_rate_min": 989.485043641046, "system_level_velocity_min": 8.025051825099778, "system_level_velocity_max": 15.604710472264163, "cost1_min": 271.8721940602429, "cost1_max": 529.0198009466231, "cost2_mean": -0.3865802908792879}, "episode_reward_min": 271.87219406024315, "hostname": "flow-main", "episodes_this_iter": 39, "timesteps_total": 870000, "date": "2019-05-06_00-31-16", "time_since_restore": 932.282107591629, "pid": 6439}
{"iterations_since_restore": 30, "training_iteration": 30, "episodes_total": 1199, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 900000, "default": {"vf_explained_var": 0.9052146077156067, "policy_loss": -0.007312638219445944, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.669025421142578, "kl": 0.013453800231218338, "vf_loss": 24.579442977905273, "total_loss": 24.5748233795166, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6411.175, "sample_time_ms": 25661.276, "load_time_ms": 5.212, "update_time_ms": 7.861, "num_steps_sampled": 900000}, "done": false, "timestamp": 1557102709, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 507.25735924037264, "policy_reward_mean": {}, "episode_len_mean": 738.43, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578ef98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578ebe0>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 900000, "timesteps_this_iter": 30000, "time_total_s": 964.574298620224, "node_ip": "10.138.0.2", "time_this_iter_s": 32.29219102859497, "episode_reward_mean": 355.99325495925007, "custom_metrics": {"cost2_min": -3.384509087796358, "system_level_velocity_mean": 10.735047829094288, "outflow_rate_mean": 1222.2813337461637, "cost1_mean": 356.03091660032413, "cost2_max": 0.0, "outflow_rate_max": 1550.7480301957899, "outflow_rate_min": 293.6963257002168, "system_level_velocity_min": 8.025051825099778, "system_level_velocity_max": 15.177762839672553, "cost1_min": 82.24974531647419, "cost1_max": 507.25735924037275, "cost2_mean": -0.37661641074068897}, "episode_reward_min": 82.2497453164742, "hostname": "flow-main", "episodes_this_iter": 41, "timesteps_total": 900000, "date": "2019-05-06_00-31-49", "time_since_restore": 964.574298620224, "pid": 6439}
{"iterations_since_restore": 31, "training_iteration": 31, "episodes_total": 1240, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 930000, "default": {"vf_explained_var": 0.9264740347862244, "policy_loss": -0.0075466386042535305, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.6709442138671875, "kl": 0.012884610332548618, "vf_loss": 20.5767765045166, "total_loss": 20.571807861328125, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6518.534, "sample_time_ms": 25616.861, "load_time_ms": 5.194, "update_time_ms": 7.667, "num_steps_sampled": 930000}, "done": false, "timestamp": 1557102741, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 544.1362426933757, "policy_reward_mean": {}, "episode_len_mean": 733.29, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e2b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e080>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 930000, "timesteps_this_iter": 30000, "time_total_s": 996.3553011417389, "node_ip": "10.138.0.2", "time_this_iter_s": 31.781002521514893, "episode_reward_mean": 355.1781398942246, "custom_metrics": {"cost2_min": -3.384509087796358, "system_level_velocity_mean": 10.83036421155156, "outflow_rate_mean": 1214.2848868858089, "cost1_mean": 355.2133310913543, "cost2_max": 0.0, "outflow_rate_max": 1604.2050368709151, "outflow_rate_min": 293.6963257002168, "system_level_velocity_min": 8.081257441584835, "system_level_velocity_max": 16.475898324495592, "cost1_min": 82.24974531647419, "cost1_max": 544.1362426933765, "cost2_mean": -0.3519119712967428}, "episode_reward_min": 82.2497453164742, "hostname": "flow-main", "episodes_this_iter": 41, "timesteps_total": 930000, "date": "2019-05-06_00-32-21", "time_since_restore": 996.3553011417389, "pid": 6439}
{"iterations_since_restore": 32, "training_iteration": 32, "episodes_total": 1281, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 960000, "default": {"vf_explained_var": 0.9314573407173157, "policy_loss": -0.007339614909142256, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.687549114227295, "kl": 0.012954308651387691, "vf_loss": 17.844194412231445, "total_loss": 17.839445114135742, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6419.117, "sample_time_ms": 25616.607, "load_time_ms": 5.283, "update_time_ms": 7.925, "num_steps_sampled": 960000}, "done": false, "timestamp": 1557102773, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 544.1362426933757, "policy_reward_mean": {}, "episode_len_mean": 739.43, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578ed30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578ee10>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 960000, "timesteps_this_iter": 30000, "time_total_s": 1028.8906648159027, "node_ip": "10.138.0.2", "time_this_iter_s": 32.53536367416382, "episode_reward_mean": 355.4281658821424, "custom_metrics": {"cost2_min": -4.0, "system_level_velocity_mean": 10.734299262010623, "outflow_rate_mean": 1222.863557280854, "cost1_mean": 355.4624989529028, "cost2_max": 0.0, "outflow_rate_max": 1604.2050368709151, "outflow_rate_min": 537.304926220516, "system_level_velocity_min": 8.081257441584835, "system_level_velocity_max": 16.475898324495592, "cost1_min": 134.41267088040655, "cost1_max": 544.1362426933765, "cost2_mean": -0.3433307076034453}, "episode_reward_min": 134.4126708804065, "hostname": "flow-main", "episodes_this_iter": 41, "timesteps_total": 960000, "date": "2019-05-06_00-32-53", "time_since_restore": 1028.8906648159027, "pid": 6439}
{"iterations_since_restore": 33, "training_iteration": 33, "episodes_total": 1321, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 990000, "default": {"vf_explained_var": 0.9121068120002747, "policy_loss": -0.007425204385071993, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.639069557189941, "kl": 0.01413770392537117, "vf_loss": 23.527101516723633, "total_loss": 23.522506713867188, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6454.736, "sample_time_ms": 25624.648, "load_time_ms": 5.276, "update_time_ms": 7.68, "num_steps_sampled": 990000}, "done": false, "timestamp": 1557102805, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 563.9948985416152, "policy_reward_mean": {}, "episode_len_mean": 737.79, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578ea90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578ecc0>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 990000, "timesteps_this_iter": 30000, "time_total_s": 1060.606478214264, "node_ip": "10.138.0.2", "time_this_iter_s": 31.715813398361206, "episode_reward_mean": 356.0161351293256, "custom_metrics": {"cost2_min": -4.0, "system_level_velocity_mean": 10.784546385070527, "outflow_rate_mean": 1222.0874818636025, "cost1_mean": 356.05012508527085, "cost2_max": 0.0, "outflow_rate_max": 1605.852579056195, "outflow_rate_min": 307.9760172405715, "system_level_velocity_min": 8.132765176569725, "system_level_velocity_max": 17.808009148690292, "cost1_min": 85.26796138783786, "cost1_max": 564.1675407086661, "cost2_mean": -0.33989955945322164}, "episode_reward_min": 85.26796138783784, "hostname": "flow-main", "episodes_this_iter": 40, "timesteps_total": 990000, "date": "2019-05-06_00-33-25", "time_since_restore": 1060.606478214264, "pid": 6439}
{"iterations_since_restore": 34, "training_iteration": 34, "episodes_total": 1363, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1020000, "default": {"vf_explained_var": 0.9280104637145996, "policy_loss": -0.008133411407470703, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.643179893493652, "kl": 0.013614930212497711, "vf_loss": 19.990205764770508, "total_loss": 19.984792709350586, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6456.553, "sample_time_ms": 25676.626, "load_time_ms": 5.307, "update_time_ms": 8.025, "num_steps_sampled": 1020000}, "done": false, "timestamp": 1557102837, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 563.9948985416152, "policy_reward_mean": {}, "episode_len_mean": 731.54, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578eef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e4a8>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1020000, "timesteps_this_iter": 30000, "time_total_s": 1092.9054741859436, "node_ip": "10.138.0.2", "time_this_iter_s": 32.29899597167969, "episode_reward_mean": 354.3507297855325, "custom_metrics": {"cost2_min": -3.6568481484298827, "system_level_velocity_mean": 10.856569170390923, "outflow_rate_mean": 1221.805684002513, "cost1_mean": 354.38344994251383, "cost2_max": 0.0, "outflow_rate_max": 1605.852579056195, "outflow_rate_min": 264.62724171596795, "system_level_velocity_min": 8.132765176569725, "system_level_velocity_max": 17.808009148690292, "cost1_min": 75.78287167672939, "cost1_max": 564.1675407086661, "cost2_mean": -0.3272015698127058}, "episode_reward_min": 75.78287167672936, "hostname": "flow-main", "episodes_this_iter": 42, "timesteps_total": 1020000, "date": "2019-05-06_00-33-57", "time_since_restore": 1092.9054741859436, "pid": 6439}
{"iterations_since_restore": 35, "training_iteration": 35, "episodes_total": 1403, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1050000, "default": {"vf_explained_var": 0.9156873822212219, "policy_loss": -0.007544154766947031, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.620235919952393, "kl": 0.013520012609660625, "vf_loss": 22.669282913208008, "total_loss": 22.664445877075195, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6355.673, "sample_time_ms": 25595.194, "load_time_ms": 5.231, "update_time_ms": 7.556, "num_steps_sampled": 1050000}, "done": false, "timestamp": 1557102868, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 563.9948985416152, "policy_reward_mean": {}, "episode_len_mean": 739.62, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578ec18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e390>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1050000, "timesteps_this_iter": 30000, "time_total_s": 1124.0009293556213, "node_ip": "10.138.0.2", "time_this_iter_s": 31.095455169677734, "episode_reward_mean": 359.76594335240793, "custom_metrics": {"cost2_min": -3.6568481484298827, "system_level_velocity_mean": 10.863762939886733, "outflow_rate_mean": 1232.6221726706601, "cost1_mean": 359.798622398421, "cost2_max": 0.0, "outflow_rate_max": 1576.7660108420025, "outflow_rate_min": 264.62724171596795, "system_level_velocity_min": 8.217984342789677, "system_level_velocity_max": 17.808009148690292, "cost1_min": 75.78287167672939, "cost1_max": 564.1675407086661, "cost2_mean": -0.3267904601309615}, "episode_reward_min": 75.78287167672936, "hostname": "flow-main", "episodes_this_iter": 40, "timesteps_total": 1050000, "date": "2019-05-06_00-34-28", "time_since_restore": 1124.0009293556213, "pid": 6439}
{"iterations_since_restore": 36, "training_iteration": 36, "episodes_total": 1444, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1080000, "default": {"vf_explained_var": 0.9070559740066528, "policy_loss": -0.007635828573256731, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.626154899597168, "kl": 0.013955352827906609, "vf_loss": 23.026216506958008, "total_loss": 23.021371841430664, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6528.045, "sample_time_ms": 25609.607, "load_time_ms": 5.22, "update_time_ms": 7.876, "num_steps_sampled": 1080000}, "done": false, "timestamp": 1557102901, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 547.5389241506304, "policy_reward_mean": {}, "episode_len_mean": 739.61, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578eef0>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1080000, "timesteps_this_iter": 30000, "time_total_s": 1156.6918902397156, "node_ip": "10.138.0.2", "time_this_iter_s": 32.69096088409424, "episode_reward_mean": 361.34850495692467, "custom_metrics": {"cost2_min": -3.200958019146028, "system_level_velocity_mean": 10.923222538827709, "outflow_rate_mean": 1237.650787573317, "cost1_mean": 361.3855677991889, "cost2_max": 0.0, "outflow_rate_max": 1575.9025168895942, "outflow_rate_min": 246.96302383181106, "system_level_velocity_min": 8.217984342789677, "system_level_velocity_max": 16.83649249681628, "cost1_min": 74.4134404590226, "cost1_max": 547.6876932662476, "cost2_mean": -0.37062842264144236}, "episode_reward_min": 74.41344045902261, "hostname": "flow-main", "episodes_this_iter": 41, "timesteps_total": 1080000, "date": "2019-05-06_00-35-01", "time_since_restore": 1156.6918902397156, "pid": 6439}
{"iterations_since_restore": 37, "training_iteration": 37, "episodes_total": 1485, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1110000, "default": {"vf_explained_var": 0.9304783344268799, "policy_loss": -0.008968384005129337, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.615921974182129, "kl": 0.013773447833955288, "vf_loss": 17.838529586791992, "total_loss": 17.832317352294922, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6384.638, "sample_time_ms": 25586.882, "load_time_ms": 5.262, "update_time_ms": 8.22, "num_steps_sampled": 1110000}, "done": false, "timestamp": 1557102933, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 504.7775335493937, "policy_reward_mean": {}, "episode_len_mean": 743.74, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578ee48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e128>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1110000, "timesteps_this_iter": 30000, "time_total_s": 1188.426741361618, "node_ip": "10.138.0.2", "time_this_iter_s": 31.734851121902466, "episode_reward_mean": 356.19283277033685, "custom_metrics": {"cost2_min": -3.200958019146028, "system_level_velocity_mean": 10.659544858237382, "outflow_rate_mean": 1231.8860288719643, "cost1_mean": 356.22640368122904, "cost2_max": 0.0, "outflow_rate_max": 1564.1626213997015, "outflow_rate_min": 246.96302383181106, "system_level_velocity_min": 8.217984342789677, "system_level_velocity_max": 15.105089062337962, "cost1_min": 74.4134404590226, "cost1_max": 504.77753354939387, "cost2_mean": -0.3357091089222595}, "episode_reward_min": 74.41344045902261, "hostname": "flow-main", "episodes_this_iter": 41, "timesteps_total": 1110000, "date": "2019-05-06_00-35-33", "time_since_restore": 1188.426741361618, "pid": 6439}
{"iterations_since_restore": 38, "training_iteration": 38, "episodes_total": 1525, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1140000, "default": {"vf_explained_var": 0.9270216226577759, "policy_loss": -0.009530540555715561, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.607294082641602, "kl": 0.015540902502834797, "vf_loss": 19.63673210144043, "total_loss": 19.63031005859375, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6559.818, "sample_time_ms": 25522.775, "load_time_ms": 5.381, "update_time_ms": 7.989, "num_steps_sampled": 1140000}, "done": false, "timestamp": 1557102965, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 560.4629071525479, "policy_reward_mean": {}, "episode_len_mean": 750.0, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578eb70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578eda0>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1140000, "timesteps_this_iter": 30000, "time_total_s": 1220.9562113285065, "node_ip": "10.138.0.2", "time_this_iter_s": 32.52946996688843, "episode_reward_mean": 368.6558844096219, "custom_metrics": {"cost2_min": -3.4818795115431467, "system_level_velocity_mean": 10.933202035625273, "outflow_rate_mean": 1262.0589055611763, "cost1_mean": 368.70305648852445, "cost2_max": 0.0, "outflow_rate_max": 1597.4512682007141, "outflow_rate_min": 1063.8591771294311, "system_level_velocity_min": 8.463934416952664, "system_level_velocity_max": 17.220673747887147, "cost1_min": 286.85768728845096, "cost1_max": 560.5920160529033, "cost2_mean": -0.4717207890271329}, "episode_reward_min": 286.857687288451, "hostname": "flow-main", "episodes_this_iter": 40, "timesteps_total": 1140000, "date": "2019-05-06_00-36-05", "time_since_restore": 1220.9562113285065, "pid": 6439}
{"iterations_since_restore": 39, "training_iteration": 39, "episodes_total": 1566, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1170000, "default": {"vf_explained_var": 0.9257116317749023, "policy_loss": -0.009243622422218323, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.6465325355529785, "kl": 0.014774397946894169, "vf_loss": 18.760921478271484, "total_loss": 18.7546329498291, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6469.376, "sample_time_ms": 25498.763, "load_time_ms": 5.429, "update_time_ms": 8.217, "num_steps_sampled": 1170000}, "done": false, "timestamp": 1557102997, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 560.4629071525479, "policy_reward_mean": {}, "episode_len_mean": 743.74, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578ec50>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1170000, "timesteps_this_iter": 30000, "time_total_s": 1252.8359415531158, "node_ip": "10.138.0.2", "time_this_iter_s": 31.879730224609375, "episode_reward_mean": 363.4784113490358, "custom_metrics": {"cost2_min": -3.8106193793480836, "system_level_velocity_mean": 10.870482070841113, "outflow_rate_mean": 1245.6780970072746, "cost1_mean": 363.5249177823041, "cost2_max": 0.0, "outflow_rate_max": 1597.4512682007141, "outflow_rate_min": 266.71855397573563, "system_level_velocity_min": 8.524275445612572, "system_level_velocity_max": 17.220673747887147, "cost1_min": 73.31833125734761, "cost1_max": 560.5920160529033, "cost2_mean": -0.46506433268355457}, "episode_reward_min": 73.31833125734764, "hostname": "flow-main", "episodes_this_iter": 41, "timesteps_total": 1170000, "date": "2019-05-06_00-36-37", "time_since_restore": 1252.8359415531158, "pid": 6439}
{"iterations_since_restore": 40, "training_iteration": 40, "episodes_total": 1607, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1200000, "default": {"vf_explained_var": 0.9145228862762451, "policy_loss": -0.008579496294260025, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.626788139343262, "kl": 0.014854486100375652, "vf_loss": 20.011255264282227, "total_loss": 20.00564956665039, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6582.362, "sample_time_ms": 25379.414, "load_time_ms": 5.431, "update_time_ms": 8.19, "num_steps_sampled": 1200000}, "done": false, "timestamp": 1557103030, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 528.6277841354191, "policy_reward_mean": {}, "episode_len_mean": 737.72, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578ea90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578eb70>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1200000, "timesteps_this_iter": 30000, "time_total_s": 1285.0669832229614, "node_ip": "10.138.0.2", "time_this_iter_s": 32.23104166984558, "episode_reward_mean": 349.5283877847783, "custom_metrics": {"cost2_min": -3.8106193793480836, "system_level_velocity_mean": 10.51280944686838, "outflow_rate_mean": 1194.7701948240847, "cost1_mean": 349.57329525450785, "cost2_max": 0.0, "outflow_rate_max": 1588.8028870683695, "outflow_rate_min": 266.71855397573563, "system_level_velocity_min": 8.188561441368982, "system_level_velocity_max": 15.911985447796692, "cost1_min": 73.31833125734761, "cost1_max": 528.6277841354191, "cost2_mean": -0.4490746972962286}, "episode_reward_min": 73.31833125734764, "hostname": "flow-main", "episodes_this_iter": 41, "timesteps_total": 1200000, "date": "2019-05-06_00-37-10", "time_since_restore": 1285.0669832229614, "pid": 6439}
{"iterations_since_restore": 41, "training_iteration": 41, "episodes_total": 1646, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1230000, "default": {"vf_explained_var": 0.9156903028488159, "policy_loss": -0.010168812237679958, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.616716384887695, "kl": 0.015868473798036575, "vf_loss": 20.28285789489746, "total_loss": 20.275861740112305, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6492.106, "sample_time_ms": 25417.585, "load_time_ms": 5.522, "update_time_ms": 8.381, "num_steps_sampled": 1230000}, "done": false, "timestamp": 1557103061, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 527.2105128255978, "policy_reward_mean": {}, "episode_len_mean": 737.72, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e2e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e7f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e358>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1230000, "timesteps_this_iter": 30000, "time_total_s": 1316.3319344520569, "node_ip": "10.138.0.2", "time_this_iter_s": 31.26495122909546, "episode_reward_mean": 347.0895105142448, "custom_metrics": {"cost2_min": -3.8106193793480836, "system_level_velocity_mean": 10.433858661229056, "outflow_rate_mean": 1181.7642278443627, "cost1_mean": 347.129164714092, "cost2_max": 0.0, "outflow_rate_max": 1534.2876409355001, "outflow_rate_min": 266.71855397573563, "system_level_velocity_min": 8.188561441368982, "system_level_velocity_max": 15.458714950155104, "cost1_min": 73.31833125734761, "cost1_max": 527.3333989672373, "cost2_mean": -0.39654199847115396}, "episode_reward_min": 73.31833125734764, "hostname": "flow-main", "episodes_this_iter": 39, "timesteps_total": 1230000, "date": "2019-05-06_00-37-41", "time_since_restore": 1316.3319344520569, "pid": 6439}
{"iterations_since_restore": 42, "training_iteration": 42, "episodes_total": 1686, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1260000, "default": {"vf_explained_var": 0.924222469329834, "policy_loss": -0.01038650143891573, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.614804744720459, "kl": 0.015829959884285927, "vf_loss": 18.525060653686523, "total_loss": 18.517841339111328, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6580.753, "sample_time_ms": 25317.574, "load_time_ms": 5.352, "update_time_ms": 8.271, "num_steps_sampled": 1260000}, "done": false, "timestamp": 1557103093, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 561.63118117204, "policy_reward_mean": {}, "episode_len_mean": 743.98, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e5f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578ea58>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1260000, "timesteps_this_iter": 30000, "time_total_s": 1348.775160074234, "node_ip": "10.138.0.2", "time_this_iter_s": 32.443225622177124, "episode_reward_mean": 352.53139134639804, "custom_metrics": {"cost2_min": -3.472644589419067, "system_level_velocity_mean": 10.499291934012108, "outflow_rate_mean": 1195.3822433900311, "cost1_mean": 352.57379037885306, "cost2_max": 0.0, "outflow_rate_max": 1579.731539668574, "outflow_rate_min": 332.04566951267765, "system_level_velocity_min": 8.140449425656056, "system_level_velocity_max": 17.363796195931805, "cost1_min": 92.96813924641708, "cost1_max": 561.7487478978444, "cost2_mean": -0.42399032455130686}, "episode_reward_min": 92.96813924641704, "hostname": "flow-main", "episodes_this_iter": 40, "timesteps_total": 1260000, "date": "2019-05-06_00-38-13", "time_since_restore": 1348.775160074234, "pid": 6439}
{"iterations_since_restore": 43, "training_iteration": 43, "episodes_total": 1726, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1290000, "default": {"vf_explained_var": 0.9084468483924866, "policy_loss": -0.009250160306692123, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.580942630767822, "kl": 0.01630955934524536, "vf_loss": 23.217573165893555, "total_loss": 23.211585998535156, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6520.669, "sample_time_ms": 25387.042, "load_time_ms": 5.393, "update_time_ms": 8.383, "num_steps_sampled": 1290000}, "done": false, "timestamp": 1557103125, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 567.6258148772622, "policy_reward_mean": {}, "episode_len_mean": 743.77, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578edd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e278>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1290000, "timesteps_this_iter": 30000, "time_total_s": 1380.5692188739777, "node_ip": "10.138.0.2", "time_this_iter_s": 31.794058799743652, "episode_reward_mean": 364.6252321603147, "custom_metrics": {"cost2_min": -3.8638979584097677, "system_level_velocity_mean": 10.913343409021802, "outflow_rate_mean": 1227.7396390790668, "cost1_mean": 364.6744957765059, "cost2_max": 0.0, "outflow_rate_max": 1579.731539668574, "outflow_rate_min": 268.44938932020506, "system_level_velocity_min": 8.140449425656056, "system_level_velocity_max": 17.463115883591303, "cost1_min": 76.65327675562988, "cost1_max": 568.0122046731025, "cost2_mean": -0.4926361619131079}, "episode_reward_min": 76.6532767556299, "hostname": "flow-main", "episodes_this_iter": 40, "timesteps_total": 1290000, "date": "2019-05-06_00-38-45", "time_since_restore": 1380.5692188739777, "pid": 6439}
{"iterations_since_restore": 44, "training_iteration": 44, "episodes_total": 1767, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1320000, "default": {"vf_explained_var": 0.9070332646369934, "policy_loss": -0.010900454595685005, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.573807716369629, "kl": 0.015849705785512924, "vf_loss": 20.725481033325195, "total_loss": 20.717750549316406, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6493.669, "sample_time_ms": 24863.043, "load_time_ms": 5.296, "update_time_ms": 8.173, "num_steps_sampled": 1320000}, "done": false, "timestamp": 1557103152, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 567.6258148772622, "policy_reward_mean": {}, "episode_len_mean": 743.77, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769f60>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1320000, "timesteps_this_iter": 30000, "time_total_s": 1407.3446600437164, "node_ip": "10.138.0.2", "time_this_iter_s": 26.77544116973877, "episode_reward_mean": 362.85060487567165, "custom_metrics": {"cost2_min": -3.8638979584097677, "system_level_velocity_mean": 10.866723179900987, "outflow_rate_mean": 1227.191270227003, "cost1_mean": 362.8917511866413, "cost2_max": 0.0, "outflow_rate_max": 1579.731539668574, "outflow_rate_min": 268.44938932020506, "system_level_velocity_min": 8.140449425656056, "system_level_velocity_max": 17.463115883591303, "cost1_min": 76.65327675562988, "cost1_max": 568.0122046731025, "cost2_mean": -0.41146310969668315}, "episode_reward_min": 76.6532767556299, "hostname": "flow-main", "episodes_this_iter": 41, "timesteps_total": 1320000, "date": "2019-05-06_00-39-12", "time_since_restore": 1407.3446600437164, "pid": 6439}
{"iterations_since_restore": 45, "training_iteration": 45, "episodes_total": 1807, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1350000, "default": {"vf_explained_var": 0.896826982498169, "policy_loss": -0.009549328126013279, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.547375679016113, "kl": 0.016580095514655113, "vf_loss": 22.609689712524414, "total_loss": 22.603458404541016, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6497.197, "sample_time_ms": 24303.453, "load_time_ms": 5.188, "update_time_ms": 8.197, "num_steps_sampled": 1350000}, "done": false, "timestamp": 1557103177, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 537.164057239923, "policy_reward_mean": {}, "episode_len_mean": 738.49, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a6d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578af60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a710>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1350000, "timesteps_this_iter": 30000, "time_total_s": 1432.8626296520233, "node_ip": "10.138.0.2", "time_this_iter_s": 25.517969608306885, "episode_reward_mean": 354.33702148703344, "custom_metrics": {"cost2_min": -4.0, "system_level_velocity_mean": 10.70922890807716, "outflow_rate_mean": 1204.6929749226747, "cost1_mean": 354.3709302140853, "cost2_max": 0.0, "outflow_rate_max": 1604.0790684037793, "outflow_rate_min": 268.44938932020506, "system_level_velocity_min": 8.484830512848546, "system_level_velocity_max": 16.357752955887545, "cost1_min": 76.65327675562988, "cost1_max": 537.2431471071337, "cost2_mean": -0.3390872705193581}, "episode_reward_min": 76.6532767556299, "hostname": "flow-main", "episodes_this_iter": 40, "timesteps_total": 1350000, "date": "2019-05-06_00-39-37", "time_since_restore": 1432.8626296520233, "pid": 6439}
{"iterations_since_restore": 46, "training_iteration": 46, "episodes_total": 1847, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1380000, "default": {"vf_explained_var": 0.9044402241706848, "policy_loss": -0.009279981255531311, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.553403377532959, "kl": 0.015662357211112976, "vf_loss": 21.608243942260742, "total_loss": 21.602096557617188, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6440.817, "sample_time_ms": 23684.512, "load_time_ms": 5.21, "update_time_ms": 7.873, "num_steps_sampled": 1380000}, "done": false, "timestamp": 1557103203, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 541.3679255168827, "policy_reward_mean": {}, "episode_len_mean": 739.56, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578ac50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5621978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f56213c8>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1380000, "timesteps_this_iter": 30000, "time_total_s": 1458.7695479393005, "node_ip": "10.138.0.2", "time_this_iter_s": 25.90691828727722, "episode_reward_mean": 360.3036720717231, "custom_metrics": {"cost2_min": -4.419860705054391, "system_level_velocity_mean": 10.89491552121014, "outflow_rate_mean": 1225.0558634134518, "cost1_mean": 360.33748853431854, "cost2_max": 0.0, "outflow_rate_max": 1612.639825897065, "outflow_rate_min": 579.2046639411302, "system_level_velocity_min": 8.210433945821245, "system_level_velocity_max": 16.357752955887545, "cost1_min": 148.2728898960699, "cost1_max": 541.3679255168836, "cost2_mean": -0.3381646259537773}, "episode_reward_min": 148.27288989606978, "hostname": "flow-main", "episodes_this_iter": 40, "timesteps_total": 1380000, "date": "2019-05-06_00-40-03", "time_since_restore": 1458.7695479393005, "pid": 6439}
{"iterations_since_restore": 47, "training_iteration": 47, "episodes_total": 1889, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1410000, "default": {"vf_explained_var": 0.9015607833862305, "policy_loss": -0.010137883946299553, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.5026092529296875, "kl": 0.016295678913593292, "vf_loss": 22.59284782409668, "total_loss": 22.585968017578125, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6445.775, "sample_time_ms": 23145.936, "load_time_ms": 5.233, "update_time_ms": 7.551, "num_steps_sampled": 1410000}, "done": false, "timestamp": 1557103230, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 541.3679255168827, "policy_reward_mean": {}, "episode_len_mean": 739.56, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e3c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f56219b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f56218d0>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1410000, "timesteps_this_iter": 30000, "time_total_s": 1485.1642305850983, "node_ip": "10.138.0.2", "time_this_iter_s": 26.39468264579773, "episode_reward_mean": 363.8934002287098, "custom_metrics": {"cost2_min": -4.581945227793534, "system_level_velocity_mean": 11.03906312119991, "outflow_rate_mean": 1234.305619523867, "cost1_mean": 363.936243799271, "cost2_max": 0.0, "outflow_rate_max": 1612.639825897065, "outflow_rate_min": 579.2046639411302, "system_level_velocity_min": 7.945169350953357, "system_level_velocity_max": 16.357752955887545, "cost1_min": 148.2728898960699, "cost1_max": 541.3679255168836, "cost2_mean": -0.42843570561349}, "episode_reward_min": 148.27288989606978, "hostname": "flow-main", "episodes_this_iter": 42, "timesteps_total": 1410000, "date": "2019-05-06_00-40-30", "time_since_restore": 1485.1642305850983, "pid": 6439}
{"iterations_since_restore": 48, "training_iteration": 48, "episodes_total": 1928, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1440000, "default": {"vf_explained_var": 0.9019055962562561, "policy_loss": -0.010700873099267483, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.5391740798950195, "kl": 0.016794774681329727, "vf_loss": 22.96735191345215, "total_loss": 22.960010528564453, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6357.156, "sample_time_ms": 22594.573, "load_time_ms": 5.115, "update_time_ms": 7.359, "num_steps_sampled": 1440000}, "done": false, "timestamp": 1557103256, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 552.6256856428417, "policy_reward_mean": {}, "episode_len_mean": 744.84, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5621470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5621978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5621630>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1440000, "timesteps_this_iter": 30000, "time_total_s": 1511.269283771515, "node_ip": "10.138.0.2", "time_this_iter_s": 26.105053186416626, "episode_reward_mean": 369.4538418966661, "custom_metrics": {"cost2_min": -4.581945227793534, "system_level_velocity_mean": 11.116060891299346, "outflow_rate_mean": 1244.660005873461, "cost1_mean": 369.4922959962374, "cost2_max": 0.0, "outflow_rate_max": 1646.6108188934882, "outflow_rate_min": 607.9847801154244, "system_level_velocity_min": 7.945169350953357, "system_level_velocity_max": 16.686488098639632, "cost1_min": 157.48775260166678, "cost1_max": 552.6256856428422, "cost2_mean": -0.3845409957117961}, "episode_reward_min": 157.48775260166676, "hostname": "flow-main", "episodes_this_iter": 39, "timesteps_total": 1440000, "date": "2019-05-06_00-40-56", "time_since_restore": 1511.269283771515, "pid": 6439}
{"iterations_since_restore": 49, "training_iteration": 49, "episodes_total": 1967, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1470000, "default": {"vf_explained_var": 0.908905029296875, "policy_loss": -0.01011045090854168, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.493318557739258, "kl": 0.016672782599925995, "vf_loss": 21.611530303955078, "total_loss": 21.604753494262695, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6425.879, "sample_time_ms": 22010.583, "load_time_ms": 5.171, "update_time_ms": 7.08, "num_steps_sampled": 1470000}, "done": false, "timestamp": 1557103283, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 552.6256856428417, "policy_reward_mean": {}, "episode_len_mean": 743.66, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5621cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5621e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f56214a8>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1470000, "timesteps_this_iter": 30000, "time_total_s": 1537.9702525138855, "node_ip": "10.138.0.2", "time_this_iter_s": 26.700968742370605, "episode_reward_mean": 370.49453804594737, "custom_metrics": {"cost2_min": -2.892918761919164, "system_level_velocity_mean": 11.162326818340292, "outflow_rate_mean": 1245.5701881233217, "cost1_mean": 370.52464545477903, "cost2_max": 0.0, "outflow_rate_max": 1646.6108188934882, "outflow_rate_min": 247.36222331862774, "system_level_velocity_min": 7.945169350953357, "system_level_velocity_max": 16.686488098639632, "cost1_min": 68.77626983517891, "cost1_max": 552.6256856428422, "cost2_mean": -0.3010740883169271}, "episode_reward_min": 68.77626983517892, "hostname": "flow-main", "episodes_this_iter": 39, "timesteps_total": 1470000, "date": "2019-05-06_00-41-23", "time_since_restore": 1537.9702525138855, "pid": 6439}
{"iterations_since_restore": 50, "training_iteration": 50, "episodes_total": 2008, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1500000, "default": {"vf_explained_var": 0.9078628420829773, "policy_loss": -0.008702419698238373, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.4679718017578125, "kl": 0.015230213291943073, "vf_loss": 22.997447967529297, "total_loss": 22.991788864135742, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6358.145, "sample_time_ms": 21481.112, "load_time_ms": 5.135, "update_time_ms": 6.934, "num_steps_sampled": 1500000}, "done": false, "timestamp": 1557103309, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 551.9056974393231, "policy_reward_mean": {}, "episode_len_mean": 743.66, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e9b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578ebe0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e860>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1500000, "timesteps_this_iter": 30000, "time_total_s": 1564.2182352542877, "node_ip": "10.138.0.2", "time_this_iter_s": 26.24798274040222, "episode_reward_mean": 372.56443390247324, "custom_metrics": {"cost2_min": -3.7332609442365747, "system_level_velocity_mean": 11.211734772795856, "outflow_rate_mean": 1256.5243125949492, "cost1_mean": 372.600112566627, "cost2_max": 0.0, "outflow_rate_max": 1646.6108188934882, "outflow_rate_min": 247.36222331862774, "system_level_velocity_min": 8.119758640445802, "system_level_velocity_max": 16.686488098639632, "cost1_min": 68.77626983517891, "cost1_max": 551.9056974393233, "cost2_mean": -0.356786641536901}, "episode_reward_min": 68.77626983517892, "hostname": "flow-main", "episodes_this_iter": 41, "timesteps_total": 1500000, "date": "2019-05-06_00-41-49", "time_since_restore": 1564.2182352542877, "pid": 6439}
{"iterations_since_restore": 51, "training_iteration": 51, "episodes_total": 2049, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1530000, "default": {"vf_explained_var": 0.9149682521820068, "policy_loss": -0.009778372012078762, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.469770908355713, "kl": 0.016861626878380775, "vf_loss": 21.27792739868164, "total_loss": 21.271522521972656, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6341.838, "sample_time_ms": 20914.677, "load_time_ms": 5.108, "update_time_ms": 6.972, "num_steps_sampled": 1530000}, "done": false, "timestamp": 1557103334, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 551.9056974393231, "policy_reward_mean": {}, "episode_len_mean": 743.67, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578add8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a128>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1530000, "timesteps_this_iter": 30000, "time_total_s": 1589.6258790493011, "node_ip": "10.138.0.2", "time_this_iter_s": 25.407643795013428, "episode_reward_mean": 375.3766087737402, "custom_metrics": {"cost2_min": -3.7332609442365747, "system_level_velocity_mean": 11.306397821997063, "outflow_rate_mean": 1265.8486610240639, "cost1_mean": 375.4190899477336, "cost2_max": 0.0, "outflow_rate_max": 1622.577400901344, "outflow_rate_min": 244.99157175954065, "system_level_velocity_min": 8.078280889356085, "system_level_velocity_max": 16.58554002082636, "cost1_min": 69.73504274077031, "cost1_max": 551.9056974393233, "cost2_mean": -0.42481173993379256}, "episode_reward_min": 69.73504274077031, "hostname": "flow-main", "episodes_this_iter": 41, "timesteps_total": 1530000, "date": "2019-05-06_00-42-14", "time_since_restore": 1589.6258790493011, "pid": 6439}
{"iterations_since_restore": 52, "training_iteration": 52, "episodes_total": 2089, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1560000, "default": {"vf_explained_var": 0.9041017293930054, "policy_loss": -0.009359830059111118, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.472639560699463, "kl": 0.01609918847680092, "vf_loss": 23.42393684387207, "total_loss": 23.417797088623047, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6274.713, "sample_time_ms": 20316.186, "load_time_ms": 5.206, "update_time_ms": 6.651, "num_steps_sampled": 1560000}, "done": false, "timestamp": 1557103360, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 547.283051449565, "policy_reward_mean": {}, "episode_len_mean": 733.1, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e3c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578e780>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1560000, "timesteps_this_iter": 30000, "time_total_s": 1615.3786597251892, "node_ip": "10.138.0.2", "time_this_iter_s": 25.75278067588806, "episode_reward_mean": 364.9421244337251, "custom_metrics": {"cost2_min": -2.524218056687874, "system_level_velocity_mean": 11.208006492795766, "outflow_rate_mean": 1238.7134713637854, "cost1_mean": 364.9692341567967, "cost2_max": 0.0, "outflow_rate_max": 1619.9930522006675, "outflow_rate_min": 244.99157175954065, "system_level_velocity_min": 8.078280889356085, "system_level_velocity_max": 16.58554002082636, "cost1_min": 69.73504274077031, "cost1_max": 547.4049801138799, "cost2_mean": -0.2710972307154957}, "episode_reward_min": 69.73504274077031, "hostname": "flow-main", "episodes_this_iter": 40, "timesteps_total": 1560000, "date": "2019-05-06_00-42-40", "time_since_restore": 1615.3786597251892, "pid": 6439}
{"iterations_since_restore": 53, "training_iteration": 53, "episodes_total": 2131, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1590000, "default": {"vf_explained_var": 0.9187574982643127, "policy_loss": -0.009917358867824078, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.484652042388916, "kl": 0.016080329194664955, "vf_loss": 19.482589721679688, "total_loss": 19.475887298583984, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6293.18, "sample_time_ms": 19780.776, "load_time_ms": 5.142, "update_time_ms": 6.519, "num_steps_sampled": 1590000}, "done": false, "timestamp": 1557103387, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 547.283051449565, "policy_reward_mean": {}, "episode_len_mean": 733.1, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a748>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1590000, "timesteps_this_iter": 30000, "time_total_s": 1641.9962363243103, "node_ip": "10.138.0.2", "time_this_iter_s": 26.617576599121094, "episode_reward_mean": 364.3220806462165, "custom_metrics": {"cost2_min": -2.939197575981531, "system_level_velocity_mean": 11.169226916187021, "outflow_rate_mean": 1241.771267422816, "cost1_mean": 364.3467611950504, "cost2_max": 0.0, "outflow_rate_max": 1619.9930522006675, "outflow_rate_min": 244.99157175954065, "system_level_velocity_min": 8.078280889356085, "system_level_velocity_max": 16.58554002082636, "cost1_min": 69.73504274077031, "cost1_max": 547.4049801138799, "cost2_mean": -0.24680548833918808}, "episode_reward_min": 69.73504274077031, "hostname": "flow-main", "episodes_this_iter": 42, "timesteps_total": 1590000, "date": "2019-05-06_00-43-07", "time_since_restore": 1641.9962363243103, "pid": 6439}
{"iterations_since_restore": 54, "training_iteration": 54, "episodes_total": 2170, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1620000, "default": {"vf_explained_var": 0.9143694639205933, "policy_loss": -0.010104421526193619, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.4837422370910645, "kl": 0.015920015051960945, "vf_loss": 19.309566497802734, "total_loss": 19.30264663696289, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6292.527, "sample_time_ms": 19667.287, "load_time_ms": 5.264, "update_time_ms": 6.535, "num_steps_sampled": 1620000}, "done": false, "timestamp": 1557103412, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 505.78521195664524, "policy_reward_mean": {}, "episode_len_mean": 750.0, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578af28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a208>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1620000, "timesteps_this_iter": 30000, "time_total_s": 1667.6334881782532, "node_ip": "10.138.0.2", "time_this_iter_s": 25.63725185394287, "episode_reward_mean": 367.1957854023754, "custom_metrics": {"cost2_min": -4.0, "system_level_velocity_mean": 10.899629000715105, "outflow_rate_mean": 1254.0026072178896, "cost1_mean": 367.22758204306314, "cost2_max": 0.0, "outflow_rate_max": 1500.8854467063943, "outflow_rate_min": 1018.0941541015565, "system_level_velocity_min": 8.839611304766008, "system_level_velocity_max": 15.212684958730067, "cost1_min": 300.60601617840564, "cost1_max": 506.05402852586894, "cost2_mean": -0.31796640687748834}, "episode_reward_min": 300.6060161784055, "hostname": "flow-main", "episodes_this_iter": 39, "timesteps_total": 1620000, "date": "2019-05-06_00-43-32", "time_since_restore": 1667.6334881782532, "pid": 6439}
{"iterations_since_restore": 55, "training_iteration": 55, "episodes_total": 2210, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1650000, "default": {"vf_explained_var": 0.9074268341064453, "policy_loss": -0.010112324729561806, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.510799407958984, "kl": 0.015551704913377762, "vf_loss": 21.1790714263916, "total_loss": 21.17207145690918, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6307.137, "sample_time_ms": 19687.933, "load_time_ms": 5.37, "update_time_ms": 6.495, "num_steps_sampled": 1650000}, "done": false, "timestamp": 1557103438, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 511.28995926929514, "policy_reward_mean": {}, "episode_len_mean": 750.0, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f578a630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f57960b8>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1650000, "timesteps_this_iter": 30000, "time_total_s": 1693.5111138820648, "node_ip": "10.138.0.2", "time_this_iter_s": 25.877625703811646, "episode_reward_mean": 367.51259074930596, "custom_metrics": {"cost2_min": -5.0, "system_level_velocity_mean": 10.916151227591481, "outflow_rate_mean": 1250.4253670238822, "cost1_mean": 367.55047696388044, "cost2_max": 0.0, "outflow_rate_max": 1562.0852625632472, "outflow_rate_min": 1018.0941541015565, "system_level_velocity_min": 8.839148918466888, "system_level_velocity_max": 15.204404607041578, "cost1_min": 297.4827718068567, "cost1_max": 511.28995926929474, "cost2_mean": -0.3788621457445489}, "episode_reward_min": 297.43023005410487, "hostname": "flow-main", "episodes_this_iter": 40, "timesteps_total": 1650000, "date": "2019-05-06_00-43-58", "time_since_restore": 1693.5111138820648, "pid": 6439}
{"iterations_since_restore": 56, "training_iteration": 56, "episodes_total": 2250, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1680000, "default": {"vf_explained_var": 0.9171540141105652, "policy_loss": -0.011003708466887474, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.50978422164917, "kl": 0.016423018649220467, "vf_loss": 19.809154510498047, "total_loss": 19.801437377929688, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6292.009, "sample_time_ms": 19692.845, "load_time_ms": 5.368, "update_time_ms": 6.46, "num_steps_sampled": 1680000}, "done": false, "timestamp": 1557103464, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 511.28995926929514, "policy_reward_mean": {}, "episode_len_mean": 743.82, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796ac8>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1680000, "timesteps_this_iter": 30000, "time_total_s": 1719.312111377716, "node_ip": "10.138.0.2", "time_this_iter_s": 25.800997495651245, "episode_reward_mean": 363.72089807860203, "custom_metrics": {"cost2_min": -5.0, "system_level_velocity_mean": 10.936036271433686, "outflow_rate_mean": 1237.2888903523274, "cost1_mean": 363.7623165649688, "cost2_max": 0.0, "outflow_rate_max": 1562.0852625632472, "outflow_rate_min": 291.90637190822076, "system_level_velocity_min": 8.7386157481155, "system_level_velocity_max": 15.204404607041578, "cost1_min": 80.87887856020589, "cost1_max": 511.28995926929474, "cost2_mean": -0.4141848636688217}, "episode_reward_min": 80.87887856020589, "hostname": "flow-main", "episodes_this_iter": 40, "timesteps_total": 1680000, "date": "2019-05-06_00-44-24", "time_since_restore": 1719.312111377716, "pid": 6439}
{"iterations_since_restore": 57, "training_iteration": 57, "episodes_total": 2293, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1710000, "default": {"vf_explained_var": 0.8910723924636841, "policy_loss": -0.010094840079545975, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.501780033111572, "kl": 0.016847331076860428, "vf_loss": 24.085830688476562, "total_loss": 24.079105377197266, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6273.188, "sample_time_ms": 19814.543, "load_time_ms": 5.321, "update_time_ms": 6.419, "num_steps_sampled": 1710000}, "done": false, "timestamp": 1557103492, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 511.28995926929514, "policy_reward_mean": {}, "episode_len_mean": 731.48, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796748>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1710000, "timesteps_this_iter": 30000, "time_total_s": 1746.7269201278687, "node_ip": "10.138.0.2", "time_this_iter_s": 27.414808750152588, "episode_reward_mean": 358.56738907566955, "custom_metrics": {"cost2_min": -5.0, "system_level_velocity_mean": 11.03228228056051, "outflow_rate_mean": 1220.4747116579135, "cost1_mean": 358.60977047368186, "cost2_max": 0.0, "outflow_rate_max": 1562.0852625632472, "outflow_rate_min": 287.56591492103314, "system_level_velocity_min": 8.352138711326845, "system_level_velocity_max": 15.491181580918589, "cost1_min": 80.87887856020589, "cost1_max": 511.28995926929474, "cost2_mean": -0.4238139801227105}, "episode_reward_min": 80.87887856020589, "hostname": "flow-main", "episodes_this_iter": 43, "timesteps_total": 1710000, "date": "2019-05-06_00-44-52", "time_since_restore": 1746.7269201278687, "pid": 6439}
{"iterations_since_restore": 58, "training_iteration": 58, "episodes_total": 2333, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1740000, "default": {"vf_explained_var": 0.9137200713157654, "policy_loss": -0.011266730725765228, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.4984588623046875, "kl": 0.016896791756153107, "vf_loss": 20.03460693359375, "total_loss": 20.026721954345703, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6278.997, "sample_time_ms": 19859.15, "load_time_ms": 5.332, "update_time_ms": 6.438, "num_steps_sampled": 1740000}, "done": false, "timestamp": 1557103518, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 528.6727150509, "policy_reward_mean": {}, "episode_len_mean": 725.39, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796128>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1740000, "timesteps_this_iter": 30000, "time_total_s": 1773.3364737033844, "node_ip": "10.138.0.2", "time_this_iter_s": 26.609553575515747, "episode_reward_mean": 354.47180754850444, "custom_metrics": {"cost2_min": -4.5187687061213895, "system_level_velocity_mean": 11.025439405877353, "outflow_rate_mean": 1208.7689905311197, "cost1_mean": 354.51921308285586, "cost2_max": 0.0, "outflow_rate_max": 1592.744813824284, "outflow_rate_min": 287.56591492103314, "system_level_velocity_min": 8.352138711326845, "system_level_velocity_max": 16.07146433773111, "cost1_min": 80.87887856020589, "cost1_max": 528.6727150508998, "cost2_mean": -0.47405534351341866}, "episode_reward_min": 80.87887856020589, "hostname": "flow-main", "episodes_this_iter": 40, "timesteps_total": 1740000, "date": "2019-05-06_00-45-18", "time_since_restore": 1773.3364737033844, "pid": 6439}
{"iterations_since_restore": 59, "training_iteration": 59, "episodes_total": 2374, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1770000, "default": {"vf_explained_var": 0.913321316242218, "policy_loss": -0.011882396414875984, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.467762470245361, "kl": 0.01736549660563469, "vf_loss": 21.396549224853516, "total_loss": 21.388137817382812, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6245.348, "sample_time_ms": 19831.599, "load_time_ms": 5.28, "update_time_ms": 6.421, "num_steps_sampled": 1770000}, "done": false, "timestamp": 1557103544, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 532.805492661263, "policy_reward_mean": {}, "episode_len_mean": 743.91, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796cf8>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1770000, "timesteps_this_iter": 30000, "time_total_s": 1799.4227328300476, "node_ip": "10.138.0.2", "time_this_iter_s": 26.086259126663208, "episode_reward_mean": 368.1221301335911, "custom_metrics": {"cost2_min": -4.463399556060935, "system_level_velocity_mean": 11.112489414894878, "outflow_rate_mean": 1246.296472960618, "cost1_mean": 368.1688059353508, "cost2_max": 0.0, "outflow_rate_max": 1624.0765672763027, "outflow_rate_min": 317.5017690587524, "system_level_velocity_min": 8.45528815180377, "system_level_velocity_max": 16.292547489659245, "cost1_min": 86.23194373938054, "cost1_max": 532.8054926612629, "cost2_mean": -0.46675801759707}, "episode_reward_min": 86.23194373938054, "hostname": "flow-main", "episodes_this_iter": 41, "timesteps_total": 1770000, "date": "2019-05-06_00-45-44", "time_since_restore": 1799.4227328300476, "pid": 6439}
{"iterations_since_restore": 60, "training_iteration": 60, "episodes_total": 2412, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1800000, "default": {"vf_explained_var": 0.9253714680671692, "policy_loss": -0.012664513662457466, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.499128818511963, "kl": 0.016358548775315285, "vf_loss": 18.14837646484375, "total_loss": 18.13898468017578, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6249.984, "sample_time_ms": 19823.546, "load_time_ms": 5.392, "update_time_ms": 6.291, "num_steps_sampled": 1800000}, "done": false, "timestamp": 1557103571, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 532.805492661263, "policy_reward_mean": {}, "episode_len_mean": 750.0, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796160>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1800000, "timesteps_this_iter": 30000, "time_total_s": 1825.6384973526, "node_ip": "10.138.0.2", "time_this_iter_s": 26.21576452255249, "episode_reward_mean": 368.62787008077333, "custom_metrics": {"cost2_min": -3.617732480559857, "system_level_velocity_mean": 11.020199489809151, "outflow_rate_mean": 1259.0833559893947, "cost1_mean": 368.6740248763631, "cost2_max": 0.0, "outflow_rate_max": 1625.002120555695, "outflow_rate_min": 988.4937431514835, "system_level_velocity_min": 8.45528815180377, "system_level_velocity_max": 16.292547489659245, "cost1_min": 286.83368036818536, "cost1_max": 532.8054926612629, "cost2_mean": -0.46154795589646125}, "episode_reward_min": 286.5290268687775, "hostname": "flow-main", "episodes_this_iter": 38, "timesteps_total": 1800000, "date": "2019-05-06_00-46-11", "time_since_restore": 1825.6384973526, "pid": 6439}
{"iterations_since_restore": 61, "training_iteration": 61, "episodes_total": 2453, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1830000, "default": {"vf_explained_var": 0.9010834097862244, "policy_loss": -0.01056304108351469, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.456361293792725, "kl": 0.01781100407242775, "vf_loss": 24.53661346435547, "total_loss": 24.52960968017578, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6321.206, "sample_time_ms": 19888.952, "load_time_ms": 5.433, "update_time_ms": 6.193, "num_steps_sampled": 1830000}, "done": false, "timestamp": 1557103597, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 511.495471063329, "policy_reward_mean": {}, "episode_len_mean": 738.43, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f57964e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796a90>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1830000, "timesteps_this_iter": 30000, "time_total_s": 1852.4175617694855, "node_ip": "10.138.0.2", "time_this_iter_s": 26.779064416885376, "episode_reward_mean": 362.56923749821163, "custom_metrics": {"cost2_min": -3.3257530406225033, "system_level_velocity_mean": 11.084409637332895, "outflow_rate_mean": 1245.5897072920034, "cost1_mean": 362.6073091367081, "cost2_max": 0.0, "outflow_rate_max": 1625.002120555695, "outflow_rate_min": 308.9650927007091, "system_level_velocity_min": 8.509945468596726, "system_level_velocity_max": 15.594560432292463, "cost1_min": 84.20662454893375, "cost1_max": 511.4954710633293, "cost2_mean": -0.38071638496513566}, "episode_reward_min": 84.20662454893373, "hostname": "flow-main", "episodes_this_iter": 41, "timesteps_total": 1830000, "date": "2019-05-06_00-46-37", "time_since_restore": 1852.4175617694855, "pid": 6439}
{"iterations_since_restore": 62, "training_iteration": 62, "episodes_total": 2495, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1860000, "default": {"vf_explained_var": 0.9099969863891602, "policy_loss": -0.00978041347116232, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.4564208984375, "kl": 0.016645191237330437, "vf_loss": 21.905532836914062, "total_loss": 21.899080276489258, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6300.574, "sample_time_ms": 19934.385, "load_time_ms": 5.358, "update_time_ms": 6.26, "num_steps_sampled": 1860000}, "done": false, "timestamp": 1557103623, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 536.9369233996898, "policy_reward_mean": {}, "episode_len_mean": 738.43, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796588>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1860000, "timesteps_this_iter": 30000, "time_total_s": 1878.4165756702423, "node_ip": "10.138.0.2", "time_this_iter_s": 25.999013900756836, "episode_reward_mean": 364.3894800421402, "custom_metrics": {"cost2_min": -3.3257530406225033, "system_level_velocity_mean": 11.169398589057021, "outflow_rate_mean": 1243.2402712013927, "cost1_mean": 364.42562696249945, "cost2_max": 0.0, "outflow_rate_max": 1616.0544765523305, "outflow_rate_min": 308.9650927007091, "system_level_velocity_min": 8.538271435774044, "system_level_velocity_max": 16.533630873230944, "cost1_min": 84.20662454893375, "cost1_max": 537.0574708417405, "cost2_mean": -0.3614692035920207}, "episode_reward_min": 84.20662454893373, "hostname": "flow-main", "episodes_this_iter": 42, "timesteps_total": 1860000, "date": "2019-05-06_00-47-03", "time_since_restore": 1878.4165756702423, "pid": 6439}
{"iterations_since_restore": 63, "training_iteration": 63, "episodes_total": 2536, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1890000, "default": {"vf_explained_var": 0.9091450572013855, "policy_loss": -0.01080617681145668, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.429482936859131, "kl": 0.01687164604663849, "vf_loss": 23.47743034362793, "total_loss": 23.46999740600586, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6271.612, "sample_time_ms": 19881.059, "load_time_ms": 5.405, "update_time_ms": 6.23, "num_steps_sampled": 1890000}, "done": false, "timestamp": 1557103649, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 566.1550792071778, "policy_reward_mean": {}, "episode_len_mean": 739.42, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f57964e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f57966d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796550>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1890000, "timesteps_this_iter": 30000, "time_total_s": 1904.2100219726562, "node_ip": "10.138.0.2", "time_this_iter_s": 25.79344630241394, "episode_reward_mean": 372.62987433687954, "custom_metrics": {"cost2_min": -4.508521768479144, "system_level_velocity_mean": 11.441313379448825, "outflow_rate_mean": 1262.8335929604275, "cost1_mean": 372.6797622197069, "cost2_max": 0.0, "outflow_rate_max": 1616.0544765523305, "outflow_rate_min": 538.8621119611404, "system_level_velocity_min": 8.246934730312773, "system_level_velocity_max": 18.284478674636155, "cost1_min": 137.66313462728758, "cost1_max": 566.3190137611309, "cost2_mean": -0.4988788282737058}, "episode_reward_min": 137.66313462728755, "hostname": "flow-main", "episodes_this_iter": 41, "timesteps_total": 1890000, "date": "2019-05-06_00-47-29", "time_since_restore": 1904.2100219726562, "pid": 6439}
{"iterations_since_restore": 64, "training_iteration": 64, "episodes_total": 2576, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1920000, "default": {"vf_explained_var": 0.9107853770256042, "policy_loss": -0.009836510755121708, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.428230285644531, "kl": 0.015690475702285767, "vf_loss": 20.925920486450195, "total_loss": 20.91922378540039, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6273.587, "sample_time_ms": 19863.107, "load_time_ms": 5.36, "update_time_ms": 6.103, "num_steps_sampled": 1920000}, "done": false, "timestamp": 1557103675, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 566.1550792071778, "policy_reward_mean": {}, "episode_len_mean": 744.86, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796518>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1920000, "timesteps_this_iter": 30000, "time_total_s": 1929.688838005066, "node_ip": "10.138.0.2", "time_this_iter_s": 25.478816032409668, "episode_reward_mean": 371.7749031419558, "custom_metrics": {"cost2_min": -4.508521768479144, "system_level_velocity_mean": 11.28616007380072, "outflow_rate_mean": 1260.2480176185, "cost1_mean": 371.82477759937234, "cost2_max": 0.0, "outflow_rate_max": 1644.8996300804245, "outflow_rate_min": 621.1156193268413, "system_level_velocity_min": 8.104871735438296, "system_level_velocity_max": 18.284478674636155, "cost1_min": 159.99034515444038, "cost1_max": 566.3190137611309, "cost2_mean": -0.4987445741646475}, "episode_reward_min": 159.9903451544404, "hostname": "flow-main", "episodes_this_iter": 40, "timesteps_total": 1920000, "date": "2019-05-06_00-47-55", "time_since_restore": 1929.688838005066, "pid": 6439}
{"iterations_since_restore": 65, "training_iteration": 65, "episodes_total": 2616, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1950000, "default": {"vf_explained_var": 0.9195939302444458, "policy_loss": -0.009948229417204857, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.415050983428955, "kl": 0.017226433381438255, "vf_loss": 20.420944213867188, "total_loss": 20.414445877075195, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6239.248, "sample_time_ms": 19851.95, "load_time_ms": 5.317, "update_time_ms": 6.17, "num_steps_sampled": 1950000}, "done": false, "timestamp": 1557103700, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 541.0528734436828, "policy_reward_mean": {}, "episode_len_mean": 750.0, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f57694a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5769f98>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1950000, "timesteps_this_iter": 30000, "time_total_s": 1955.1113233566284, "node_ip": "10.138.0.2", "time_this_iter_s": 25.4224853515625, "episode_reward_mean": 371.77157421462834, "custom_metrics": {"cost2_min": -4.508521768479144, "system_level_velocity_mean": 11.141693359859206, "outflow_rate_mean": 1267.72914704267, "cost1_mean": 371.8187185299755, "cost2_max": 0.0, "outflow_rate_max": 1644.8996300804245, "outflow_rate_min": 994.2340468890665, "system_level_velocity_min": 8.104871735438296, "system_level_velocity_max": 16.655600181884918, "cost1_min": 273.07966117438355, "cost1_max": 541.05442235862, "cost2_mean": -0.4714431534720101}, "episode_reward_min": 273.0796611743836, "hostname": "flow-main", "episodes_this_iter": 40, "timesteps_total": 1950000, "date": "2019-05-06_00-48-20", "time_since_restore": 1955.1113233566284, "pid": 6439}
{"iterations_since_restore": 66, "training_iteration": 66, "episodes_total": 2659, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 1980000, "default": {"vf_explained_var": 0.8844189643859863, "policy_loss": -0.007438971661031246, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.36743688583374, "kl": 0.014591212384402752, "vf_loss": 25.90863800048828, "total_loss": 25.904115676879883, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6284.846, "sample_time_ms": 19899.449, "load_time_ms": 5.358, "update_time_ms": 6.1, "num_steps_sampled": 1980000}, "done": false, "timestamp": 1557103727, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 541.0528734436828, "policy_reward_mean": {}, "episode_len_mean": 737.77, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796ac8>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 1980000, "timesteps_this_iter": 30000, "time_total_s": 1981.8505232334137, "node_ip": "10.138.0.2", "time_this_iter_s": 26.73919987678528, "episode_reward_mean": 368.12046508298545, "custom_metrics": {"cost2_min": -4.0, "system_level_velocity_mean": 11.278572641295307, "outflow_rate_mean": 1255.0949708304563, "cost1_mean": 368.17027635959647, "cost2_max": 0.0, "outflow_rate_max": 1635.1263971057406, "outflow_rate_min": 299.31262698509084, "system_level_velocity_min": 8.579984816857182, "system_level_velocity_max": 16.655600181884918, "cost1_min": 81.22015850843974, "cost1_max": 541.05442235862, "cost2_mean": -0.4981127661104196}, "episode_reward_min": 81.22015850843975, "hostname": "flow-main", "episodes_this_iter": 43, "timesteps_total": 1980000, "date": "2019-05-06_00-48-47", "time_since_restore": 1981.8505232334137, "pid": 6439}
{"iterations_since_restore": 67, "training_iteration": 67, "episodes_total": 2697, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 2010000, "default": {"vf_explained_var": 0.9120681881904602, "policy_loss": -0.009970218874514103, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.391264915466309, "kl": 0.016347922384738922, "vf_loss": 21.13385581970215, "total_loss": 21.12715721130371, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6295.734, "sample_time_ms": 19726.711, "load_time_ms": 5.446, "update_time_ms": 6.331, "num_steps_sampled": 2010000}, "done": false, "timestamp": 1557103753, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 565.060648762156, "policy_reward_mean": {}, "episode_len_mean": 737.77, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796b70>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 2010000, "timesteps_this_iter": 30000, "time_total_s": 2007.6521036624908, "node_ip": "10.138.0.2", "time_this_iter_s": 25.80158042907715, "episode_reward_mean": 363.0162108068123, "custom_metrics": {"cost2_min": -4.0, "system_level_velocity_mean": 11.119288047184387, "outflow_rate_mean": 1244.9906715014636, "cost1_mean": 363.0650540868078, "cost2_max": 0.0, "outflow_rate_max": 1587.0051036227244, "outflow_rate_min": 299.31262698509084, "system_level_velocity_min": 8.579984816857182, "system_level_velocity_max": 18.132767119679887, "cost1_min": 81.22015850843974, "cost1_max": 565.3243400238482, "cost2_mean": -0.48843279995523203}, "episode_reward_min": 81.22015850843975, "hostname": "flow-main", "episodes_this_iter": 38, "timesteps_total": 2010000, "date": "2019-05-06_00-49-13", "time_since_restore": 2007.6521036624908, "pid": 6439}
{"iterations_since_restore": 68, "training_iteration": 68, "episodes_total": 2739, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 2040000, "default": {"vf_explained_var": 0.900068998336792, "policy_loss": -0.011644075624644756, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.38340425491333, "kl": 0.017570052295923233, "vf_loss": 22.54618263244629, "total_loss": 22.538055419921875, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6266.583, "sample_time_ms": 19695.861, "load_time_ms": 5.428, "update_time_ms": 6.335, "num_steps_sampled": 2040000}, "done": false, "timestamp": 1557103779, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 565.060648762156, "policy_reward_mean": {}, "episode_len_mean": 737.77, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796518>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 2040000, "timesteps_this_iter": 30000, "time_total_s": 2033.6607220172882, "node_ip": "10.138.0.2", "time_this_iter_s": 26.008618354797363, "episode_reward_mean": 363.4314327546194, "custom_metrics": {"cost2_min": -4.0, "system_level_velocity_mean": 11.112200573585538, "outflow_rate_mean": 1241.5427108694726, "cost1_mean": 363.48325606470144, "cost2_max": 0.0, "outflow_rate_max": 1610.0757642873546, "outflow_rate_min": 299.31262698509084, "system_level_velocity_min": 8.407351673029115, "system_level_velocity_max": 18.132767119679887, "cost1_min": 81.22015850843974, "cost1_max": 565.3243400238482, "cost2_mean": -0.5182331008199523}, "episode_reward_min": 81.22015850843975, "hostname": "flow-main", "episodes_this_iter": 42, "timesteps_total": 2040000, "date": "2019-05-06_00-49-39", "time_since_restore": 2033.6607220172882, "pid": 6439}
{"iterations_since_restore": 69, "training_iteration": 69, "episodes_total": 2781, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 2070000, "default": {"vf_explained_var": 0.8884018063545227, "policy_loss": -0.01237304788082838, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.402333736419678, "kl": 0.018103040754795074, "vf_loss": 25.00586700439453, "total_loss": 24.997112274169922, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6219.674, "sample_time_ms": 19855.519, "load_time_ms": 5.521, "update_time_ms": 6.389, "num_steps_sampled": 2070000}, "done": false, "timestamp": 1557103806, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 565.060648762156, "policy_reward_mean": {}, "episode_len_mean": 732.58, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796a90>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 2070000, "timesteps_this_iter": 30000, "time_total_s": 2060.8736248016357, "node_ip": "10.138.0.2", "time_this_iter_s": 27.212902784347534, "episode_reward_mean": 363.60412825098706, "custom_metrics": {"cost2_min": -3.444405408346338, "system_level_velocity_mean": 11.215727199304636, "outflow_rate_mean": 1243.3910972032643, "cost1_mean": 363.6446096166917, "cost2_max": 0.0, "outflow_rate_max": 1652.4043544143592, "outflow_rate_min": 262.60739102303893, "system_level_velocity_min": 8.407351673029115, "system_level_velocity_max": 18.132767119679887, "cost1_min": 72.5112468965691, "cost1_max": 565.3243400238482, "cost2_mean": -0.4048136570462651}, "episode_reward_min": 72.51124689656909, "hostname": "flow-main", "episodes_this_iter": 42, "timesteps_total": 2070000, "date": "2019-05-06_00-50-06", "time_since_restore": 2060.8736248016357, "pid": 6439}
{"iterations_since_restore": 70, "training_iteration": 70, "episodes_total": 2820, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 2100000, "default": {"vf_explained_var": 0.9050397276878357, "policy_loss": -0.010879328474402428, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.382107257843018, "kl": 0.01738997921347618, "vf_loss": 21.893491744995117, "total_loss": 21.886091232299805, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6209.034, "sample_time_ms": 19814.276, "load_time_ms": 5.41, "update_time_ms": 6.397, "num_steps_sampled": 2100000}, "done": false, "timestamp": 1557103832, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 565.791355383095, "policy_reward_mean": {}, "episode_len_mean": 727.09, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f57960f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796780>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 2100000, "timesteps_this_iter": 30000, "time_total_s": 2086.568567276001, "node_ip": "10.138.0.2", "time_this_iter_s": 25.694942474365234, "episode_reward_mean": 360.4423977637878, "custom_metrics": {"cost2_min": -3.1846955785944164, "system_level_velocity_mean": 11.235941184549617, "outflow_rate_mean": 1235.7984413306651, "cost1_mean": 360.4739823560591, "cost2_max": 0.0, "outflow_rate_max": 1652.4043544143592, "outflow_rate_min": 262.60739102303893, "system_level_velocity_min": 8.681373515554446, "system_level_velocity_max": 17.535408920500505, "cost1_min": 72.5112468965691, "cost1_max": 565.9390830397379, "cost2_mean": -0.31584592271257217}, "episode_reward_min": 72.51124689656909, "hostname": "flow-main", "episodes_this_iter": 39, "timesteps_total": 2100000, "date": "2019-05-06_00-50-32", "time_since_restore": 2086.568567276001, "pid": 6439}
{"iterations_since_restore": 71, "training_iteration": 71, "episodes_total": 2861, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 2130000, "default": {"vf_explained_var": 0.9156056046485901, "policy_loss": -0.013263115659356117, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.406955242156982, "kl": 0.018306544050574303, "vf_loss": 21.058074951171875, "total_loss": 21.048471450805664, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6168.221, "sample_time_ms": 19775.679, "load_time_ms": 5.371, "update_time_ms": 6.456, "num_steps_sampled": 2130000}, "done": false, "timestamp": 1557103858, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 565.791355383095, "policy_reward_mean": {}, "episode_len_mean": 732.21, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f57967f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796550>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 2130000, "timesteps_this_iter": 30000, "time_total_s": 2112.5539062023163, "node_ip": "10.138.0.2", "time_this_iter_s": 25.985338926315308, "episode_reward_mean": 367.2360377401515, "custom_metrics": {"cost2_min": -6.628690093672193, "system_level_velocity_mean": 11.368114891542978, "outflow_rate_mean": 1261.778919696206, "cost1_mean": 367.2896154792968, "cost2_max": 0.0, "outflow_rate_max": 1652.4043544143592, "outflow_rate_min": 293.33438811992926, "system_level_velocity_min": 8.525934834580552, "system_level_velocity_max": 18.256446718531503, "cost1_min": 80.26446810175301, "cost1_max": 565.9692572700744, "cost2_mean": -0.5357773914535168}, "episode_reward_min": 80.26446810175305, "hostname": "flow-main", "episodes_this_iter": 41, "timesteps_total": 2130000, "date": "2019-05-06_00-50-58", "time_since_restore": 2112.5539062023163, "pid": 6439}
{"iterations_since_restore": 72, "training_iteration": 72, "episodes_total": 2902, "num_metric_batches_dropped": 0, "info": {"num_steps_trained": 2160000, "default": {"vf_explained_var": 0.9156675338745117, "policy_loss": -0.011865389533340931, "cur_kl_coeff": 0.20000004768371582, "entropy": 6.355064868927002, "kl": 0.01702284626662731, "vf_loss": 20.44442367553711, "total_loss": 20.435964584350586, "cur_lr": 0.0005000000237487257}, "grad_time_ms": 6181.018, "sample_time_ms": 19780.342, "load_time_ms": 5.377, "update_time_ms": 6.484, "num_steps_sampled": 2160000}, "done": false, "timestamp": 1557103884, "experiment_id": "f7136ced45da420dab794e72c9250b51", "episode_reward_max": 565.7440697609, "policy_reward_mean": {}, "episode_len_mean": 737.7, "config": {"output_max_file_size": 67108864, "optimizer": {}, "collect_metrics_timeout": 180, "vf_share_layers": false, "preprocessor_pref": "deepmind", "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "horizon": 1500, "tf_session_args": {"log_device_placement": false, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "lambda": 0.97, "clip_actions": false, "compress_observations": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f96f57960f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f96f57965c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f96f5796198>", "on_train_result": null, "on_sample_end": null}, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "custom_resources_per_worker": {}, "sample_batch_size": 200, "sgd_minibatch_size": 128, "output": null, "observation_filter": "NoFilter", "vf_clip_param": 1000000.0, "kl_target": 0.01, "num_sgd_iter": 10, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "use_gae": true, "straggler_mitigation": false, "input_evaluation": null, "clip_param": 0.3, "output_compress_columns": ["obs", "new_obs"], "num_workers": 20, "num_envs_per_worker": 1, "lr_schedule": null, "kl_coeff": 0.2, "clip_rewards": null, "env": "WaveAttenuationMergePOEnv-v0", "num_gpus": 0, "lr": 0.0005, "num_cpus_for_driver": 1, "gamma": 0.99, "monitor": false, "num_cpus_per_worker": 1, "simple_optimizer": false, "model": {"fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_options": {}, "custom_model": null, "dim": 84, "max_seq_len": 20, "conv_activation": "relu", "grayscale": false, "squash_to_range": false, "use_lstm": false, "fcnet_activation": "tanh", "free_log_std": false, "lstm_cell_size": 256, "framestack": true, "conv_filters": null, "zero_mean": true, "lstm_use_prev_action_reward": false, "custom_preprocessor": null}, "num_gpus_per_worker": 0, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"max_accel\": 1.5,\n            \"max_decel\": 1.5,\n            \"num_rl\": 5,\n            \"target_velocity\": 20\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"WaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"merge_0\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 500,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true, "train_batch_size": 30000}, "timesteps_since_restore": 2160000, "timesteps_this_iter": 30000, "time_total_s": 2138.735899448395, "node_ip": "10.138.0.2", "time_this_iter_s": 26.18199324607849, "episode_reward_mean": 364.59011236842497, "custom_metrics": {"cost2_min": -6.628690093672193, "system_level_velocity_mean": 11.14733628444689, "outflow_rate_mean": 1258.221380600574, "cost1_mean": 364.65127178660236, "cost2_max": 0.0, "outflow_rate_max": 1571.4033710086735, "outflow_rate_min": 293.33438811992926, "system_level_velocity_min": 8.086318405090886, "system_level_velocity_max": 18.256446718531503, "cost1_min": 80.26446810175301, "cost1_max": 565.9692572700744, "cost2_mean": -0.6115941817742465}, "episode_reward_min": 80.26446810175305, "hostname": "flow-main", "episodes_this_iter": 41, "timesteps_total": 2160000, "date": "2019-05-06_00-51-24", "time_since_restore": 2138.735899448395, "pid": 6439}

{"info": {"sample_time_ms": 28796.895, "load_time_ms": 80.069, "update_time_ms": 1212.44, "grad_time_ms": 7281.265, "default": {"kl": 0.0030864416621625423, "cur_lr": 0.0005000000237487257, "total_loss": 1.288871169090271, "entropy": 1.4252458810806274, "cur_kl_coeff": 0.20000003278255463, "vf_loss": 1.2893614768981934, "policy_loss": -0.0011076502269133925, "vf_explained_var": 0.8863043189048767}, "num_steps_trained": 39723, "num_steps_sampled": 39723}, "custom_metrics": {"cost1_min": 171.3387899508022, "system_level_velocity_min": 6.7637660672941955, "outflow_rate_min": 557.4792057610063, "cost1_mean": 191.05414390415683, "cost2_max": 0.0, "cost2_mean": 0.0, "cost2_min": 0.0, "system_level_velocity_mean": 7.424004307088585, "outflow_rate_max": 611.462236349884, "cost1_max": 206.89123023937458, "outflow_rate_mean": 578.0348220032447, "system_level_velocity_max": 7.977662391932657}, "episodes_total": 6, "episode_reward_max": 331.5083383160687, "timestamp": 1557110854, "episode_reward_mean": 264.51572793354825, "episodes_this_iter": 6, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 37.48970699310303, "timesteps_since_restore": 39723, "episode_reward_min": 198.48946775030475, "node_ip": "10.138.0.2", "time_total_s": 37.48970699310303, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-47-34", "done": false, "timesteps_total": 39723, "timesteps_this_iter": 39723, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4519588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f45195c0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4519550>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 1, "training_iteration": 1, "policy_reward_mean": {}, "time_since_restore": 37.48970699310303, "episode_len_mean": 700.0}
{"info": {"sample_time_ms": 21191.144, "load_time_ms": 47.775, "update_time_ms": 609.395, "grad_time_ms": 8175.568, "default": {"kl": 0.008934972807765007, "cur_lr": 0.0005000000237487257, "total_loss": 1.265333652496338, "entropy": 1.434026837348938, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 1.2685554027557373, "policy_loss": -0.0041153645142912865, "vf_explained_var": 0.9282199740409851}, "num_steps_trained": 82194, "num_steps_sampled": 82194}, "custom_metrics": {"cost1_min": 168.01984033226262, "system_level_velocity_min": 6.530327181866511, "outflow_rate_min": 537.2504280572099, "cost1_mean": 200.79920328204494, "cost2_max": 0.0, "cost2_mean": -0.003920364125577747, "cost2_min": -0.10753315061711044, "system_level_velocity_mean": 7.769061446280143, "outflow_rate_max": 813.5712845878787, "cost1_max": 270.7658827177588, "outflow_rate_mean": 612.552243644955, "system_level_velocity_max": 10.41897850054351}, "episodes_total": 28, "episode_reward_max": 449.88670306120616, "timestamp": 1557110877, "episode_reward_mean": 305.82466593913114, "episodes_this_iter": 22, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 22.758339881896973, "timesteps_since_restore": 82194, "episode_reward_min": 198.48946775030475, "node_ip": "10.138.0.2", "time_total_s": 60.248046875, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-47-57", "done": false, "timesteps_total": 82194, "timesteps_this_iter": 42471, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba240>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba278>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba208>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 2, "training_iteration": 2, "policy_reward_mean": {}, "time_since_restore": 60.248046875, "episode_len_mean": 700.0}
{"info": {"sample_time_ms": 18210.259, "load_time_ms": 36.238, "update_time_ms": 409.048, "grad_time_ms": 7622.827, "default": {"kl": 0.008017541840672493, "cur_lr": 0.0005000000237487257, "total_loss": 2.3490631580352783, "entropy": 1.424318790435791, "cur_kl_coeff": 0.10000002384185791, "vf_loss": 2.352452039718628, "policy_loss": -0.004190616775304079, "vf_explained_var": 0.9368740320205688}, "num_steps_trained": 122998, "num_steps_sampled": 122998}, "custom_metrics": {"cost1_min": 15.62109407362707, "system_level_velocity_min": 2.911597186527219, "outflow_rate_min": 247.2172550698439, "cost1_mean": 195.56639748123095, "cost2_max": 0.0, "cost2_mean": -0.0026135760837184977, "cost2_min": -0.10753315061711044, "system_level_velocity_mean": 7.919347113447726, "outflow_rate_max": 862.7406332585174, "cost1_max": 276.88183268314185, "outflow_rate_mean": 610.8629229790763, "system_level_velocity_max": 17.183626551145704}, "episodes_total": 42, "episode_reward_max": 566.5831232791954, "timestamp": 1557110896, "episode_reward_mean": 334.95319843156244, "episodes_this_iter": 14, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 18.84890580177307, "timesteps_since_restore": 122998, "episode_reward_min": 34.66595117225309, "node_ip": "10.138.0.2", "time_total_s": 79.09695267677307, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-48-16", "done": false, "timesteps_total": 122998, "timesteps_this_iter": 40804, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3abad68>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3abada0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3abad30>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 3, "training_iteration": 3, "policy_reward_mean": {}, "time_since_restore": 79.09695267677307, "episode_len_mean": 683.9047619047619}
{"info": {"sample_time_ms": 17083.986, "load_time_ms": 30.874, "update_time_ms": 308.249, "grad_time_ms": 7422.251, "default": {"kl": 0.007271972950547934, "cur_lr": 0.0005000000237487257, "total_loss": 2.912433385848999, "entropy": 1.4096930027008057, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 2.9151413440704346, "policy_loss": -0.0034350911155343056, "vf_explained_var": 0.9404324889183044}, "num_steps_trained": 164773, "num_steps_sampled": 164773}, "custom_metrics": {"cost1_min": 15.62109407362707, "system_level_velocity_min": 2.911597186527219, "outflow_rate_min": 247.2172550698439, "cost1_mean": 205.67202174385247, "cost2_max": 0.0, "cost2_mean": -0.008516287546885628, "cost2_min": -0.3980408608543638, "system_level_velocity_mean": 8.421671555968201, "outflow_rate_max": 963.7562976694481, "cost1_max": 292.1343802322521, "outflow_rate_mean": 657.6171029215459, "system_level_velocity_max": 17.784805328839358}, "episodes_total": 61, "episode_reward_max": 826.5836861828092, "timestamp": 1557110916, "episode_reward_mean": 411.06241737911637, "episodes_this_iter": 19, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 20.609939336776733, "timesteps_since_restore": 164773, "episode_reward_min": 34.66595117225309, "node_ip": "10.138.0.2", "time_total_s": 99.7068920135498, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-48-36", "done": false, "timesteps_total": 164773, "timesteps_this_iter": 41775, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531c50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531358>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f45316a0>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 4, "training_iteration": 4, "policy_reward_mean": {}, "time_since_restore": 99.7068920135498, "episode_len_mean": 678.0}
{"info": {"sample_time_ms": 16228.061, "load_time_ms": 29.056, "update_time_ms": 247.985, "grad_time_ms": 7380.848, "default": {"kl": 0.006197216920554638, "cur_lr": 0.0005000000237487257, "total_loss": 3.865741729736328, "entropy": 1.3902899026870728, "cur_kl_coeff": 0.10000002384185791, "vf_loss": 3.868220806121826, "policy_loss": -0.0030986021738499403, "vf_explained_var": 0.9149988889694214}, "num_steps_trained": 207542, "num_steps_sampled": 207542}, "custom_metrics": {"cost1_min": 15.62109407362707, "system_level_velocity_min": 2.911597186527219, "outflow_rate_min": 247.2172550698439, "cost1_mean": 219.2849842520114, "cost2_max": 0.0, "cost2_mean": -0.013047134672963883, "cost2_min": -0.3980408608543638, "system_level_velocity_mean": 8.793736317811266, "outflow_rate_max": 1009.5614894043956, "cost1_max": 312.89092665818623, "outflow_rate_mean": 709.4418015108919, "system_level_velocity_max": 17.784805328839358}, "episodes_total": 78, "episode_reward_max": 913.1113921074018, "timestamp": 1557110936, "episode_reward_mean": 486.02283376734016, "episodes_this_iter": 17, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 20.137288331985474, "timesteps_since_restore": 207542, "episode_reward_min": 34.66595117225309, "node_ip": "10.138.0.2", "time_total_s": 119.84418034553528, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-48-56", "done": false, "timesteps_total": 207542, "timesteps_this_iter": 42769, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531b70>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531f60>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531b38>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 5, "training_iteration": 5, "policy_reward_mean": {}, "time_since_restore": 119.84418034553528, "episode_len_mean": 682.7948717948718}
{"info": {"sample_time_ms": 15536.522, "load_time_ms": 25.77, "update_time_ms": 207.739, "grad_time_ms": 7501.13, "default": {"kl": 0.006984777748584747, "cur_lr": 0.0005000000237487257, "total_loss": 3.5696823596954346, "entropy": 1.3784540891647339, "cur_kl_coeff": 0.10000002384185791, "vf_loss": 3.571509838104248, "policy_loss": -0.002525413641706109, "vf_explained_var": 0.9444419145584106}, "num_steps_trained": 250376, "num_steps_sampled": 250376}, "custom_metrics": {"cost1_min": 15.62109407362707, "system_level_velocity_min": 2.911597186527219, "outflow_rate_min": 247.2172550698439, "cost1_mean": 225.8485018760121, "cost2_max": 0.0, "cost2_mean": -0.013450969246212335, "cost2_min": -0.3980408608543638, "system_level_velocity_mean": 8.98300051290401, "outflow_rate_max": 1035.9649025866186, "cost1_max": 320.1315294210955, "outflow_rate_mean": 734.9471519749601, "system_level_velocity_max": 17.784805328839358}, "episodes_total": 87, "episode_reward_max": 913.1113921074018, "timestamp": 1557110957, "episode_reward_mean": 517.0389887477432, "episodes_this_iter": 9, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 20.270065307617188, "timesteps_since_restore": 250376, "episode_reward_min": 34.66595117225309, "node_ip": "10.138.0.2", "time_total_s": 140.11424565315247, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-49-17", "done": false, "timesteps_total": 250376, "timesteps_this_iter": 42834, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3abaa58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba6d8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3abad30>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 6, "training_iteration": 6, "policy_reward_mean": {}, "time_since_restore": 140.11424565315247, "episode_len_mean": 684.5747126436781}
{"info": {"sample_time_ms": 15145.414, "load_time_ms": 24.483, "update_time_ms": 178.911, "grad_time_ms": 7582.079, "default": {"kl": 0.0038288459181785583, "cur_lr": 0.0005000000237487257, "total_loss": 5.309763431549072, "entropy": 1.3729482889175415, "cur_kl_coeff": 0.10000002384185791, "vf_loss": 5.310245037078857, "policy_loss": -0.0008643025648780167, "vf_explained_var": 0.9175008535385132}, "num_steps_trained": 293361, "num_steps_sampled": 293361}, "custom_metrics": {"cost1_min": 15.62109407362707, "system_level_velocity_min": 2.911597186527219, "outflow_rate_min": 247.2172550698439, "cost1_mean": 239.54962954793646, "cost2_max": 0.0, "cost2_mean": -0.023973873579366613, "cost2_min": -0.5221752351265994, "system_level_velocity_mean": 9.427161928124274, "outflow_rate_max": 1106.6789795731543, "cost1_max": 341.25464914585, "outflow_rate_mean": 790.1729552079676, "system_level_velocity_max": 17.784805328839358}, "episodes_total": 106, "episode_reward_max": 1029.4802082414928, "timestamp": 1557110978, "episode_reward_mean": 586.5591686812473, "episodes_this_iter": 19, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 20.969978094100952, "timesteps_since_restore": 293361, "episode_reward_min": 34.66595117225309, "node_ip": "10.138.0.2", "time_total_s": 161.08422374725342, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-49-38", "done": false, "timesteps_total": 293361, "timesteps_this_iter": 42985, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531438>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531748>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531c50>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 7, "training_iteration": 7, "policy_reward_mean": {}, "time_since_restore": 161.08422374725342, "episode_len_mean": 686.58}
{"info": {"sample_time_ms": 14815.496, "load_time_ms": 23.316, "update_time_ms": 157.478, "grad_time_ms": 7620.961, "default": {"kl": 0.007410597987473011, "cur_lr": 0.0005000000237487257, "total_loss": 4.871402263641357, "entropy": 1.3610073328018188, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 4.873312473297119, "policy_loss": -0.002280749147757888, "vf_explained_var": 0.9338101744651794}, "num_steps_trained": 335104, "num_steps_sampled": 335104}, "custom_metrics": {"cost1_min": 15.62109407362707, "system_level_velocity_min": 2.911597186527219, "outflow_rate_min": 247.2172550698439, "cost1_mean": 252.91506434341485, "cost2_max": 0.0, "cost2_mean": -0.0337252608914516, "cost2_min": -0.5221752351265994, "system_level_velocity_mean": 9.908938726758672, "outflow_rate_max": 1117.4571653549544, "cost1_max": 352.2426430867579, "outflow_rate_mean": 848.5747624731798, "system_level_velocity_max": 17.784805328839358}, "episodes_total": 121, "episode_reward_max": 1029.4802082414928, "timestamp": 1557110998, "episode_reward_mean": 660.3339730536255, "episodes_this_iter": 15, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 20.4892680644989, "timesteps_since_restore": 335104, "episode_reward_min": 34.66595117225309, "node_ip": "10.138.0.2", "time_total_s": 181.57349181175232, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-49-58", "done": false, "timesteps_total": 335104, "timesteps_this_iter": 41743, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1898>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac19e8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1208>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 8, "training_iteration": 8, "policy_reward_mean": {}, "time_since_restore": 181.57349181175232, "episode_len_mean": 686.58}
{"info": {"sample_time_ms": 14583.265, "load_time_ms": 22.644, "update_time_ms": 140.647, "grad_time_ms": 7678.44, "default": {"kl": 0.0058734542690217495, "cur_lr": 0.0005000000237487257, "total_loss": 5.128595352172852, "entropy": 1.3550317287445068, "cur_kl_coeff": 0.05000000074505806, "vf_loss": 5.129942893981934, "policy_loss": -0.0016414499841630459, "vf_explained_var": 0.9289650917053223}, "num_steps_trained": 377235, "num_steps_sampled": 377235}, "custom_metrics": {"cost1_min": 15.62109407362707, "system_level_velocity_min": 4.960184380572864, "outflow_rate_min": 477.8911634321994, "cost1_mean": 268.10666679462713, "cost2_max": 0.0, "cost2_mean": -0.039118637983434186, "cost2_min": -0.5221752351265994, "system_level_velocity_mean": 10.461569612212731, "outflow_rate_max": 1138.7284179481765, "cost1_max": 377.0932466010172, "outflow_rate_mean": 904.7864706257144, "system_level_velocity_max": 17.784805328839358}, "episodes_total": 136, "episode_reward_max": 1029.4802082414928, "timestamp": 1557111019, "episode_reward_mean": 727.1231777780903, "episodes_this_iter": 15, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 20.964807987213135, "timesteps_since_restore": 377235, "episode_reward_min": 34.66595117225309, "node_ip": "10.138.0.2", "time_total_s": 202.53829979896545, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-50-19", "done": false, "timesteps_total": 377235, "timesteps_this_iter": 42131, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1c18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1c50>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1be0>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 9, "training_iteration": 9, "policy_reward_mean": {}, "time_since_restore": 202.53829979896545, "episode_len_mean": 686.58}
{"info": {"sample_time_ms": 14568.721, "load_time_ms": 21.481, "update_time_ms": 127.145, "grad_time_ms": 7919.094, "default": {"kl": 0.006522900890558958, "cur_lr": 0.0005000000237487257, "total_loss": 6.956276893615723, "entropy": 1.34439218044281, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 6.956450462341309, "policy_loss": -0.0005008862353861332, "vf_explained_var": 0.9221318364143372}, "num_steps_trained": 420337, "num_steps_sampled": 420337}, "custom_metrics": {"cost1_min": 128.43015026638963, "system_level_velocity_min": 4.960184380572864, "outflow_rate_min": 510.3539164520531, "cost1_mean": 282.5502567270742, "cost2_max": 0.0, "cost2_mean": -0.06302190261656199, "cost2_min": -0.6363636363636364, "system_level_velocity_mean": 10.666453473590531, "outflow_rate_max": 1246.0561524366365, "cost1_max": 422.392272168403, "outflow_rate_mean": 954.440869912689, "system_level_velocity_max": 15.654711989633038}, "episodes_total": 156, "episode_reward_max": 1051.398561765921, "timestamp": 1557111044, "episode_reward_mean": 784.0296460880719, "episodes_this_iter": 20, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 24.624568939208984, "timesteps_since_restore": 420337, "episode_reward_min": 494.53840976716504, "node_ip": "10.138.0.2", "time_total_s": 227.16286873817444, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-50-44", "done": false, "timesteps_total": 420337, "timesteps_this_iter": 43102, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1a90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1ac8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac15f8>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 10, "training_iteration": 10, "policy_reward_mean": {}, "time_since_restore": 227.16286873817444, "episode_len_mean": 700.0}
{"info": {"sample_time_ms": 12942.802, "load_time_ms": 14.601, "update_time_ms": 7.124, "grad_time_ms": 7981.206, "default": {"kl": 0.005642841104418039, "cur_lr": 0.0005000000237487257, "total_loss": 5.134751796722412, "entropy": 1.3485748767852783, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 5.135403633117676, "policy_loss": -0.0009343900601379573, "vf_explained_var": 0.9359648823738098}, "num_steps_trained": 462643, "num_steps_sampled": 462643}, "custom_metrics": {"cost1_min": 159.77846054722644, "system_level_velocity_min": 6.236813076581831, "outflow_rate_min": 664.6083153835632, "cost1_mean": 287.83512511775933, "cost2_max": 0.0, "cost2_mean": -0.06741647276522861, "cost2_min": -0.6363636363636364, "system_level_velocity_mean": 10.874922965479955, "outflow_rate_max": 1246.0561524366365, "cost1_max": 422.392272168403, "outflow_rate_mean": 973.2667502802294, "system_level_velocity_max": 15.654711989633038}, "episodes_total": 168, "episode_reward_max": 1051.398561765921, "timestamp": 1557111064, "episode_reward_mean": 795.1205895269927, "episodes_this_iter": 12, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 20.535347938537598, "timesteps_since_restore": 462643, "episode_reward_min": 574.7273157325304, "node_ip": "10.138.0.2", "time_total_s": 247.69821667671204, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-51-04", "done": false, "timesteps_total": 462643, "timesteps_this_iter": 42306, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531278>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f45316d8>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 11, "training_iteration": 11, "policy_reward_mean": {}, "time_since_restore": 247.69821667671204, "episode_len_mean": 700.0}
{"info": {"sample_time_ms": 12863.915, "load_time_ms": 14.032, "update_time_ms": 7.338, "grad_time_ms": 7773.992, "default": {"kl": 0.006019386928528547, "cur_lr": 0.0005000000237487257, "total_loss": 5.822657585144043, "entropy": 1.3432375192642212, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 5.823369979858398, "policy_loss": -0.0010135045740753412, "vf_explained_var": 0.936363935470581}, "num_steps_trained": 505047, "num_steps_sampled": 505047}, "custom_metrics": {"cost1_min": 26.866598301881833, "system_level_velocity_min": 6.236813076581831, "outflow_rate_min": 518.3320510526078, "cost1_mean": 285.7658638634306, "cost2_max": 0.0, "cost2_mean": -0.06873572630664065, "cost2_min": -0.6363636363636364, "system_level_velocity_mean": 10.981587269915265, "outflow_rate_max": 1246.0561524366365, "cost1_max": 422.392272168403, "outflow_rate_mean": 973.9642197407015, "system_level_velocity_max": 18.519752724665967}, "episodes_total": 184, "episode_reward_max": 1051.398561765921, "timestamp": 1557111084, "episode_reward_mean": 786.9035229829789, "episodes_this_iter": 16, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 19.875942945480347, "timesteps_since_restore": 505047, "episode_reward_min": 60.208188081803485, "node_ip": "10.138.0.2", "time_total_s": 267.5741596221924, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-51-24", "done": false, "timesteps_total": 505047, "timesteps_this_iter": 42404, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac19e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1160>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac12e8>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 12, "training_iteration": 12, "policy_reward_mean": {}, "time_since_restore": 267.5741596221924, "episode_len_mean": 693.41}
{"info": {"sample_time_ms": 12938.142, "load_time_ms": 13.701, "update_time_ms": 7.129, "grad_time_ms": 7807.548, "default": {"kl": 0.006279826629906893, "cur_lr": 0.0005000000237487257, "total_loss": 6.524172306060791, "entropy": 1.3361961841583252, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 6.525183200836182, "policy_loss": -0.0013248099712654948, "vf_explained_var": 0.9187256097793579}, "num_steps_trained": 548194, "num_steps_sampled": 548194}, "custom_metrics": {"cost1_min": 26.866598301881833, "system_level_velocity_min": 4.041208317249559, "outflow_rate_min": 336.2809552405862, "cost1_mean": 285.7087551761004, "cost2_max": 0.0, "cost2_mean": -0.07704339058498459, "cost2_min": -0.6363636363636364, "system_level_velocity_mean": 10.98846652466758, "outflow_rate_max": 1246.0561524366365, "cost1_max": 422.392272168403, "outflow_rate_mean": 975.0094337103196, "system_level_velocity_max": 18.519752724665967}, "episodes_total": 200, "episode_reward_max": 1051.398561765921, "timestamp": 1557111104, "episode_reward_mean": 789.3667224910938, "episodes_this_iter": 16, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 19.921876668930054, "timesteps_since_restore": 548194, "episode_reward_min": 60.208188081803485, "node_ip": "10.138.0.2", "time_total_s": 287.49603629112244, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-51-44", "done": false, "timesteps_total": 548194, "timesteps_this_iter": 43147, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1e48>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1f98>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac15c0>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 13, "training_iteration": 13, "policy_reward_mean": {}, "time_since_restore": 287.49603629112244, "episode_len_mean": 693.41}
{"info": {"sample_time_ms": 12783.606, "load_time_ms": 14.213, "update_time_ms": 7.163, "grad_time_ms": 7902.266, "default": {"kl": 0.006576440762728453, "cur_lr": 0.0005000000237487257, "total_loss": 6.1970295906066895, "entropy": 1.3056095838546753, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 6.198882102966309, "policy_loss": -0.0021815611980855465, "vf_explained_var": 0.9300881624221802}, "num_steps_trained": 590265, "num_steps_sampled": 590265}, "custom_metrics": {"cost1_min": 26.866598301881833, "system_level_velocity_min": 4.041208317249559, "outflow_rate_min": 336.2809552405862, "cost1_mean": 283.2236238855035, "cost2_max": 0.0, "cost2_mean": -0.07447933320082528, "cost2_min": -0.6363636363636364, "system_level_velocity_mean": 10.91110360835292, "outflow_rate_max": 1246.0561524366365, "cost1_max": 422.392272168403, "outflow_rate_mean": 968.7266248559386, "system_level_velocity_max": 18.519752724665967}, "episodes_total": 214, "episode_reward_max": 1051.398561765921, "timestamp": 1557111124, "episode_reward_mean": 782.8370091113812, "episodes_this_iter": 14, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 20.020721673965454, "timesteps_since_restore": 590265, "episode_reward_min": 60.208188081803485, "node_ip": "10.138.0.2", "time_total_s": 307.5167579650879, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-52-04", "done": false, "timesteps_total": 590265, "timesteps_this_iter": 42071, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531f28>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531c18>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 14, "training_iteration": 14, "policy_reward_mean": {}, "time_since_restore": 307.5167579650879, "episode_len_mean": 693.41}
{"info": {"sample_time_ms": 12811.92, "load_time_ms": 13.623, "update_time_ms": 7.088, "grad_time_ms": 7995.473, "default": {"kl": 0.006574686150997877, "cur_lr": 0.0005000000237487257, "total_loss": 8.376884460449219, "entropy": 1.2949016094207764, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 8.378514289855957, "policy_loss": -0.001957950182259083, "vf_explained_var": 0.9034069776535034}, "num_steps_trained": 632724, "num_steps_sampled": 632724}, "custom_metrics": {"cost1_min": 26.866598301881833, "system_level_velocity_min": 4.041208317249559, "outflow_rate_min": 336.2809552405862, "cost1_mean": 282.48741346551526, "cost2_max": 0.0, "cost2_mean": -0.09790545695915137, "cost2_min": -0.6549143426479072, "system_level_velocity_mean": 10.904175648189597, "outflow_rate_max": 1246.0561524366365, "cost1_max": 422.392272168403, "outflow_rate_mean": 968.4436153237905, "system_level_velocity_max": 18.519752724665967}, "episodes_total": 234, "episode_reward_max": 1051.398561765921, "timestamp": 1557111146, "episode_reward_mean": 786.8315811229387, "episodes_this_iter": 20, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 21.331911087036133, "timesteps_since_restore": 632724, "episode_reward_min": 60.208188081803485, "node_ip": "10.138.0.2", "time_total_s": 328.848669052124, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-52-26", "done": false, "timesteps_total": 632724, "timesteps_this_iter": 42459, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac16d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1f28>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac12e8>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 15, "training_iteration": 15, "policy_reward_mean": {}, "time_since_restore": 328.848669052124, "episode_len_mean": 693.41}
{"info": {"sample_time_ms": 12863.75, "load_time_ms": 13.881, "update_time_ms": 7.11, "grad_time_ms": 7983.944, "default": {"kl": 0.008232378400862217, "cur_lr": 0.0005000000237487257, "total_loss": 7.1837310791015625, "entropy": 1.3008562326431274, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 7.185486316680908, "policy_loss": -0.0021659068297594786, "vf_explained_var": 0.9205284714698792}, "num_steps_trained": 674086, "num_steps_sampled": 674086}, "custom_metrics": {"cost1_min": 26.866598301881833, "system_level_velocity_min": 4.041208317249559, "outflow_rate_min": 336.2809552405862, "cost1_mean": 282.56204457330125, "cost2_max": 0.0, "cost2_mean": -0.0949824481822439, "cost2_min": -0.6549143426479072, "system_level_velocity_mean": 10.908177641426649, "outflow_rate_max": 1196.8252211015126, "cost1_max": 379.3621415284947, "outflow_rate_mean": 969.9759969052067, "system_level_velocity_max": 18.519752724665967}, "episodes_total": 248, "episode_reward_max": 1023.1247506878443, "timestamp": 1557111166, "episode_reward_mean": 792.2381872996724, "episodes_this_iter": 14, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 20.674927234649658, "timesteps_since_restore": 674086, "episode_reward_min": 60.208188081803485, "node_ip": "10.138.0.2", "time_total_s": 349.5235962867737, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-52-46", "done": false, "timesteps_total": 674086, "timesteps_this_iter": 41362, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba4a8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba240>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba978>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 16, "training_iteration": 16, "policy_reward_mean": {}, "time_since_restore": 349.5235962867737, "episode_len_mean": 693.41}
{"info": {"sample_time_ms": 12866.627, "load_time_ms": 13.082, "update_time_ms": 7.247, "grad_time_ms": 7952.125, "default": {"kl": 0.008866745047271252, "cur_lr": 0.0005000000237487257, "total_loss": 8.519888877868652, "entropy": 1.2769864797592163, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 8.522123336791992, "policy_loss": -0.0026784506626427174, "vf_explained_var": 0.9066574573516846}, "num_steps_trained": 715230, "num_steps_sampled": 715230}, "custom_metrics": {"cost1_min": 26.866598301881833, "system_level_velocity_min": 4.041208317249559, "outflow_rate_min": 336.2809552405862, "cost1_mean": 286.01309766938266, "cost2_max": 0.0, "cost2_mean": -0.08458747274189761, "cost2_min": -0.6549143426479072, "system_level_velocity_mean": 11.044644730343299, "outflow_rate_max": 1196.8252211015126, "cost1_max": 379.3621415284947, "outflow_rate_mean": 980.0560799052254, "system_level_velocity_max": 18.519752724665967}, "episodes_total": 263, "episode_reward_max": 1023.1247506878443, "timestamp": 1557111187, "episode_reward_mean": 804.6528153802818, "episodes_this_iter": 15, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 20.669754028320312, "timesteps_since_restore": 715230, "episode_reward_min": 60.208188081803485, "node_ip": "10.138.0.2", "time_total_s": 370.193350315094, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-53-07", "done": false, "timesteps_total": 715230, "timesteps_this_iter": 41144, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba668>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3abada0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3abad30>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 17, "training_iteration": 17, "policy_reward_mean": {}, "time_since_restore": 370.193350315094, "episode_len_mean": 693.41}
{"info": {"sample_time_ms": 12890.541, "load_time_ms": 12.737, "update_time_ms": 7.201, "grad_time_ms": 8051.697, "default": {"kl": 0.006920584477484226, "cur_lr": 0.0005000000237487257, "total_loss": 7.634130477905273, "entropy": 1.2845522165298462, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 7.6359429359436035, "policy_loss": -0.002157430863007903, "vf_explained_var": 0.915611982345581}, "num_steps_trained": 758262, "num_steps_sampled": 758262}, "custom_metrics": {"cost1_min": 101.6777664325152, "system_level_velocity_min": 4.041208317249559, "outflow_rate_min": 336.2809552405862, "cost1_mean": 294.24779865329685, "cost2_max": 0.0, "cost2_mean": -0.09235600887708313, "cost2_min": -0.6549143426479072, "system_level_velocity_mean": 11.186488793854558, "outflow_rate_max": 1196.8252211015126, "cost1_max": 387.0252376841439, "outflow_rate_mean": 1001.36330857952, "system_level_velocity_max": 14.517935379201464}, "episodes_total": 279, "episode_reward_max": 1023.1247506878443, "timestamp": 1557111209, "episode_reward_mean": 831.97213286355, "episodes_this_iter": 16, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 21.733377933502197, "timesteps_since_restore": 758262, "episode_reward_min": 439.48362898421976, "node_ip": "10.138.0.2", "time_total_s": 391.9267282485962, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-53-29", "done": false, "timesteps_total": 758262, "timesteps_this_iter": 43032, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1e10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3abaeb8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac14e0>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 18, "training_iteration": 18, "policy_reward_mean": {}, "time_since_restore": 391.9267282485962, "episode_len_mean": 700.0}
{"info": {"sample_time_ms": 12907.63, "load_time_ms": 12.37, "update_time_ms": 7.327, "grad_time_ms": 8082.021, "default": {"kl": 0.010640985332429409, "cur_lr": 0.0005000000237487257, "total_loss": 10.007237434387207, "entropy": 1.26997971534729, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 10.008971214294434, "policy_loss": -0.0022659364622086287, "vf_explained_var": 0.9181134104728699}, "num_steps_trained": 799204, "num_steps_sampled": 799204}, "custom_metrics": {"cost1_min": 19.468434252413918, "system_level_velocity_min": 7.116066012083398, "outflow_rate_min": 477.932734294326, "cost1_mean": 298.07505823150217, "cost2_max": 0.0, "cost2_mean": -0.10246365302597163, "cost2_min": -0.6549143426479072, "system_level_velocity_mean": 11.515866005566515, "outflow_rate_max": 1239.4674092213972, "cost1_max": 395.8741590805862, "outflow_rate_mean": 1013.7230412745661, "system_level_velocity_max": 18.064803156329017}, "episodes_total": 296, "episode_reward_max": 1092.749420312937, "timestamp": 1557111230, "episode_reward_mean": 838.3007563774431, "episodes_this_iter": 17, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 21.440791130065918, "timesteps_since_restore": 799204, "episode_reward_min": 52.944170067428395, "node_ip": "10.138.0.2", "time_total_s": 413.3675193786621, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-53-50", "done": false, "timesteps_total": 799204, "timesteps_this_iter": 40942, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3abac18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba5f8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f453f978>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 19, "training_iteration": 19, "policy_reward_mean": {}, "time_since_restore": 413.3675193786621, "episode_len_mean": 693.29}
{"info": {"sample_time_ms": 12588.281, "load_time_ms": 12.537, "update_time_ms": 7.619, "grad_time_ms": 7943.375, "default": {"kl": 0.007678313180804253, "cur_lr": 0.0005000000237487257, "total_loss": 9.806412696838379, "entropy": 1.2789983749389648, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 9.807751655578613, "policy_loss": -0.001722182147204876, "vf_explained_var": 0.898408055305481}, "num_steps_trained": 839846, "num_steps_sampled": 839846}, "custom_metrics": {"cost1_min": 19.468434252413918, "system_level_velocity_min": 7.116066012083398, "outflow_rate_min": 477.932734294326, "cost1_mean": 304.3428229723979, "cost2_max": 0.0, "cost2_mean": -0.09271151783330726, "cost2_min": -0.6549143426479072, "system_level_velocity_mean": 11.743286685319948, "outflow_rate_max": 1239.4674092213972, "cost1_max": 395.8741590805862, "outflow_rate_mean": 1029.012927014193, "system_level_velocity_max": 18.064803156329017}, "episodes_total": 315, "episode_reward_max": 1092.749420312937, "timestamp": 1557111250, "episode_reward_mean": 850.8703289634406, "episodes_this_iter": 19, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 20.034024000167847, "timesteps_since_restore": 839846, "episode_reward_min": 52.944170067428395, "node_ip": "10.138.0.2", "time_total_s": 433.40154337882996, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-54-10", "done": false, "timesteps_total": 839846, "timesteps_this_iter": 40642, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba668>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba320>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ababe0>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 20, "training_iteration": 20, "policy_reward_mean": {}, "time_since_restore": 433.40154337882996, "episode_len_mean": 693.29}
{"info": {"sample_time_ms": 12523.938, "load_time_ms": 12.463, "update_time_ms": 7.191, "grad_time_ms": 8068.115, "default": {"kl": 0.008207350037992, "cur_lr": 0.0005000000237487257, "total_loss": 9.429015159606934, "entropy": 1.2667044401168823, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 9.430828094482422, "policy_loss": -0.0022231563925743103, "vf_explained_var": 0.904126763343811}, "num_steps_trained": 880080, "num_steps_sampled": 880080}, "custom_metrics": {"cost1_min": 19.468434252413918, "system_level_velocity_min": 7.116066012083398, "outflow_rate_min": 477.932734294326, "cost1_mean": 307.19001059378365, "cost2_max": 0.0, "cost2_mean": -0.06580280073913831, "cost2_min": -0.5014324401588025, "system_level_velocity_mean": 11.853074747511744, "outflow_rate_max": 1239.4674092213972, "cost1_max": 395.8741590805862, "outflow_rate_mean": 1037.4036384664341, "system_level_velocity_max": 18.064803156329017}, "episodes_total": 330, "episode_reward_max": 1092.749420312937, "timestamp": 1557111271, "episode_reward_mean": 853.8242715610047, "episodes_this_iter": 15, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 21.137420892715454, "timesteps_since_restore": 880080, "episode_reward_min": 52.944170067428395, "node_ip": "10.138.0.2", "time_total_s": 454.5389642715454, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-54-31", "done": false, "timesteps_total": 880080, "timesteps_this_iter": 40234, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3abab70>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3abab38>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f453f978>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 21, "training_iteration": 21, "policy_reward_mean": {}, "time_since_restore": 454.5389642715454, "episode_len_mean": 693.29}
{"info": {"sample_time_ms": 12375.079, "load_time_ms": 13.192, "update_time_ms": 7.025, "grad_time_ms": 8360.445, "default": {"kl": 0.009912757202982903, "cur_lr": 0.0005000000237487257, "total_loss": 9.195625305175781, "entropy": 1.2673051357269287, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 9.199996948242188, "policy_loss": -0.004867715761065483, "vf_explained_var": 0.9010846018791199}, "num_steps_trained": 921594, "num_steps_sampled": 921594}, "custom_metrics": {"cost1_min": 19.468434252413918, "system_level_velocity_min": 8.93321864312866, "outflow_rate_min": 477.932734294326, "cost1_mean": 311.5991392427073, "cost2_max": 0.0, "cost2_mean": -0.06645928969124267, "cost2_min": -0.3718938658259337, "system_level_velocity_mean": 12.02682191238306, "outflow_rate_max": 1239.4674092213972, "cost1_max": 395.8741590805862, "outflow_rate_mean": 1047.7479324161434, "system_level_velocity_max": 18.064803156329017}, "episodes_total": 346, "episode_reward_max": 1092.749420312937, "timestamp": 1557111293, "episode_reward_mean": 856.5622868257212, "episodes_this_iter": 16, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 21.324032306671143, "timesteps_since_restore": 921594, "episode_reward_min": 52.944170067428395, "node_ip": "10.138.0.2", "time_total_s": 475.86299657821655, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-54-53", "done": false, "timesteps_total": 921594, "timesteps_this_iter": 41514, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3abad68>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba5f8>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 22, "training_iteration": 22, "policy_reward_mean": {}, "time_since_restore": 475.86299657821655, "episode_len_mean": 693.29}
{"info": {"sample_time_ms": 12238.724, "load_time_ms": 13.617, "update_time_ms": 7.103, "grad_time_ms": 8691.944, "default": {"kl": 0.008351839147508144, "cur_lr": 0.0005000000237487257, "total_loss": 8.269659996032715, "entropy": 1.2733705043792725, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 8.271737098693848, "policy_loss": -0.0024932140950113535, "vf_explained_var": 0.9103253483772278}, "num_steps_trained": 963288, "num_steps_sampled": 963288}, "custom_metrics": {"cost1_min": 19.468434252413918, "system_level_velocity_min": 8.93321864312866, "outflow_rate_min": 477.932734294326, "cost1_mean": 311.46652047795976, "cost2_max": 0.0, "cost2_mean": -0.07819181843932871, "cost2_min": -0.5703305488228833, "system_level_velocity_mean": 12.023163482257766, "outflow_rate_max": 1239.4674092213972, "cost1_max": 395.8741590805862, "outflow_rate_mean": 1047.2854115239081, "system_level_velocity_max": 18.064803156329017}, "episodes_total": 361, "episode_reward_max": 1092.749420312937, "timestamp": 1557111315, "episode_reward_mean": 852.0089161928462, "episodes_this_iter": 15, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 21.883638620376587, "timesteps_since_restore": 963288, "episode_reward_min": 52.944170067428395, "node_ip": "10.138.0.2", "time_total_s": 497.74663519859314, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-55-15", "done": false, "timesteps_total": 963288, "timesteps_this_iter": 41694, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba9e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3abadd8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4519978>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 23, "training_iteration": 23, "policy_reward_mean": {}, "time_since_restore": 497.74663519859314, "episode_len_mean": 693.29}
{"info": {"sample_time_ms": 12089.89, "load_time_ms": 12.804, "update_time_ms": 7.22, "grad_time_ms": 8959.349, "default": {"kl": 0.01074176374822855, "cur_lr": 0.0005000000237487257, "total_loss": 7.818026542663574, "entropy": 1.2784996032714844, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 7.820031642913818, "policy_loss": -0.002542446833103895, "vf_explained_var": 0.9272727370262146}, "num_steps_trained": 1004817, "num_steps_sampled": 1004817}, "custom_metrics": {"cost1_min": 19.468434252413918, "system_level_velocity_min": 8.977367804788784, "outflow_rate_min": 477.932734294326, "cost1_mean": 309.7116966041726, "cost2_max": 0.0, "cost2_mean": -0.08762618893429173, "cost2_min": -0.5714285714285714, "system_level_velocity_mean": 11.960568561566765, "outflow_rate_max": 1239.4674092213972, "cost1_max": 395.8741590805862, "outflow_rate_mean": 1043.325723497878, "system_level_velocity_max": 18.064803156329017}, "episodes_total": 377, "episode_reward_max": 1092.749420312937, "timestamp": 1557111336, "episode_reward_mean": 846.3509992415804, "episodes_this_iter": 16, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 21.202484130859375, "timesteps_since_restore": 1004817, "episode_reward_min": 52.944170067428395, "node_ip": "10.138.0.2", "time_total_s": 518.9491193294525, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-55-36", "done": false, "timesteps_total": 1004817, "timesteps_this_iter": 41529, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1240>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1710>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac16d8>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 24, "training_iteration": 24, "policy_reward_mean": {}, "time_since_restore": 518.9491193294525, "episode_len_mean": 693.29}
{"info": {"sample_time_ms": 11957.581, "load_time_ms": 13.543, "update_time_ms": 7.333, "grad_time_ms": 9253.674, "default": {"kl": 0.009467937983572483, "cur_lr": 0.0005000000237487257, "total_loss": 10.010286331176758, "entropy": 1.271166443824768, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 10.01292896270752, "policy_loss": -0.003115609986707568, "vf_explained_var": 0.9001064896583557}, "num_steps_trained": 1045258, "num_steps_sampled": 1045258}, "custom_metrics": {"cost1_min": 220.97996163005956, "system_level_velocity_min": 8.77688391461493, "outflow_rate_min": 863.2827227799615, "cost1_mean": 308.22171846544586, "cost2_max": 0.0, "cost2_mean": -0.07257795774988128, "cost2_min": -0.5714285714285714, "system_level_velocity_mean": 11.7399657022378, "outflow_rate_max": 1179.4779480105294, "cost1_max": 369.85600717906806, "outflow_rate_mean": 1039.7044041024997, "system_level_velocity_max": 13.862544977919844}, "episodes_total": 396, "episode_reward_max": 1019.3071210813216, "timestamp": 1557111359, "episode_reward_mean": 840.3899861041184, "episodes_this_iter": 19, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 22.96571922302246, "timesteps_since_restore": 1045258, "episode_reward_min": 706.5357601327202, "node_ip": "10.138.0.2", "time_total_s": 541.914838552475, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-55-59", "done": false, "timesteps_total": 1045258, "timesteps_this_iter": 40441, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ababa8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba6d8>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 25, "training_iteration": 25, "policy_reward_mean": {}, "time_since_restore": 541.914838552475, "episode_len_mean": 700.0}
{"info": {"sample_time_ms": 11792.049, "load_time_ms": 14.016, "update_time_ms": 7.411, "grad_time_ms": 9463.22, "default": {"kl": 0.011644318699836731, "cur_lr": 0.0005000000237487257, "total_loss": 10.032158851623535, "entropy": 1.2667986154556274, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 10.035194396972656, "policy_loss": -0.0036190280225127935, "vf_explained_var": 0.9002193212509155}, "num_steps_trained": 1084962, "num_steps_sampled": 1084962}, "custom_metrics": {"cost1_min": 204.7369731287511, "system_level_velocity_min": 8.07477544754372, "outflow_rate_min": 840.7856846588552, "cost1_mean": 301.1432059308581, "cost2_max": 0.0, "cost2_mean": -0.0714805625488002, "cost2_min": -0.5714285714285714, "system_level_velocity_mean": 11.503344257419904, "outflow_rate_max": 1179.4779480105294, "cost1_max": 369.85600717906806, "outflow_rate_mean": 1026.6202105666673, "system_level_velocity_max": 13.759955486311114}, "episodes_total": 412, "episode_reward_max": 1014.1952618376959, "timestamp": 1557111380, "episode_reward_mean": 828.749331808514, "episodes_this_iter": 16, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 21.125786542892456, "timesteps_since_restore": 1084962, "episode_reward_min": 682.5908824939618, "node_ip": "10.138.0.2", "time_total_s": 563.0406250953674, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-56-20", "done": false, "timesteps_total": 1084962, "timesteps_this_iter": 39704, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ace278>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ace2b0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ace240>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 26, "training_iteration": 26, "policy_reward_mean": {}, "time_since_restore": 563.0406250953674, "episode_len_mean": 700.0}
{"info": {"sample_time_ms": 11712.97, "load_time_ms": 15.102, "update_time_ms": 7.423, "grad_time_ms": 9688.703, "default": {"kl": 0.00891010370105505, "cur_lr": 0.0005000000237487257, "total_loss": 10.205191612243652, "entropy": 1.2776343822479248, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 10.206805229187012, "policy_loss": -0.0020583500154316425, "vf_explained_var": 0.9126747250556946}, "num_steps_trained": 1125692, "num_steps_sampled": 1125692}, "custom_metrics": {"cost1_min": 204.7369731287511, "system_level_velocity_min": 8.07477544754372, "outflow_rate_min": 840.7856846588552, "cost1_mean": 300.87400561179754, "cost2_max": 0.0, "cost2_mean": -0.07568924102536201, "cost2_min": -0.5714285714285714, "system_level_velocity_mean": 11.497319642342065, "outflow_rate_max": 1179.4779480105294, "cost1_max": 373.98087937832867, "outflow_rate_mean": 1024.8729973806292, "system_level_velocity_max": 14.089359928280734}, "episodes_total": 428, "episode_reward_max": 1014.1952618376959, "timestamp": 1557111402, "episode_reward_mean": 822.6607450914909, "episodes_this_iter": 16, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 22.144649744033813, "timesteps_since_restore": 1125692, "episode_reward_min": 682.5908824939618, "node_ip": "10.138.0.2", "time_total_s": 585.1852748394012, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-56-42", "done": false, "timesteps_total": 1125692, "timesteps_this_iter": 40730, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1748>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1320>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 27, "training_iteration": 27, "policy_reward_mean": {}, "time_since_restore": 585.1852748394012, "episode_len_mean": 700.0}
{"info": {"sample_time_ms": 11531.337, "load_time_ms": 15.388, "update_time_ms": 7.412, "grad_time_ms": 9820.111, "default": {"kl": 0.01059021707624197, "cur_lr": 0.0005000000237487257, "total_loss": 9.7223482131958, "entropy": 1.291719675064087, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 9.72396469116211, "policy_loss": -0.0021459986455738544, "vf_explained_var": 0.9120697975158691}, "num_steps_trained": 1166551, "num_steps_sampled": 1166551}, "custom_metrics": {"cost1_min": 204.7369731287511, "system_level_velocity_min": 8.07477544754372, "outflow_rate_min": 840.7856846588552, "cost1_mean": 299.1941863364658, "cost2_max": 0.0, "cost2_mean": -0.08139397550285614, "cost2_min": -0.5714285714285714, "system_level_velocity_mean": 11.447395921889257, "outflow_rate_max": 1190.8809535824905, "cost1_max": 373.98087937832867, "outflow_rate_mean": 1020.4460152627382, "system_level_velocity_max": 14.089359928280734}, "episodes_total": 444, "episode_reward_max": 968.229156375712, "timestamp": 1557111423, "episode_reward_mean": 815.9316370781878, "episodes_this_iter": 16, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 21.22477912902832, "timesteps_since_restore": 1166551, "episode_reward_min": 651.8435943223866, "node_ip": "10.138.0.2", "time_total_s": 606.4100539684296, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-57-03", "done": false, "timesteps_total": 1166551, "timesteps_this_iter": 40859, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ace828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ace630>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ace710>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 28, "training_iteration": 28, "policy_reward_mean": {}, "time_since_restore": 606.4100539684296, "episode_len_mean": 700.0}
{"info": {"sample_time_ms": 11329.974, "load_time_ms": 15.35, "update_time_ms": 7.322, "grad_time_ms": 9986.775, "default": {"kl": 0.009917333722114563, "cur_lr": 0.0005000000237487257, "total_loss": 11.025726318359375, "entropy": 1.2703660726547241, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 11.027830123901367, "policy_loss": -0.002600868698209524, "vf_explained_var": 0.9184905886650085}, "num_steps_trained": 1207620, "num_steps_sampled": 1207620}, "custom_metrics": {"cost1_min": 204.7369731287511, "system_level_velocity_min": 8.07477544754372, "outflow_rate_min": 840.7856846588552, "cost1_mean": 298.71535447104765, "cost2_max": 0.0, "cost2_mean": -0.08487002400519822, "cost2_min": -0.5714285714285714, "system_level_velocity_mean": 11.441976887705607, "outflow_rate_max": 1191.8000975085386, "cost1_max": 378.16777252500026, "outflow_rate_mean": 1019.4403132982146, "system_level_velocity_max": 14.103890693029363}, "episodes_total": 459, "episode_reward_max": 1067.610547408096, "timestamp": 1557111445, "episode_reward_mean": 816.9547399737594, "episodes_this_iter": 15, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 21.08246374130249, "timesteps_since_restore": 1207620, "episode_reward_min": 651.8435943223866, "node_ip": "10.138.0.2", "time_total_s": 627.492517709732, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-57-25", "done": false, "timesteps_total": 1207620, "timesteps_this_iter": 41069, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1cf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1cc0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1f28>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 29, "training_iteration": 29, "policy_reward_mean": {}, "time_since_restore": 627.492517709732, "episode_len_mean": 700.0}
{"info": {"sample_time_ms": 11266.676, "load_time_ms": 15.621, "update_time_ms": 7.19, "grad_time_ms": 10136.462, "default": {"kl": 0.01144661195576191, "cur_lr": 0.0005000000237487257, "total_loss": 13.524009704589844, "entropy": 1.266331672668457, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 13.526927947998047, "policy_loss": -0.0034916589502245188, "vf_explained_var": 0.8914434313774109}, "num_steps_trained": 1247967, "num_steps_sampled": 1247967}, "custom_metrics": {"cost1_min": 204.7369731287511, "system_level_velocity_min": 8.07477544754372, "outflow_rate_min": 840.7856846588552, "cost1_mean": 301.19078902523745, "cost2_max": 0.0, "cost2_mean": -0.06078718988901473, "cost2_min": -0.4913002188186233, "system_level_velocity_mean": 11.528055688464985, "outflow_rate_max": 1191.8000975085386, "cost1_max": 378.16777252500026, "outflow_rate_mean": 1024.9607745937415, "system_level_velocity_max": 14.103890693029363}, "episodes_total": 477, "episode_reward_max": 1067.610547408096, "timestamp": 1557111466, "episode_reward_mean": 819.6558485490029, "episodes_this_iter": 18, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 20.90449833869934, "timesteps_since_restore": 1247967, "episode_reward_min": 651.8435943223866, "node_ip": "10.138.0.2", "time_total_s": 648.3970160484314, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-57-46", "done": false, "timesteps_total": 1247967, "timesteps_this_iter": 40347, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba1d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3abab38>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba4e0>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 30, "training_iteration": 30, "policy_reward_mean": {}, "time_since_restore": 648.3970160484314, "episode_len_mean": 700.0}
{"info": {"sample_time_ms": 11129.936, "load_time_ms": 16.011, "update_time_ms": 7.144, "grad_time_ms": 10249.172, "default": {"kl": 0.009467942640185356, "cur_lr": 0.0005000000237487257, "total_loss": 12.257377624511719, "entropy": 1.2484270334243774, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 12.258892059326172, "policy_loss": -0.001988800475373864, "vf_explained_var": 0.9054250717163086}, "num_steps_trained": 1288149, "num_steps_sampled": 1288149}, "custom_metrics": {"cost1_min": 204.7369731287511, "system_level_velocity_min": 8.07477544754372, "outflow_rate_min": 840.7856846588552, "cost1_mean": 303.05197122732415, "cost2_max": 0.0, "cost2_mean": -0.06309009979218257, "cost2_min": -0.4913002188186233, "system_level_velocity_mean": 11.603605061534598, "outflow_rate_max": 1191.8000975085386, "cost1_max": 378.16777252500026, "outflow_rate_mean": 1028.810937324811, "system_level_velocity_max": 14.103890693029363}, "episodes_total": 494, "episode_reward_max": 1067.610547408096, "timestamp": 1557111486, "episode_reward_mean": 824.1532797927254, "episodes_this_iter": 17, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 20.90194082260132, "timesteps_since_restore": 1288149, "episode_reward_min": 651.8435943223866, "node_ip": "10.138.0.2", "time_total_s": 669.2989568710327, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-58-06", "done": false, "timesteps_total": 1288149, "timesteps_this_iter": 40182, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ace7f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3acea20>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3acebe0>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 31, "training_iteration": 31, "policy_reward_mean": {}, "time_since_restore": 669.2989568710327, "episode_len_mean": 700.0}
{"info": {"sample_time_ms": 11044.438, "load_time_ms": 15.741, "update_time_ms": 7.316, "grad_time_ms": 10255.353, "default": {"kl": 0.01037503220140934, "cur_lr": 0.0005000000237487257, "total_loss": 12.160199165344238, "entropy": 1.2368603944778442, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 12.162812232971191, "policy_loss": -0.003131567733362317, "vf_explained_var": 0.9049180150032043}, "num_steps_trained": 1328686, "num_steps_sampled": 1328686}, "custom_metrics": {"cost1_min": 223.59616466063545, "system_level_velocity_min": 8.659928449102795, "outflow_rate_min": 866.7455413985427, "cost1_mean": 308.2354872776704, "cost2_max": 0.0, "cost2_mean": -0.07781411089391582, "cost2_min": -0.8, "system_level_velocity_mean": 11.795889367249012, "outflow_rate_max": 1191.8000975085386, "cost1_max": 378.16777252500026, "outflow_rate_mean": 1039.0448662108427, "system_level_velocity_max": 14.103890693029363}, "episodes_total": 511, "episode_reward_max": 1067.610547408096, "timestamp": 1557111507, "episode_reward_mean": 832.3485317412265, "episodes_this_iter": 17, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 20.537495851516724, "timesteps_since_restore": 1328686, "episode_reward_min": 651.8435943223866, "node_ip": "10.138.0.2", "time_total_s": 689.8364527225494, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-58-27", "done": false, "timesteps_total": 1328686, "timesteps_this_iter": 40537, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ace2e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ace080>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ace4a8>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 32, "training_iteration": 32, "policy_reward_mean": {}, "time_since_restore": 689.8364527225494, "episode_len_mean": 700.0}
{"info": {"sample_time_ms": 10975.028, "load_time_ms": 15.701, "update_time_ms": 7.379, "grad_time_ms": 10231.925, "default": {"kl": 0.011664336547255516, "cur_lr": 0.0005000000237487257, "total_loss": 10.498281478881836, "entropy": 1.2444700002670288, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 10.50218677520752, "policy_loss": -0.004487724509090185, "vf_explained_var": 0.9188302159309387}, "num_steps_trained": 1369168, "num_steps_sampled": 1369168}, "custom_metrics": {"cost1_min": 223.59616466063545, "system_level_velocity_min": 8.659928449102795, "outflow_rate_min": 866.7455413985427, "cost1_mean": 308.6165883500121, "cost2_max": 0.0, "cost2_mean": -0.08141651680157784, "cost2_min": -0.8, "system_level_velocity_mean": 11.814054525195331, "outflow_rate_max": 1191.8000975085386, "cost1_max": 378.16777252500026, "outflow_rate_mean": 1040.6531917410123, "system_level_velocity_max": 14.133489100540267}, "episodes_total": 527, "episode_reward_max": 1067.610547408096, "timestamp": 1557111528, "episode_reward_mean": 834.4260442737421, "episodes_this_iter": 16, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 20.956033945083618, "timesteps_since_restore": 1369168, "episode_reward_min": 651.8435943223866, "node_ip": "10.138.0.2", "time_total_s": 710.792486667633, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-58-48", "done": false, "timesteps_total": 1369168, "timesteps_this_iter": 40482, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3acea58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ace208>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3acefd0>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 33, "training_iteration": 33, "policy_reward_mean": {}, "time_since_restore": 710.792486667633, "episode_len_mean": 700.0}
{"info": {"sample_time_ms": 10962.734, "load_time_ms": 16.469, "update_time_ms": 7.293, "grad_time_ms": 10213.334, "default": {"kl": 0.010512576438486576, "cur_lr": 0.0005000000237487257, "total_loss": 9.6309175491333, "entropy": 1.2421637773513794, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 9.63381290435791, "policy_loss": -0.00342100509442389, "vf_explained_var": 0.9319109320640564}, "num_steps_trained": 1409815, "num_steps_sampled": 1409815}, "custom_metrics": {"cost1_min": 223.59616466063545, "system_level_velocity_min": 8.659928449102795, "outflow_rate_min": 900.1327214659245, "cost1_mean": 309.5312048674382, "cost2_max": 0.0, "cost2_mean": -0.08009124286318647, "cost2_min": -0.8, "system_level_velocity_mean": 11.853331165465411, "outflow_rate_max": 1191.8000975085386, "cost1_max": 378.16777252500026, "outflow_rate_mean": 1042.932593316997, "system_level_velocity_max": 14.133489100540267}, "episodes_total": 543, "episode_reward_max": 1067.610547408096, "timestamp": 1557111549, "episode_reward_mean": 839.002478039864, "episodes_this_iter": 16, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 20.899757385253906, "timesteps_since_restore": 1409815, "episode_reward_min": 654.9037336118979, "node_ip": "10.138.0.2", "time_total_s": 731.692244052887, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-59-09", "done": false, "timesteps_total": 1409815, "timesteps_this_iter": 40647, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ace748>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ace710>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3acea20>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 34, "training_iteration": 34, "policy_reward_mean": {}, "time_since_restore": 731.692244052887, "episode_len_mean": 700.0}
{"info": {"sample_time_ms": 10860.716, "load_time_ms": 15.606, "update_time_ms": 7.271, "grad_time_ms": 10120.447, "default": {"kl": 0.010275178588926792, "cur_lr": 0.0005000000237487257, "total_loss": 12.652281761169434, "entropy": 1.2355459928512573, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 12.655258178710938, "policy_loss": -0.003489421447739005, "vf_explained_var": 0.9070101976394653}, "num_steps_trained": 1450098, "num_steps_sampled": 1450098}, "custom_metrics": {"cost1_min": 229.8779587646756, "system_level_velocity_min": 8.975074379839452, "outflow_rate_min": 913.1288881825689, "cost1_mean": 313.45809632362716, "cost2_max": 0.0, "cost2_mean": -0.0766774754825415, "cost2_min": -0.8, "system_level_velocity_mean": 11.9913197769822, "outflow_rate_max": 1185.5989261065454, "cost1_max": 380.68783627054347, "outflow_rate_mean": 1050.804952175238, "system_level_velocity_max": 14.343909514276563}, "episodes_total": 560, "episode_reward_max": 1024.4106801441187, "timestamp": 1557111570, "episode_reward_mean": 847.4495599261535, "episodes_this_iter": 17, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 21.000568151474, "timesteps_since_restore": 1450098, "episode_reward_min": 654.9037336118979, "node_ip": "10.138.0.2", "time_total_s": 752.692812204361, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-59-30", "done": false, "timesteps_total": 1450098, "timesteps_this_iter": 40283, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac18d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531f28>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac14e0>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 35, "training_iteration": 35, "policy_reward_mean": {}, "time_since_restore": 752.692812204361, "episode_len_mean": 700.0}
{"info": {"sample_time_ms": 10971.423, "load_time_ms": 15.68, "update_time_ms": 7.197, "grad_time_ms": 10121.706, "default": {"kl": 0.012505686841905117, "cur_lr": 0.0005000000237487257, "total_loss": 12.7552490234375, "entropy": 1.233476161956787, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 12.757591247558594, "policy_loss": -0.0029665243346244097, "vf_explained_var": 0.9116160273551941}, "num_steps_trained": 1490529, "num_steps_sampled": 1490529}, "custom_metrics": {"cost1_min": 229.8779587646756, "system_level_velocity_min": 8.975074379839452, "outflow_rate_min": 913.1288881825689, "cost1_mean": 314.07662704358734, "cost2_max": 0.0, "cost2_mean": -0.07795185265528434, "cost2_min": -0.8, "system_level_velocity_mean": 12.02204003186434, "outflow_rate_max": 1172.816344036955, "cost1_max": 380.68783627054347, "outflow_rate_mean": 1050.717469894053, "system_level_velocity_max": 14.343909514276563}, "episodes_total": 576, "episode_reward_max": 1024.4106801441187, "timestamp": 1557111592, "episode_reward_mean": 847.8619968857289, "episodes_this_iter": 16, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 22.240371227264404, "timesteps_since_restore": 1490529, "episode_reward_min": 654.9037336118979, "node_ip": "10.138.0.2", "time_total_s": 774.9331834316254, "num_metric_batches_dropped": 0, "date": "2019-05-06_02-59-52", "done": false, "timesteps_total": 1490529, "timesteps_this_iter": 40431, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba240>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3abab38>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba4e0>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 36, "training_iteration": 36, "policy_reward_mean": {}, "time_since_restore": 774.9331834316254, "episode_len_mean": 700.0}
{"info": {"sample_time_ms": 10864.543, "load_time_ms": 15.59, "update_time_ms": 7.075, "grad_time_ms": 10149.625, "default": {"kl": 0.012690190225839615, "cur_lr": 0.0005000000237487257, "total_loss": 11.583903312683105, "entropy": 1.2454419136047363, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 11.587456703186035, "policy_loss": -0.004187826067209244, "vf_explained_var": 0.9104008674621582}, "num_steps_trained": 1531650, "num_steps_sampled": 1531650}, "custom_metrics": {"cost1_min": 229.8779587646756, "system_level_velocity_min": 8.975074379839452, "outflow_rate_min": 913.1288881825689, "cost1_mean": 316.2852822072637, "cost2_max": 0.0, "cost2_mean": -0.07670325084718488, "cost2_min": -0.8, "system_level_velocity_mean": 12.09714919997716, "outflow_rate_max": 1172.816344036955, "cost1_max": 380.68783627054347, "outflow_rate_mean": 1053.6941578283927, "system_level_velocity_max": 14.343909514276563}, "episodes_total": 594, "episode_reward_max": 1024.4106801441187, "timestamp": 1557111614, "episode_reward_mean": 852.2634823684607, "episodes_this_iter": 18, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 21.354309797286987, "timesteps_since_restore": 1531650, "episode_reward_min": 654.9037336118979, "node_ip": "10.138.0.2", "time_total_s": 796.2874932289124, "num_metric_batches_dropped": 0, "date": "2019-05-06_03-00-14", "done": false, "timesteps_total": 1531650, "timesteps_this_iter": 41121, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ace710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531860>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ace160>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 37, "training_iteration": 37, "policy_reward_mean": {}, "time_since_restore": 796.2874932289124, "episode_len_mean": 700.0}
{"info": {"sample_time_ms": 10864.871, "load_time_ms": 15.404, "update_time_ms": 7.067, "grad_time_ms": 10131.795, "default": {"kl": 0.01033172570168972, "cur_lr": 0.0005000000237487257, "total_loss": 8.943177223205566, "entropy": 1.2262617349624634, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 8.946133613586426, "policy_loss": -0.003471917239949107, "vf_explained_var": 0.9361939430236816}, "num_steps_trained": 1571538, "num_steps_sampled": 1571538}, "custom_metrics": {"cost1_min": 229.8779587646756, "system_level_velocity_min": 8.975074379839452, "outflow_rate_min": 913.1288881825689, "cost1_mean": 314.75187380331647, "cost2_max": 0.0, "cost2_mean": -0.0627150365091319, "cost2_min": -0.4178738571708895, "system_level_velocity_mean": 12.029511033811781, "outflow_rate_max": 1172.816344036955, "cost1_max": 380.68783627054347, "outflow_rate_mean": 1050.3653563698037, "system_level_velocity_max": 14.343909514276563}, "episodes_total": 609, "episode_reward_max": 1006.4894257001692, "timestamp": 1557111635, "episode_reward_mean": 850.230107276688, "episodes_this_iter": 15, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 21.044634103775024, "timesteps_since_restore": 1571538, "episode_reward_min": 654.9037336118979, "node_ip": "10.138.0.2", "time_total_s": 817.3321273326874, "num_metric_batches_dropped": 0, "date": "2019-05-06_03-00-35", "done": false, "timesteps_total": 1571538, "timesteps_this_iter": 39888, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1dd8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1240>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1d30>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 38, "training_iteration": 38, "policy_reward_mean": {}, "time_since_restore": 817.3321273326874, "episode_len_mean": 700.0}
{"info": {"sample_time_ms": 10885.81, "load_time_ms": 15.839, "update_time_ms": 7.059, "grad_time_ms": 10122.405, "default": {"kl": 0.011560344137251377, "cur_lr": 0.0005000000237487257, "total_loss": 14.012123107910156, "entropy": 1.2145566940307617, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 14.014747619628906, "policy_loss": -0.003202093532308936, "vf_explained_var": 0.9176921248435974}, "num_steps_trained": 1611109, "num_steps_sampled": 1611109}, "custom_metrics": {"cost1_min": 21.03559826323536, "system_level_velocity_min": 8.975074379839452, "outflow_rate_min": 498.40178486676893, "cost1_mean": 311.9488146078392, "cost2_max": 0.0, "cost2_mean": -0.05953736124376613, "cost2_min": -0.4178738571708895, "system_level_velocity_mean": 12.08895331261992, "outflow_rate_max": 1172.816344036955, "cost1_max": 380.68783627054347, "outflow_rate_mean": 1043.81391255309, "system_level_velocity_max": 18.860657567311403}, "episodes_total": 627, "episode_reward_max": 1006.4894257001692, "timestamp": 1557111656, "episode_reward_mean": 845.6803571125314, "episodes_this_iter": 18, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 21.199236631393433, "timesteps_since_restore": 1611109, "episode_reward_min": 51.82773284841394, "node_ip": "10.138.0.2", "time_total_s": 838.5313639640808, "num_metric_batches_dropped": 0, "date": "2019-05-06_03-00-56", "done": false, "timesteps_total": 1611109, "timesteps_this_iter": 39571, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3acec88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3acef28>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ace6a0>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 39, "training_iteration": 39, "policy_reward_mean": {}, "time_since_restore": 838.5313639640808, "episode_len_mean": 693.32}
{"info": {"sample_time_ms": 11045.004, "load_time_ms": 17.192, "update_time_ms": 7.002, "grad_time_ms": 10118.196, "default": {"kl": 0.015447373501956463, "cur_lr": 0.0005000000237487257, "total_loss": 12.300609588623047, "entropy": 1.193393349647522, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 12.304682731628418, "policy_loss": -0.004845314659178257, "vf_explained_var": 0.9243574142456055}, "num_steps_trained": 1651395, "num_steps_sampled": 1651395}, "custom_metrics": {"cost1_min": 21.03559826323536, "system_level_velocity_min": 8.815039285997386, "outflow_rate_min": 498.40178486676893, "cost1_mean": 315.5810309068147, "cost2_max": 0.0, "cost2_mean": -0.056338335444526974, "cost2_min": -0.4178738571708895, "system_level_velocity_mean": 12.20864814899956, "outflow_rate_max": 1208.247928112041, "cost1_max": 386.96694463159065, "outflow_rate_mean": 1048.7079544288574, "system_level_velocity_max": 18.860657567311403}, "episodes_total": 644, "episode_reward_max": 1006.4894257001692, "timestamp": 1557111678, "episode_reward_mean": 846.5713082348988, "episodes_this_iter": 17, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 22.466251850128174, "timesteps_since_restore": 1651395, "episode_reward_min": 51.82773284841394, "node_ip": "10.138.0.2", "time_total_s": 860.997615814209, "num_metric_batches_dropped": 0, "date": "2019-05-06_03-01-18", "done": false, "timesteps_total": 1651395, "timesteps_this_iter": 40286, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531f28>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531a20>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 40, "training_iteration": 40, "policy_reward_mean": {}, "time_since_restore": 860.997615814209, "episode_len_mean": 693.32}
{"info": {"sample_time_ms": 11084.19, "load_time_ms": 17.054, "update_time_ms": 6.994, "grad_time_ms": 10128.203, "default": {"kl": 0.01145993359386921, "cur_lr": 0.0005000000237487257, "total_loss": 12.524819374084473, "entropy": 1.2011747360229492, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 12.527511596679688, "policy_loss": -0.0032645922619849443, "vf_explained_var": 0.9025618433952332}, "num_steps_trained": 1692267, "num_steps_sampled": 1692267}, "custom_metrics": {"cost1_min": 21.03559826323536, "system_level_velocity_min": 8.815039285997386, "outflow_rate_min": 498.40178486676893, "cost1_mean": 314.7099502472775, "cost2_max": 0.0, "cost2_mean": -0.05236532817382561, "cost2_min": -0.4178738571708895, "system_level_velocity_mean": 12.178153222414503, "outflow_rate_max": 1226.5255556460718, "cost1_max": 387.5084158573894, "outflow_rate_mean": 1047.8118001242456, "system_level_velocity_max": 18.860657567311403}, "episodes_total": 659, "episode_reward_max": 1005.7953016188961, "timestamp": 1557111700, "episode_reward_mean": 842.8557772888701, "episodes_this_iter": 15, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 21.400501489639282, "timesteps_since_restore": 1692267, "episode_reward_min": 51.82773284841394, "node_ip": "10.138.0.2", "time_total_s": 882.3981173038483, "num_metric_batches_dropped": 0, "date": "2019-05-06_03-01-40", "done": false, "timesteps_total": 1692267, "timesteps_this_iter": 40872, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1240>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1ba8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1b38>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 41, "training_iteration": 41, "policy_reward_mean": {}, "time_since_restore": 882.3981173038483, "episode_len_mean": 693.32}
{"info": {"sample_time_ms": 11108.086, "load_time_ms": 16.743, "update_time_ms": 6.9, "grad_time_ms": 10140.821, "default": {"kl": 0.012396967969834805, "cur_lr": 0.0005000000237487257, "total_loss": 12.30443286895752, "entropy": 1.185652256011963, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 12.307544708251953, "policy_loss": -0.003731628181412816, "vf_explained_var": 0.9195852875709534}, "num_steps_trained": 1732600, "num_steps_sampled": 1732600}, "custom_metrics": {"cost1_min": 21.03559826323536, "system_level_velocity_min": 8.815039285997386, "outflow_rate_min": 498.40178486676893, "cost1_mean": 312.23296558802423, "cost2_max": 0.0, "cost2_mean": -0.05751989025573658, "cost2_min": -0.48255229028749347, "system_level_velocity_mean": 12.100494950305333, "outflow_rate_max": 1226.5255556460718, "cost1_max": 387.5084158573894, "outflow_rate_mean": 1043.5154002379218, "system_level_velocity_max": 18.860657567311403}, "episodes_total": 675, "episode_reward_max": 1005.7953016188961, "timestamp": 1557111721, "episode_reward_mean": 839.6673581936114, "episodes_this_iter": 16, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 20.893852472305298, "timesteps_since_restore": 1732600, "episode_reward_min": 51.82773284841394, "node_ip": "10.138.0.2", "time_total_s": 903.2919697761536, "num_metric_batches_dropped": 0, "date": "2019-05-06_03-02-01", "done": false, "timesteps_total": 1732600, "timesteps_this_iter": 40333, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8ef0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8cf8>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 42, "training_iteration": 42, "policy_reward_mean": {}, "time_since_restore": 903.2919697761536, "episode_len_mean": 693.32}
{"info": {"sample_time_ms": 11056.962, "load_time_ms": 16.431, "update_time_ms": 6.812, "grad_time_ms": 10136.289, "default": {"kl": 0.014245565980672836, "cur_lr": 0.0005000000237487257, "total_loss": 15.34399127960205, "entropy": 1.1748355627059937, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 15.346128463745117, "policy_loss": -0.00285115884616971, "vf_explained_var": 0.9145365953445435}, "num_steps_trained": 1772116, "num_steps_sampled": 1772116}, "custom_metrics": {"cost1_min": 21.03559826323536, "system_level_velocity_min": 8.815039285997386, "outflow_rate_min": 498.40178486676893, "cost1_mean": 313.67104170556655, "cost2_max": 0.0, "cost2_mean": -0.06249722750768468, "cost2_min": -0.5, "system_level_velocity_mean": 12.154095747902863, "outflow_rate_max": 1226.5255556460718, "cost1_max": 387.5084158573894, "outflow_rate_mean": 1046.7495585427935, "system_level_velocity_max": 18.860657567311403}, "episodes_total": 692, "episode_reward_max": 1008.2923518717653, "timestamp": 1557111741, "episode_reward_mean": 840.3600659927339, "episodes_this_iter": 17, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 20.405407190322876, "timesteps_since_restore": 1772116, "episode_reward_min": 51.82773284841394, "node_ip": "10.138.0.2", "time_total_s": 923.6973769664764, "num_metric_batches_dropped": 0, "date": "2019-05-06_03-02-21", "done": false, "timesteps_total": 1772116, "timesteps_this_iter": 39516, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8748>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8160>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac84e0>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 43, "training_iteration": 43, "policy_reward_mean": {}, "time_since_restore": 923.6973769664764, "episode_len_mean": 693.32}
{"info": {"sample_time_ms": 11123.383, "load_time_ms": 15.951, "update_time_ms": 6.924, "grad_time_ms": 10092.081, "default": {"kl": 0.016984272748231888, "cur_lr": 0.0005000000237487257, "total_loss": 13.8033447265625, "entropy": 1.1741756200790405, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 13.808441162109375, "policy_loss": -0.005946715362370014, "vf_explained_var": 0.9168175458908081}, "num_steps_trained": 1812197, "num_steps_sampled": 1812197}, "custom_metrics": {"cost1_min": 21.03559826323536, "system_level_velocity_min": 8.815039285997386, "outflow_rate_min": 498.40178486676893, "cost1_mean": 318.38425021738084, "cost2_max": 0.0, "cost2_mean": -0.06362229087863348, "cost2_min": -0.5, "system_level_velocity_mean": 12.345143922965338, "outflow_rate_max": 1226.5255556460718, "cost1_max": 387.5084158573894, "outflow_rate_mean": 1055.027021629986, "system_level_velocity_max": 18.860657567311403}, "episodes_total": 711, "episode_reward_max": 1008.2923518717653, "timestamp": 1557111762, "episode_reward_mean": 842.3836999100141, "episodes_this_iter": 19, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 21.1157968044281, "timesteps_since_restore": 1812197, "episode_reward_min": 51.82773284841394, "node_ip": "10.138.0.2", "time_total_s": 944.8131737709045, "num_metric_batches_dropped": 0, "date": "2019-05-06_03-02-42", "done": false, "timesteps_total": 1812197, "timesteps_this_iter": 40081, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1e10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac11d0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1ba8>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 44, "training_iteration": 44, "policy_reward_mean": {}, "time_since_restore": 944.8131737709045, "episode_len_mean": 693.32}
{"info": {"sample_time_ms": 11206.127, "load_time_ms": 15.636, "update_time_ms": 6.843, "grad_time_ms": 10134.227, "default": {"kl": 0.01408904418349266, "cur_lr": 0.0005000000237487257, "total_loss": 13.360373497009277, "entropy": 1.1732308864593506, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 13.362919807434082, "policy_loss": -0.0032517416402697563, "vf_explained_var": 0.9161596894264221}, "num_steps_trained": 1852750, "num_steps_sampled": 1852750}, "custom_metrics": {"cost1_min": 227.0934132055494, "system_level_velocity_min": 8.815039285997386, "outflow_rate_min": 892.3745823486704, "cost1_mean": 325.57413223380064, "cost2_max": 0.0, "cost2_mean": -0.06567308183557424, "cost2_min": -0.5, "system_level_velocity_mean": 12.444676745150245, "outflow_rate_max": 1236.2020986174587, "cost1_max": 409.48369813163424, "outflow_rate_mean": 1070.4565766324604, "system_level_velocity_max": 15.5094192063962}, "episodes_total": 728, "episode_reward_max": 1008.2923518717653, "timestamp": 1557111785, "episode_reward_mean": 855.5600617651316, "episodes_this_iter": 17, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 22.255091428756714, "timesteps_since_restore": 1852750, "episode_reward_min": 677.939011741575, "node_ip": "10.138.0.2", "time_total_s": 967.0682651996613, "num_metric_batches_dropped": 0, "date": "2019-05-06_03-03-05", "done": false, "timesteps_total": 1852750, "timesteps_this_iter": 40553, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8d68>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac80f0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8470>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 45, "training_iteration": 45, "policy_reward_mean": {}, "time_since_restore": 967.0682651996613, "episode_len_mean": 700.0}
{"info": {"sample_time_ms": 11119.915, "load_time_ms": 15.423, "update_time_ms": 6.93, "grad_time_ms": 10153.748, "default": {"kl": 0.014253286644816399, "cur_lr": 0.0005000000237487257, "total_loss": 12.931212425231934, "entropy": 1.1846039295196533, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 12.934807777404785, "policy_loss": -0.004310086835175753, "vf_explained_var": 0.9057324528694153}, "num_steps_trained": 1892560, "num_steps_sampled": 1892560}, "custom_metrics": {"cost1_min": 254.7474852200558, "system_level_velocity_min": 9.839773905394887, "outflow_rate_min": 915.156924733262, "cost1_mean": 323.3699007671021, "cost2_max": 0.0, "cost2_mean": -0.07071441718544809, "cost2_min": -0.6844058916424947, "system_level_velocity_mean": 12.38438435338832, "outflow_rate_max": 1236.2020986174587, "cost1_max": 409.48369813163424, "outflow_rate_mean": 1068.0616295215616, "system_level_velocity_max": 15.5094192063962}, "episodes_total": 743, "episode_reward_max": 1008.2923518717653, "timestamp": 1557111806, "episode_reward_mean": 857.1936695276512, "episodes_this_iter": 15, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 21.573096752166748, "timesteps_since_restore": 1892560, "episode_reward_min": 677.939011741575, "node_ip": "10.138.0.2", "time_total_s": 988.641361951828, "num_metric_batches_dropped": 0, "date": "2019-05-06_03-03-26", "done": false, "timesteps_total": 1892560, "timesteps_this_iter": 39810, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ace8d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ace2e8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ace4a8>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 46, "training_iteration": 46, "policy_reward_mean": {}, "time_since_restore": 988.641361951828, "episode_len_mean": 700.0}
{"info": {"sample_time_ms": 11163.21, "load_time_ms": 15.122, "update_time_ms": 7.018, "grad_time_ms": 10173.513, "default": {"kl": 0.01638362742960453, "cur_lr": 0.0005000000237487257, "total_loss": 13.56494426727295, "entropy": 1.195189356803894, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 13.569624900817871, "policy_loss": -0.0055007473565638065, "vf_explained_var": 0.9206340909004211}, "num_steps_trained": 1932766, "num_steps_sampled": 1932766}, "custom_metrics": {"cost1_min": 226.39235058717577, "system_level_velocity_min": 8.872984941015977, "outflow_rate_min": 877.0444975653883, "cost1_mean": 319.6894303546897, "cost2_max": 0.0, "cost2_mean": -0.07039655686047548, "cost2_min": -0.6844058916424947, "system_level_velocity_mean": 12.265605063182557, "outflow_rate_max": 1236.2020986174587, "cost1_max": 409.48369813163424, "outflow_rate_mean": 1061.6674707980144, "system_level_velocity_max": 15.5094192063962}, "episodes_total": 760, "episode_reward_max": 1039.790508315689, "timestamp": 1557111828, "episode_reward_mean": 852.7950244601492, "episodes_this_iter": 17, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 21.975135326385498, "timesteps_since_restore": 1932766, "episode_reward_min": 658.8530562081096, "node_ip": "10.138.0.2", "time_total_s": 1010.6164972782135, "num_metric_batches_dropped": 0, "date": "2019-05-06_03-03-48", "done": false, "timesteps_total": 1932766, "timesteps_this_iter": 40206, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1668>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1c50>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1470>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 47, "training_iteration": 47, "policy_reward_mean": {}, "time_since_restore": 1010.6164972782135, "episode_len_mean": 700.0}
{"info": {"sample_time_ms": 11192.961, "load_time_ms": 15.588, "update_time_ms": 6.977, "grad_time_ms": 10214.461, "default": {"kl": 0.012964410707354546, "cur_lr": 0.0005000000237487257, "total_loss": 13.942949295043945, "entropy": 1.1547592878341675, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 13.945971488952637, "policy_loss": -0.0036706840619444847, "vf_explained_var": 0.9159137606620789}, "num_steps_trained": 1973349, "num_steps_sampled": 1973349}, "custom_metrics": {"cost1_min": 226.39235058717577, "system_level_velocity_min": 8.872984941015977, "outflow_rate_min": 877.0444975653883, "cost1_mean": 325.42070665145906, "cost2_max": 0.0, "cost2_mean": -0.07372703587564344, "cost2_min": -0.6844058916424947, "system_level_velocity_mean": 12.47423768963879, "outflow_rate_max": 1287.2741636163375, "cost1_max": 451.26826163494724, "outflow_rate_mean": 1074.1222907189474, "system_level_velocity_max": 17.0510926297714}, "episodes_total": 775, "episode_reward_max": 1039.790508315689, "timestamp": 1557111850, "episode_reward_mean": 858.2005339708936, "episodes_this_iter": 15, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 21.759238719940186, "timesteps_since_restore": 1973349, "episode_reward_min": 658.8530562081096, "node_ip": "10.138.0.2", "time_total_s": 1032.3757359981537, "num_metric_batches_dropped": 0, "date": "2019-05-06_03-04-10", "done": false, "timesteps_total": 1973349, "timesteps_this_iter": 40583, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8ef0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac87b8>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 48, "training_iteration": 48, "policy_reward_mean": {}, "time_since_restore": 1032.3757359981537, "episode_len_mean": 700.0}
{"info": {"sample_time_ms": 11194.243, "load_time_ms": 15.871, "update_time_ms": 7.006, "grad_time_ms": 10275.606, "default": {"kl": 0.012443075887858868, "cur_lr": 0.0005000000237487257, "total_loss": 13.77012825012207, "entropy": 1.178022861480713, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 13.772614479064941, "policy_loss": -0.0031056918669492006, "vf_explained_var": 0.9282875061035156}, "num_steps_trained": 2014276, "num_steps_sampled": 2014276}, "custom_metrics": {"cost1_min": 226.39235058717577, "system_level_velocity_min": 8.872984941015977, "outflow_rate_min": 877.0444975653883, "cost1_mean": 324.5875371980066, "cost2_max": 0.0, "cost2_mean": -0.072873167768753, "cost2_min": -0.6844058916424947, "system_level_velocity_mean": 12.454721225379322, "outflow_rate_max": 1287.2741636163375, "cost1_max": 451.26826163494724, "outflow_rate_mean": 1075.2385440793555, "system_level_velocity_max": 17.0510926297714}, "episodes_total": 791, "episode_reward_max": 1039.790508315689, "timestamp": 1557111872, "episode_reward_mean": 858.4436933243712, "episodes_this_iter": 16, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 21.834883213043213, "timesteps_since_restore": 2014276, "episode_reward_min": 658.8530562081096, "node_ip": "10.138.0.2", "time_total_s": 1054.210619211197, "num_metric_batches_dropped": 0, "date": "2019-05-06_03-04-32", "done": false, "timesteps_total": 2014276, "timesteps_this_iter": 40927, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac16a0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1c50>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ace7f0>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 49, "training_iteration": 49, "policy_reward_mean": {}, "time_since_restore": 1054.210619211197, "episode_len_mean": 700.0}
{"info": {"sample_time_ms": 11087.795, "load_time_ms": 14.658, "update_time_ms": 7.113, "grad_time_ms": 10153.014, "default": {"kl": 0.013728927820920944, "cur_lr": 0.0005000000237487257, "total_loss": 13.334480285644531, "entropy": 1.1685625314712524, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 13.337979316711426, "policy_loss": -0.00418337294831872, "vf_explained_var": 0.9329378604888916}, "num_steps_trained": 2054460, "num_steps_sampled": 2054460}, "custom_metrics": {"cost1_min": 226.39235058717577, "system_level_velocity_min": 8.872984941015977, "outflow_rate_min": 877.0444975653883, "cost1_mean": 322.761719970013, "cost2_max": 0.0, "cost2_mean": -0.07920665920395237, "cost2_min": -0.6844058916424947, "system_level_velocity_mean": 12.396375734295937, "outflow_rate_max": 1315.809611346283, "cost1_max": 451.26826163494724, "outflow_rate_mean": 1072.9135317635698, "system_level_velocity_max": 17.0510926297714}, "episodes_total": 809, "episode_reward_max": 1039.790508315689, "timestamp": 1557111892, "episode_reward_mean": 858.4227161240404, "episodes_this_iter": 18, "experiment_id": "41f38833e0d2489fba39f8833aee9a1a", "time_this_iter_s": 20.17082381248474, "timesteps_since_restore": 2054460, "episode_reward_min": 658.8530562081096, "node_ip": "10.138.0.2", "time_total_s": 1074.3814430236816, "num_metric_batches_dropped": 0, "date": "2019-05-06_03-04-52", "done": true, "timesteps_total": 2054460, "timesteps_this_iter": 40184, "hostname": "flow-main", "pid": 13200, "config": {"use_gae": true, "vf_loss_coeff": 1.0, "optimizer": {}, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "output_compress_columns": ["obs", "new_obs"], "straggler_mitigation": false, "batch_mode": "truncate_episodes", "kl_coeff": 0.2, "clip_param": 0.3, "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "framestack": true, "conv_filters": null, "grayscale": false, "custom_options": {}, "use_lstm": false, "fcnet_hiddens": [100, 50, 25]}, "sample_async": false, "output_max_file_size": 67108864, "input": "sampler", "num_cpus_for_driver": 1, "train_batch_size": 30000, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "vf_share_layers": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_gpus": 0, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "input_evaluation": null, "vf_clip_param": 1000000.0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4519828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4519d68>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4519b00>"}, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "iterations_since_restore": 50, "training_iteration": 50, "policy_reward_mean": {}, "time_since_restore": 1074.3814430236816, "episode_len_mean": 700.0}

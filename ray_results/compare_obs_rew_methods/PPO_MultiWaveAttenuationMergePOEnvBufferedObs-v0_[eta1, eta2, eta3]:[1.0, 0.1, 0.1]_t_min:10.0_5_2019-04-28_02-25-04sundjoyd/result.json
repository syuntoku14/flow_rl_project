{"policy_reward_mean": {}, "time_this_iter_s": 69.05825972557068, "episode_reward_max": 468.6758582585809, "episodes_this_iter": 41, "episode_reward_mean": 330.79813259765007, "timesteps_total": 114047, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 114047, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 114047, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ab08d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ab09e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ab0668>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 1, "done": false, "info": {"update_time_ms": 2619.047, "default": {"entropy": 1.4147518873214722, "vf_explained_var": 0.8900800943374634, "cur_kl_coeff": 0.20000003278255463, "policy_loss": -0.0004533546743914485, "cur_lr": 0.0005000000237487257, "total_loss": 1.4107471704483032, "kl": 0.0010215569054707885, "vf_loss": 1.4109960794448853}, "num_steps_sampled": 114047, "load_time_ms": 60.68, "num_steps_trained": 114047, "sample_time_ms": 41330.845, "grad_time_ms": 24786.691}, "training_iteration": 1, "date": "2019-04-28_02-26-32", "episodes_total": 41, "timestamp": 1556418392, "time_total_s": 69.05825972557068, "episode_len_mean": 700.0, "episode_reward_min": 192.40500809537545, "time_since_restore": 69.05825972557068, "custom_metrics": {"cost2_max": -31.26396531489502, "system_level_velocity_mean": 7.78005253047703, "cost1_max": 259.1779322168784, "cost1_min": 163.40242960383688, "outflow_rate_max": 788.102996648367, "cost1_mean": 200.9602586095176, "outflow_rate_min": 551.5147310147903, "cost2_min": -79.44176883817055, "system_level_velocity_max": 10.041140742765865, "outflow_rate_mean": 621.4412395975869, "system_level_velocity_min": 6.380862127810603, "cost2_mean": -52.00275620756216}}
{"policy_reward_mean": {}, "time_this_iter_s": 42.2333550453186, "episode_reward_max": 581.987192581643, "episodes_this_iter": 60, "episode_reward_mean": 345.94371345980403, "timesteps_total": 232592, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 232592, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 118545, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77780>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ee48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e978>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 2, "done": false, "info": {"update_time_ms": 1315.493, "default": {"entropy": 1.412442684173584, "vf_explained_var": 0.8809385299682617, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.004172763787209988, "cur_lr": 0.0005000000237487257, "total_loss": 1.3302639722824097, "kl": 0.008978170342743397, "vf_loss": 1.3335391283035278}, "num_steps_sampled": 232592, "load_time_ms": 41.961, "num_steps_trained": 232592, "sample_time_ms": 28490.697, "grad_time_ms": 25559.415}, "training_iteration": 2, "date": "2019-04-28_02-27-15", "episodes_total": 101, "timestamp": 1556418435, "time_total_s": 111.29161477088928, "episode_len_mean": 700.0, "episode_reward_min": 192.40500809537545, "time_since_restore": 111.29161477088928, "custom_metrics": {"cost2_max": -31.26396531489502, "system_level_velocity_mean": 7.782308606313297, "cost1_max": 259.1779322168784, "cost1_min": 151.2190579962915, "outflow_rate_max": 820.5918580066726, "cost1_mean": 201.27672921356697, "outflow_rate_min": 430.06453429904394, "cost2_min": -85.99484228424343, "system_level_velocity_max": 10.041140742765865, "outflow_rate_mean": 613.9682876610464, "system_level_velocity_min": 5.843434845357141, "cost2_mean": -53.27911949432291}}
{"policy_reward_mean": {}, "time_this_iter_s": 40.34982681274414, "episode_reward_max": 713.6941117552262, "episodes_this_iter": 29, "episode_reward_mean": 415.5512478632946, "timesteps_total": 356868, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 356868, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 124276, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e9e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e7f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e080>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 3, "done": false, "info": {"update_time_ms": 881.343, "default": {"entropy": 1.4006279706954956, "vf_explained_var": 0.8577334880828857, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.002993745496496558, "cur_lr": 0.0005000000237487257, "total_loss": 5.933186054229736, "kl": 0.0063437363132834435, "vf_loss": 5.935545444488525}, "num_steps_sampled": 356868, "load_time_ms": 36.032, "num_steps_trained": 356868, "sample_time_ms": 24058.105, "grad_time_ms": 25343.801}, "training_iteration": 3, "date": "2019-04-28_02-27-55", "episodes_total": 130, "timestamp": 1556418475, "time_total_s": 151.64144158363342, "episode_len_mean": 700.0, "episode_reward_min": 192.40500809537545, "time_since_restore": 151.64144158363342, "custom_metrics": {"cost2_max": -31.6183003351377, "system_level_velocity_mean": 8.391707262087273, "cost1_max": 319.24931124510636, "cost1_min": 151.2190579962915, "outflow_rate_max": 979.9454626742231, "cost1_mean": 217.70894841909842, "outflow_rate_min": 430.06453429904394, "cost2_min": -115.82706923032879, "system_level_velocity_max": 12.274427524760753, "outflow_rate_mean": 658.3388312976344, "system_level_velocity_min": 5.843434845357141, "cost2_mean": -60.28123533874896}}
{"policy_reward_mean": {}, "time_this_iter_s": 41.35106325149536, "episode_reward_max": 990.614095370451, "episodes_this_iter": 50, "episode_reward_mean": 597.111051501168, "timesteps_total": 480237, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 480237, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 123369, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e5c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e470>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 4, "done": false, "info": {"update_time_ms": 663.615, "default": {"entropy": 1.4037829637527466, "vf_explained_var": 0.8590937256813049, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.001549863605760038, "cur_lr": 0.0005000000237487257, "total_loss": 7.7971343994140625, "kl": 0.003565066959708929, "vf_loss": 7.798328399658203}, "num_steps_sampled": 480237, "load_time_ms": 30.85, "num_steps_trained": 480237, "sample_time_ms": 22001.849, "grad_time_ms": 25328.673}, "training_iteration": 4, "date": "2019-04-28_02-28-36", "episodes_total": 180, "timestamp": 1556418516, "time_total_s": 192.99250483512878, "episode_len_mean": 693.27, "episode_reward_min": 37.85493669873974, "time_since_restore": 192.99250483512878, "custom_metrics": {"cost2_max": -17.864203668198687, "system_level_velocity_mean": 9.98899749205571, "cost1_max": 355.5285742328419, "cost1_min": 17.77625827849206, "outflow_rate_max": 1079.9122582566392, "cost1_mean": 257.69179041766915, "outflow_rate_min": 464.1057421303347, "cost2_min": -136.07231685182046, "system_level_velocity_max": 17.687686258032848, "outflow_rate_mean": 807.3710424425137, "system_level_velocity_min": 5.843434845357141, "cost2_mean": -87.00466535539341}}
{"policy_reward_mean": {}, "time_this_iter_s": 40.385666370391846, "episode_reward_max": 990.614095370451, "episodes_this_iter": 49, "episode_reward_mean": 775.480771729939, "timesteps_total": 601063, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 601063, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 120826, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e630>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e4a8>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 5, "done": false, "info": {"update_time_ms": 533.083, "default": {"entropy": 1.3891009092330933, "vf_explained_var": 0.8341416716575623, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0006743608391843736, "cur_lr": 0.0005000000237487257, "total_loss": 9.533321380615234, "kl": 0.0036519416607916355, "vf_loss": 9.533812522888184}, "num_steps_sampled": 601063, "load_time_ms": 28.114, "num_steps_trained": 601063, "sample_time_ms": 20461.177, "grad_time_ms": 25430.986}, "training_iteration": 5, "date": "2019-04-28_02-29-17", "episodes_total": 229, "timestamp": 1556418557, "time_total_s": 233.37817120552063, "episode_len_mean": 693.27, "episode_reward_min": 37.85493669873974, "time_since_restore": 233.37817120552063, "custom_metrics": {"cost2_max": -17.864203668198687, "system_level_velocity_mean": 11.230969551495201, "cost1_max": 361.79651250238106, "cost1_min": 17.77625827849206, "outflow_rate_max": 1119.0992699672295, "cost1_mean": 293.23861724020486, "outflow_rate_min": 489.92492200470633, "cost2_min": -140.90543274268106, "system_level_velocity_max": 17.687686258032848, "outflow_rate_mean": 943.9823134576083, "system_level_velocity_min": 8.390211942287086, "cost2_mean": -112.63371325370288}}
{"policy_reward_mean": {}, "time_this_iter_s": 39.35853934288025, "episode_reward_max": 952.7242725203037, "episodes_this_iter": 54, "episode_reward_mean": 838.4631037296374, "timesteps_total": 719357, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 719357, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 118294, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e5f8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ee80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ed30>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 6, "done": false, "info": {"update_time_ms": 446.247, "default": {"entropy": 1.3796964883804321, "vf_explained_var": 0.8236820697784424, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0006051029195077717, "cur_lr": 0.0005000000237487257, "total_loss": 10.346673965454102, "kl": 0.004241905175149441, "vf_loss": 10.347174644470215}, "num_steps_sampled": 719357, "load_time_ms": 27.006, "num_steps_trained": 719357, "sample_time_ms": 19488.883, "grad_time_ms": 25275.308}, "training_iteration": 6, "date": "2019-04-28_02-29-56", "episodes_total": 283, "timestamp": 1556418596, "time_total_s": 272.7367105484009, "episode_len_mean": 700.0, "episode_reward_min": 659.7974657629196, "time_since_restore": 272.7367105484009, "custom_metrics": {"cost2_max": -93.15283954862281, "system_level_velocity_mean": 11.509356429844816, "cost1_max": 361.79651250238106, "cost1_min": 227.77208303194047, "outflow_rate_max": 1119.0992699672295, "cost1_mean": 306.58088639095286, "outflow_rate_min": 796.489535905154, "cost2_min": -161.29319090460547, "system_level_velocity_max": 13.598449344658636, "outflow_rate_mean": 985.5408134036428, "system_level_velocity_min": 8.726949401467934, "cost2_mean": -119.92270036477287}}
{"policy_reward_mean": {}, "time_this_iter_s": 40.36074137687683, "episode_reward_max": 952.7242725203037, "episodes_this_iter": 60, "episode_reward_mean": 848.306771245296, "timesteps_total": 838198, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 838198, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 118841, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ef28>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a68358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a685c0>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 7, "done": false, "info": {"update_time_ms": 384.047, "default": {"entropy": 1.3716397285461426, "vf_explained_var": 0.8009499907493591, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0009060620213858783, "cur_lr": 0.0005000000237487257, "total_loss": 11.911574363708496, "kl": 0.004878797102719545, "vf_loss": 11.912421226501465}, "num_steps_sampled": 838198, "load_time_ms": 28.283, "num_steps_trained": 838198, "sample_time_ms": 18810.607, "grad_time_ms": 25283.628}, "training_iteration": 7, "date": "2019-04-28_02-30-36", "episodes_total": 343, "timestamp": 1556418636, "time_total_s": 313.0974519252777, "episode_len_mean": 700.0, "episode_reward_min": 715.9525058157822, "time_since_restore": 313.0974519252777, "custom_metrics": {"cost2_max": -90.31496927417976, "system_level_velocity_mean": 11.49348507066479, "cost1_max": 357.92316777970893, "cost1_min": 243.43644324804032, "outflow_rate_max": 1079.7929422895052, "cost1_mean": 306.6932768927321, "outflow_rate_min": 838.8909066683501, "cost2_min": -156.50048433459287, "system_level_velocity_max": 13.49265137024323, "outflow_rate_mean": 984.7493929421107, "system_level_velocity_min": 9.248320430641664, "cost2_mean": -120.3731987695999}}
{"policy_reward_mean": {}, "time_this_iter_s": 40.82834243774414, "episode_reward_max": 951.7788043239414, "episodes_this_iter": 45, "episode_reward_mean": 848.5296564553736, "timesteps_total": 961261, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 961261, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 123063, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e278>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e4e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e7b8>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 8, "done": false, "info": {"update_time_ms": 337.514, "default": {"entropy": 1.3668107986450195, "vf_explained_var": 0.8036966919898987, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0009989874670282006, "cur_lr": 0.0005000000237487257, "total_loss": 12.332481384277344, "kl": 0.006298402789980173, "vf_loss": 12.333440780639648}, "num_steps_sampled": 961261, "load_time_ms": 27.615, "num_steps_trained": 961261, "sample_time_ms": 18335.123, "grad_time_ms": 25316.139}, "training_iteration": 8, "date": "2019-04-28_02-31-17", "episodes_total": 388, "timestamp": 1556418677, "time_total_s": 353.92579436302185, "episode_len_mean": 693.27, "episode_reward_min": 39.909001533951404, "time_since_restore": 353.92579436302185, "custom_metrics": {"cost2_max": -19.294143890149556, "system_level_velocity_mean": 11.590778634211198, "cost1_max": 351.81639019091966, "cost1_min": 17.479648157118916, "outflow_rate_max": 1063.0659607041496, "cost1_mean": 305.24957387333774, "outflow_rate_min": 445.6108305202122, "cost2_min": -159.66486385291853, "system_level_velocity_max": 16.715960001707153, "outflow_rate_mean": 983.384761181707, "system_level_velocity_min": 9.248320430641664, "cost2_mean": -121.66724265492721}}
{"policy_reward_mean": {}, "time_this_iter_s": 39.560349225997925, "episode_reward_max": 951.7788043239414, "episodes_this_iter": 54, "episode_reward_mean": 833.021345631571, "timesteps_total": 1087095, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 1087095, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 125834, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ecf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ec50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e940>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 9, "done": false, "info": {"update_time_ms": 301.253, "default": {"entropy": 1.3613611459732056, "vf_explained_var": 0.7748156785964966, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0008555334061384201, "cur_lr": 0.0005000000237487257, "total_loss": 11.615711212158203, "kl": 0.005887829232960939, "vf_loss": 11.61652946472168}, "num_steps_sampled": 1087095, "load_time_ms": 27.019, "num_steps_trained": 1087095, "sample_time_ms": 18024.434, "grad_time_ms": 25140.358}, "training_iteration": 9, "date": "2019-04-28_02-31-57", "episodes_total": 442, "timestamp": 1556418717, "time_total_s": 393.4861435890198, "episode_len_mean": 686.64, "episode_reward_min": 39.909001533951404, "time_since_restore": 393.4861435890198, "custom_metrics": {"cost2_max": -19.294143890149556, "system_level_velocity_mean": 11.457128186143823, "cost1_max": 351.81639019091966, "cost1_min": 17.479648157118916, "outflow_rate_max": 1063.0659607041496, "cost1_mean": 297.28442761919734, "outflow_rate_min": 445.6108305202122, "cost2_min": -163.89250624921644, "system_level_velocity_max": 18.26587261800364, "outflow_rate_mean": 974.3879300390967, "system_level_velocity_min": 7.807264668742231, "cost2_mean": -128.31261996218527}}
{"policy_reward_mean": {}, "time_this_iter_s": 41.37487816810608, "episode_reward_max": 969.9171409036269, "episodes_this_iter": 35, "episode_reward_mean": 827.6454963463533, "timesteps_total": 1211175, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 1211175, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 124080, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77b70>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77710>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 10, "done": false, "info": {"update_time_ms": 272.239, "default": {"entropy": 1.3475590944290161, "vf_explained_var": 0.8044654130935669, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.001735420897603035, "cur_lr": 0.0005000000237487257, "total_loss": 9.382319450378418, "kl": 0.007964737713336945, "vf_loss": 9.384005546569824}, "num_steps_sampled": 1211175, "load_time_ms": 26.747, "num_steps_trained": 1211175, "sample_time_ms": 17763.019, "grad_time_ms": 25194.758}, "training_iteration": 10, "date": "2019-04-28_02-32-38", "episodes_total": 477, "timestamp": 1556418758, "time_total_s": 434.86102175712585, "episode_len_mean": 686.64, "episode_reward_min": 39.909001533951404, "time_since_restore": 434.86102175712585, "custom_metrics": {"cost2_max": -19.294143890149556, "system_level_velocity_mean": 11.287229306506317, "cost1_max": 351.81639019091966, "cost1_min": 17.479648157118916, "outflow_rate_max": 1063.0659607041496, "cost1_mean": 292.9273850308354, "outflow_rate_min": 445.6108305202122, "cost2_min": -163.89250624921644, "system_level_velocity_max": 18.26587261800364, "outflow_rate_mean": 967.3165551287144, "system_level_velocity_min": 7.807264668742231, "cost2_mean": -131.19106654137047}}
{"policy_reward_mean": {}, "time_this_iter_s": 41.237669944763184, "episode_reward_max": 969.9171409036269, "episodes_this_iter": 52, "episode_reward_mean": 823.6256182040113, "timesteps_total": 1333399, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 1333399, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 122224, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e0f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e9b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ef28>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 11, "done": false, "info": {"update_time_ms": 11.426, "default": {"entropy": 1.3442866802215576, "vf_explained_var": 0.7613945007324219, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0007151915342546999, "cur_lr": 0.0005000000237487257, "total_loss": 12.119860649108887, "kl": 0.005697599146515131, "vf_loss": 12.120539665222168}, "num_steps_sampled": 1333399, "load_time_ms": 23.312, "num_steps_trained": 1333399, "sample_time_ms": 15108.111, "grad_time_ms": 25331.608}, "training_iteration": 11, "date": "2019-04-28_02-33-20", "episodes_total": 529, "timestamp": 1556418800, "time_total_s": 476.09869170188904, "episode_len_mean": 686.74, "episode_reward_min": 51.90802471144287, "time_since_restore": 476.09869170188904, "custom_metrics": {"cost2_max": -20.56751399483661, "system_level_velocity_mean": 11.0953020398208, "cost1_max": 337.23604399958293, "cost1_min": 23.659818021998113, "outflow_rate_max": 1058.9840044252103, "cost1_mean": 287.80062108331293, "outflow_rate_min": 503.20159799185285, "cost2_min": -181.29506414512932, "system_level_velocity_max": 18.26587261800364, "outflow_rate_mean": 957.184318465031, "system_level_velocity_min": 7.807264668742231, "cost2_mean": -135.585836170888}}
{"policy_reward_mean": {}, "time_this_iter_s": 42.6067578792572, "episode_reward_max": 987.2526801166658, "episodes_this_iter": 58, "episode_reward_mean": 844.6655682161294, "timesteps_total": 1456089, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 1456089, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 122690, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7efd0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a779b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a774e0>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 12, "done": false, "info": {"update_time_ms": 11.411, "default": {"entropy": 1.3397624492645264, "vf_explained_var": 0.7371264100074768, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0005702673806808889, "cur_lr": 0.0005000000237487257, "total_loss": 14.574091911315918, "kl": 0.006049029994755983, "vf_loss": 14.574625015258789}, "num_steps_sampled": 1456089, "load_time_ms": 23.73, "num_steps_trained": 1456089, "sample_time_ms": 15070.484, "grad_time_ms": 25405.347}, "training_iteration": 12, "date": "2019-04-28_02-34-02", "episodes_total": 587, "timestamp": 1556418842, "time_total_s": 518.7054495811462, "episode_len_mean": 693.35, "episode_reward_min": 49.282964392083656, "time_since_restore": 518.7054495811462, "custom_metrics": {"cost2_max": -21.139620103893183, "system_level_velocity_mean": 11.139103630728162, "cost1_max": 337.09467452469073, "cost1_min": 22.68218337898306, "outflow_rate_max": 1080.7446413695297, "cost1_mean": 293.8893942960021, "outflow_rate_min": 486.33929757591704, "cost2_min": -181.29506414512932, "system_level_velocity_max": 18.14189683845227, "outflow_rate_mean": 971.784769647432, "system_level_velocity_min": 9.31867519837042, "cost2_mean": -144.76865058202105}}
{"policy_reward_mean": {}, "time_this_iter_s": 42.49877715110779, "episode_reward_max": 987.2526801166658, "episodes_this_iter": 42, "episode_reward_mean": 856.6163759740687, "timesteps_total": 1578559, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 1578559, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 122470, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75438>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a753c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75e10>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 13, "done": false, "info": {"update_time_ms": 11.132, "default": {"entropy": 1.326509952545166, "vf_explained_var": 0.7766303420066833, "cur_kl_coeff": 0.006250001490116119, "policy_loss": -0.0008917138329707086, "cur_lr": 0.0005000000237487257, "total_loss": 11.950222969055176, "kl": 0.0065598092041909695, "vf_loss": 11.95107364654541}, "num_steps_sampled": 1578559, "load_time_ms": 24.194, "num_steps_trained": 1578559, "sample_time_ms": 15018.275, "grad_time_ms": 25667.506}, "training_iteration": 13, "date": "2019-04-28_02-34-45", "episodes_total": 629, "timestamp": 1556418885, "time_total_s": 561.204226732254, "episode_len_mean": 693.35, "episode_reward_min": 49.282964392083656, "time_since_restore": 561.204226732254, "custom_metrics": {"cost2_max": -21.139620103893183, "system_level_velocity_mean": 11.342953978245387, "cost1_max": 341.79406211012684, "cost1_min": 22.68218337898306, "outflow_rate_max": 1084.7403107926925, "cost1_mean": 299.54699653494663, "outflow_rate_min": 486.33929757591704, "cost2_min": -178.84018032453014, "system_level_velocity_max": 18.14189683845227, "outflow_rate_mean": 992.277520184427, "system_level_velocity_min": 9.796153472772156, "cost2_mean": -150.75844676028822}}
{"policy_reward_mean": {}, "time_this_iter_s": 42.31919002532959, "episode_reward_max": 983.7412376541597, "episodes_this_iter": 55, "episode_reward_mean": 861.4062888204083, "timesteps_total": 1703566, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 1703566, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 125007, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77dd8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a773c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77588>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 14, "done": false, "info": {"update_time_ms": 11.293, "default": {"entropy": 1.31548273563385, "vf_explained_var": 0.7249726057052612, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0011063911952078342, "cur_lr": 0.0005000000237487257, "total_loss": 14.300920486450195, "kl": 0.00636419327929616, "vf_loss": 14.301986694335938}, "num_steps_sampled": 1703566, "load_time_ms": 25.109, "num_steps_trained": 1703566, "sample_time_ms": 14961.923, "grad_time_ms": 25816.863}, "training_iteration": 14, "date": "2019-04-28_02-35-27", "episodes_total": 684, "timestamp": 1556418927, "time_total_s": 603.5234167575836, "episode_len_mean": 693.35, "episode_reward_min": 49.282964392083656, "time_since_restore": 603.5234167575836, "custom_metrics": {"cost2_max": -21.139620103893183, "system_level_velocity_mean": 11.465709329641111, "cost1_max": 341.79406211012684, "cost1_min": 22.68218337898306, "outflow_rate_max": 1092.746843634832, "cost1_mean": 302.3406930432923, "outflow_rate_min": 486.33929757591704, "cost2_min": -202.36482224798567, "system_level_velocity_max": 18.14189683845227, "outflow_rate_mean": 1011.4778026038801, "system_level_velocity_min": 9.542810827358647, "cost2_mean": -157.7424629569872}}
{"policy_reward_mean": {}, "time_this_iter_s": 41.407880544662476, "episode_reward_max": 983.7412376541597, "episodes_this_iter": 36, "episode_reward_mean": 874.006799670685, "timesteps_total": 1829608, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 1829608, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 126042, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e0f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ef28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ecc0>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 15, "done": false, "info": {"update_time_ms": 11.33, "default": {"entropy": 1.3060917854309082, "vf_explained_var": 0.7877100706100464, "cur_kl_coeff": 0.006250000558793545, "policy_loss": -0.0017826976254582405, "cur_lr": 0.0005000000237487257, "total_loss": 10.699518203735352, "kl": 0.008121825754642487, "vf_loss": 10.701250076293945}, "num_steps_sampled": 1829608, "load_time_ms": 25.645, "num_steps_trained": 1829608, "sample_time_ms": 14987.082, "grad_time_ms": 25890.392}, "training_iteration": 15, "date": "2019-04-28_02-36-09", "episodes_total": 720, "timestamp": 1556418969, "time_total_s": 644.9312973022461, "episode_len_mean": 700.0, "episode_reward_min": 747.6590590942309, "time_since_restore": 644.9312973022461, "custom_metrics": {"cost2_max": -136.09764824788073, "system_level_velocity_mean": 11.466460148514686, "cost1_max": 341.8561597082783, "cost1_min": 254.65678420165835, "outflow_rate_max": 1107.8689311738074, "cost1_mean": 307.0674767777218, "outflow_rate_min": 872.7202545272356, "cost2_min": -202.36482224798567, "system_level_velocity_max": 12.69459441767808, "outflow_rate_mean": 1028.0658243952726, "system_level_velocity_min": 9.542810827358647, "cost2_mean": -164.8207508198805}}
{"policy_reward_mean": {}, "time_this_iter_s": 40.50667214393616, "episode_reward_max": 980.2624002161514, "episodes_this_iter": 53, "episode_reward_mean": 871.7050161975887, "timesteps_total": 1953764, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 1953764, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 124156, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a774e0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a778d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77828>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 16, "done": false, "info": {"update_time_ms": 11.226, "default": {"entropy": 1.2961241006851196, "vf_explained_var": 0.758961021900177, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0006432055379264057, "cur_lr": 0.0005000000237487257, "total_loss": 14.79133415222168, "kl": 0.006402900442481041, "vf_loss": 14.791937828063965}, "num_steps_sampled": 1953764, "load_time_ms": 25.943, "num_steps_trained": 1953764, "sample_time_ms": 14998.228, "grad_time_ms": 25988.227}, "training_iteration": 16, "date": "2019-04-28_02-36-49", "episodes_total": 773, "timestamp": 1556419009, "time_total_s": 685.4379694461823, "episode_len_mean": 700.0, "episode_reward_min": 754.0222461292739, "time_since_restore": 685.4379694461823, "custom_metrics": {"cost2_max": -142.5109784958276, "system_level_velocity_mean": 11.497582162940992, "cost1_max": 341.8561597082783, "cost1_min": 261.3356796713208, "outflow_rate_max": 1107.8689311738074, "cost1_mean": 307.90927111184556, "outflow_rate_min": 914.8160974645086, "cost2_min": -213.34497945638026, "system_level_velocity_max": 12.69459441767808, "outflow_rate_mean": 1032.908682710518, "system_level_velocity_min": 9.881320115881163, "cost2_mean": -169.3567118941811}}
{"policy_reward_mean": {}, "time_this_iter_s": 42.40039944648743, "episode_reward_max": 975.2048859775745, "episodes_this_iter": 54, "episode_reward_mean": 855.1896859486251, "timesteps_total": 2078097, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 2078097, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 124333, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ecc0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e0f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ef28>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 17, "done": false, "info": {"update_time_ms": 11.482, "default": {"entropy": 1.2883871793746948, "vf_explained_var": 0.7378235459327698, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.00012491218512877822, "cur_lr": 0.0005000000237487257, "total_loss": 15.45313835144043, "kl": 0.005965346936136484, "vf_loss": 15.453225135803223}, "num_steps_sampled": 2078097, "load_time_ms": 23.813, "num_steps_trained": 2078097, "sample_time_ms": 15053.183, "grad_time_ms": 26137.908}, "training_iteration": 17, "date": "2019-04-28_02-37-32", "episodes_total": 827, "timestamp": 1556419052, "time_total_s": 727.8383688926697, "episode_len_mean": 700.0, "episode_reward_min": 754.0222461292739, "time_since_restore": 727.8383688926697, "custom_metrics": {"cost2_max": -140.2344729311505, "system_level_velocity_mean": 11.443104267120848, "cost1_max": 341.51768717680767, "cost1_min": 255.30685806255502, "outflow_rate_max": 1097.1993490504397, "cost1_mean": 305.2843069139597, "outflow_rate_min": 899.6501714608855, "cost2_min": -210.5043389028815, "system_level_velocity_max": 12.677788842806544, "outflow_rate_mean": 1023.6291542885627, "system_level_velocity_min": 9.877252352588846, "cost2_mean": -172.8160578447153}}
{"policy_reward_mean": {}, "time_this_iter_s": 38.59109306335449, "episode_reward_max": 938.5289549390651, "episodes_this_iter": 45, "episode_reward_mean": 853.4599070133263, "timesteps_total": 2200625, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 2200625, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 122528, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a775c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a779e8>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 18, "done": false, "info": {"update_time_ms": 11.463, "default": {"entropy": 1.275726318359375, "vf_explained_var": 0.783473551273346, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.001535315765067935, "cur_lr": 0.0005000000237487257, "total_loss": 13.009980201721191, "kl": 0.00886351615190506, "vf_loss": 13.011459350585938}, "num_steps_sampled": 2200625, "load_time_ms": 23.893, "num_steps_trained": 2200625, "sample_time_ms": 15006.054, "grad_time_ms": 25962.206}, "training_iteration": 18, "date": "2019-04-28_02-38-10", "episodes_total": 872, "timestamp": 1556419090, "time_total_s": 766.4294619560242, "episode_len_mean": 700.0, "episode_reward_min": 758.617030630813, "time_since_restore": 766.4294619560242, "custom_metrics": {"cost2_max": -140.2344729311505, "system_level_velocity_mean": 11.543022903798713, "cost1_max": 341.51768717680767, "cost1_min": 255.30685806255502, "outflow_rate_max": 1111.567440659944, "cost1_mean": 307.4753442477848, "outflow_rate_min": 899.6501714608855, "cost2_min": -212.05375634487342, "system_level_velocity_max": 12.75504962319646, "outflow_rate_mean": 1030.8894317892568, "system_level_velocity_min": 9.877252352588846, "cost2_mean": -176.61307800824216}}
{"policy_reward_mean": {}, "time_this_iter_s": 39.556841135025024, "episode_reward_max": 928.7496130619842, "episodes_this_iter": 55, "episode_reward_mean": 857.4194924447543, "timesteps_total": 2324291, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 2324291, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 123666, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e198>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ef60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7eac8>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 19, "done": false, "info": {"update_time_ms": 11.312, "default": {"entropy": 1.2670059204101562, "vf_explained_var": 0.7207854986190796, "cur_kl_coeff": 0.006250001490116119, "policy_loss": -0.0006720211240462959, "cur_lr": 0.0005000000237487257, "total_loss": 16.81151008605957, "kl": 0.00744366180151701, "vf_loss": 16.8121337890625}, "num_steps_sampled": 2324291, "load_time_ms": 23.835, "num_steps_trained": 2324291, "sample_time_ms": 14926.359, "grad_time_ms": 26045.513}, "training_iteration": 19, "date": "2019-04-28_02-38-50", "episodes_total": 927, "timestamp": 1556419130, "time_total_s": 805.9863030910492, "episode_len_mean": 700.0, "episode_reward_min": 787.5876795172607, "time_since_restore": 805.9863030910492, "custom_metrics": {"cost2_max": -152.38838865828757, "system_level_velocity_mean": 11.611095989140363, "cost1_max": 340.7837350480743, "cost1_min": 258.7881340780208, "outflow_rate_max": 1111.567440659944, "cost1_mean": 309.06108216186846, "outflow_rate_min": 937.9807923720421, "cost2_min": -212.05375634487342, "system_level_velocity_max": 12.75504962319646, "outflow_rate_mean": 1038.6739932330318, "system_level_velocity_min": 9.74632448281342, "cost2_mean": -178.8403599254014}}
{"policy_reward_mean": {}, "time_this_iter_s": 41.352322578430176, "episode_reward_max": 928.7496130619842, "episodes_this_iter": 40, "episode_reward_mean": 857.6139240739785, "timesteps_total": 2447595, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 2447595, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 123304, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a773c8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a779e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77e80>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 20, "done": false, "info": {"update_time_ms": 11.318, "default": {"entropy": 1.259155511856079, "vf_explained_var": 0.7332779169082642, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0012142750201746821, "cur_lr": 0.0005000000237487257, "total_loss": 14.085919380187988, "kl": 0.008321835659444332, "vf_loss": 14.087080955505371}, "num_steps_sampled": 2447595, "load_time_ms": 23.978, "num_steps_trained": 2447595, "sample_time_ms": 14833.802, "grad_time_ms": 26133.198}, "training_iteration": 20, "date": "2019-04-28_02-39-31", "episodes_total": 967, "timestamp": 1556419171, "time_total_s": 847.3386256694794, "episode_len_mean": 700.0, "episode_reward_min": 782.5295174917317, "time_since_restore": 847.3386256694794, "custom_metrics": {"cost2_max": -152.38838865828757, "system_level_velocity_mean": 11.677215299775105, "cost1_max": 347.53027057234, "cost1_min": 258.7881340780208, "outflow_rate_max": 1107.1605222873916, "cost1_mean": 310.2714509241093, "outflow_rate_min": 945.8460383624958, "cost2_min": -210.26867413231767, "system_level_velocity_max": 13.022547117392426, "outflow_rate_mean": 1041.052705605548, "system_level_velocity_min": 9.74632448281342, "cost2_mean": -177.43664631488107}}
{"policy_reward_mean": {}, "time_this_iter_s": 40.572094202041626, "episode_reward_max": 928.7496130619842, "episodes_this_iter": 53, "episode_reward_mean": 856.1569457524635, "timesteps_total": 2572176, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 2572176, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 124581, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75a58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75208>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 21, "done": false, "info": {"update_time_ms": 11.595, "default": {"entropy": 1.2425986528396606, "vf_explained_var": 0.6943938732147217, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0011540439445525408, "cur_lr": 0.0005000000237487257, "total_loss": 15.335969924926758, "kl": 0.010453927330672741, "vf_loss": 15.337057113647461}, "num_steps_sampled": 2572176, "load_time_ms": 23.624, "num_steps_trained": 2572176, "sample_time_ms": 14906.913, "grad_time_ms": 25999.256}, "training_iteration": 21, "date": "2019-04-28_02-40-12", "episodes_total": 1020, "timestamp": 1556419212, "time_total_s": 887.910719871521, "episode_len_mean": 700.0, "episode_reward_min": 746.0736761766829, "time_since_restore": 887.910719871521, "custom_metrics": {"cost2_max": -146.82431353385016, "system_level_velocity_mean": 11.667074271149147, "cost1_max": 347.53027057234, "cost1_min": 258.40038118951134, "outflow_rate_max": 1107.1605222873916, "cost1_mean": 309.64018058925313, "outflow_rate_min": 930.1836666433103, "cost2_min": -205.11060680872055, "system_level_velocity_max": 13.022547117392426, "outflow_rate_mean": 1039.1603757208377, "system_level_velocity_min": 9.953610508338771, "cost2_mean": -173.367470057738}}
{"policy_reward_mean": {}, "time_this_iter_s": 38.186012506484985, "episode_reward_max": 965.7363031830168, "episodes_this_iter": 47, "episode_reward_mean": 846.7326932042846, "timesteps_total": 2695159, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 2695159, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 122983, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ebe0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ef98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ee10>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 22, "done": false, "info": {"update_time_ms": 11.462, "default": {"entropy": 1.2242873907089233, "vf_explained_var": 0.7102009654045105, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0013443081406876445, "cur_lr": 0.0005000000237487257, "total_loss": 15.602359771728516, "kl": 0.008795294910669327, "vf_loss": 15.603650093078613}, "num_steps_sampled": 2695159, "load_time_ms": 23.575, "num_steps_trained": 2695159, "sample_time_ms": 14860.981, "grad_time_ms": 25603.75}, "training_iteration": 22, "date": "2019-04-28_02-40-50", "episodes_total": 1067, "timestamp": 1556419250, "time_total_s": 926.096732378006, "episode_len_mean": 700.0, "episode_reward_min": 746.0736761766829, "time_since_restore": 926.096732378006, "custom_metrics": {"cost2_max": -134.41467104863176, "system_level_velocity_mean": 11.412921048890437, "cost1_max": 340.53331223180635, "cost1_min": 258.40038118951134, "outflow_rate_max": 1130.3982620904665, "cost1_mean": 302.55186863531605, "outflow_rate_min": 929.1433136518989, "cost2_min": -195.35078573443926, "system_level_velocity_max": 12.72196440189745, "outflow_rate_mean": 1021.263280759418, "system_level_velocity_min": 9.87990619900901, "cost2_mean": -168.66506159061984}}
{"policy_reward_mean": {}, "time_this_iter_s": 37.62395095825195, "episode_reward_max": 965.7363031830168, "episodes_this_iter": 50, "episode_reward_mean": 848.5062937762827, "timesteps_total": 2817235, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 2817235, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 122076, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75fd0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a759e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a757f0>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 23, "done": false, "info": {"update_time_ms": 11.463, "default": {"entropy": 1.2027406692504883, "vf_explained_var": 0.7295808792114258, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.000709408603142947, "cur_lr": 0.0005000000237487257, "total_loss": 15.533705711364746, "kl": 0.008467213250696659, "vf_loss": 15.534360885620117}, "num_steps_sampled": 2817235, "load_time_ms": 23.055, "num_steps_trained": 2817235, "sample_time_ms": 14834.613, "grad_time_ms": 25146.845}, "training_iteration": 23, "date": "2019-04-28_02-41-28", "episodes_total": 1117, "timestamp": 1556419288, "time_total_s": 963.7206833362579, "episode_len_mean": 700.0, "episode_reward_min": 755.2381792709192, "time_since_restore": 963.7206833362579, "custom_metrics": {"cost2_max": -134.41467104863176, "system_level_velocity_mean": 11.424628365554234, "cost1_max": 340.53331223180635, "cost1_min": 261.78668197256843, "outflow_rate_max": 1130.3982620904665, "cost1_mean": 303.18181254860224, "outflow_rate_min": 900.9769953737431, "cost2_min": -193.11905018004782, "system_level_velocity_max": 12.684185486804578, "outflow_rate_mean": 1019.1387128020543, "system_level_velocity_min": 9.87990619900901, "cost2_mean": -164.89696019514875}}
{"policy_reward_mean": {}, "time_this_iter_s": 37.969364166259766, "episode_reward_max": 935.9767751537532, "episodes_this_iter": 55, "episode_reward_mean": 853.8514681977656, "timesteps_total": 2938917, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 2938917, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 121682, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a773c8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a779b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a779e8>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 24, "done": false, "info": {"update_time_ms": 11.601, "default": {"entropy": 1.1859090328216553, "vf_explained_var": 0.7229449152946472, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0015519289299845695, "cur_lr": 0.0005000000237487257, "total_loss": 16.92684555053711, "kl": 0.009928401559591293, "vf_loss": 16.928335189819336}, "num_steps_sampled": 2938917, "load_time_ms": 23.256, "num_steps_trained": 2938917, "sample_time_ms": 14775.319, "grad_time_ms": 24770.802}, "training_iteration": 24, "date": "2019-04-28_02-42-06", "episodes_total": 1172, "timestamp": 1556419326, "time_total_s": 1001.6900475025177, "episode_len_mean": 700.0, "episode_reward_min": 772.4159431105614, "time_since_restore": 1001.6900475025177, "custom_metrics": {"cost2_max": -140.75318179333078, "system_level_velocity_mean": 11.607664393131133, "cost1_max": 344.6060739989238, "cost1_min": 270.0939762889296, "outflow_rate_max": 1103.5967225760194, "cost1_mean": 308.3203432031617, "outflow_rate_min": 900.9769953737431, "cost2_min": -195.87363187705333, "system_level_velocity_max": 12.914585151049078, "outflow_rate_mean": 1028.116657567642, "system_level_velocity_min": 10.326508096306872, "cost2_mean": -161.67881051686965}}
{"policy_reward_mean": {}, "time_this_iter_s": 40.72718906402588, "episode_reward_max": 949.9283038479281, "episodes_this_iter": 47, "episode_reward_mean": 861.9531913458859, "timesteps_total": 3059496, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 3059496, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 120579, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ed30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e9b0>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 25, "done": false, "info": {"update_time_ms": 11.555, "default": {"entropy": 1.17832350730896, "vf_explained_var": 0.7383601665496826, "cur_kl_coeff": 0.006250001490116119, "policy_loss": -0.0017146178288385272, "cur_lr": 0.0005000000237487257, "total_loss": 16.277053833007812, "kl": 0.010460046119987965, "vf_loss": 16.278703689575195}, "num_steps_sampled": 3059496, "load_time_ms": 22.561, "num_steps_trained": 3059496, "sample_time_ms": 14956.407, "grad_time_ms": 24524.184}, "training_iteration": 25, "date": "2019-04-28_02-42-46", "episodes_total": 1219, "timestamp": 1556419366, "time_total_s": 1042.4172365665436, "episode_len_mean": 700.0, "episode_reward_min": 758.1963292531883, "time_since_restore": 1042.4172365665436, "custom_metrics": {"cost2_max": -141.69540039022155, "system_level_velocity_mean": 11.751274916024434, "cost1_max": 344.6060739989238, "cost1_min": 254.21869012320923, "outflow_rate_max": 1103.5967225760194, "cost1_mean": 312.10709402610183, "outflow_rate_min": 888.6725757566287, "cost2_min": -195.87363187705333, "system_level_velocity_max": 12.914585151049078, "outflow_rate_mean": 1037.5249851848178, "system_level_velocity_min": 9.84487901679295, "cost2_mean": -161.68456938005392}}
{"policy_reward_mean": {}, "time_this_iter_s": 37.124934673309326, "episode_reward_max": 964.8421649650103, "episodes_this_iter": 54, "episode_reward_mean": 867.0947654960563, "timesteps_total": 3180112, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 3180112, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 120616, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7eef0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ef98>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 26, "done": false, "info": {"update_time_ms": 11.449, "default": {"entropy": 1.1434874534606934, "vf_explained_var": 0.68193519115448, "cur_kl_coeff": 0.006250001490116119, "policy_loss": -0.0014646686613559723, "cur_lr": 0.0005000000237487257, "total_loss": 21.70479965209961, "kl": 0.013192550279200077, "vf_loss": 21.70618438720703}, "num_steps_sampled": 3180112, "load_time_ms": 21.644, "num_steps_trained": 3180112, "sample_time_ms": 14942.342, "grad_time_ms": 24206.57}, "training_iteration": 26, "date": "2019-04-28_02-43-23", "episodes_total": 1273, "timestamp": 1556419403, "time_total_s": 1079.542171239853, "episode_len_mean": 700.0, "episode_reward_min": 758.1963292531883, "time_since_restore": 1079.542171239853, "custom_metrics": {"cost2_max": -139.6728416738976, "system_level_velocity_mean": 11.941980115819511, "cost1_max": 348.6683656985774, "cost1_min": 254.21869012320923, "outflow_rate_max": 1108.9799147349866, "cost1_mean": 316.4129791760759, "outflow_rate_min": 888.6725757566287, "cost2_min": -191.92124844302447, "system_level_velocity_max": 13.116938595337906, "outflow_rate_mean": 1047.1094072632063, "system_level_velocity_min": 9.84487901679295, "cost2_mean": -162.8522593246713}}
{"policy_reward_mean": {}, "time_this_iter_s": 35.195194244384766, "episode_reward_max": 964.8421649650103, "episodes_this_iter": 42, "episode_reward_mean": 870.3424883403138, "timesteps_total": 3299954, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 3299954, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 119842, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88240>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a884a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88470>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 27, "done": false, "info": {"update_time_ms": 11.473, "default": {"entropy": 1.1294375658035278, "vf_explained_var": 0.7072872519493103, "cur_kl_coeff": 0.006250001490116119, "policy_loss": -0.001326457248069346, "cur_lr": 0.0005000000237487257, "total_loss": 19.145267486572266, "kl": 0.011474216356873512, "vf_loss": 19.146522521972656}, "num_steps_sampled": 3299954, "load_time_ms": 22.461, "num_steps_trained": 3299954, "sample_time_ms": 14827.924, "grad_time_ms": 23604.919}, "training_iteration": 27, "date": "2019-04-28_02-43-59", "episodes_total": 1315, "timestamp": 1556419439, "time_total_s": 1114.7373654842377, "episode_len_mean": 700.0, "episode_reward_min": 746.5122071038929, "time_since_restore": 1114.7373654842377, "custom_metrics": {"cost2_max": -132.58027095101994, "system_level_velocity_mean": 12.139981362773133, "cost1_max": 359.1167585081184, "cost1_min": 253.2973383313891, "outflow_rate_max": 1131.8277292683501, "cost1_mean": 320.74567775785204, "outflow_rate_min": 918.4099348248577, "cost2_min": -197.61436135638814, "system_level_velocity_max": 13.640947982833163, "outflow_rate_mean": 1056.8877326888596, "system_level_velocity_min": 9.924109934503484, "cost2_mean": -163.48318277136667}}
{"policy_reward_mean": {}, "time_this_iter_s": 38.14909315109253, "episode_reward_max": 960.3880922081801, "episodes_this_iter": 57, "episode_reward_mean": 862.5862603885529, "timesteps_total": 3419239, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 3419239, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 119285, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a779b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a779e8>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 28, "done": false, "info": {"update_time_ms": 11.696, "default": {"entropy": 1.1179319620132446, "vf_explained_var": 0.6632801294326782, "cur_kl_coeff": 0.006250001490116119, "policy_loss": -0.0009119720780290663, "cur_lr": 0.0005000000237487257, "total_loss": 25.269180297851562, "kl": 0.009190871380269527, "vf_loss": 25.270034790039062}, "num_steps_sampled": 3419239, "load_time_ms": 22.557, "num_steps_trained": 3419239, "sample_time_ms": 14837.931, "grad_time_ms": 23553.24}, "training_iteration": 28, "date": "2019-04-28_02-44-37", "episodes_total": 1372, "timestamp": 1556419477, "time_total_s": 1152.8864586353302, "episode_len_mean": 693.35, "episode_reward_min": 47.619242265161766, "time_since_restore": 1152.8864586353302, "custom_metrics": {"cost2_max": -21.689844014788402, "system_level_velocity_mean": 12.394685413786087, "cost1_max": 375.93609084956705, "cost1_min": 22.879327943486704, "outflow_rate_max": 1179.8021078264092, "cost1_mean": 321.72135403385863, "outflow_rate_min": 505.27649765701665, "cost2_min": -197.61436135638814, "system_level_velocity_max": 18.444290509828534, "outflow_rate_mean": 1060.1978682599747, "system_level_velocity_min": 9.924109934503484, "cost2_mean": -162.64520255384213}}
{"policy_reward_mean": {}, "time_this_iter_s": 39.70917248725891, "episode_reward_max": 1018.9273769038434, "episodes_this_iter": 53, "episode_reward_mean": 856.9721099601724, "timesteps_total": 3538339, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 3538339, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 119100, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88470>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a888d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a885f8>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 29, "done": false, "info": {"update_time_ms": 11.831, "default": {"entropy": 1.1129900217056274, "vf_explained_var": 0.6591898798942566, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.001099972054362297, "cur_lr": 0.0005000000237487257, "total_loss": 24.387168884277344, "kl": 0.009260163642466068, "vf_loss": 24.38821029663086}, "num_steps_sampled": 3538339, "load_time_ms": 23.131, "num_steps_trained": 3538339, "sample_time_ms": 14875.313, "grad_time_ms": 23530.168}, "training_iteration": 29, "date": "2019-04-28_02-45-17", "episodes_total": 1425, "timestamp": 1556419517, "time_total_s": 1192.595631122589, "episode_len_mean": 686.7, "episode_reward_min": 47.619242265161766, "time_since_restore": 1192.595631122589, "custom_metrics": {"cost2_max": -21.689844014788402, "system_level_velocity_mean": 12.586692108052551, "cost1_max": 406.29504437889824, "cost1_min": 22.879327943486704, "outflow_rate_max": 1237.4998264755718, "cost1_mean": 321.7629127257985, "outflow_rate_min": 493.8745706160326, "cost2_min": -202.00534048886982, "system_level_velocity_max": 18.444290509828534, "outflow_rate_mean": 1063.4381598345487, "system_level_velocity_min": 8.843316317331347, "cost2_mean": -162.08566639528627}}
{"policy_reward_mean": {}, "time_this_iter_s": 39.23157334327698, "episode_reward_max": 1018.9273769038434, "episodes_this_iter": 49, "episode_reward_mean": 859.093156972994, "timesteps_total": 3657012, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 3657012, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 118673, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e080>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ee48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ee10>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 30, "done": false, "info": {"update_time_ms": 11.916, "default": {"entropy": 1.102351188659668, "vf_explained_var": 0.6851776242256165, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0014955351362004876, "cur_lr": 0.0005000000237487257, "total_loss": 21.437196731567383, "kl": 0.010572223924100399, "vf_loss": 21.438629150390625}, "num_steps_sampled": 3657012, "load_time_ms": 23.235, "num_steps_trained": 3657012, "sample_time_ms": 14885.175, "grad_time_ms": 23313.295}, "training_iteration": 30, "date": "2019-04-28_02-45-56", "episodes_total": 1474, "timestamp": 1556419556, "time_total_s": 1231.827204465866, "episode_len_mean": 686.7, "episode_reward_min": 49.00189357620129, "time_since_restore": 1231.827204465866, "custom_metrics": {"cost2_max": -22.317899922789543, "system_level_velocity_mean": 12.716619065880097, "cost1_max": 406.29504437889824, "cost1_min": 22.709637471194064, "outflow_rate_max": 1237.4998264755718, "cost1_mean": 325.01464387404405, "outflow_rate_min": 476.7640714436957, "cost2_min": -202.00534048886982, "system_level_velocity_max": 18.354136942880498, "outflow_rate_mean": 1072.1292922135276, "system_level_velocity_min": 8.843316317331347, "cost2_mean": -161.5770553535136}}
{"policy_reward_mean": {}, "time_this_iter_s": 37.88412141799927, "episode_reward_max": 980.9084013136369, "episodes_this_iter": 51, "episode_reward_mean": 865.8275531901443, "timesteps_total": 3776016, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 3776016, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 119004, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a885f8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a889e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88ac8>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 31, "done": false, "info": {"update_time_ms": 11.851, "default": {"entropy": 1.1047579050064087, "vf_explained_var": 0.6871777176856995, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0008994587115012109, "cur_lr": 0.0005000000237487257, "total_loss": 21.813861846923828, "kl": 0.00940119381994009, "vf_loss": 21.8147029876709}, "num_steps_sampled": 3776016, "load_time_ms": 23.42, "num_steps_trained": 3776016, "sample_time_ms": 14774.078, "grad_time_ms": 23151.964}, "training_iteration": 31, "date": "2019-04-28_02-46-34", "episodes_total": 1525, "timestamp": 1556419594, "time_total_s": 1269.7113258838654, "episode_len_mean": 693.35, "episode_reward_min": 49.870827034993795, "time_since_restore": 1269.7113258838654, "custom_metrics": {"cost2_max": -23.27066694460954, "system_level_velocity_mean": 12.75504590868576, "cost1_max": 396.98499691483806, "cost1_min": 22.709637471194064, "outflow_rate_max": 1214.0248288359846, "cost1_mean": 330.4971474597394, "outflow_rate_min": 476.7640714436957, "cost2_min": -195.1328040247824, "system_level_velocity_max": 18.199550201263637, "outflow_rate_mean": 1081.6455088536275, "system_level_velocity_min": 10.416309056749487, "cost2_mean": -159.88012699658586}}
{"policy_reward_mean": {}, "time_this_iter_s": 37.85105514526367, "episode_reward_max": 980.9084013136369, "episodes_this_iter": 47, "episode_reward_mean": 860.8074296464209, "timesteps_total": 3894644, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 3894644, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 118628, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77e80>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a882b0>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 32, "done": false, "info": {"update_time_ms": 12.117, "default": {"entropy": 1.1068437099456787, "vf_explained_var": 0.7037944197654724, "cur_kl_coeff": 0.006250001490116119, "policy_loss": -0.001012528664432466, "cur_lr": 0.0005000000237487257, "total_loss": 21.63917350769043, "kl": 0.009587121196091175, "vf_loss": 21.640127182006836}, "num_steps_sampled": 3894644, "load_time_ms": 23.365, "num_steps_trained": 3894644, "sample_time_ms": 14785.324, "grad_time_ms": 23108.676}, "training_iteration": 32, "date": "2019-04-28_02-47-12", "episodes_total": 1572, "timestamp": 1556419632, "time_total_s": 1307.562381029129, "episode_len_mean": 693.38, "episode_reward_min": 49.72386737850209, "time_since_restore": 1307.562381029129, "custom_metrics": {"cost2_max": -23.14111218848188, "system_level_velocity_mean": 12.67254719387724, "cost1_max": 396.98499691483806, "cost1_min": 24.47481923140164, "outflow_rate_max": 1214.0248288359846, "cost1_mean": 328.0816336902099, "outflow_rate_min": 502.49609743223635, "cost2_min": -195.1328040247824, "system_level_velocity_max": 17.835757484356037, "outflow_rate_mean": 1074.885282793422, "system_level_velocity_min": 10.416309056749487, "cost2_mean": -158.71617579227413}}
{"policy_reward_mean": {}, "time_this_iter_s": 37.2553277015686, "episode_reward_max": 1017.7684114272564, "episodes_this_iter": 55, "episode_reward_mean": 863.0529109988258, "timesteps_total": 4013736, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 4013736, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 119092, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a887f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a889e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88c88>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 33, "done": false, "info": {"update_time_ms": 12.152, "default": {"entropy": 1.0984010696411133, "vf_explained_var": 0.6858246922492981, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0013872628333047032, "cur_lr": 0.0005000000237487257, "total_loss": 23.62672996520996, "kl": 0.009986805729568005, "vf_loss": 23.628053665161133}, "num_steps_sampled": 4013736, "load_time_ms": 23.172, "num_steps_trained": 4013736, "sample_time_ms": 14752.772, "grad_time_ms": 23105.353}, "training_iteration": 33, "date": "2019-04-28_02-47-49", "episodes_total": 1627, "timestamp": 1556419669, "time_total_s": 1344.8177087306976, "episode_len_mean": 693.38, "episode_reward_min": 49.72386737850209, "time_since_restore": 1344.8177087306976, "custom_metrics": {"cost2_max": -23.14111218848188, "system_level_velocity_mean": 12.705106135996562, "cost1_max": 410.4417170331384, "cost1_min": 24.47481923140164, "outflow_rate_max": 1236.4203981791402, "cost1_mean": 328.76983876397105, "outflow_rate_min": 502.49609743223635, "cost2_min": -184.53934663781632, "system_level_velocity_max": 17.835757484356037, "outflow_rate_mean": 1075.246801925378, "system_level_velocity_min": 10.556760567590256, "cost2_mean": -158.06169469843593}}
{"policy_reward_mean": {}, "time_this_iter_s": 40.26517415046692, "episode_reward_max": 1035.6831687546305, "episodes_this_iter": 49, "episode_reward_mean": 877.4840162044908, "timesteps_total": 4130311, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 4130311, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 116575, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a883c8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88cf8>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 34, "done": false, "info": {"update_time_ms": 12.014, "default": {"entropy": 1.100433111190796, "vf_explained_var": 0.7050805687904358, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0009670323343016207, "cur_lr": 0.0005000000237487257, "total_loss": 25.00337791442871, "kl": 0.00920945592224598, "vf_loss": 25.004287719726562}, "num_steps_sampled": 4130311, "load_time_ms": 23.107, "num_steps_trained": 4130311, "sample_time_ms": 14848.27, "grad_time_ms": 23242.386}, "training_iteration": 34, "date": "2019-04-28_02-48-29", "episodes_total": 1676, "timestamp": 1556419709, "time_total_s": 1385.0828828811646, "episode_len_mean": 700.0, "episode_reward_min": 750.6481260082458, "time_since_restore": 1385.0828828811646, "custom_metrics": {"cost2_max": -132.5912460020446, "system_level_velocity_mean": 12.748844370085129, "cost1_max": 410.4417170331384, "cost1_min": 264.9828043556528, "outflow_rate_max": 1236.4203981791402, "cost1_mean": 334.73911527573887, "outflow_rate_min": 927.035456192222, "cost2_min": -181.98283974751925, "system_level_velocity_max": 15.383292571218224, "outflow_rate_mean": 1087.9220969626388, "system_level_velocity_min": 10.320556084304398, "cost2_mean": -157.66262932764374}}
{"policy_reward_mean": {}, "time_this_iter_s": 37.078322410583496, "episode_reward_max": 1035.6831687546305, "episodes_this_iter": 57, "episode_reward_mean": 879.4072128620239, "timesteps_total": 4246190, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 4246190, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 115879, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88c88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88898>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 35, "done": false, "info": {"update_time_ms": 12.139, "default": {"entropy": 1.0950301885604858, "vf_explained_var": 0.6536348462104797, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0017427989514544606, "cur_lr": 0.0005000000237487257, "total_loss": 28.08909797668457, "kl": 0.010534814558923244, "vf_loss": 28.090774536132812}, "num_steps_sampled": 4246190, "load_time_ms": 23.949, "num_steps_trained": 4246190, "sample_time_ms": 14667.086, "grad_time_ms": 23060.663}, "training_iteration": 35, "date": "2019-04-28_02-49-06", "episodes_total": 1733, "timestamp": 1556419746, "time_total_s": 1422.161205291748, "episode_len_mean": 700.0, "episode_reward_min": 772.7793706608298, "time_since_restore": 1422.161205291748, "custom_metrics": {"cost2_max": -132.5912460020446, "system_level_velocity_mean": 12.854908025461755, "cost1_max": 408.2835778846845, "cost1_min": 262.86022723319155, "outflow_rate_max": 1234.3033116207912, "cost1_mean": 336.8250640903353, "outflow_rate_min": 916.9904669964446, "cost2_min": -177.63009169467762, "system_level_velocity_max": 15.313430966531321, "outflow_rate_mean": 1091.5548367454574, "system_level_velocity_min": 10.210711565583855, "cost2_mean": -153.83033161911274}}
{"policy_reward_mean": {}, "time_this_iter_s": 38.10543608665466, "episode_reward_max": 1000.0845644533312, "episodes_this_iter": 52, "episode_reward_mean": 870.0888395257831, "timesteps_total": 4361859, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 4361859, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 115669, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88198>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88a58>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 36, "done": false, "info": {"update_time_ms": 12.343, "default": {"entropy": 1.0942738056182861, "vf_explained_var": 0.6503742933273315, "cur_kl_coeff": 0.006250001490116119, "policy_loss": -0.0013284072047099471, "cur_lr": 0.0005000000237487257, "total_loss": 29.513505935668945, "kl": 0.008968501351773739, "vf_loss": 29.5147762298584}, "num_steps_sampled": 4361859, "load_time_ms": 24.663, "num_steps_trained": 4361859, "sample_time_ms": 14680.926, "grad_time_ms": 23144.181}, "training_iteration": 36, "date": "2019-04-28_02-49-45", "episodes_total": 1785, "timestamp": 1556419785, "time_total_s": 1460.2666413784027, "episode_len_mean": 700.0, "episode_reward_min": 756.6815621731337, "time_since_restore": 1460.2666413784027, "custom_metrics": {"cost2_max": -135.40540920770076, "system_level_velocity_mean": 12.751930448419625, "cost1_max": 407.58637456022285, "cost1_min": 261.98622514434953, "outflow_rate_max": 1232.7438934142122, "cost1_mean": 332.27113014484627, "outflow_rate_min": 916.9904669964446, "cost2_min": -177.94182532593965, "system_level_velocity_max": 15.313430966531321, "outflow_rate_mean": 1082.623946399737, "system_level_velocity_min": 10.210711565583855, "cost2_mean": -153.3907271891715}}
{"policy_reward_mean": {}, "time_this_iter_s": 40.074702501297, "episode_reward_max": 1014.5370765695801, "episodes_this_iter": 48, "episode_reward_mean": 867.7426999292843, "timesteps_total": 4478840, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 4478840, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 116981, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88048>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a880b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88b00>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 37, "done": false, "info": {"update_time_ms": 12.097, "default": {"entropy": 1.0855571031570435, "vf_explained_var": 0.6899873614311218, "cur_kl_coeff": 0.006250000558793545, "policy_loss": -0.0015797155210748315, "cur_lr": 0.0005000000237487257, "total_loss": 24.96999168395996, "kl": 0.009010524488985538, "vf_loss": 24.971511840820312}, "num_steps_sampled": 4478840, "load_time_ms": 24.992, "num_steps_trained": 4478840, "sample_time_ms": 14777.091, "grad_time_ms": 23531.367}, "training_iteration": 37, "date": "2019-04-28_02-50-25", "episodes_total": 1833, "timestamp": 1556419825, "time_total_s": 1500.3413438796997, "episode_len_mean": 700.0, "episode_reward_min": 756.6815621731337, "time_since_restore": 1500.3413438796997, "custom_metrics": {"cost2_max": -133.00600656621475, "system_level_velocity_mean": 12.74485075759189, "cost1_max": 421.45713921300546, "cost1_min": 261.98622514434953, "outflow_rate_max": 1251.9142814119846, "cost1_mean": 331.5456280170469, "outflow_rate_min": 931.3091817416199, "cost2_min": -180.46774105136856, "system_level_velocity_max": 15.945233655346897, "outflow_rate_mean": 1080.903804721965, "system_level_velocity_min": 10.100646370957165, "cost2_mean": -151.83979305318445}}
{"policy_reward_mean": {}, "time_this_iter_s": 39.389745473861694, "episode_reward_max": 1014.5370765695801, "episodes_this_iter": 54, "episode_reward_mean": 873.2738426912067, "timesteps_total": 4596407, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 4596407, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 117567, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88c18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a886d8>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 38, "done": false, "info": {"update_time_ms": 11.713, "default": {"entropy": 1.0814356803894043, "vf_explained_var": 0.6788609027862549, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.001815869938582182, "cur_lr": 0.0005000000237487257, "total_loss": 26.843984603881836, "kl": 0.010426935739815235, "vf_loss": 26.845733642578125}, "num_steps_sampled": 4596407, "load_time_ms": 25.196, "num_steps_trained": 4596407, "sample_time_ms": 14882.458, "grad_time_ms": 23549.684}, "training_iteration": 38, "date": "2019-04-28_02-51-04", "episodes_total": 1887, "timestamp": 1556419864, "time_total_s": 1539.7310893535614, "episode_len_mean": 700.0, "episode_reward_min": 761.2548954660883, "time_since_restore": 1539.7310893535614, "custom_metrics": {"cost2_max": -130.94555866986343, "system_level_velocity_mean": 12.879804730293495, "cost1_max": 421.45713921300546, "cost1_min": 243.69794371240306, "outflow_rate_max": 1251.9142814119846, "cost1_mean": 335.7447365778933, "outflow_rate_min": 888.1223397113941, "cost2_min": -183.93213079719396, "system_level_velocity_max": 15.945233655346897, "outflow_rate_mean": 1089.0184770387232, "system_level_velocity_min": 9.350736656441141, "cost2_mean": -149.94885888465615}}
{"policy_reward_mean": {}, "time_this_iter_s": 38.36506962776184, "episode_reward_max": 1010.8388969334533, "episodes_this_iter": 50, "episode_reward_mean": 877.0030400430944, "timesteps_total": 4714585, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 4714585, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 118178, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88eb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88048>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 39, "done": false, "info": {"update_time_ms": 11.688, "default": {"entropy": 1.055100679397583, "vf_explained_var": 0.7156500220298767, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0011272935662418604, "cur_lr": 0.0005000000237487257, "total_loss": 22.869821548461914, "kl": 0.012321095913648605, "vf_loss": 22.870872497558594}, "num_steps_sampled": 4714585, "load_time_ms": 24.125, "num_steps_trained": 4714585, "sample_time_ms": 14925.515, "grad_time_ms": 23369.839}, "training_iteration": 39, "date": "2019-04-28_02-51-42", "episodes_total": 1937, "timestamp": 1556419902, "time_total_s": 1578.0961589813232, "episode_len_mean": 700.0, "episode_reward_min": 696.4664334603478, "time_since_restore": 1578.0961589813232, "custom_metrics": {"cost2_max": -130.94555866986343, "system_level_velocity_mean": 12.942066125041345, "cost1_max": 415.5355793323662, "cost1_min": 223.8663745316491, "outflow_rate_max": 1242.8087017626651, "cost1_mean": 338.04163545116603, "outflow_rate_min": 839.1940300067744, "cost2_min": -183.93213079719396, "system_level_velocity_max": 15.667167655944915, "outflow_rate_mean": 1093.6584155089486, "system_level_velocity_min": 8.775906600306628, "cost2_mean": -149.90212705402467}}
{"policy_reward_mean": {}, "time_this_iter_s": 35.746854305267334, "episode_reward_max": 1141.0285423046753, "episodes_this_iter": 55, "episode_reward_mean": 869.5801764694385, "timesteps_total": 4829903, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 4829903, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 115318, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e5c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e5f8>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 40, "done": false, "info": {"update_time_ms": 12.242, "default": {"entropy": 1.05264151096344, "vf_explained_var": 0.6821120977401733, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0007652360945940018, "cur_lr": 0.0005000000237487257, "total_loss": 28.243276596069336, "kl": 0.010442008264362812, "vf_loss": 28.243976593017578}, "num_steps_sampled": 4829903, "load_time_ms": 23.584, "num_steps_trained": 4829903, "sample_time_ms": 14971.766, "grad_time_ms": 22973.513}, "training_iteration": 40, "date": "2019-04-28_02-52-18", "episodes_total": 1992, "timestamp": 1556419938, "time_total_s": 1613.8430132865906, "episode_len_mean": 700.0, "episode_reward_min": 696.4664334603478, "time_since_restore": 1613.8430132865906, "custom_metrics": {"cost2_max": -132.5628128936363, "system_level_velocity_mean": 12.796250801707469, "cost1_max": 442.34830639836537, "cost1_min": 223.8663745316491, "outflow_rate_max": 1258.0350258267215, "cost1_mean": 334.13302155133687, "outflow_rate_min": 839.1940300067744, "cost2_min": -176.59197865188523, "system_level_velocity_max": 16.605634870052313, "outflow_rate_mean": 1084.8929834033747, "system_level_velocity_min": 8.775906600306628, "cost2_mean": -149.39711037788365}}
{"policy_reward_mean": {}, "time_this_iter_s": 38.51654076576233, "episode_reward_max": 1141.0285423046753, "episodes_this_iter": 48, "episode_reward_mean": 873.4958236795127, "timesteps_total": 4945226, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 4945226, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 115323, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a889e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88dd8>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 41, "done": false, "info": {"update_time_ms": 12.004, "default": {"entropy": 1.04656183719635, "vf_explained_var": 0.7096265554428101, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.001624310971237719, "cur_lr": 0.0005000000237487257, "total_loss": 24.26972007751465, "kl": 0.011539666913449764, "vf_loss": 24.271270751953125}, "num_steps_sampled": 4945226, "load_time_ms": 22.542, "num_steps_trained": 4945226, "sample_time_ms": 15062.356, "grad_time_ms": 22951.998}, "training_iteration": 41, "date": "2019-04-28_02-52-57", "episodes_total": 2040, "timestamp": 1556419977, "time_total_s": 1652.359554052353, "episode_len_mean": 700.0, "episode_reward_min": 786.5398446355406, "time_since_restore": 1652.359554052353, "custom_metrics": {"cost2_max": -129.72095912708386, "system_level_velocity_mean": 12.955406120985133, "cost1_max": 442.34830639836537, "cost1_min": 271.0853956176113, "outflow_rate_max": 1258.0350258267215, "cost1_mean": 337.54669247827957, "outflow_rate_min": 925.7179882002264, "cost2_min": -176.79542932242197, "system_level_velocity_max": 16.605634870052313, "outflow_rate_mean": 1092.9256700725712, "system_level_velocity_min": 10.480397413285548, "cost2_mean": -147.0143384129972}}
{"policy_reward_mean": {}, "time_this_iter_s": 36.849997758865356, "episode_reward_max": 1075.1238360446866, "episodes_this_iter": 57, "episode_reward_mean": 873.9575756182134, "timesteps_total": 5060344, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 5060344, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 115118, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88128>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a882e8>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 42, "done": false, "info": {"update_time_ms": 11.78, "default": {"entropy": 1.0324726104736328, "vf_explained_var": 0.6810415387153625, "cur_kl_coeff": 0.006250000558793545, "policy_loss": -0.0019836637657135725, "cur_lr": 0.0005000000237487257, "total_loss": 27.80808448791504, "kl": 0.01157632190734148, "vf_loss": 27.80999755859375}, "num_steps_sampled": 5060344, "load_time_ms": 21.958, "num_steps_trained": 5060344, "sample_time_ms": 15082.957, "grad_time_ms": 22832.011}, "training_iteration": 42, "date": "2019-04-28_02-53-34", "episodes_total": 2097, "timestamp": 1556420014, "time_total_s": 1689.2095518112183, "episode_len_mean": 700.0, "episode_reward_min": 790.7662011302108, "time_since_restore": 1689.2095518112183, "custom_metrics": {"cost2_max": -129.72095912708386, "system_level_velocity_mean": 12.92921543144987, "cost1_max": 428.6802520853535, "cost1_min": 271.8251085245134, "outflow_rate_max": 1246.6726458288338, "cost1_mean": 336.2146653935147, "outflow_rate_min": 937.7809446506384, "cost2_min": -176.79542932242197, "system_level_velocity_max": 16.098060504003517, "outflow_rate_mean": 1090.187708639426, "system_level_velocity_min": 10.55968284365402, "cost2_mean": -145.43812202387488}}
{"policy_reward_mean": {}, "time_this_iter_s": 35.50408434867859, "episode_reward_max": 1125.2054476782025, "episodes_this_iter": 52, "episode_reward_mean": 874.8806394149588, "timesteps_total": 5175196, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 5175196, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 114852, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e5c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e5f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e4e0>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 43, "done": false, "info": {"update_time_ms": 11.876, "default": {"entropy": 1.0170072317123413, "vf_explained_var": 0.6773380041122437, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0017205268377438188, "cur_lr": 0.0005000000237487257, "total_loss": 28.142948150634766, "kl": 0.012225614860653877, "vf_loss": 28.14459228515625}, "num_steps_sampled": 5175196, "load_time_ms": 22.109, "num_steps_trained": 5175196, "sample_time_ms": 15164.351, "grad_time_ms": 22574.817}, "training_iteration": 43, "date": "2019-04-28_02-54-09", "episodes_total": 2149, "timestamp": 1556420049, "time_total_s": 1724.7136361598969, "episode_len_mean": 700.0, "episode_reward_min": 790.7662011302108, "time_since_restore": 1724.7136361598969, "custom_metrics": {"cost2_max": -130.1654901823103, "system_level_velocity_mean": 12.965199855765691, "cost1_max": 436.3735414265193, "cost1_min": 271.8251085245134, "outflow_rate_max": 1251.2495054765227, "cost1_mean": 337.443848656734, "outflow_rate_min": 937.7809446506384, "cost2_min": -174.94266704462527, "system_level_velocity_max": 16.319904752478042, "outflow_rate_mean": 1092.0396486191303, "system_level_velocity_min": 10.612135422113205, "cost2_mean": -145.32001331933557}}
{"policy_reward_mean": {}, "time_this_iter_s": 38.023951053619385, "episode_reward_max": 1125.2054476782025, "episodes_this_iter": 51, "episode_reward_mean": 867.9546353541515, "timesteps_total": 5291076, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 5291076, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 115880, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a882b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a882e8>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 44, "done": false, "info": {"update_time_ms": 11.746, "default": {"entropy": 1.0196057558059692, "vf_explained_var": 0.6794207096099854, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0009673399035818875, "cur_lr": 0.0005000000237487257, "total_loss": 28.712238311767578, "kl": 0.01248790230602026, "vf_loss": 28.71312713623047}, "num_steps_sampled": 5291076, "load_time_ms": 21.621, "num_steps_trained": 5291076, "sample_time_ms": 15177.492, "grad_time_ms": 22338.296}, "training_iteration": 44, "date": "2019-04-28_02-54-47", "episodes_total": 2200, "timestamp": 1556420087, "time_total_s": 1762.7375872135162, "episode_len_mean": 693.35, "episode_reward_min": 50.84688230855995, "time_since_restore": 1762.7375872135162, "custom_metrics": {"cost2_max": -23.882664755088456, "system_level_velocity_mean": 13.13790038774378, "cost1_max": 436.3735414265193, "cost1_min": 22.93485492498682, "outflow_rate_max": 1251.2495054765227, "cost1_mean": 337.3369686974027, "outflow_rate_min": 467.21399731799954, "cost2_min": -178.73580274068706, "system_level_velocity_max": 18.393264405317836, "outflow_rate_mean": 1091.5451457601382, "system_level_velocity_min": 10.70697851832634, "cost2_mean": -146.47019406585687}}
{"policy_reward_mean": {}, "time_this_iter_s": 38.06548523902893, "episode_reward_max": 1004.244521692865, "episodes_this_iter": 52, "episode_reward_mean": 858.6982714745878, "timesteps_total": 5408057, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 5408057, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 116981, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ecf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a68a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e470>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 45, "done": false, "info": {"update_time_ms": 11.599, "default": {"entropy": 1.0099411010742188, "vf_explained_var": 0.6843248605728149, "cur_kl_coeff": 0.006250000558793545, "policy_loss": -0.0009396569803357124, "cur_lr": 0.0005000000237487257, "total_loss": 25.967195510864258, "kl": 0.01133120059967041, "vf_loss": 25.96806526184082}, "num_steps_sampled": 5408057, "load_time_ms": 21.604, "num_steps_trained": 5408057, "sample_time_ms": 15185.533, "grad_time_ms": 22425.162}, "training_iteration": 45, "date": "2019-04-28_02-55-25", "episodes_total": 2252, "timestamp": 1556420125, "time_total_s": 1800.8030724525452, "episode_len_mean": 693.35, "episode_reward_min": 50.84688230855995, "time_since_restore": 1800.8030724525452, "custom_metrics": {"cost2_max": -23.882664755088456, "system_level_velocity_mean": 12.976898035012828, "cost1_max": 415.77766410558013, "cost1_min": 22.93485492498682, "outflow_rate_max": 1231.3142600808958, "cost1_mean": 332.7768668649931, "outflow_rate_min": 467.21399731799954, "cost2_min": -186.63226258837364, "system_level_velocity_max": 18.393264405317836, "outflow_rate_mean": 1080.4838282339501, "system_level_velocity_min": 10.584769456844423, "cost2_mean": -149.14114515661342}}
{"policy_reward_mean": {}, "time_this_iter_s": 38.70618796348572, "episode_reward_max": 994.1732813603536, "episodes_this_iter": 48, "episode_reward_mean": 861.0306042871221, "timesteps_total": 5524345, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 5524345, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 116288, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a880f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a882b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88048>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 46, "done": false, "info": {"update_time_ms": 11.7, "default": {"entropy": 1.0013376474380493, "vf_explained_var": 0.7219141721725464, "cur_kl_coeff": 0.006250001490116119, "policy_loss": -0.0013097244082018733, "cur_lr": 0.0005000000237487257, "total_loss": 25.834827423095703, "kl": 0.01122681051492691, "vf_loss": 25.83606719970703}, "num_steps_sampled": 5524345, "load_time_ms": 21.833, "num_steps_trained": 5524345, "sample_time_ms": 15230.423, "grad_time_ms": 22435.858}, "training_iteration": 46, "date": "2019-04-28_02-56-04", "episodes_total": 2300, "timestamp": 1556420164, "time_total_s": 1839.5092604160309, "episode_len_mean": 700.0, "episode_reward_min": 754.7770295218102, "time_since_restore": 1839.5092604160309, "custom_metrics": {"cost2_max": -130.37216693945848, "system_level_velocity_mean": 12.736937013179473, "cost1_max": 411.0323102557801, "cost1_min": 255.74921906756242, "outflow_rate_max": 1223.5514363455447, "cost1_mean": 331.282610038207, "outflow_rate_min": 919.2616876787287, "cost2_min": -186.63226258837364, "system_level_velocity_max": 15.565398172634595, "outflow_rate_mean": 1076.2874210167072, "system_level_velocity_min": 9.844276377901314, "cost2_mean": -153.45992328755005}}
{"policy_reward_mean": {}, "time_this_iter_s": 38.223387002944946, "episode_reward_max": 998.6169033769187, "episodes_this_iter": 58, "episode_reward_mean": 849.6740111048653, "timesteps_total": 5640947, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 5640947, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 116602, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77780>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 47, "done": false, "info": {"update_time_ms": 11.508, "default": {"entropy": 1.0075193643569946, "vf_explained_var": 0.7097703814506531, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0014283494092524052, "cur_lr": 0.0005000000237487257, "total_loss": 29.04249382019043, "kl": 0.011627244763076305, "vf_loss": 29.043848037719727}, "num_steps_sampled": 5640947, "load_time_ms": 21.416, "num_steps_trained": 5640947, "sample_time_ms": 15202.29, "grad_time_ms": 22283.695}, "training_iteration": 47, "date": "2019-04-28_02-56-42", "episodes_total": 2358, "timestamp": 1556420202, "time_total_s": 1877.7326474189758, "episode_len_mean": 686.72, "episode_reward_min": 50.062746966107504, "time_since_restore": 1877.7326474189758, "custom_metrics": {"cost2_max": -22.381456170623807, "system_level_velocity_mean": 12.935919804526108, "cost1_max": 414.92716942986794, "cost1_min": 22.860812803620103, "outflow_rate_max": 1231.9989297028728, "cost1_mean": 327.95249394310156, "outflow_rate_min": 468.8485586228365, "cost2_min": -197.18304682340988, "system_level_velocity_max": 18.442068713697758, "outflow_rate_mean": 1071.2946230383466, "system_level_velocity_min": 9.844276377901314, "cost2_mean": -153.84641363321794}}
{"policy_reward_mean": {}, "time_this_iter_s": 39.89024353027344, "episode_reward_max": 1122.5277156381433, "episodes_this_iter": 48, "episode_reward_mean": 845.5280814117161, "timesteps_total": 5757135, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 5757135, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 116188, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a882b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a880f0>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 48, "done": false, "info": {"update_time_ms": 11.554, "default": {"entropy": 1.0015476942062378, "vf_explained_var": 0.7357635498046875, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.00103205896448344, "cur_lr": 0.0005000000237487257, "total_loss": 27.96273422241211, "kl": 0.011804467998445034, "vf_loss": 27.96368980407715}, "num_steps_sampled": 5757135, "load_time_ms": 21.384, "num_steps_trained": 5757135, "sample_time_ms": 15241.243, "grad_time_ms": 22294.05}, "training_iteration": 48, "date": "2019-04-28_02-57-22", "episodes_total": 2406, "timestamp": 1556420242, "time_total_s": 1917.6228909492493, "episode_len_mean": 673.34, "episode_reward_min": 38.19528706329585, "time_since_restore": 1917.6228909492493, "custom_metrics": {"cost2_max": -18.220889508549607, "system_level_velocity_mean": 13.299312150640944, "cost1_max": 449.9338194094931, "cost1_min": 17.939429004670554, "outflow_rate_max": 1274.7096232091994, "cost1_mean": 328.89133446449074, "outflow_rate_min": 468.8485586228365, "cost2_min": -197.18304682340988, "system_level_velocity_max": 18.473149214581014, "outflow_rate_mean": 1074.9962540364659, "system_level_velocity_min": 10.124395639761294, "cost2_mean": -150.74259840846076}}
{"policy_reward_mean": {}, "time_this_iter_s": 40.382495641708374, "episode_reward_max": 1122.5277156381433, "episodes_this_iter": 59, "episode_reward_mean": 856.7546988815487, "timesteps_total": 5872143, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 5872143, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 115008, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77e80>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 49, "done": false, "info": {"update_time_ms": 11.562, "default": {"entropy": 0.9878569841384888, "vf_explained_var": 0.7262241840362549, "cur_kl_coeff": 0.006250001490116119, "policy_loss": -0.0009653368033468723, "cur_lr": 0.0005000000237487257, "total_loss": 33.26045608520508, "kl": 0.01238609291613102, "vf_loss": 33.26134490966797}, "num_steps_sampled": 5872143, "load_time_ms": 21.985, "num_steps_trained": 5872143, "sample_time_ms": 15322.419, "grad_time_ms": 22419.163}, "training_iteration": 49, "date": "2019-04-28_02-58-03", "episodes_total": 2465, "timestamp": 1556420283, "time_total_s": 1958.0053865909576, "episode_len_mean": 679.97, "episode_reward_min": 38.19528706329585, "time_since_restore": 1958.0053865909576, "custom_metrics": {"cost2_max": -18.220889508549607, "system_level_velocity_mean": 13.45447341687367, "cost1_max": 449.9338194094931, "cost1_min": 17.939429004670554, "outflow_rate_max": 1274.7096232091994, "cost1_mean": 336.38882560594453, "outflow_rate_min": 473.20973104725, "cost2_min": -191.77112194976604, "system_level_velocity_max": 18.5484261354765, "outflow_rate_mean": 1092.419846161952, "system_level_velocity_min": 9.778708319992127, "cost2_mean": -148.9082146434186}}
{"policy_reward_mean": {}, "time_this_iter_s": 40.9352080821991, "episode_reward_max": 1124.4579505453369, "episodes_this_iter": 54, "episode_reward_mean": 867.1499786251902, "timesteps_total": 5986736, "num_metric_batches_dropped": 0, "node_ip": "10.138.0.2", "timesteps_since_restore": 5986736, "pid": 28190, "experiment_id": "f0c49533503f4d47a33625199ce0ccab", "timesteps_this_iter": 114593, "config": {"lr_schedule": null, "train_batch_size": 90000, "clip_actions": false, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88cf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a884e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a88240>", "on_train_result": null, "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"fcnet_activation": "tanh", "channel_major": false, "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 50, "done": true, "info": {"update_time_ms": 10.784, "default": {"entropy": 0.9844366312026978, "vf_explained_var": 0.7016839385032654, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0017761761555448174, "cur_lr": 0.0005000000237487257, "total_loss": 35.09609603881836, "kl": 0.010571127757430077, "vf_loss": 35.09780502319336}, "num_steps_sampled": 5986736, "load_time_ms": 22.193, "num_steps_trained": 5986736, "sample_time_ms": 15358.558, "grad_time_ms": 22901.52}, "training_iteration": 50, "date": "2019-04-28_02-58-44", "episodes_total": 2519, "timestamp": 1556420324, "time_total_s": 1998.9405946731567, "episode_len_mean": 686.73, "episode_reward_min": 47.09210847990602, "time_since_restore": 1998.9405946731567, "custom_metrics": {"cost2_max": -22.015258470288003, "system_level_velocity_mean": 13.46044038373613, "cost1_max": 453.5088733831752, "cost1_min": 22.99558006029194, "outflow_rate_max": 1278.7646125994017, "cost1_mean": 340.15723595672955, "outflow_rate_min": 491.69632701915526, "cost2_min": -181.40219005685407, "system_level_velocity_max": 18.5484261354765, "outflow_rate_mean": 1099.0424298706407, "system_level_velocity_min": 10.544060389828568, "cost2_mean": -149.62619330730607}}

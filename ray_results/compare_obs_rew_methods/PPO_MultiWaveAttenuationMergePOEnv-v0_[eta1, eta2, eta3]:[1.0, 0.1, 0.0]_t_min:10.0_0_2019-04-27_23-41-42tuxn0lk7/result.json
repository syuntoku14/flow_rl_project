{"episode_reward_min": 187.9043727063967, "policy_reward_mean": {}, "time_this_iter_s": 55.88007926940918, "num_metric_batches_dropped": 0, "episodes_this_iter": 18, "episode_reward_mean": 252.40327800831633, "episode_reward_max": 395.0652296253301, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ab06a0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ab06d8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ab0710>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 119749, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 55.88007926940918, "pid": 33400, "iterations_since_restore": 1, "done": false, "info": {"update_time_ms": 1294.734, "default": {"entropy": 1.4186972379684448, "vf_explained_var": 0.8778775334358215, "cur_kl_coeff": 0.20000003278255463, "policy_loss": -0.0003638273919932544, "cur_lr": 0.0005000000237487257, "total_loss": 1.2015016078948975, "kl": 0.0010272085200995207, "vf_loss": 1.20166015625}, "num_steps_sampled": 119749, "load_time_ms": 45.005, "num_steps_trained": 119749, "sample_time_ms": 32074.658, "grad_time_ms": 22202.724}, "timesteps_total": 119749, "training_iteration": 1, "episode_len_mean": 700.0, "episodes_total": 18, "timestamp": 1556408583, "hostname": "flow-main", "date": "2019-04-27_23-43-03", "timesteps_since_restore": 119749, "time_since_restore": 55.88007926940918, "custom_metrics": {"cost2_max": -29.66596991377465, "system_level_velocity_mean": 7.726879533955044, "outflow_rate_mean": 604.2392227449428, "cost1_min": 172.4665948609167, "outflow_rate_min": 533.685928402251, "cost1_mean": 198.89033774264857, "cost1_max": 240.6424129602792, "cost2_min": -63.69907134020145, "system_level_velocity_max": 9.10688516878882, "outflow_rate_max": 787.653225643471, "system_level_velocity_min": 6.710525609737673, "cost2_mean": -49.23307116043228}}
{"episode_reward_min": 187.9043727063967, "policy_reward_mean": {}, "time_this_iter_s": 39.62970519065857, "num_metric_batches_dropped": 0, "episodes_this_iter": 60, "episode_reward_mean": 279.7649227551552, "episode_reward_max": 395.0652296253301, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ab0cf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ab0b00>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc048>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 120390, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 95.50978446006775, "pid": 33400, "iterations_since_restore": 2, "done": false, "info": {"update_time_ms": 652.716, "default": {"entropy": 1.4168678522109985, "vf_explained_var": 0.9135810136795044, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0038232929073274136, "cur_lr": 0.0005000000237487257, "total_loss": 1.2867215871810913, "kl": 0.009299450553953648, "vf_loss": 1.2896149158477783}, "num_steps_sampled": 240139, "load_time_ms": 26.336, "num_steps_trained": 240139, "sample_time_ms": 23960.618, "grad_time_ms": 22878.975}, "timesteps_total": 240139, "training_iteration": 2, "episode_len_mean": 700.0, "episodes_total": 78, "timestamp": 1556408622, "hostname": "flow-main", "date": "2019-04-27_23-43-42", "timesteps_since_restore": 240139, "time_since_restore": 95.50978446006775, "custom_metrics": {"cost2_max": -29.66596991377465, "system_level_velocity_mean": 7.714259568465124, "outflow_rate_mean": 610.9240164220059, "cost1_min": 159.38054934248174, "outflow_rate_min": 390.60658658344767, "cost1_mean": 199.4039835235244, "cost1_max": 258.5975554650993, "cost2_min": -98.79471879419431, "system_level_velocity_max": 10.064380817622554, "outflow_rate_max": 787.653225643471, "system_level_velocity_min": 6.2001190733729885, "cost2_mean": -55.41074292838826}}
{"episode_reward_min": 47.258802281456866, "policy_reward_mean": {}, "time_this_iter_s": 37.184382915496826, "num_metric_batches_dropped": 0, "episodes_this_iter": 53, "episode_reward_mean": 317.86527638548273, "episode_reward_max": 592.2883890433895, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc9b0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc9e8>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 117647, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 132.69416737556458, "pid": 33400, "iterations_since_restore": 3, "done": false, "info": {"update_time_ms": 439.305, "default": {"entropy": 1.4078269004821777, "vf_explained_var": 0.8860408663749695, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.003738562110811472, "cur_lr": 0.0005000000237487257, "total_loss": 4.433305740356445, "kl": 0.007544321473687887, "vf_loss": 4.4362897872924805}, "num_steps_sampled": 357786, "load_time_ms": 20.169, "num_steps_trained": 357786, "sample_time_ms": 20826.219, "grad_time_ms": 22715.727}, "timesteps_total": 357786, "training_iteration": 3, "episode_len_mean": 693.35, "episodes_total": 131, "timestamp": 1556408660, "hostname": "flow-main", "date": "2019-04-27_23-44-20", "timesteps_since_restore": 357786, "time_since_restore": 132.69416737556458, "custom_metrics": {"cost2_max": -20.518028783265077, "system_level_velocity_mean": 8.126613949630144, "outflow_rate_mean": 632.8421173350292, "cost1_min": 22.89173538960253, "outflow_rate_min": 390.60658658344767, "cost1_mean": 206.23263370276447, "cost1_max": 319.212811188517, "cost2_min": -98.79471879419431, "system_level_velocity_max": 18.453810018620153, "outflow_rate_max": 970.3197861657136, "system_level_velocity_min": 6.2001190733729885, "cost2_mean": -57.20091843862846}}
{"episode_reward_min": 44.61442558440023, "policy_reward_mean": {}, "time_this_iter_s": 38.53354573249817, "num_metric_batches_dropped": 0, "episodes_this_iter": 59, "episode_reward_mean": 496.4043021361548, "episode_reward_max": 785.5271848326655, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ab0b70>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ab0cc0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ab0a90>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 119611, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 171.22771310806274, "pid": 33400, "iterations_since_restore": 4, "done": false, "info": {"update_time_ms": 331.78, "default": {"entropy": 1.391249418258667, "vf_explained_var": 0.8004846572875977, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0024211853742599487, "cur_lr": 0.0005000000237487257, "total_loss": 9.498927116394043, "kl": 0.005666148848831654, "vf_loss": 9.500781059265137}, "num_steps_sampled": 477397, "load_time_ms": 16.914, "num_steps_trained": 477397, "sample_time_ms": 19416.485, "grad_time_ms": 22810.919}, "timesteps_total": 477397, "training_iteration": 4, "episode_len_mean": 693.35, "episodes_total": 190, "timestamp": 1556408698, "hostname": "flow-main", "date": "2019-04-27_23-44-58", "timesteps_since_restore": 477397, "time_since_restore": 171.22771310806274, "custom_metrics": {"cost2_max": -21.757464146737277, "system_level_velocity_mean": 9.780935432876076, "outflow_rate_mean": 789.1067985810951, "cost1_min": 22.728891101960386, "outflow_rate_min": 511.17688865063195, "cost1_mean": 252.08246875369036, "cost1_max": 337.62047881469925, "cost2_min": -134.68479640127725, "system_level_velocity_max": 18.387605904875503, "outflow_rate_max": 1026.2790715374608, "system_level_velocity_min": 6.532052195413406, "cost2_mean": -82.43645152334433}}
{"episode_reward_min": 44.61442558440023, "policy_reward_mean": {}, "time_this_iter_s": 37.07921648025513, "num_metric_batches_dropped": 0, "episodes_this_iter": 51, "episode_reward_mean": 641.5146568026689, "episode_reward_max": 828.7223100943735, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863accc88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc8d0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc710>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 121834, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 208.30692958831787, "pid": 33400, "iterations_since_restore": 5, "done": false, "info": {"update_time_ms": 267.52, "default": {"entropy": 1.3916077613830566, "vf_explained_var": 0.7611616253852844, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0015513771213591099, "cur_lr": 0.0005000000237487257, "total_loss": 11.636219024658203, "kl": 0.0046035293489694595, "vf_loss": 11.637310028076172}, "num_steps_sampled": 599231, "load_time_ms": 15.14, "num_steps_trained": 599231, "sample_time_ms": 18559.562, "grad_time_ms": 22586.895}, "timesteps_total": 599231, "training_iteration": 5, "episode_len_mean": 693.35, "episodes_total": 241, "timestamp": 1556408735, "hostname": "flow-main", "date": "2019-04-27_23-45-35", "timesteps_since_restore": 599231, "time_since_restore": 208.30692958831787, "custom_metrics": {"cost2_max": -21.757464146737277, "system_level_velocity_mean": 11.10307891502154, "outflow_rate_mean": 931.7684602925206, "cost1_min": 22.728891101960386, "outflow_rate_min": 511.17688865063195, "cost1_mean": 288.9130499340464, "cost1_max": 360.09310745345846, "cost2_min": -175.61167785640725, "system_level_velocity_max": 18.387605904875503, "outflow_rate_max": 1085.7722494173825, "system_level_velocity_min": 8.21846652524182, "cost2_mean": -111.35449397105194}}
{"episode_reward_min": 402.53183233888626, "policy_reward_mean": {}, "time_this_iter_s": 38.600425481796265, "num_metric_batches_dropped": 0, "episodes_this_iter": 39, "episode_reward_mean": 676.5182492861925, "episode_reward_max": 828.7223100943735, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc2e8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f78d9c4ec18>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 123635, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 246.90735507011414, "pid": 33400, "iterations_since_restore": 6, "done": false, "info": {"update_time_ms": 225.296, "default": {"entropy": 1.385667085647583, "vf_explained_var": 0.7852998971939087, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0011785108363255858, "cur_lr": 0.0005000000237487257, "total_loss": 10.798650741577148, "kl": 0.006049275863915682, "vf_loss": 10.799527168273926}, "num_steps_sampled": 722866, "load_time_ms": 13.556, "num_steps_trained": 722866, "sample_time_ms": 17870.127, "grad_time_ms": 22811.44}, "timesteps_total": 722866, "training_iteration": 6, "episode_len_mean": 700.0, "episodes_total": 280, "timestamp": 1556408774, "hostname": "flow-main", "date": "2019-04-27_23-46-14", "timesteps_since_restore": 722866, "time_since_restore": 246.90735507011414, "custom_metrics": {"cost2_max": -64.83700607504338, "system_level_velocity_mean": 11.336705912841897, "outflow_rate_mean": 976.8066913675814, "cost1_min": 224.02015139451626, "outflow_rate_min": 696.9262842648099, "cost1_mean": 299.6484906358309, "cost1_max": 360.09310745345846, "cost2_min": -175.61167785640725, "system_level_velocity_max": 13.607435117775461, "outflow_rate_max": 1090.3756515430352, "system_level_velocity_min": 8.675898723664432, "cost2_mean": -121.85839103450819}}
{"episode_reward_min": 49.5995324282527, "policy_reward_mean": {}, "time_this_iter_s": 38.96976613998413, "num_metric_batches_dropped": 0, "episodes_this_iter": 58, "episode_reward_mean": 680.3404190233738, "episode_reward_max": 828.7223100943735, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc908>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc2b0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc160>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 123932, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 285.87712121009827, "pid": 33400, "iterations_since_restore": 7, "done": false, "info": {"update_time_ms": 194.761, "default": {"entropy": 1.3727701902389526, "vf_explained_var": 0.692973792552948, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0005440388922579587, "cur_lr": 0.0005000000237487257, "total_loss": 14.243706703186035, "kl": 0.004270695615559816, "vf_loss": 14.244037628173828}, "num_steps_sampled": 846798, "load_time_ms": 12.582, "num_steps_trained": 846798, "sample_time_ms": 17418.144, "grad_time_ms": 22983.735}, "timesteps_total": 846798, "training_iteration": 7, "episode_len_mean": 693.35, "episodes_total": 338, "timestamp": 1556408813, "hostname": "flow-main", "date": "2019-04-27_23-46-53", "timesteps_since_restore": 846798, "time_since_restore": 285.87712121009827, "custom_metrics": {"cost2_max": -20.39582953337872, "system_level_velocity_mean": 11.550887591330184, "outflow_rate_mean": 1002.9467562105441, "cost1_min": 22.590269312470713, "outflow_rate_min": 484.21082740815524, "cost1_mean": 300.3774648736687, "cost1_max": 365.1296160220751, "cost2_min": -160.3536294170641, "system_level_velocity_max": 18.12046462685875, "outflow_rate_max": 1154.9867572365367, "system_level_velocity_min": 8.979988505487341, "cost2_mean": -131.97726503213767}}
{"episode_reward_min": 49.5995324282527, "policy_reward_mean": {}, "time_this_iter_s": 39.27124881744385, "num_metric_batches_dropped": 0, "episodes_this_iter": 34, "episode_reward_mean": 691.2581938769135, "episode_reward_max": 849.4220813296379, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc0f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc048>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc320>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 123512, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 325.1483700275421, "pid": 33400, "iterations_since_restore": 8, "done": false, "info": {"update_time_ms": 171.823, "default": {"entropy": 1.3617894649505615, "vf_explained_var": 0.7369453310966492, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0011137399123981595, "cur_lr": 0.0005000000237487257, "total_loss": 12.560129165649414, "kl": 0.005510432180017233, "vf_loss": 12.561104774475098}, "num_steps_sampled": 970310, "load_time_ms": 12.153, "num_steps_trained": 970310, "sample_time_ms": 17053.673, "grad_time_ms": 23173.271}, "timesteps_total": 970310, "training_iteration": 8, "episode_len_mean": 693.35, "episodes_total": 372, "timestamp": 1556408852, "hostname": "flow-main", "date": "2019-04-27_23-47-32", "timesteps_since_restore": 970310, "time_since_restore": 325.1483700275421, "custom_metrics": {"cost2_max": -20.39582953337872, "system_level_velocity_mean": 11.65867755110917, "outflow_rate_mean": 1016.882389127586, "cost1_min": 22.590269312470713, "outflow_rate_min": 484.21082740815524, "cost1_mean": 303.50003724386187, "cost1_max": 377.1836505201559, "cost2_min": -168.23834955585102, "system_level_velocity_max": 18.12046462685875, "outflow_rate_max": 1169.6194843220546, "system_level_velocity_min": 9.006412429781728, "cost2_mean": -137.23484211116607}}
{"episode_reward_min": 587.0290645409066, "policy_reward_mean": {}, "time_this_iter_s": 39.85616612434387, "num_metric_batches_dropped": 0, "episodes_this_iter": 58, "episode_reward_mean": 709.5112252851184, "episode_reward_max": 857.4622319825588, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc358>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acccc0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863accb38>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 123225, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 365.004536151886, "pid": 33400, "iterations_since_restore": 9, "done": false, "info": {"update_time_ms": 153.957, "default": {"entropy": 1.3675227165222168, "vf_explained_var": 0.6541126370429993, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0009477443527430296, "cur_lr": 0.0005000000237487257, "total_loss": 15.146797180175781, "kl": 0.005062921438366175, "vf_loss": 15.147619247436523}, "num_steps_sampled": 1093535, "load_time_ms": 11.571, "num_steps_trained": 1093535, "sample_time_ms": 16772.97, "grad_time_ms": 23388.663}, "timesteps_total": 1093535, "training_iteration": 9, "episode_len_mean": 700.0, "episodes_total": 430, "timestamp": 1556408892, "hostname": "flow-main", "date": "2019-04-27_23-48-12", "timesteps_since_restore": 1093535, "time_since_restore": 365.004536151886, "custom_metrics": {"cost2_max": -119.61303259820723, "system_level_velocity_mean": 11.714453624556507, "outflow_rate_mean": 1033.1487939261685, "cost1_min": 228.98477877789475, "outflow_rate_min": 826.7450926504537, "cost1_mean": 309.3567877970724, "cost1_max": 377.1836505201559, "cost2_min": -170.74212984141093, "system_level_velocity_max": 14.198764112776262, "outflow_rate_max": 1169.6194843220546, "system_level_velocity_min": 8.756576172241894, "cost2_mean": -144.15042727194705}}
{"episode_reward_min": 605.326775370621, "policy_reward_mean": {}, "time_this_iter_s": 39.35903739929199, "num_metric_batches_dropped": 0, "episodes_this_iter": 52, "episode_reward_mean": 712.5369110531578, "episode_reward_max": 787.5664245880405, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc668>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc630>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 123028, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 404.363573551178, "pid": 33400, "iterations_since_restore": 10, "done": false, "info": {"update_time_ms": 139.835, "default": {"entropy": 1.3639425039291382, "vf_explained_var": 0.6267418265342712, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.00075177988037467, "cur_lr": 0.0005000000237487257, "total_loss": 15.695747375488281, "kl": 0.005113798659294844, "vf_loss": 15.696371078491211}, "num_steps_sampled": 1216563, "load_time_ms": 11.316, "num_steps_trained": 1216563, "sample_time_ms": 16588.519, "grad_time_ms": 23469.411}, "timesteps_total": 1216563, "training_iteration": 10, "episode_len_mean": 700.0, "episodes_total": 482, "timestamp": 1556408931, "hostname": "flow-main", "date": "2019-04-27_23-48-51", "timesteps_since_restore": 1216563, "time_since_restore": 404.363573551178, "custom_metrics": {"cost2_max": -119.61303259820723, "system_level_velocity_mean": 11.714871631068476, "outflow_rate_mean": 1037.2808116209644, "cost1_min": 240.33137797947865, "outflow_rate_min": 848.0598615600317, "cost1_mean": 309.3540221968088, "cost1_max": 363.1361038082707, "cost2_min": -176.3276542530137, "system_level_velocity_max": 13.614014064238644, "outflow_rate_max": 1164.2870982099473, "system_level_velocity_min": 9.14988374251117, "cost2_mean": -150.46665248636396}}
{"episode_reward_min": 605.326775370621, "policy_reward_mean": {}, "time_this_iter_s": 37.172860860824585, "num_metric_batches_dropped": 0, "episodes_this_iter": 46, "episode_reward_mean": 714.8571099666026, "episode_reward_max": 802.9998138628401, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acccf8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863accb38>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 119993, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 441.53643441200256, "pid": 33400, "iterations_since_restore": 11, "done": false, "info": {"update_time_ms": 11.571, "default": {"entropy": 1.347887635231018, "vf_explained_var": 0.647064745426178, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -6.211503932718188e-05, "cur_lr": 0.0005000000237487257, "total_loss": 15.582383155822754, "kl": 0.004379113670438528, "vf_loss": 15.582335472106934}, "num_steps_sampled": 1336556, "load_time_ms": 7.549, "num_steps_trained": 1336556, "sample_time_ms": 14856.906, "grad_time_ms": 23466.156}, "timesteps_total": 1336556, "training_iteration": 11, "episode_len_mean": 700.0, "episodes_total": 528, "timestamp": 1556408969, "hostname": "flow-main", "date": "2019-04-27_23-49-29", "timesteps_since_restore": 1336556, "time_since_restore": 441.53643441200256, "custom_metrics": {"cost2_max": -124.1598726173941, "system_level_velocity_mean": 11.605548465735042, "outflow_rate_mean": 1032.0660695242757, "cost1_min": 243.76326006773567, "outflow_rate_min": 861.9807574018116, "cost1_mean": 306.206588318691, "cost1_max": 350.500597771304, "cost2_min": -182.08926718449598, "system_level_velocity_max": 13.166146404860328, "outflow_rate_max": 1152.3936436870877, "system_level_velocity_min": 9.47466276058363, "cost2_mean": -157.67206455060395}}
{"episode_reward_min": 611.2011561506628, "policy_reward_mean": {}, "time_this_iter_s": 38.60366153717041, "num_metric_batches_dropped": 0, "episodes_this_iter": 60, "episode_reward_mean": 721.3786775696333, "episode_reward_max": 815.3765848300262, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863adaa90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc9e8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acceb8>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 122409, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 480.140095949173, "pid": 33400, "iterations_since_restore": 12, "done": false, "info": {"update_time_ms": 11.657, "default": {"entropy": 1.3415731191635132, "vf_explained_var": 0.5395740866661072, "cur_kl_coeff": 0.012500002980232239, "policy_loss": -4.6922072215238586e-05, "cur_lr": 0.0005000000237487257, "total_loss": 17.859933853149414, "kl": 0.004054464865475893, "vf_loss": 17.85993003845215}, "num_steps_sampled": 1458965, "load_time_ms": 7.363, "num_steps_trained": 1458965, "sample_time_ms": 14779.871, "grad_time_ms": 23439.468}, "timesteps_total": 1458965, "training_iteration": 12, "episode_len_mean": 700.0, "episodes_total": 588, "timestamp": 1556409007, "hostname": "flow-main", "date": "2019-04-27_23-50-07", "timesteps_since_restore": 1458965, "time_since_restore": 480.140095949173, "custom_metrics": {"cost2_max": -138.84633684351846, "system_level_velocity_mean": 11.691472511005005, "outflow_rate_mean": 1039.941912343362, "cost1_min": 243.76326006773567, "outflow_rate_min": 877.6469661273323, "cost1_mean": 308.49515919990273, "cost1_max": 350.500597771304, "cost2_min": -182.1216967358501, "system_level_velocity_max": 13.166146404860328, "outflow_rate_max": 1139.59775741787, "system_level_velocity_min": 9.487676524659763, "cost2_mean": -161.42576135036055}}
{"episode_reward_min": 612.2784687985783, "policy_reward_mean": {}, "time_this_iter_s": 37.168412923812866, "num_metric_batches_dropped": 0, "episodes_this_iter": 30, "episode_reward_mean": 721.5884652035754, "episode_reward_max": 821.9394435400111, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acccf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc518>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc9b0>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 122605, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 517.3085088729858, "pid": 33400, "iterations_since_restore": 13, "done": false, "info": {"update_time_ms": 11.362, "default": {"entropy": 1.3408344984054565, "vf_explained_var": 0.6599267721176147, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.00029205105965957046, "cur_lr": 0.0005000000237487257, "total_loss": 13.957514762878418, "kl": 0.005482273176312447, "vf_loss": 13.957772254943848}, "num_steps_sampled": 1581570, "load_time_ms": 6.995, "num_steps_trained": 1581570, "sample_time_ms": 14757.831, "grad_time_ms": 23459.964}, "timesteps_total": 1581570, "training_iteration": 13, "episode_len_mean": 700.0, "episodes_total": 618, "timestamp": 1556409045, "hostname": "flow-main", "date": "2019-04-27_23-50-45", "timesteps_since_restore": 1581570, "time_since_restore": 517.3085088729858, "custom_metrics": {"cost2_max": -138.84633684351846, "system_level_velocity_mean": 11.678915713818443, "outflow_rate_mean": 1040.991938629944, "cost1_min": 251.75744812410386, "outflow_rate_min": 904.1522712596585, "cost1_mean": 308.47103279650435, "cost1_max": 345.590621668617, "cost2_min": -194.2129530187546, "system_level_velocity_max": 12.96049737457091, "outflow_rate_max": 1134.517831980913, "system_level_velocity_min": 9.71265644729561, "cost2_mean": -163.01007540383893}}
{"episode_reward_min": 648.6910474632931, "policy_reward_mean": {}, "time_this_iter_s": 37.78692650794983, "num_metric_batches_dropped": 0, "episodes_this_iter": 56, "episode_reward_mean": 722.8926053322936, "episode_reward_max": 821.9394435400111, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc6d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc198>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863accfd0>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 125254, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 555.0954353809357, "pid": 33400, "iterations_since_restore": 14, "done": false, "info": {"update_time_ms": 11.473, "default": {"entropy": 1.3355820178985596, "vf_explained_var": 0.5875058174133301, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.000746562669519335, "cur_lr": 0.0005000000237487257, "total_loss": 17.829818725585938, "kl": 0.007169716525822878, "vf_loss": 17.830520629882812}, "num_steps_sampled": 1706824, "load_time_ms": 6.826, "num_steps_trained": 1706824, "sample_time_ms": 14711.586, "grad_time_ms": 23431.739}, "timesteps_total": 1706824, "training_iteration": 14, "episode_len_mean": 700.0, "episodes_total": 674, "timestamp": 1556409082, "hostname": "flow-main", "date": "2019-04-27_23-51-22", "timesteps_since_restore": 1706824, "time_since_restore": 555.0954353809357, "custom_metrics": {"cost2_max": -139.4108346145903, "system_level_velocity_mean": 11.711446681431788, "outflow_rate_mean": 1043.7965130053876, "cost1_min": 261.8207149492606, "outflow_rate_min": 907.0574444448087, "cost1_mean": 309.2038849451443, "cost1_max": 359.8210934739486, "cost2_min": -194.2129530187546, "system_level_velocity_max": 13.526429044269863, "outflow_rate_max": 1161.0843393981572, "system_level_velocity_min": 10.0838723434138, "cost2_mean": -165.54777623960103}}
{"episode_reward_min": 584.6350001029479, "policy_reward_mean": {}, "time_this_iter_s": 38.883039236068726, "num_metric_batches_dropped": 0, "episodes_this_iter": 48, "episode_reward_mean": 713.0418175863874, "episode_reward_max": 798.7620774299899, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ab0b00>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ab0e80>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ab0fd0>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 124375, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 593.9784746170044, "pid": 33400, "iterations_since_restore": 15, "done": false, "info": {"update_time_ms": 11.65, "default": {"entropy": 1.334869623184204, "vf_explained_var": 0.6288836002349854, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.00021015455422457308, "cur_lr": 0.0005000000237487257, "total_loss": 17.14406394958496, "kl": 0.00601454172283411, "vf_loss": 17.144235610961914}, "num_steps_sampled": 1831199, "load_time_ms": 6.71, "num_steps_trained": 1831199, "sample_time_ms": 14714.704, "grad_time_ms": 23610.039}, "timesteps_total": 1831199, "training_iteration": 15, "episode_len_mean": 700.0, "episodes_total": 722, "timestamp": 1556409121, "hostname": "flow-main", "date": "2019-04-27_23-52-01", "timesteps_since_restore": 1831199, "time_since_restore": 593.9784746170044, "custom_metrics": {"cost2_max": -143.78201972986002, "system_level_velocity_mean": 11.549474584078368, "outflow_rate_mean": 1037.0319899301962, "cost1_min": 218.6245294064306, "outflow_rate_min": 850.1256335739812, "cost1_mean": 304.82424372354944, "cost1_max": 359.8210934739486, "cost2_min": -193.2133472516076, "system_level_velocity_max": 13.526429044269863, "outflow_rate_max": 1161.0843393981572, "system_level_velocity_min": 8.444854790522493, "cost2_mean": -165.67900898292564}}
{"episode_reward_min": 584.6350001029479, "policy_reward_mean": {}, "time_this_iter_s": 38.835676431655884, "num_metric_batches_dropped": 0, "episodes_this_iter": 50, "episode_reward_mean": 706.9692382491282, "episode_reward_max": 784.8224861308994, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc668>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863accfd0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc198>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 121828, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 632.8141510486603, "pid": 33400, "iterations_since_restore": 16, "done": false, "info": {"update_time_ms": 11.274, "default": {"entropy": 1.3320884704589844, "vf_explained_var": 0.639599084854126, "cur_kl_coeff": 0.006250001490116119, "policy_loss": -0.00046624845708720386, "cur_lr": 0.0005000000237487257, "total_loss": 18.558454513549805, "kl": 0.0054340241476893425, "vf_loss": 18.55888557434082}, "num_steps_sampled": 1953027, "load_time_ms": 6.635, "num_steps_trained": 1953027, "sample_time_ms": 14716.645, "grad_time_ms": 23611.357}, "timesteps_total": 1953027, "training_iteration": 16, "episode_len_mean": 700.0, "episodes_total": 772, "timestamp": 1556409160, "hostname": "flow-main", "date": "2019-04-27_23-52-40", "timesteps_since_restore": 1953027, "time_since_restore": 632.8141510486603, "custom_metrics": {"cost2_max": -140.9582397453774, "system_level_velocity_mean": 11.33529378424327, "outflow_rate_mean": 1022.1200753587423, "cost1_min": 218.6245294064306, "outflow_rate_min": 850.1256335739812, "cost1_mean": 299.2122032169123, "cost1_max": 333.48014572990337, "cost2_min": -193.651537321127, "system_level_velocity_max": 12.539684543230544, "outflow_rate_max": 1110.4747720964435, "system_level_velocity_min": 8.444854790522493, "cost2_mean": -163.77462771403583}}
{"episode_reward_min": 606.0028952262426, "policy_reward_mean": {}, "time_this_iter_s": 39.234434843063354, "num_metric_batches_dropped": 0, "episodes_this_iter": 60, "episode_reward_mean": 710.1316454503128, "episode_reward_max": 798.8668895143344, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ab0fd0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ab0e80>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ab0b00>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 123236, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 672.0485858917236, "pid": 33400, "iterations_since_restore": 17, "done": false, "info": {"update_time_ms": 12.197, "default": {"entropy": 1.3228633403778076, "vf_explained_var": 0.5921915173530579, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0007405549404211342, "cur_lr": 0.0005000000237487257, "total_loss": 21.307676315307617, "kl": 0.006688190158456564, "vf_loss": 21.308374404907227}, "num_steps_sampled": 2076263, "load_time_ms": 6.496, "num_steps_trained": 2076263, "sample_time_ms": 14819.65, "grad_time_ms": 23536.822}, "timesteps_total": 2076263, "training_iteration": 17, "episode_len_mean": 700.0, "episodes_total": 832, "timestamp": 1556409199, "hostname": "flow-main", "date": "2019-04-27_23-53-19", "timesteps_since_restore": 2076263, "time_since_restore": 672.0485858917236, "custom_metrics": {"cost2_max": -129.53153923910014, "system_level_velocity_mean": 11.304165083300834, "outflow_rate_mean": 1020.4969060845252, "cost1_min": 226.5622246944302, "outflow_rate_min": 868.1636482828001, "cost1_mean": 299.13479777869105, "cost1_max": 343.7738566530029, "cost2_min": -193.9692723437693, "system_level_velocity_max": 12.81778892140942, "outflow_rate_max": 1143.4622529781502, "system_level_velocity_min": 8.718998651252496, "cost2_mean": -162.50230639624888}}
{"episode_reward_min": 626.9328710627929, "policy_reward_mean": {}, "time_this_iter_s": 38.38666033744812, "num_metric_batches_dropped": 0, "episodes_this_iter": 34, "episode_reward_mean": 715.1342842432616, "episode_reward_max": 798.8668895143344, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863accfd0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc668>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc208>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 121757, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 710.4352462291718, "pid": 33400, "iterations_since_restore": 18, "done": false, "info": {"update_time_ms": 12.137, "default": {"entropy": 1.3011806011199951, "vf_explained_var": 0.6738138794898987, "cur_kl_coeff": 0.006250001490116119, "policy_loss": -0.00022508819529321045, "cur_lr": 0.0005000000237487257, "total_loss": 18.180492401123047, "kl": 0.005323690362274647, "vf_loss": 18.18068504333496}, "num_steps_sampled": 2198020, "load_time_ms": 6.112, "num_steps_trained": 2198020, "sample_time_ms": 14811.96, "grad_time_ms": 23459.237}, "timesteps_total": 2198020, "training_iteration": 18, "episode_len_mean": 700.0, "episodes_total": 866, "timestamp": 1556409238, "hostname": "flow-main", "date": "2019-04-27_23-53-58", "timesteps_since_restore": 2198020, "time_since_restore": 710.4352462291718, "custom_metrics": {"cost2_max": -129.53153923910014, "system_level_velocity_mean": 11.365984725253018, "outflow_rate_mean": 1026.8806418727147, "cost1_min": 238.13997090896237, "outflow_rate_min": 900.0750390542887, "cost1_mean": 300.915367281298, "cost1_max": 344.9580543564095, "cost2_min": -214.2804892474325, "system_level_velocity_max": 12.840348433716446, "outflow_rate_max": 1143.4622529781502, "system_level_velocity_min": 9.17495700576372, "cost2_mean": -165.17957372020305}}
{"episode_reward_min": 618.3095871847214, "policy_reward_mean": {}, "time_this_iter_s": 39.044291973114014, "num_metric_batches_dropped": 0, "episodes_this_iter": 56, "episode_reward_mean": 720.5132102814345, "episode_reward_max": 864.7705038257909, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ab0fd0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ab0ba8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ab0e10>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 124849, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 749.4795382022858, "pid": 33400, "iterations_since_restore": 19, "done": false, "info": {"update_time_ms": 12.272, "default": {"entropy": 1.291130542755127, "vf_explained_var": 0.6186944842338562, "cur_kl_coeff": 0.006250001024454832, "policy_loss": 0.00014590447244700044, "cur_lr": 0.0005000000237487257, "total_loss": 22.783878326416016, "kl": 0.005332489497959614, "vf_loss": 22.783702850341797}, "num_steps_sampled": 2322869, "load_time_ms": 5.959, "num_steps_trained": 2322869, "sample_time_ms": 14890.682, "grad_time_ms": 23295.964}, "timesteps_total": 2322869, "training_iteration": 19, "episode_len_mean": 700.0, "episodes_total": 922, "timestamp": 1556409277, "hostname": "flow-main", "date": "2019-04-27_23-54-37", "timesteps_since_restore": 2322869, "time_since_restore": 749.4795382022858, "custom_metrics": {"cost2_max": -142.33211033728347, "system_level_velocity_mean": 11.542369846336037, "outflow_rate_mean": 1035.5747271459215, "cost1_min": 238.13997090896237, "outflow_rate_min": 877.0656781452263, "cost1_mean": 305.0884579116539, "cost1_max": 344.9580543564095, "cost2_min": -214.2804892474325, "system_level_velocity_max": 13.043436943643433, "outflow_rate_max": 1143.4622529781502, "system_level_velocity_min": 9.17495700576372, "cost2_mean": -170.90052100531574}}
{"episode_reward_min": 618.3095871847214, "policy_reward_mean": {}, "time_this_iter_s": 37.06087517738342, "num_metric_batches_dropped": 0, "episodes_this_iter": 43, "episode_reward_mean": 714.5001525274046, "episode_reward_max": 864.7705038257909, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc7b8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acccc0>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 124293, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 786.5404133796692, "pid": 33400, "iterations_since_restore": 20, "done": false, "info": {"update_time_ms": 12.117, "default": {"entropy": 1.2806662321090698, "vf_explained_var": 0.6428921818733215, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -3.507147266645916e-05, "cur_lr": 0.0005000000237487257, "total_loss": 21.978891372680664, "kl": 0.006064168643206358, "vf_loss": 21.9788875579834}, "num_steps_sampled": 2447162, "load_time_ms": 5.762, "num_steps_trained": 2447162, "sample_time_ms": 14885.771, "grad_time_ms": 23069.333}, "timesteps_total": 2447162, "training_iteration": 20, "episode_len_mean": 700.0, "episodes_total": 965, "timestamp": 1556409314, "hostname": "flow-main", "date": "2019-04-27_23-55-14", "timesteps_since_restore": 2447162, "time_since_restore": 786.5404133796692, "custom_metrics": {"cost2_max": -142.33211033728347, "system_level_velocity_mean": 11.59345112335558, "outflow_rate_mean": 1038.2444625598857, "cost1_min": 245.6367381420543, "outflow_rate_min": 877.0656781452263, "cost1_mean": 305.8817397150504, "cost1_max": 373.9203590582479, "cost2_min": -212.20479901966831, "system_level_velocity_max": 14.080659678952845, "outflow_rate_max": 1200.7406083157612, "system_level_velocity_min": 9.46418813928117, "cost2_mean": -173.33099966855335}}
{"episode_reward_min": 613.7572866611997, "policy_reward_mean": {}, "time_this_iter_s": 36.30475640296936, "num_metric_batches_dropped": 0, "episodes_this_iter": 50, "episode_reward_mean": 712.7422506761196, "episode_reward_max": 832.6531730126175, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7a58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7ef0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7ac8>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 122383, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 822.8451697826385, "pid": 33400, "iterations_since_restore": 21, "done": false, "info": {"update_time_ms": 12.11, "default": {"entropy": 1.288023829460144, "vf_explained_var": 0.6563611030578613, "cur_kl_coeff": 0.006250001490116119, "policy_loss": -0.00048323231749236584, "cur_lr": 0.0005000000237487257, "total_loss": 21.644498825073242, "kl": 0.005936372093856335, "vf_loss": 21.644943237304688}, "num_steps_sampled": 2569545, "load_time_ms": 5.755, "num_steps_trained": 2569545, "sample_time_ms": 14829.578, "grad_time_ms": 23038.337}, "timesteps_total": 2569545, "training_iteration": 21, "episode_len_mean": 700.0, "episodes_total": 1015, "timestamp": 1556409350, "hostname": "flow-main", "date": "2019-04-27_23-55-50", "timesteps_since_restore": 2569545, "time_since_restore": 822.8451697826385, "custom_metrics": {"cost2_max": -148.99306493868644, "system_level_velocity_mean": 11.642880856946208, "outflow_rate_mean": 1043.8688467235154, "cost1_min": 246.8910231241883, "outflow_rate_min": 884.4200810901241, "cost1_mean": 306.9382093644991, "cost1_max": 389.0168841888117, "cost2_min": -212.20479901966831, "system_level_velocity_max": 14.585727720198488, "outflow_rate_max": 1227.7940786345332, "system_level_velocity_min": 9.50762291913745, "cost2_mean": -175.75996470686152}}
{"episode_reward_min": 602.2385028315839, "policy_reward_mean": {}, "time_this_iter_s": 38.727065563201904, "num_metric_batches_dropped": 0, "episodes_this_iter": 57, "episode_reward_mean": 705.884563141238, "episode_reward_max": 832.6531730126175, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863adaa90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ab0e80>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ab0fd0>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 124419, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 861.5722353458405, "pid": 33400, "iterations_since_restore": 22, "done": false, "info": {"update_time_ms": 12.027, "default": {"entropy": 1.2811123132705688, "vf_explained_var": 0.6308482885360718, "cur_kl_coeff": 0.006250000558793545, "policy_loss": -0.00013686979946214706, "cur_lr": 0.0005000000237487257, "total_loss": 22.75057029724121, "kl": 0.005823297426104546, "vf_loss": 22.75067138671875}, "num_steps_sampled": 2693964, "load_time_ms": 5.632, "num_steps_trained": 2693964, "sample_time_ms": 14821.504, "grad_time_ms": 23057.411}, "timesteps_total": 2693964, "training_iteration": 22, "episode_len_mean": 700.0, "episodes_total": 1072, "timestamp": 1556409389, "hostname": "flow-main", "date": "2019-04-27_23-56-29", "timesteps_since_restore": 2693964, "time_since_restore": 861.5722353458405, "custom_metrics": {"cost2_max": -151.77868693208188, "system_level_velocity_mean": 11.40741405817041, "outflow_rate_mean": 1029.3455545448405, "cost1_min": 232.75397256297447, "outflow_rate_min": 877.9571048422542, "cost1_mean": 300.7005666212279, "cost1_max": 358.9788883258496, "cost2_min": -216.08258498942337, "system_level_velocity_max": 13.550958207919342, "outflow_rate_max": 1167.532865798056, "system_level_velocity_min": 8.971076551541199, "cost2_mean": -178.9253845696241}}
{"episode_reward_min": 602.2385028315839, "policy_reward_mean": {}, "time_this_iter_s": 37.99165749549866, "num_metric_batches_dropped": 0, "episodes_this_iter": 40, "episode_reward_mean": 704.8012949825329, "episode_reward_max": 788.0035252565482, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7048>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7080>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad70b8>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 122850, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 899.5638928413391, "pid": 33400, "iterations_since_restore": 23, "done": false, "info": {"update_time_ms": 12.297, "default": {"entropy": 1.2672369480133057, "vf_explained_var": 0.6809820532798767, "cur_kl_coeff": 0.006250001490116119, "policy_loss": 2.7010164558305405e-05, "cur_lr": 0.0005000000237487257, "total_loss": 21.192522048950195, "kl": 0.006043197587132454, "vf_loss": 21.19245719909668}, "num_steps_sampled": 2816814, "load_time_ms": 5.872, "num_steps_trained": 2816814, "sample_time_ms": 14814.156, "grad_time_ms": 23145.594}, "timesteps_total": 2816814, "training_iteration": 23, "episode_len_mean": 700.0, "episodes_total": 1112, "timestamp": 1556409427, "hostname": "flow-main", "date": "2019-04-27_23-57-07", "timesteps_since_restore": 2816814, "time_since_restore": 899.5638928413391, "custom_metrics": {"cost2_max": -151.73059772770165, "system_level_velocity_mean": 11.305041478465245, "outflow_rate_mean": 1024.6322547827922, "cost1_min": 232.75397256297447, "outflow_rate_min": 877.9571048422542, "cost1_mean": 298.7048397309473, "cost1_max": 347.6532256433537, "cost2_min": -218.35889151343338, "system_level_velocity_max": 13.024112206905748, "outflow_rate_max": 1138.8921202044357, "system_level_velocity_min": 8.971076551541199, "cost2_mean": -181.0804683298898}}
{"episode_reward_min": 602.2385028315839, "policy_reward_mean": {}, "time_this_iter_s": 37.812058210372925, "num_metric_batches_dropped": 0, "episodes_this_iter": 56, "episode_reward_mean": 710.799591244423, "episode_reward_max": 831.349753743079, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc550>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc9e8>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 124323, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 937.375951051712, "pid": 33400, "iterations_since_restore": 24, "done": false, "info": {"update_time_ms": 12.326, "default": {"entropy": 1.2553759813308716, "vf_explained_var": 0.6210146546363831, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0007286948966793716, "cur_lr": 0.0005000000237487257, "total_loss": 25.212127685546875, "kl": 0.006876658648252487, "vf_loss": 25.212814331054688}, "num_steps_sampled": 2941137, "load_time_ms": 6.084, "num_steps_trained": 2941137, "sample_time_ms": 14834.244, "grad_time_ms": 23130.989}, "timesteps_total": 2941137, "training_iteration": 24, "episode_len_mean": 700.0, "episodes_total": 1168, "timestamp": 1556409465, "hostname": "flow-main", "date": "2019-04-27_23-57-45", "timesteps_since_restore": 2941137, "time_since_restore": 937.375951051712, "custom_metrics": {"cost2_max": -151.73059772770165, "system_level_velocity_mean": 11.431863431224954, "outflow_rate_mean": 1033.925764539673, "cost1_min": 232.75397256297447, "outflow_rate_min": 877.9571048422542, "cost1_mean": 302.54307238777596, "cost1_max": 368.2231259632456, "cost2_min": -218.35889151343338, "system_level_velocity_max": 13.78275303197093, "outflow_rate_max": 1179.0480409221998, "system_level_velocity_min": 8.971076551541199, "cost2_mean": -184.73664949695154}}
{"episode_reward_min": 615.8399301241071, "policy_reward_mean": {}, "time_this_iter_s": 38.94617056846619, "num_metric_batches_dropped": 0, "episodes_this_iter": 39, "episode_reward_mean": 708.3344602556416, "episode_reward_max": 831.349753743079, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad71d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7160>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7198>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 126687, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 976.3221216201782, "pid": 33400, "iterations_since_restore": 25, "done": false, "info": {"update_time_ms": 12.188, "default": {"entropy": 1.2511706352233887, "vf_explained_var": 0.6894357800483704, "cur_kl_coeff": 0.006250000558793545, "policy_loss": -0.00019458969472907484, "cur_lr": 0.0005000000237487257, "total_loss": 21.624778747558594, "kl": 0.0059410082176327705, "vf_loss": 21.624935150146484}, "num_steps_sampled": 3067824, "load_time_ms": 6.1, "num_steps_trained": 3067824, "sample_time_ms": 14817.224, "grad_time_ms": 23154.06}, "timesteps_total": 3067824, "training_iteration": 25, "episode_len_mean": 700.0, "episodes_total": 1207, "timestamp": 1556409504, "hostname": "flow-main", "date": "2019-04-27_23-58-24", "timesteps_since_restore": 3067824, "time_since_restore": 976.3221216201782, "custom_metrics": {"cost2_max": -151.4274058062361, "system_level_velocity_mean": 11.43791996514116, "outflow_rate_mean": 1034.7513322072546, "cost1_min": 250.46702450285014, "outflow_rate_min": 923.1420683946781, "cost1_mean": 302.5533890956646, "cost1_max": 368.2231259632456, "cost2_min": -218.35889151343338, "system_level_velocity_max": 13.78275303197093, "outflow_rate_max": 1179.0480409221998, "system_level_velocity_min": 9.662611337787462, "cost2_mean": -185.85837867000293}}
{"episode_reward_min": 604.0669878311955, "policy_reward_mean": {}, "time_this_iter_s": 37.23760962486267, "num_metric_batches_dropped": 0, "episodes_this_iter": 50, "episode_reward_mean": 703.2348070534557, "episode_reward_max": 831.349753743079, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc7b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863accef0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc6a0>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 124327, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 1013.5597312450409, "pid": 33400, "iterations_since_restore": 26, "done": false, "info": {"update_time_ms": 12.145, "default": {"entropy": 1.246700406074524, "vf_explained_var": 0.687736988067627, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0002739947522059083, "cur_lr": 0.0005000000237487257, "total_loss": 25.168729782104492, "kl": 0.006008825730532408, "vf_loss": 25.16896629333496}, "num_steps_sampled": 3192151, "load_time_ms": 6.346, "num_steps_trained": 3192151, "sample_time_ms": 14828.736, "grad_time_ms": 23005.409}, "timesteps_total": 3192151, "training_iteration": 26, "episode_len_mean": 700.0, "episodes_total": 1257, "timestamp": 1556409541, "hostname": "flow-main", "date": "2019-04-27_23-59-01", "timesteps_since_restore": 3192151, "time_since_restore": 1013.5597312450409, "custom_metrics": {"cost2_max": -151.4274058062361, "system_level_velocity_mean": 11.401173399803406, "outflow_rate_mean": 1034.8424003290365, "cost1_min": 240.75812543180018, "outflow_rate_min": 902.672094113209, "cost1_mean": 301.4323191518977, "cost1_max": 360.66424917718786, "cost2_min": -226.45686492766035, "system_level_velocity_max": 13.507100764311872, "outflow_rate_max": 1169.773844602055, "system_level_velocity_min": 9.154569592878426, "cost2_mean": -186.11533610596024}}
{"episode_reward_min": 604.0669878311955, "policy_reward_mean": {}, "time_this_iter_s": 41.881860971450806, "num_metric_batches_dropped": 0, "episodes_this_iter": 55, "episode_reward_mean": 702.9177439919675, "episode_reward_max": 801.8875973106275, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7a20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7a58>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7a90>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 124510, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 1055.4415922164917, "pid": 33400, "iterations_since_restore": 27, "done": false, "info": {"update_time_ms": 11.275, "default": {"entropy": 1.2223520278930664, "vf_explained_var": 0.6560623645782471, "cur_kl_coeff": 0.006250000558793545, "policy_loss": -0.0001723923342069611, "cur_lr": 0.0005000000237487257, "total_loss": 26.9190731048584, "kl": 0.0063225021585822105, "vf_loss": 26.919206619262695}, "num_steps_sampled": 3316661, "load_time_ms": 6.586, "num_steps_trained": 3316661, "sample_time_ms": 14747.748, "grad_time_ms": 23347.784}, "timesteps_total": 3316661, "training_iteration": 27, "episode_len_mean": 700.0, "episodes_total": 1312, "timestamp": 1556409583, "hostname": "flow-main", "date": "2019-04-27_23-59-43", "timesteps_since_restore": 3316661, "time_since_restore": 1055.4415922164917, "custom_metrics": {"cost2_max": -153.9046247051309, "system_level_velocity_mean": 11.427901536643002, "outflow_rate_mean": 1031.6880040871638, "cost1_min": 240.75812543180018, "outflow_rate_min": 902.672094113209, "cost1_mean": 301.9878371505413, "cost1_max": 356.7804256318414, "cost2_min": -226.45686492766035, "system_level_velocity_max": 13.369880819685605, "outflow_rate_max": 1165.0652382579221, "system_level_velocity_min": 9.154569592878426, "cost2_mean": -185.2323813325786}}
{"episode_reward_min": 617.3787769063186, "policy_reward_mean": {}, "time_this_iter_s": 35.04057717323303, "num_metric_batches_dropped": 0, "episodes_this_iter": 46, "episode_reward_mean": 701.7424872403811, "episode_reward_max": 801.8875973106275, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad74e0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7f98>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7d68>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 122773, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 1090.4821693897247, "pid": 33400, "iterations_since_restore": 28, "done": false, "info": {"update_time_ms": 11.293, "default": {"entropy": 1.2182650566101074, "vf_explained_var": 0.697020947933197, "cur_kl_coeff": 0.006250001490116119, "policy_loss": -0.00035266546183265746, "cur_lr": 0.0005000000237487257, "total_loss": 26.43058967590332, "kl": 0.00724873086437583, "vf_loss": 26.430896759033203}, "num_steps_sampled": 3439434, "load_time_ms": 6.657, "num_steps_trained": 3439434, "sample_time_ms": 14728.449, "grad_time_ms": 23032.01}, "timesteps_total": 3439434, "training_iteration": 28, "episode_len_mean": 700.0, "episodes_total": 1358, "timestamp": 1556409618, "hostname": "flow-main", "date": "2019-04-28_00-00-18", "timesteps_since_restore": 3439434, "time_since_restore": 1090.4821693897247, "custom_metrics": {"cost2_max": -160.17095260782136, "system_level_velocity_mean": 11.426734703554418, "outflow_rate_mean": 1026.688475795985, "cost1_min": 241.74828169649598, "outflow_rate_min": 904.5932369760144, "cost1_mean": 301.88145033736816, "cost1_max": 356.7804256318414, "cost2_min": -223.57353048075333, "system_level_velocity_max": 13.369880819685605, "outflow_rate_max": 1165.0652382579221, "system_level_velocity_min": 9.289092962865224, "cost2_mean": -186.89978412509333}}
{"episode_reward_min": 587.93865164114, "policy_reward_mean": {}, "time_this_iter_s": 38.40519094467163, "num_metric_batches_dropped": 0, "episodes_this_iter": 56, "episode_reward_mean": 698.8605653414055, "episode_reward_max": 818.4091874681042, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad77b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7978>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7668>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 124757, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 1128.8873603343964, "pid": 33400, "iterations_since_restore": 29, "done": false, "info": {"update_time_ms": 11.074, "default": {"entropy": 1.2155681848526, "vf_explained_var": 0.6531230211257935, "cur_kl_coeff": 0.006250000558793545, "policy_loss": -0.00036299816565588117, "cur_lr": 0.0005000000237487257, "total_loss": 28.928226470947266, "kl": 0.006232318468391895, "vf_loss": 28.928550720214844}, "num_steps_sampled": 3564191, "load_time_ms": 6.816, "num_steps_trained": 3564191, "sample_time_ms": 14698.52, "grad_time_ms": 23001.53}, "timesteps_total": 3564191, "training_iteration": 29, "episode_len_mean": 700.0, "episodes_total": 1414, "timestamp": 1556409657, "hostname": "flow-main", "date": "2019-04-28_00-00-57", "timesteps_since_restore": 3564191, "time_since_restore": 1128.8873603343964, "custom_metrics": {"cost2_max": -160.17095260782136, "system_level_velocity_mean": 11.42784441516679, "outflow_rate_mean": 1030.9260322046582, "cost1_min": 241.74828169649598, "outflow_rate_min": 904.5932369760144, "cost1_mean": 301.9571822655218, "cost1_max": 368.6545318625629, "cost2_min": -229.6068570989359, "system_level_velocity_max": 13.735122859962841, "outflow_rate_max": 1182.8720949987971, "system_level_velocity_min": 9.289092962865224, "cost2_mean": -192.9275202233623}}
{"episode_reward_min": 587.93865164114, "policy_reward_mean": {}, "time_this_iter_s": 39.54802441596985, "num_metric_batches_dropped": 0, "episodes_this_iter": 34, "episode_reward_mean": 706.5628434862664, "episode_reward_max": 887.1710540289521, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc780>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc630>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7400>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 125786, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 1168.4353847503662, "pid": 33400, "iterations_since_restore": 30, "done": false, "info": {"update_time_ms": 11.11, "default": {"entropy": 1.215376615524292, "vf_explained_var": 0.7070994973182678, "cur_kl_coeff": 0.006250000558793545, "policy_loss": -0.00037491045077331364, "cur_lr": 0.0005000000237487257, "total_loss": 24.352920532226562, "kl": 0.006850364152342081, "vf_loss": 24.353252410888672}, "num_steps_sampled": 3689977, "load_time_ms": 6.924, "num_steps_trained": 3689977, "sample_time_ms": 14677.014, "grad_time_ms": 23273.085}, "timesteps_total": 3689977, "training_iteration": 30, "episode_len_mean": 700.0, "episodes_total": 1448, "timestamp": 1556409696, "hostname": "flow-main", "date": "2019-04-28_00-01-36", "timesteps_since_restore": 3689977, "time_since_restore": 1168.4353847503662, "custom_metrics": {"cost2_max": -164.18325779253163, "system_level_velocity_mean": 11.611146942618031, "outflow_rate_mean": 1043.7679908756952, "cost1_min": 256.27216942129826, "outflow_rate_min": 933.4547188384772, "cost1_mean": 306.8454644225357, "cost1_max": 368.6545318625629, "cost2_min": -229.6068570989359, "system_level_velocity_max": 13.735122859962841, "outflow_rate_max": 1182.8720949987971, "system_level_velocity_min": 9.761866181887992, "cost2_mean": -195.35273935454825}}
{"episode_reward_min": 611.5365654091006, "policy_reward_mean": {}, "time_this_iter_s": 38.34305453300476, "num_metric_batches_dropped": 0, "episodes_this_iter": 51, "episode_reward_mean": 704.7101625664877, "episode_reward_max": 887.1710540289521, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7a20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7cf8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7b38>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 125380, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 1206.778439283371, "pid": 33400, "iterations_since_restore": 31, "done": false, "info": {"update_time_ms": 10.91, "default": {"entropy": 1.2075996398925781, "vf_explained_var": 0.6796528100967407, "cur_kl_coeff": 0.006250000558793545, "policy_loss": -0.00031493877759203315, "cur_lr": 0.0005000000237487257, "total_loss": 28.647165298461914, "kl": 0.006474826019257307, "vf_loss": 28.647436141967773}, "num_steps_sampled": 3815357, "load_time_ms": 7.073, "num_steps_trained": 3815357, "sample_time_ms": 14692.054, "grad_time_ms": 23462.242}, "timesteps_total": 3815357, "training_iteration": 31, "episode_len_mean": 700.0, "episodes_total": 1499, "timestamp": 1556409735, "hostname": "flow-main", "date": "2019-04-28_00-02-15", "timesteps_since_restore": 3815357, "time_since_restore": 1206.778439283371, "custom_metrics": {"cost2_max": -166.9202447639468, "system_level_velocity_mean": 11.629659162582186, "outflow_rate_mean": 1045.5298764169452, "cost1_min": 256.27216942129826, "outflow_rate_min": 935.7799637126332, "cost1_mean": 306.76453084182197, "cost1_max": 388.73682192536336, "cost2_min": -229.6068570989359, "system_level_velocity_max": 14.538586492763606, "outflow_rate_max": 1215.4637019299912, "system_level_velocity_min": 9.761866181887992, "cost2_mean": -197.62977957271033}}
{"episode_reward_min": 619.0500101801662, "policy_reward_mean": {}, "time_this_iter_s": 37.939446687698364, "num_metric_batches_dropped": 0, "episodes_this_iter": 54, "episode_reward_mean": 700.7778338663878, "episode_reward_max": 843.4715119358831, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc7b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc198>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863accda0>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 125420, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 1244.7178859710693, "pid": 33400, "iterations_since_restore": 32, "done": false, "info": {"update_time_ms": 10.827, "default": {"entropy": 1.184278130531311, "vf_explained_var": 0.6904950737953186, "cur_kl_coeff": 0.006250000558793545, "policy_loss": -0.0003312721673864871, "cur_lr": 0.0005000000237487257, "total_loss": 28.873201370239258, "kl": 0.006118407007306814, "vf_loss": 28.873491287231445}, "num_steps_sampled": 3940777, "load_time_ms": 6.912, "num_steps_trained": 3940777, "sample_time_ms": 14672.522, "grad_time_ms": 23406.661}, "timesteps_total": 3940777, "training_iteration": 32, "episode_len_mean": 700.0, "episodes_total": 1553, "timestamp": 1556409773, "hostname": "flow-main", "date": "2019-04-28_00-02-53", "timesteps_since_restore": 3940777, "time_since_restore": 1244.7178859710693, "custom_metrics": {"cost2_max": -171.34114506388508, "system_level_velocity_mean": 11.632123922032765, "outflow_rate_mean": 1044.9657269316249, "cost1_min": 260.3000864002671, "outflow_rate_min": 945.4622636421198, "cost1_mean": 306.8710050476487, "cost1_max": 388.73682192536336, "cost2_min": -233.20539323301034, "system_level_velocity_max": 14.538586492763606, "outflow_rate_max": 1215.4637019299912, "system_level_velocity_min": 9.954373301943534, "cost2_mean": -198.89181318377877}}
{"episode_reward_min": 616.000019445726, "policy_reward_mean": {}, "time_this_iter_s": 36.979156732559204, "num_metric_batches_dropped": 0, "episodes_this_iter": 47, "episode_reward_mean": 704.2221103190993, "episode_reward_max": 835.2799331360474, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7b38>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7cf8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7a20>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 122421, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 1281.6970427036285, "pid": 33400, "iterations_since_restore": 33, "done": false, "info": {"update_time_ms": 10.675, "default": {"entropy": 1.1774739027023315, "vf_explained_var": 0.7170026302337646, "cur_kl_coeff": 0.006250001490116119, "policy_loss": -0.0002818691136781126, "cur_lr": 0.0005000000237487257, "total_loss": 29.56068229675293, "kl": 0.006347327958792448, "vf_loss": 29.560922622680664}, "num_steps_sampled": 4063198, "load_time_ms": 6.891, "num_steps_trained": 4063198, "sample_time_ms": 14668.354, "grad_time_ms": 23312.788}, "timesteps_total": 4063198, "training_iteration": 33, "episode_len_mean": 700.0, "episodes_total": 1600, "timestamp": 1556409810, "hostname": "flow-main", "date": "2019-04-28_00-03-30", "timesteps_since_restore": 4063198, "time_since_restore": 1281.6970427036285, "custom_metrics": {"cost2_max": -164.63382475759042, "system_level_velocity_mean": 11.710221582115821, "outflow_rate_mean": 1049.5884661631858, "cost1_min": 260.3000864002671, "outflow_rate_min": 945.4622636421198, "cost1_mean": 309.0038543284803, "cost1_max": 372.33456799252605, "cost2_min": -248.19750896378426, "system_level_velocity_max": 14.009008328810985, "outflow_rate_max": 1193.7796396245128, "system_level_velocity_min": 9.954373301943534, "cost2_mean": -201.2186498732598}}
{"episode_reward_min": 616.000019445726, "policy_reward_mean": {}, "time_this_iter_s": 37.64241337776184, "num_metric_batches_dropped": 0, "episodes_this_iter": 58, "episode_reward_mean": 708.8738807141343, "episode_reward_max": 870.809872962298, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7400>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7f98>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7518>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 124055, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 1319.3394560813904, "pid": 33400, "iterations_since_restore": 34, "done": false, "info": {"update_time_ms": 10.736, "default": {"entropy": 1.1596240997314453, "vf_explained_var": 0.6696995496749878, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0003843813028652221, "cur_lr": 0.0005000000237487257, "total_loss": 33.162757873535156, "kl": 0.007036393973976374, "vf_loss": 33.1630973815918}, "num_steps_sampled": 4187253, "load_time_ms": 6.704, "num_steps_trained": 4187253, "sample_time_ms": 14693.915, "grad_time_ms": 23270.983}, "timesteps_total": 4187253, "training_iteration": 34, "episode_len_mean": 700.0, "episodes_total": 1658, "timestamp": 1556409847, "hostname": "flow-main", "date": "2019-04-28_00-04-07", "timesteps_since_restore": 4187253, "time_since_restore": 1319.3394560813904, "custom_metrics": {"cost2_max": -160.8486837727609, "system_level_velocity_mean": 11.964687549237901, "outflow_rate_mean": 1063.2169655857551, "cost1_min": 266.5863327743592, "outflow_rate_min": 950.0399695163709, "cost1_mean": 314.85329608758786, "cost1_max": 400.8230706173716, "cost2_min": -248.19750896378426, "system_level_velocity_max": 15.094195156160339, "outflow_rate_max": 1253.2713884847287, "system_level_velocity_min": 10.19264792403672, "cost2_mean": -201.27044814167965}}
{"episode_reward_min": 48.62540282188433, "policy_reward_mean": {}, "time_this_iter_s": 40.509260177612305, "num_metric_batches_dropped": 0, "episodes_this_iter": 38, "episode_reward_mean": 702.8950708948662, "episode_reward_max": 874.8060999869725, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7e10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad77b8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad77f0>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 125516, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 1359.8487162590027, "pid": 33400, "iterations_since_restore": 35, "done": false, "info": {"update_time_ms": 10.713, "default": {"entropy": 1.1575366258621216, "vf_explained_var": 0.7264715433120728, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -3.005923099408392e-05, "cur_lr": 0.0005000000237487257, "total_loss": 27.844341278076172, "kl": 0.005658880341798067, "vf_loss": 27.844337463378906}, "num_steps_sampled": 4312769, "load_time_ms": 6.589, "num_steps_trained": 4312769, "sample_time_ms": 14650.558, "grad_time_ms": 23469.982}, "timesteps_total": 4312769, "training_iteration": 35, "episode_len_mean": 693.37, "episodes_total": 1696, "timestamp": 1556409888, "hostname": "flow-main", "date": "2019-04-28_00-04-48", "timesteps_since_restore": 4312769, "time_since_restore": 1359.8487162590027, "custom_metrics": {"cost2_max": -23.419735604619014, "system_level_velocity_mean": 12.154743842109937, "outflow_rate_mean": 1065.4021140595862, "cost1_min": 24.61691404620796, "outflow_rate_min": 504.21486338125436, "cost1_mean": 314.75922202189753, "cost1_max": 410.98512692709926, "cost2_min": -238.84149348855627, "system_level_velocity_max": 18.835950161333972, "outflow_rate_max": 1272.0558854838412, "system_level_velocity_min": 10.100725700616314, "cost2_mean": -201.63266730327956}}
{"episode_reward_min": 48.62540282188433, "policy_reward_mean": {}, "time_this_iter_s": 37.41339159011841, "num_metric_batches_dropped": 0, "episodes_this_iter": 49, "episode_reward_mean": 700.4780391036172, "episode_reward_max": 874.8060999869725, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc080>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc7b8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc9e8>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 124917, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 1397.262107849121, "pid": 33400, "iterations_since_restore": 36, "done": false, "info": {"update_time_ms": 10.823, "default": {"entropy": 1.1497833728790283, "vf_explained_var": 0.6995779275894165, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0003172066935803741, "cur_lr": 0.0005000000237487257, "total_loss": 32.33460235595703, "kl": 0.0062221260741353035, "vf_loss": 32.33488082885742}, "num_steps_sampled": 4437686, "load_time_ms": 6.342, "num_steps_trained": 4437686, "sample_time_ms": 14699.519, "grad_time_ms": 23434.893}, "timesteps_total": 4437686, "training_iteration": 36, "episode_len_mean": 693.37, "episodes_total": 1745, "timestamp": 1556409925, "hostname": "flow-main", "date": "2019-04-28_00-05-25", "timesteps_since_restore": 4437686, "time_since_restore": 1397.262107849121, "custom_metrics": {"cost2_max": -23.419735604619014, "system_level_velocity_mean": 12.134739731147974, "outflow_rate_mean": 1065.0461818844467, "cost1_min": 24.61691404620796, "outflow_rate_min": 504.21486338125436, "cost1_mean": 314.11692008717864, "cost1_max": 410.98512692709926, "cost2_min": -244.96782728900996, "system_level_velocity_max": 18.835950161333972, "outflow_rate_max": 1272.0558854838412, "system_level_velocity_min": 10.042172216253945, "cost2_mean": -205.2905525115675}}
{"episode_reward_min": 50.882816013697706, "policy_reward_mean": {}, "time_this_iter_s": 37.359317779541016, "num_metric_batches_dropped": 0, "episodes_this_iter": 52, "episode_reward_mean": 706.0609882349653, "episode_reward_max": 883.1364177454315, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7cf8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7a20>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7ac8>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 124649, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 1434.621425628662, "pid": 33400, "iterations_since_restore": 37, "done": false, "info": {"update_time_ms": 10.693, "default": {"entropy": 1.1427104473114014, "vf_explained_var": 0.6983281970024109, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0005722354399040341, "cur_lr": 0.0005000000237487257, "total_loss": 33.68431854248047, "kl": 0.007029955741018057, "vf_loss": 33.68484878540039}, "num_steps_sampled": 4562335, "load_time_ms": 5.964, "num_steps_trained": 4562335, "sample_time_ms": 14706.554, "grad_time_ms": 22977.743}, "timesteps_total": 4562335, "training_iteration": 37, "episode_len_mean": 693.38, "episodes_total": 1797, "timestamp": 1556409963, "hostname": "flow-main", "date": "2019-04-28_00-06-03", "timesteps_since_restore": 4562335, "time_since_restore": 1434.621425628662, "custom_metrics": {"cost2_max": -23.931092933706278, "system_level_velocity_mean": 12.18718131013223, "outflow_rate_mean": 1069.5693255995905, "cost1_min": 24.366915640087615, "outflow_rate_min": 476.4044925366999, "cost1_mean": 316.16122179752546, "cost1_max": 404.0397211310738, "cost2_min": -244.96782728900996, "system_level_velocity_max": 17.991344087818526, "outflow_rate_max": 1242.2884505496054, "system_level_velocity_min": 10.042172216253945, "cost2_mean": -205.03325507365082}}
{"episode_reward_min": 49.515203656679, "policy_reward_mean": {}, "time_this_iter_s": 37.75478982925415, "num_metric_batches_dropped": 0, "episodes_this_iter": 51, "episode_reward_mean": 701.406556094608, "episode_reward_max": 883.1364177454315, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc780>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7780>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7f98>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 123466, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 1472.3762154579163, "pid": 33400, "iterations_since_restore": 38, "done": false, "info": {"update_time_ms": 10.552, "default": {"entropy": 1.1381700038909912, "vf_explained_var": 0.7217661738395691, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -4.2954790842486545e-05, "cur_lr": 0.0005000000237487257, "total_loss": 32.079376220703125, "kl": 0.005983891896903515, "vf_loss": 32.079383850097656}, "num_steps_sampled": 4685801, "load_time_ms": 5.876, "num_steps_trained": 4685801, "sample_time_ms": 14748.839, "grad_time_ms": 23205.987}, "timesteps_total": 4685801, "training_iteration": 38, "episode_len_mean": 686.75, "episodes_total": 1848, "timestamp": 1556410000, "hostname": "flow-main", "date": "2019-04-28_00-06-40", "timesteps_since_restore": 4685801, "time_since_restore": 1472.3762154579163, "custom_metrics": {"cost2_max": -23.086290959560934, "system_level_velocity_mean": 12.254825282540212, "outflow_rate_mean": 1064.9296344389281, "cost1_min": 23.83517884318265, "outflow_rate_min": 476.4044925366999, "cost1_mean": 313.7396189084254, "cost1_max": 404.0397211310738, "cost2_min": -238.09874817117233, "system_level_velocity_max": 18.160641859413893, "outflow_rate_max": 1242.2884505496054, "system_level_velocity_min": 10.160415494698809, "cost2_mean": -202.68877193690514}}
{"episode_reward_min": 49.515203656679, "policy_reward_mean": {}, "time_this_iter_s": 39.14895510673523, "num_metric_batches_dropped": 0, "episodes_this_iter": 55, "episode_reward_mean": 692.4108997022151, "episode_reward_max": 876.9986831150022, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc048>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7e10>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7e48>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 124876, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 1511.5251705646515, "pid": 33400, "iterations_since_restore": 39, "done": false, "info": {"update_time_ms": 10.629, "default": {"entropy": 1.1353535652160645, "vf_explained_var": 0.6825741529464722, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0006339135579764843, "cur_lr": 0.0005000000237487257, "total_loss": 34.40781021118164, "kl": 0.00649435818195343, "vf_loss": 34.40839767456055}, "num_steps_sampled": 4810677, "load_time_ms": 5.797, "num_steps_trained": 4810677, "sample_time_ms": 14730.17, "grad_time_ms": 23297.53}, "timesteps_total": 4810677, "training_iteration": 39, "episode_len_mean": 693.37, "episodes_total": 1903, "timestamp": 1556410040, "hostname": "flow-main", "date": "2019-04-28_00-07-20", "timesteps_since_restore": 4810677, "time_since_restore": 1511.5251705646515, "custom_metrics": {"cost2_max": -23.086290959560934, "system_level_velocity_mean": 11.90914783807948, "outflow_rate_mean": 1053.2458702811198, "cost1_min": 23.83517884318265, "outflow_rate_min": 482.93760633587414, "cost1_mean": 308.5054264470215, "cost1_max": 405.5709426895361, "cost2_min": -241.03064725477626, "system_level_velocity_max": 18.160641859413893, "outflow_rate_max": 1253.443381759638, "system_level_velocity_min": 9.743294281220123, "cost2_mean": -209.2834302429224}}
{"episode_reward_min": 49.515203656679, "policy_reward_mean": {}, "time_this_iter_s": 40.406105756759644, "num_metric_batches_dropped": 0, "episodes_this_iter": 36, "episode_reward_mean": 686.3792159093246, "episode_reward_max": 920.8122024058076, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7470>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7c18>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7d68>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 124923, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 1551.9312763214111, "pid": 33400, "iterations_since_restore": 40, "done": false, "info": {"update_time_ms": 10.497, "default": {"entropy": 1.112632155418396, "vf_explained_var": 0.7379738688468933, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0003945340868085623, "cur_lr": 0.0005000000237487257, "total_loss": 31.13231086730957, "kl": 0.007342801429331303, "vf_loss": 31.132659912109375}, "num_steps_sampled": 4935600, "load_time_ms": 5.433, "num_steps_trained": 4935600, "sample_time_ms": 14766.171, "grad_time_ms": 23349.342}, "timesteps_total": 4935600, "training_iteration": 40, "episode_len_mean": 693.37, "episodes_total": 1939, "timestamp": 1556410080, "hostname": "flow-main", "date": "2019-04-28_00-08-00", "timesteps_since_restore": 4935600, "time_since_restore": 1551.9312763214111, "custom_metrics": {"cost2_max": -23.086290959560934, "system_level_velocity_mean": 11.870411451827744, "outflow_rate_mean": 1052.273860997915, "cost1_min": 23.83517884318265, "outflow_rate_min": 482.93760633587414, "cost1_mean": 307.07105139164145, "cost1_max": 420.3619959343532, "cost2_min": -253.47131824847406, "system_level_velocity_max": 18.160641859413893, "outflow_rate_max": 1277.6130614555796, "system_level_velocity_min": 9.743294281220123, "cost2_mean": -211.11332758712607}}
{"episode_reward_min": 606.3825143840565, "policy_reward_mean": {}, "time_this_iter_s": 40.81871175765991, "num_metric_batches_dropped": 0, "episodes_this_iter": 51, "episode_reward_mean": 702.3682349491253, "episode_reward_max": 935.7080721417227, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7b38>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7e48>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7a90>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 125014, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 1592.749988079071, "pid": 33400, "iterations_since_restore": 41, "done": false, "info": {"update_time_ms": 10.589, "default": {"entropy": 1.1005874872207642, "vf_explained_var": 0.7263942956924438, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.000624675361905247, "cur_lr": 0.0005000000237487257, "total_loss": 37.20861053466797, "kl": 0.008056006394326687, "vf_loss": 37.20918273925781}, "num_steps_sampled": 5060614, "load_time_ms": 5.583, "num_steps_trained": 5060614, "sample_time_ms": 14854.258, "grad_time_ms": 23508.568}, "timesteps_total": 5060614, "training_iteration": 41, "episode_len_mean": 700.0, "episodes_total": 1990, "timestamp": 1556410121, "hostname": "flow-main", "date": "2019-04-28_00-08-41", "timesteps_since_restore": 5060614, "time_since_restore": 1592.749988079071, "custom_metrics": {"cost2_max": -170.68639647828104, "system_level_velocity_mean": 12.042636804993084, "outflow_rate_mean": 1073.322429043554, "cost1_min": 259.6769137159031, "outflow_rate_min": 940.4674552065349, "cost1_mean": 316.3578582983547, "cost1_max": 436.39811234432125, "cost2_min": -253.47131824847406, "system_level_velocity_max": 16.654401757902438, "outflow_rate_max": 1301.1313725102948, "system_level_velocity_min": 10.106961663900801, "cost2_mean": -212.55850325513512}}
{"episode_reward_min": 44.42367408962364, "policy_reward_mean": {}, "time_this_iter_s": 39.13770651817322, "num_metric_batches_dropped": 0, "episodes_this_iter": 52, "episode_reward_mean": 704.7583335619435, "episode_reward_max": 985.6748848365282, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7898>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7eb8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7780>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 124253, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 1631.8876945972443, "pid": 33400, "iterations_since_restore": 42, "done": false, "info": {"update_time_ms": 10.73, "default": {"entropy": 1.1001132726669312, "vf_explained_var": 0.7190029621124268, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0005072737694717944, "cur_lr": 0.0005000000237487257, "total_loss": 41.163848876953125, "kl": 0.007292901165783405, "vf_loss": 41.164310455322266}, "num_steps_sampled": 5184867, "load_time_ms": 5.678, "num_steps_trained": 5184867, "sample_time_ms": 14894.004, "grad_time_ms": 23587.757}, "timesteps_total": 5184867, "training_iteration": 42, "episode_len_mean": 693.35, "episodes_total": 2042, "timestamp": 1556410160, "hostname": "flow-main", "date": "2019-04-28_00-09-20", "timesteps_since_restore": 5184867, "time_since_restore": 1631.8876945972443, "custom_metrics": {"cost2_max": -22.22697269842556, "system_level_velocity_mean": 12.337841096245002, "outflow_rate_mean": 1078.482965630443, "cost1_min": 23.014499422524775, "outflow_rate_min": 513.1510694623687, "cost1_mean": 318.78648568571975, "cost1_max": 449.3938272193104, "cost2_min": -249.57769591064687, "system_level_velocity_max": 18.722732644359553, "outflow_rate_max": 1317.1989303960484, "system_level_velocity_min": 10.173129037786826, "cost2_mean": -209.55710941076154}}
{"episode_reward_min": 44.42367408962364, "policy_reward_mean": {}, "time_this_iter_s": 39.262150049209595, "num_metric_batches_dropped": 0, "episodes_this_iter": 51, "episode_reward_mean": 707.9132777888658, "episode_reward_max": 985.6748848365282, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7b38>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad79b0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7b70>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 121944, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 1671.1498446464539, "pid": 33400, "iterations_since_restore": 43, "done": false, "info": {"update_time_ms": 10.734, "default": {"entropy": 1.0921920537948608, "vf_explained_var": 0.7389370203018188, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0007001529447734356, "cur_lr": 0.0005000000237487257, "total_loss": 39.16266632080078, "kl": 0.007945439778268337, "vf_loss": 39.1633186340332}, "num_steps_sampled": 5306811, "load_time_ms": 5.889, "num_steps_trained": 5306811, "sample_time_ms": 14939.043, "grad_time_ms": 23767.389}, "timesteps_total": 5306811, "training_iteration": 43, "episode_len_mean": 693.35, "episodes_total": 2093, "timestamp": 1556410199, "hostname": "flow-main", "date": "2019-04-28_00-09-59", "timesteps_since_restore": 5306811, "time_since_restore": 1671.1498446464539, "custom_metrics": {"cost2_max": -22.22697269842556, "system_level_velocity_mean": 12.544505283795957, "outflow_rate_mean": 1089.7562350831017, "cost1_min": 23.014499422524775, "outflow_rate_min": 513.1510694623687, "cost1_mean": 323.4806157010899, "cost1_max": 449.3938272193104, "cost2_min": -244.8561636801389, "system_level_velocity_max": 18.722732644359553, "outflow_rate_max": 1326.25630919738, "system_level_velocity_min": 10.226331384541158, "cost2_mean": -208.99347902417335}}
{"episode_reward_min": 39.22895740704371, "policy_reward_mean": {}, "time_this_iter_s": 38.71980285644531, "num_metric_batches_dropped": 0, "episodes_this_iter": 57, "episode_reward_mean": 711.3138868080513, "episode_reward_max": 865.2587305177723, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7b00>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7780>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 122750, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 1709.8696475028992, "pid": 33400, "iterations_since_restore": 44, "done": false, "info": {"update_time_ms": 11.131, "default": {"entropy": 1.081799030303955, "vf_explained_var": 0.7157811522483826, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.00046394389937631786, "cur_lr": 0.0005000000237487257, "total_loss": 42.13243865966797, "kl": 0.007078689523041248, "vf_loss": 42.13285446166992}, "num_steps_sampled": 5429561, "load_time_ms": 5.864, "num_steps_trained": 5429561, "sample_time_ms": 14915.646, "grad_time_ms": 23893.847}, "timesteps_total": 5429561, "training_iteration": 44, "episode_len_mean": 693.27, "episodes_total": 2150, "timestamp": 1556410238, "hostname": "flow-main", "date": "2019-04-28_00-10-38", "timesteps_since_restore": 5429561, "time_since_restore": 1709.8696475028992, "custom_metrics": {"cost2_max": -21.04094125917124, "system_level_velocity_mean": 12.589991177235241, "outflow_rate_mean": 1095.7318466633637, "cost1_min": 17.91897488959958, "outflow_rate_min": 442.8785900830537, "cost1_mean": 325.58923411175596, "cost1_max": 419.0761659217368, "cost2_min": -248.67825952314598, "system_level_velocity_max": 17.296518690769176, "outflow_rate_max": 1287.2813737005977, "system_level_velocity_min": 10.334075973821008, "cost2_mean": -209.8864998541751}}
{"episode_reward_min": 39.22895740704371, "policy_reward_mean": {}, "time_this_iter_s": 38.30308222770691, "num_metric_batches_dropped": 0, "episodes_this_iter": 39, "episode_reward_mean": 713.159675008779, "episode_reward_max": 1014.7753019642812, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc6d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc048>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863accfd0>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 123322, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 1748.172729730606, "pid": 33400, "iterations_since_restore": 45, "done": false, "info": {"update_time_ms": 11.257, "default": {"entropy": 1.0693382024765015, "vf_explained_var": 0.7560623288154602, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0006005125469528139, "cur_lr": 0.0005000000237487257, "total_loss": 36.216548919677734, "kl": 0.007685961667448282, "vf_loss": 36.217098236083984}, "num_steps_sampled": 5552883, "load_time_ms": 5.768, "num_steps_trained": 5552883, "sample_time_ms": 14938.066, "grad_time_ms": 23651.178}, "timesteps_total": 5552883, "training_iteration": 45, "episode_len_mean": 693.27, "episodes_total": 2189, "timestamp": 1556410276, "hostname": "flow-main", "date": "2019-04-28_00-11-16", "timesteps_since_restore": 5552883, "time_since_restore": 1748.172729730606, "custom_metrics": {"cost2_max": -21.04094125917124, "system_level_velocity_mean": 12.638356424813106, "outflow_rate_mean": 1094.6649137301729, "cost1_min": 17.91897488959958, "outflow_rate_min": 442.8785900830537, "cost1_mean": 326.3979905910013, "cost1_max": 463.6164162969952, "cost2_min": -248.67825952314598, "system_level_velocity_max": 17.664689713188906, "outflow_rate_max": 1346.7196932627658, "system_level_velocity_min": 9.05827197599974, "cost2_mean": -209.4901601363034}}
{"episode_reward_min": 35.34440730063439, "policy_reward_mean": {}, "time_this_iter_s": 38.79214143753052, "num_metric_batches_dropped": 0, "episodes_this_iter": 55, "episode_reward_mean": 696.173530533017, "episode_reward_max": 1014.7753019642812, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7b00>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7518>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7f98>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 123833, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 1786.9648711681366, "pid": 33400, "iterations_since_restore": 46, "done": false, "info": {"update_time_ms": 11.305, "default": {"entropy": 1.0678832530975342, "vf_explained_var": 0.7124378681182861, "cur_kl_coeff": 0.006250001490116119, "policy_loss": -0.0008524516597390175, "cur_lr": 0.0005000000237487257, "total_loss": 42.11511993408203, "kl": 0.008599301800131798, "vf_loss": 42.11591720581055}, "num_steps_sampled": 5676716, "load_time_ms": 6.071, "num_steps_trained": 5676716, "sample_time_ms": 14926.982, "grad_time_ms": 23802.173}, "timesteps_total": 5676716, "training_iteration": 46, "episode_len_mean": 679.94, "episodes_total": 2244, "timestamp": 1556410315, "hostname": "flow-main", "date": "2019-04-28_00-11-55", "timesteps_since_restore": 5676716, "time_since_restore": 1786.9648711681366, "custom_metrics": {"cost2_max": -18.823596200291455, "system_level_velocity_mean": 12.70883812262094, "outflow_rate_mean": 1079.3839429199923, "cost1_min": 17.91897488959958, "outflow_rate_min": 442.8785900830537, "cost1_mean": 318.62954064570545, "cost1_max": 463.6164162969952, "cost2_min": -248.67825952314598, "system_level_velocity_max": 18.535013421648642, "outflow_rate_max": 1346.7196932627658, "system_level_velocity_min": 9.05827197599974, "cost2_mean": -206.28098109061858}}
{"episode_reward_min": 35.34440730063439, "policy_reward_mean": {}, "time_this_iter_s": 40.96879506111145, "num_metric_batches_dropped": 0, "episodes_this_iter": 47, "episode_reward_mean": 697.3981881627649, "episode_reward_max": 955.9019258681576, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc048>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc6d8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acceb8>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 123591, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 1827.933666229248, "pid": 33400, "iterations_since_restore": 47, "done": false, "info": {"update_time_ms": 11.469, "default": {"entropy": 1.0582783222198486, "vf_explained_var": 0.7255292534828186, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.00034085859078913927, "cur_lr": 0.0005000000237487257, "total_loss": 42.32566452026367, "kl": 0.0070794071070849895, "vf_loss": 42.32596206665039}, "num_steps_sampled": 5800307, "load_time_ms": 6.473, "num_steps_trained": 5800307, "sample_time_ms": 14956.189, "grad_time_ms": 24130.942}, "timesteps_total": 5800307, "training_iteration": 47, "episode_len_mean": 679.94, "episodes_total": 2291, "timestamp": 1556410356, "hostname": "flow-main", "date": "2019-04-28_00-12-36", "timesteps_since_restore": 5800307, "time_since_restore": 1827.933666229248, "custom_metrics": {"cost2_max": -18.823596200291455, "system_level_velocity_mean": 12.747340451274383, "outflow_rate_mean": 1083.8148826741503, "cost1_min": 17.728035381476303, "outflow_rate_min": 462.55509215489616, "cost1_mean": 319.4925885483559, "cost1_max": 454.298907960708, "cost2_min": -252.57512984252153, "system_level_velocity_max": 18.535013421648642, "outflow_rate_max": 1335.439220453915, "system_level_velocity_min": 9.802150294940008, "cost2_mean": -207.47023386269447}}
{"episode_reward_min": 37.23926846810267, "policy_reward_mean": {}, "time_this_iter_s": 40.234660387039185, "num_metric_batches_dropped": 0, "episodes_this_iter": 47, "episode_reward_mean": 700.3833254041358, "episode_reward_max": 964.8845686198885, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7ef0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad75f8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863adaa90>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 122925, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 1868.1683266162872, "pid": 33400, "iterations_since_restore": 48, "done": false, "info": {"update_time_ms": 11.819, "default": {"entropy": 1.0638680458068848, "vf_explained_var": 0.7393573522567749, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0003679848450701684, "cur_lr": 0.0005000000237487257, "total_loss": 41.21766662597656, "kl": 0.007434212602674961, "vf_loss": 41.21799087524414}, "num_steps_sampled": 5923232, "load_time_ms": 6.516, "num_steps_trained": 5923232, "sample_time_ms": 15036.289, "grad_time_ms": 24297.645}, "timesteps_total": 5923232, "training_iteration": 48, "episode_len_mean": 693.27, "episodes_total": 2338, "timestamp": 1556410396, "hostname": "flow-main", "date": "2019-04-28_00-13-16", "timesteps_since_restore": 5923232, "time_since_restore": 1868.1683266162872, "custom_metrics": {"cost2_max": -19.32362319987223, "system_level_velocity_mean": 12.43157226897946, "outflow_rate_mean": 1084.7753863471853, "cost1_min": 17.728035381476303, "outflow_rate_min": 462.55509215489616, "cost1_mean": 319.4377630777785, "cost1_max": 454.298907960708, "cost2_min": -252.57512984252153, "system_level_velocity_max": 17.454623802867953, "outflow_rate_max": 1335.439220453915, "system_level_velocity_min": 9.802150294940008, "cost2_mean": -214.55263278047195}}
{"episode_reward_min": 603.9877013515212, "policy_reward_mean": {}, "time_this_iter_s": 40.07473564147949, "num_metric_batches_dropped": 0, "episodes_this_iter": 57, "episode_reward_mean": 709.7189491168168, "episode_reward_max": 964.8845686198885, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc668>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ab0ba8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a5be48>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 123356, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 1908.2430622577667, "pid": 33400, "iterations_since_restore": 49, "done": false, "info": {"update_time_ms": 12.24, "default": {"entropy": 1.045213222503662, "vf_explained_var": 0.7272256016731262, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0004615508078131825, "cur_lr": 0.0005000000237487257, "total_loss": 41.73553466796875, "kl": 0.00810210220515728, "vf_loss": 41.73594665527344}, "num_steps_sampled": 6046588, "load_time_ms": 6.585, "num_steps_trained": 6046588, "sample_time_ms": 15083.242, "grad_time_ms": 24339.411}, "timesteps_total": 6046588, "training_iteration": 49, "episode_len_mean": 700.0, "episodes_total": 2395, "timestamp": 1556410437, "hostname": "flow-main", "date": "2019-04-28_00-13-57", "timesteps_since_restore": 6046588, "time_since_restore": 1908.2430622577667, "custom_metrics": {"cost2_max": -171.61874561982108, "system_level_velocity_mean": 12.565494532409614, "outflow_rate_mean": 1103.0337073360502, "cost1_min": 256.3087224187084, "outflow_rate_min": 960.1208598927358, "cost1_mean": 327.0577795039045, "cost1_max": 454.2176321461216, "cost2_min": -253.30562547644365, "system_level_velocity_max": 17.366755646017666, "outflow_rate_max": 1333.0274695966386, "system_level_velocity_min": 9.835511443313367, "cost2_mean": -217.90328414518456}}
{"episode_reward_min": 599.870436748193, "policy_reward_mean": {}, "time_this_iter_s": 38.4946973323822, "num_metric_batches_dropped": 0, "episodes_this_iter": 41, "episode_reward_mean": 721.2559131027307, "episode_reward_max": 1004.4466009697238, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "optimizer": {}, "sample_batch_size": 200, "synchronize_filters": true, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f78d9c4ec18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a5bb00>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a5b2e8>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "model": {"custom_options": {}, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "framestack": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "free_log_std": false, "custom_model": null, "zero_mean": true, "channel_major": false, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "collect_metrics_timeout": 180, "sample_async": false, "kl_coeff": 0.2, "compress_observations": false, "vf_loss_coeff": 1.0, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "node_ip": "10.138.0.2", "timesteps_this_iter": 120314, "experiment_id": "2cff12669d654b3b9d6c0084aac32eef", "time_total_s": 1946.737759590149, "pid": 33400, "iterations_since_restore": 50, "done": true, "info": {"update_time_ms": 12.448, "default": {"entropy": 1.0520384311676025, "vf_explained_var": 0.7566385269165039, "cur_kl_coeff": 0.006250001024454832, "policy_loss": -0.0004115832853130996, "cur_lr": 0.0005000000237487257, "total_loss": 41.06302261352539, "kl": 0.006888335570693016, "vf_loss": 41.06338882446289}, "num_steps_sampled": 6166902, "load_time_ms": 6.746, "num_steps_trained": 6166902, "sample_time_ms": 15102.302, "grad_time_ms": 24124.229}, "timesteps_total": 6166902, "training_iteration": 50, "episode_len_mean": 700.0, "episodes_total": 2436, "timestamp": 1556410475, "hostname": "flow-main", "date": "2019-04-28_00-14-35", "timesteps_since_restore": 6166902, "time_since_restore": 1946.737759590149, "custom_metrics": {"cost2_max": -165.07675363490804, "system_level_velocity_mean": 12.85709615734564, "outflow_rate_mean": 1117.3034426360396, "cost1_min": 257.2733254500585, "outflow_rate_min": 939.6296134969103, "cost1_mean": 334.73846156341233, "cost1_max": 456.4417792989283, "cost2_min": -253.30562547644365, "system_level_velocity_max": 17.295996621099967, "outflow_rate_max": 1336.25772453817, "system_level_velocity_min": 10.010210720715186, "cost2_mean": -213.82276351950813}}

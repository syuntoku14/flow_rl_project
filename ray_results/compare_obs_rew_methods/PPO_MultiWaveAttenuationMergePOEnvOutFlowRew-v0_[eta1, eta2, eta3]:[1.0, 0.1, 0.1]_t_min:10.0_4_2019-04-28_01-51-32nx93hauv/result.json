{"timesteps_total": 119582, "time_this_iter_s": 71.82657957077026, "num_metric_batches_dropped": 0, "episodes_this_iter": 25, "episodes_total": 25, "episode_reward_max": 476.0423708848142, "node_ip": "10.138.0.2", "timesteps_since_restore": 119582, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 673.4, "timesteps_this_iter": 119582, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ab08d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ab0160>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ab0518>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 1, "done": false, "info": {"update_time_ms": 2481.612, "default": {"entropy": 1.4171617031097412, "vf_explained_var": 0.8782660961151123, "cur_kl_coeff": 0.20000004768371582, "policy_loss": -0.000394572940422222, "cur_lr": 0.0005000000237487257, "total_loss": 1.3782272338867188, "kl": 0.0014212592504918575, "vf_loss": 1.3783375024795532}, "num_steps_sampled": 119582, "load_time_ms": 48.595, "num_steps_trained": 119582, "sample_time_ms": 46109.502, "grad_time_ms": 22933.692}, "training_iteration": 1, "pid": 64382, "episode_reward_mean": 310.10439148960336, "timestamp": 1556416387, "time_total_s": 71.82657957077026, "date": "2019-04-28_01-53-07", "episode_reward_min": 47.383491798419534, "time_since_restore": 71.82657957077026, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -19.570730810146323, "system_level_velocity_mean": 8.11715377434007, "outflow_rate_max": 713.8996004134566, "cost1_min": 21.98702995224827, "outflow_rate_min": 487.2386111474995, "cost1_mean": 191.490278965492, "cost1_max": 230.82242720199895, "cost2_min": -84.20716196918505, "system_level_velocity_max": 17.594817257182964, "outflow_rate_mean": 601.9272690004256, "system_level_velocity_min": 6.396155097080548, "cost2_mean": -49.324035230014815}}
{"timesteps_total": 237633, "time_this_iter_s": 39.52461338043213, "num_metric_batches_dropped": 0, "episodes_this_iter": 62, "episodes_total": 87, "episode_reward_max": 568.5693978519778, "node_ip": "10.138.0.2", "timesteps_since_restore": 237633, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 684.7126436781609, "timesteps_this_iter": 118051, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75d30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75eb8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75a58>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 2, "done": false, "info": {"update_time_ms": 1246.468, "default": {"entropy": 1.4177062511444092, "vf_explained_var": 0.8980828523635864, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0024682232178747654, "cur_lr": 0.0005000000237487257, "total_loss": 1.6519560813903809, "kl": 0.0070397574454545975, "vf_loss": 1.6537203788757324}, "num_steps_sampled": 237633, "load_time_ms": 29.727, "num_steps_trained": 237633, "sample_time_ms": 30741.153, "grad_time_ms": 23430.695}, "training_iteration": 2, "pid": 64382, "episode_reward_mean": 350.40879126692266, "timestamp": 1556416427, "time_total_s": 111.35119295120239, "date": "2019-04-28_01-53-47", "episode_reward_min": 47.383491798419534, "time_since_restore": 111.35119295120239, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -19.570730810146323, "system_level_velocity_mean": 7.903473680702698, "outflow_rate_max": 832.3249870265408, "cost1_min": 21.98702995224827, "outflow_rate_min": 427.80026473138446, "cost1_mean": 194.5116533696069, "cost1_max": 257.45290004984804, "cost2_min": -95.79290075011667, "system_level_velocity_max": 18.334411533160164, "outflow_rate_mean": 604.7438367710241, "system_level_velocity_min": 6.192217453639556, "cost2_mean": -54.897878660350706}}
{"timesteps_total": 351822, "time_this_iter_s": 36.915278673172, "num_metric_batches_dropped": 0, "episodes_this_iter": 50, "episodes_total": 137, "episode_reward_max": 652.722188280835, "node_ip": "10.138.0.2", "timesteps_since_restore": 351822, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 693.35, "timesteps_this_iter": 114189, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a68cc0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a68a20>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a689e8>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 3, "done": false, "info": {"update_time_ms": 834.658, "default": {"entropy": 1.4021366834640503, "vf_explained_var": 0.8929699063301086, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.005431054625660181, "cur_lr": 0.0005000000237487257, "total_loss": 3.583972930908203, "kl": 0.009274084120988846, "vf_loss": 3.5884764194488525}, "num_steps_sampled": 351822, "load_time_ms": 22.31, "num_steps_trained": 351822, "sample_time_ms": 25138.332, "grad_time_ms": 23207.098}, "training_iteration": 3, "pid": 64382, "episode_reward_mean": 408.9113551815501, "timestamp": 1556416464, "time_total_s": 148.2664716243744, "date": "2019-04-28_01-54-24", "episode_reward_min": 48.13686455366655, "time_since_restore": 148.2664716243744, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -20.856565083824165, "system_level_velocity_mean": 8.18948221264035, "outflow_rate_max": 937.8821217095839, "cost1_min": 22.721576770757366, "outflow_rate_min": 427.80026473138446, "cost1_mean": 208.48758270306314, "cost1_max": 295.02911920325164, "cost2_min": -95.79290075011667, "system_level_velocity_max": 18.334411533160164, "outflow_rate_mean": 636.5135671276967, "system_level_velocity_min": 6.192217453639556, "cost2_mean": -59.17048781066945}}
{"timesteps_total": 467422, "time_this_iter_s": 37.36625814437866, "num_metric_batches_dropped": 0, "episodes_this_iter": 57, "episodes_total": 194, "episode_reward_max": 839.9850548490203, "node_ip": "10.138.0.2", "timesteps_since_restore": 467422, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 115600, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a752b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75eb8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75d30>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 4, "done": false, "info": {"update_time_ms": 628.434, "default": {"entropy": 1.3690650463104248, "vf_explained_var": 0.7748024463653564, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0029808373656123877, "cur_lr": 0.0005000000237487257, "total_loss": 8.57470417022705, "kl": 0.007698201574385166, "vf_loss": 8.576915740966797}, "num_steps_sampled": 467422, "load_time_ms": 18.868, "num_steps_trained": 467422, "sample_time_ms": 22659.845, "grad_time_ms": 22888.384}, "training_iteration": 4, "pid": 64382, "episode_reward_mean": 564.5898702295021, "timestamp": 1556416501, "time_total_s": 185.63272976875305, "date": "2019-04-28_01-55-01", "episode_reward_min": 305.5966414440804, "time_since_restore": 185.63272976875305, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -41.2855341735526, "system_level_velocity_mean": 9.529859220009238, "outflow_rate_max": 982.8178957666753, "cost1_min": 172.76837006326838, "outflow_rate_min": 522.1851473083947, "cost1_mean": 249.42588370646934, "cost1_max": 316.95115249377636, "cost2_min": -106.6096520801172, "system_level_velocity_max": 12.003177027152393, "outflow_rate_mean": 748.4276659409367, "system_level_velocity_min": 6.800837162472999, "cost2_mean": -66.44377316755187}}
{"timesteps_total": 586415, "time_this_iter_s": 38.80381417274475, "num_metric_batches_dropped": 0, "episodes_this_iter": 50, "episodes_total": 244, "episode_reward_max": 908.7668540647517, "node_ip": "10.138.0.2", "timesteps_since_restore": 586415, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 118993, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a750b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75278>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75fd0>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 5, "done": false, "info": {"update_time_ms": 504.92, "default": {"entropy": 1.3601552248001099, "vf_explained_var": 0.7685448527336121, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.000501204514876008, "cur_lr": 0.0005000000237487257, "total_loss": 10.872903823852539, "kl": 0.002996766706928611, "vf_loss": 10.873106002807617}, "num_steps_sampled": 586415, "load_time_ms": 16.827, "num_steps_trained": 586415, "sample_time_ms": 21119.279, "grad_time_ms": 23030.859}, "training_iteration": 5, "pid": 64382, "episode_reward_mean": 731.2508174436499, "timestamp": 1556416540, "time_total_s": 224.4365439414978, "date": "2019-04-28_01-55-40", "episode_reward_min": 392.948170763328, "time_since_restore": 224.4365439414978, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -48.06070258142538, "system_level_velocity_mean": 10.705715652745516, "outflow_rate_max": 1023.4484221302394, "cost1_min": 183.07205294528242, "outflow_rate_min": 574.6053480495051, "cost1_mean": 282.9710745337478, "cost1_max": 336.71004508312706, "cost2_min": -141.36289626976344, "system_level_velocity_max": 12.633604227845629, "outflow_rate_mean": 870.8742775968831, "system_level_velocity_min": 7.048949864904584, "cost2_mean": -85.95726729356171}}
{"timesteps_total": 709098, "time_this_iter_s": 38.460543155670166, "num_metric_batches_dropped": 0, "episodes_this_iter": 49, "episodes_total": 293, "episode_reward_max": 919.049260211963, "node_ip": "10.138.0.2", "timesteps_since_restore": 709098, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 122683, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75908>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75cc0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863ad7128>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 6, "done": false, "info": {"update_time_ms": 422.806, "default": {"entropy": 1.3562283515930176, "vf_explained_var": 0.8083467483520508, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0005853768670931458, "cur_lr": 0.0005000000237487257, "total_loss": 9.927345275878906, "kl": 0.004611161537468433, "vf_loss": 9.92770004272461}, "num_steps_sampled": 709098, "load_time_ms": 15.43, "num_steps_trained": 709098, "sample_time_ms": 19993.368, "grad_time_ms": 23168.397}, "training_iteration": 6, "pid": 64382, "episode_reward_mean": 811.904322846362, "timestamp": 1556416578, "time_total_s": 262.89708709716797, "date": "2019-04-28_01-56-18", "episode_reward_min": 539.1432532020773, "time_since_restore": 262.89708709716797, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -57.62853932566288, "system_level_velocity_mean": 11.100099963654324, "outflow_rate_max": 1038.1449603163492, "cost1_min": 236.8760134549661, "outflow_rate_min": 740.176075531455, "cost1_mean": 295.43524463519987, "cost1_max": 336.71004508312706, "cost2_min": -154.57631294206752, "system_level_velocity_max": 12.633604227845629, "outflow_rate_mean": 945.4809902904678, "system_level_velocity_min": 8.98033591443867, "cost2_mean": -111.3017974170856}}
{"timesteps_total": 833938, "time_this_iter_s": 38.38017559051514, "num_metric_batches_dropped": 0, "episodes_this_iter": 57, "episodes_total": 350, "episode_reward_max": 969.1874653520817, "node_ip": "10.138.0.2", "timesteps_since_restore": 833938, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 124840, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75470>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75208>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75fd0>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 7, "done": false, "info": {"update_time_ms": 363.742, "default": {"entropy": 1.3370387554168701, "vf_explained_var": 0.7568130493164062, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0006378346006385982, "cur_lr": 0.0005000000237487257, "total_loss": 10.282599449157715, "kl": 0.00521776033565402, "vf_loss": 10.283106803894043}, "num_steps_sampled": 833938, "load_time_ms": 14.471, "num_steps_trained": 833938, "sample_time_ms": 19258.363, "grad_time_ms": 23185.845}, "training_iteration": 7, "pid": 64382, "episode_reward_mean": 827.8508039977635, "timestamp": 1556416617, "time_total_s": 301.2772626876831, "date": "2019-04-28_01-56-57", "episode_reward_min": 691.7340662595267, "time_since_restore": 301.2772626876831, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -94.82454749365138, "system_level_velocity_mean": 11.068065229682912, "outflow_rate_max": 1085.7905786080796, "cost1_min": 234.12397232798412, "outflow_rate_min": 817.7004670077911, "cost1_mean": 295.33967156274906, "cost1_max": 352.4280615596697, "cost2_min": -158.45840513177262, "system_level_velocity_max": 13.159106785970721, "outflow_rate_mean": 971.4860481098501, "system_level_velocity_min": 8.875150949562132, "cost2_mean": -130.82687816244157}}
{"timesteps_total": 958142, "time_this_iter_s": 40.89188098907471, "num_metric_batches_dropped": 0, "episodes_this_iter": 26, "episodes_total": 376, "episode_reward_max": 969.1874653520817, "node_ip": "10.138.0.2", "timesteps_since_restore": 958142, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 124204, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75438>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75e10>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75da0>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 8, "done": false, "info": {"update_time_ms": 319.632, "default": {"entropy": 1.3162013292312622, "vf_explained_var": 0.8286570310592651, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0015121700707823038, "cur_lr": 0.0005000000237487257, "total_loss": 7.204770088195801, "kl": 0.007132178172469139, "vf_loss": 7.206103801727295}, "num_steps_sampled": 958142, "load_time_ms": 13.84, "num_steps_trained": 958142, "sample_time_ms": 18802.546, "grad_time_ms": 23420.375}, "training_iteration": 8, "pid": 64382, "episode_reward_mean": 834.4717416039609, "timestamp": 1556416658, "time_total_s": 342.1691436767578, "date": "2019-04-28_01-57-38", "episode_reward_min": 725.2865229923603, "time_since_restore": 342.1691436767578, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -94.82454749365138, "system_level_velocity_mean": 11.13218566407346, "outflow_rate_max": 1085.7905786080796, "cost1_min": 234.12397232798412, "outflow_rate_min": 817.7004670077911, "cost1_mean": 297.2438160397612, "cost1_max": 352.4280615596697, "cost2_min": -158.45840513177262, "system_level_velocity_max": 13.159106785970721, "outflow_rate_mean": 975.283378485357, "system_level_velocity_min": 8.875150949562132, "cost2_mean": -131.4363356293554}}
{"timesteps_total": 1080265, "time_this_iter_s": 38.993430614471436, "num_metric_batches_dropped": 0, "episodes_this_iter": 56, "episodes_total": 432, "episode_reward_max": 948.6660491942481, "node_ip": "10.138.0.2", "timesteps_since_restore": 1080265, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 122123, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a685c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a68cf8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a5b7b8>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 9, "done": false, "info": {"update_time_ms": 285.358, "default": {"entropy": 1.327486515045166, "vf_explained_var": 0.768930196762085, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0008737994940020144, "cur_lr": 0.0005000000237487257, "total_loss": 12.011445999145508, "kl": 0.005610446911305189, "vf_loss": 12.012179374694824}, "num_steps_sampled": 1080265, "load_time_ms": 13.41, "num_steps_trained": 1080265, "sample_time_ms": 18311.604, "grad_time_ms": 23525.561}, "training_iteration": 9, "pid": 64382, "episode_reward_mean": 844.8321002792634, "timestamp": 1556416697, "time_total_s": 381.16257429122925, "date": "2019-04-28_01-58-17", "episode_reward_min": 725.2865229923603, "time_since_restore": 381.16257429122925, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -99.78098987179688, "system_level_velocity_mean": 11.23435724817788, "outflow_rate_max": 1062.7321661675849, "cost1_min": 245.53900146385428, "outflow_rate_min": 841.915970125552, "cost1_mean": 300.32287397976324, "cost1_max": 342.2301757330214, "cost2_min": -159.50641040209962, "system_level_velocity_max": 12.75908298565772, "outflow_rate_mean": 976.471089137819, "system_level_velocity_min": 9.201243249978962, "cost2_mean": -131.0889302124327}}
{"timesteps_total": 1202432, "time_this_iter_s": 38.717241048812866, "num_metric_batches_dropped": 0, "episodes_this_iter": 52, "episodes_total": 484, "episode_reward_max": 991.6535068731972, "node_ip": "10.138.0.2", "timesteps_since_restore": 1202432, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 122167, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a750f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a759e8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75da0>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 10, "done": false, "info": {"update_time_ms": 257.899, "default": {"entropy": 1.3184062242507935, "vf_explained_var": 0.76326584815979, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0006819884874857962, "cur_lr": 0.0005000000237487257, "total_loss": 11.623900413513184, "kl": 0.006918152328580618, "vf_loss": 11.624408721923828}, "num_steps_sampled": 1202432, "load_time_ms": 12.997, "num_steps_trained": 1202432, "sample_time_ms": 17937.807, "grad_time_ms": 23562.235}, "training_iteration": 10, "pid": 64382, "episode_reward_mean": 863.4910998721138, "timestamp": 1556416735, "time_total_s": 419.8798153400421, "date": "2019-04-28_01-58-55", "episode_reward_min": 733.9133394138744, "time_since_restore": 419.8798153400421, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -108.16485883869237, "system_level_velocity_mean": 11.385686905368457, "outflow_rate_max": 1086.0423332591345, "cost1_min": 245.53900146385428, "outflow_rate_min": 841.915970125552, "cost1_mean": 304.93771800700847, "cost1_max": 349.2189904336315, "cost2_min": -168.64586143183016, "system_level_velocity_max": 12.997271999050112, "outflow_rate_mean": 994.4734822027755, "system_level_velocity_min": 9.201243249978962, "cost2_mean": -140.2743893126273}}
{"timesteps_total": 1323800, "time_this_iter_s": 37.163445472717285, "num_metric_batches_dropped": 0, "episodes_this_iter": 54, "episodes_total": 538, "episode_reward_max": 991.6535068731972, "node_ip": "10.138.0.2", "timesteps_since_restore": 1323800, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 121368, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a684e0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a685c0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a68390>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 11, "done": false, "info": {"update_time_ms": 11.032, "default": {"entropy": 1.3162877559661865, "vf_explained_var": 0.7493762373924255, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0009702927200123668, "cur_lr": 0.0005000000237487257, "total_loss": 13.085692405700684, "kl": 0.006438686978071928, "vf_loss": 13.086502075195312}, "num_steps_sampled": 1323800, "load_time_ms": 9.03, "num_steps_trained": 1323800, "sample_time_ms": 14780.825, "grad_time_ms": 23509.842}, "training_iteration": 11, "pid": 64382, "episode_reward_mean": 870.6763826405813, "timestamp": 1556416773, "time_total_s": 457.0432608127594, "date": "2019-04-28_01-59-33", "episode_reward_min": 773.5231462773248, "time_since_restore": 457.0432608127594, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -118.68920774140034, "system_level_velocity_mean": 11.388373494276804, "outflow_rate_max": 1091.5605391044526, "cost1_min": 258.72540656648744, "outflow_rate_min": 888.2644984463127, "cost1_mean": 305.4538083940181, "cost1_max": 349.2189904336315, "cost2_min": -183.58060759794108, "system_level_velocity_max": 12.997271999050112, "outflow_rate_mean": 1007.5345686805689, "system_level_velocity_min": 9.599437625722913, "cost2_mean": -151.55656964575815}}
{"timesteps_total": 1448930, "time_this_iter_s": 39.252158880233765, "num_metric_batches_dropped": 0, "episodes_this_iter": 57, "episodes_total": 595, "episode_reward_max": 989.0503110153868, "node_ip": "10.138.0.2", "timesteps_since_restore": 1448930, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 125130, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a759e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75da0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a750f0>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 12, "done": false, "info": {"update_time_ms": 11.576, "default": {"entropy": 1.2948803901672363, "vf_explained_var": 0.6723881363868713, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.000614061311352998, "cur_lr": 0.0005000000237487257, "total_loss": 14.378785133361816, "kl": 0.005784026347100735, "vf_loss": 14.379255294799805}, "num_steps_sampled": 1448930, "load_time_ms": 9.093, "num_steps_trained": 1448930, "sample_time_ms": 14728.632, "grad_time_ms": 23534.98}, "training_iteration": 12, "pid": 64382, "episode_reward_mean": 857.334805270372, "timestamp": 1556416812, "time_total_s": 496.29541969299316, "date": "2019-04-28_02-00-12", "episode_reward_min": 781.3779338600733, "time_since_restore": 496.29541969299316, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -134.68743764001962, "system_level_velocity_mean": 11.163429069433025, "outflow_rate_max": 1091.4348910598228, "cost1_min": 255.20154508457256, "outflow_rate_min": 888.2644984463127, "cost1_mean": 299.11341717431185, "cost1_max": 336.1476387872542, "cost2_min": -188.53505330813317, "system_level_velocity_max": 12.489527689000472, "outflow_rate_mean": 1004.7704358261523, "system_level_velocity_min": 9.540846219110826, "cost2_mean": -162.74581943942783}}
{"timesteps_total": 1573379, "time_this_iter_s": 38.71628975868225, "num_metric_batches_dropped": 0, "episodes_this_iter": 28, "episodes_total": 623, "episode_reward_max": 989.0503110153868, "node_ip": "10.138.0.2", "timesteps_since_restore": 1573379, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 693.35, "timesteps_this_iter": 124449, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77400>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a5b898>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77860>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 13, "done": false, "info": {"update_time_ms": 11.57, "default": {"entropy": 1.288297176361084, "vf_explained_var": 0.7652446627616882, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.0004886329988949001, "cur_lr": 0.0005000000237487257, "total_loss": 9.807504653930664, "kl": 0.0057876924984157085, "vf_loss": 9.80784797668457}, "num_steps_sampled": 1573379, "load_time_ms": 9.406, "num_steps_trained": 1573379, "sample_time_ms": 14832.561, "grad_time_ms": 23608.694}, "training_iteration": 13, "pid": 64382, "episode_reward_mean": 855.5830073946736, "timestamp": 1556416851, "time_total_s": 535.0117094516754, "date": "2019-04-28_02-00-51", "episode_reward_min": 46.015005959300176, "time_since_restore": 535.0117094516754, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -19.99392993505555, "system_level_velocity_mean": 11.293077502284419, "outflow_rate_max": 1096.2828533862378, "cost1_min": 22.287023484327026, "outflow_rate_min": 511.17688865063195, "cost1_mean": 298.0578134843817, "cost1_max": 336.1476387872542, "cost2_min": -190.09119106778468, "system_level_velocity_max": 18.03735376983099, "outflow_rate_mean": 1009.9807975902108, "system_level_velocity_min": 9.540846219110826, "cost2_mean": -165.05763998814405}}
{"timesteps_total": 1700285, "time_this_iter_s": 40.98779225349426, "num_metric_batches_dropped": 0, "episodes_this_iter": 54, "episodes_total": 677, "episode_reward_max": 989.0503110153868, "node_ip": "10.138.0.2", "timesteps_since_restore": 1700285, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 693.35, "timesteps_this_iter": 126906, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863acc0b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75cc0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a68828>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 14, "done": false, "info": {"update_time_ms": 11.678, "default": {"entropy": 1.2935596704483032, "vf_explained_var": 0.696713924407959, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.0009589488035999238, "cur_lr": 0.0005000000237487257, "total_loss": 15.038454055786133, "kl": 0.0064971232786774635, "vf_loss": 15.039251327514648}, "num_steps_sampled": 1700285, "load_time_ms": 9.738, "num_steps_trained": 1700285, "sample_time_ms": 14803.334, "grad_time_ms": 23997.108}, "training_iteration": 14, "pid": 64382, "episode_reward_mean": 860.8054780849773, "timestamp": 1556416892, "time_total_s": 575.9995017051697, "date": "2019-04-28_02-01-32", "episode_reward_min": 46.015005959300176, "time_since_restore": 575.9995017051697, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -19.99392993505555, "system_level_velocity_mean": 11.378378538461584, "outflow_rate_max": 1107.73002420709, "cost1_min": 22.287023484327026, "outflow_rate_min": 511.17688865063195, "cost1_mean": 300.2010516618025, "cost1_max": 336.1476387872542, "cost2_min": -197.77214005482125, "system_level_velocity_max": 18.03735376983099, "outflow_rate_mean": 1020.8382830630972, "system_level_velocity_min": 9.540846219110826, "cost2_mean": -169.77671700635594}}
{"timesteps_total": 1827149, "time_this_iter_s": 40.7244930267334, "num_metric_batches_dropped": 0, "episodes_this_iter": 48, "episodes_total": 725, "episode_reward_max": 981.2096222299185, "node_ip": "10.138.0.2", "timesteps_since_restore": 1827149, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 126864, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a772e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a777f0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a773c8>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 15, "done": false, "info": {"update_time_ms": 11.758, "default": {"entropy": 1.2729047536849976, "vf_explained_var": 0.7013343572616577, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.0002614986151456833, "cur_lr": 0.0005000000237487257, "total_loss": 14.844732284545898, "kl": 0.0058476366102695465, "vf_loss": 14.844847679138184}, "num_steps_sampled": 1827149, "load_time_ms": 9.575, "num_steps_trained": 1827149, "sample_time_ms": 14830.738, "grad_time_ms": 24161.759}, "training_iteration": 15, "pid": 64382, "episode_reward_mean": 855.4897986366116, "timestamp": 1556416932, "time_total_s": 616.7239947319031, "date": "2019-04-28_02-02-12", "episode_reward_min": 710.5171275872162, "time_since_restore": 616.7239947319031, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -147.00683808644823, "system_level_velocity_mean": 11.177449293276547, "outflow_rate_max": 1107.73002420709, "cost1_min": 239.020913498156, "outflow_rate_min": 849.2614761193894, "cost1_mean": 298.6367419839793, "cost1_max": 333.2256184853353, "cost2_min": -200.0505185050239, "system_level_velocity_max": 12.39688332460607, "outflow_rate_mean": 1016.7925504274936, "system_level_velocity_min": 9.13133692266995, "cost2_mean": -174.76639403799055}}
{"timesteps_total": 1950376, "time_this_iter_s": 38.886791467666626, "num_metric_batches_dropped": 0, "episodes_this_iter": 53, "episodes_total": 778, "episode_reward_max": 935.576010574312, "node_ip": "10.138.0.2", "timesteps_since_restore": 1950376, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 123227, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a5b5c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a5bbe0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77470>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 16, "done": false, "info": {"update_time_ms": 11.461, "default": {"entropy": 1.2691807746887207, "vf_explained_var": 0.6997200846672058, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0007003488717600703, "cur_lr": 0.0005000000237487257, "total_loss": 16.27482795715332, "kl": 0.006024130620062351, "vf_loss": 16.27537727355957}, "num_steps_sampled": 1950376, "load_time_ms": 9.554, "num_steps_trained": 1950376, "sample_time_ms": 14889.036, "grad_time_ms": 24145.175}, "training_iteration": 16, "pid": 64382, "episode_reward_mean": 834.912211794273, "timestamp": 1556416971, "time_total_s": 655.6107861995697, "date": "2019-04-28_02-02-51", "episode_reward_min": 710.5171275872162, "time_since_restore": 655.6107861995697, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -154.2918866543042, "system_level_velocity_mean": 11.010980068192998, "outflow_rate_max": 1098.454666785316, "cost1_min": 239.020913498156, "outflow_rate_min": 849.2614761193894, "cost1_mean": 293.26635587270295, "cost1_max": 328.55248525091406, "cost2_min": -211.33719409842152, "system_level_velocity_max": 12.344600230044396, "outflow_rate_mean": 1006.9844385978656, "system_level_velocity_min": 9.13133692266995, "cost2_mean": -179.2939094433093}}
{"timesteps_total": 2075727, "time_this_iter_s": 38.592557191848755, "num_metric_batches_dropped": 0, "episodes_this_iter": 57, "episodes_total": 835, "episode_reward_max": 935.576010574312, "node_ip": "10.138.0.2", "timesteps_since_restore": 2075727, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 125351, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77a58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77f28>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77ac8>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 17, "done": false, "info": {"update_time_ms": 11.606, "default": {"entropy": 1.2647804021835327, "vf_explained_var": 0.6550559401512146, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.00027649151161313057, "cur_lr": 0.0005000000237487257, "total_loss": 16.449199676513672, "kl": 0.006411682348698378, "vf_loss": 16.44931411743164}, "num_steps_sampled": 2075727, "load_time_ms": 9.704, "num_steps_trained": 2075727, "sample_time_ms": 14924.937, "grad_time_ms": 24130.825}, "training_iteration": 17, "pid": 64382, "episode_reward_mean": 830.783346626231, "timestamp": 1556417010, "time_total_s": 694.2033433914185, "date": "2019-04-28_02-03-30", "episode_reward_min": 763.8400965499783, "time_since_restore": 694.2033433914185, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -155.18352185409762, "system_level_velocity_mean": 11.085057801928698, "outflow_rate_max": 1096.4967484600238, "cost1_min": 248.99936450713676, "outflow_rate_min": 892.2314187259785, "cost1_mean": 294.88609450270366, "cost1_max": 324.06415142567727, "cost2_min": -211.33719409842152, "system_level_velocity_max": 12.12894357158436, "outflow_rate_mean": 1012.3168572052124, "system_level_velocity_min": 9.502793194020262, "cost2_mean": -180.35466593698064}}
{"timesteps_total": 2200516, "time_this_iter_s": 37.41877198219299, "num_metric_batches_dropped": 0, "episodes_this_iter": 31, "episodes_total": 866, "episode_reward_max": 919.900383186846, "node_ip": "10.138.0.2", "timesteps_since_restore": 2200516, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 693.27, "timesteps_this_iter": 124789, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77438>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77d30>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77e48>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 18, "done": false, "info": {"update_time_ms": 11.716, "default": {"entropy": 1.2506237030029297, "vf_explained_var": 0.7466233968734741, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.0005984394229017198, "cur_lr": 0.0005000000237487257, "total_loss": 12.579806327819824, "kl": 0.006312391720712185, "vf_loss": 12.580245971679688}, "num_steps_sampled": 2200516, "load_time_ms": 9.741, "num_steps_trained": 2200516, "sample_time_ms": 14822.198, "grad_time_ms": 23886.93}, "training_iteration": 18, "pid": 64382, "episode_reward_mean": 827.3634985566657, "timestamp": 1556417047, "time_total_s": 731.6221153736115, "date": "2019-04-28_02-04-07", "episode_reward_min": 37.23540890572163, "time_since_restore": 731.6221153736115, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -18.186719150258565, "system_level_velocity_mean": 11.320470949541708, "outflow_rate_max": 1101.0488120377324, "cost1_min": 17.82617686935755, "outflow_rate_min": 492.0625426222078, "cost1_mean": 296.36184603661576, "cost1_max": 341.0553168617315, "cost2_min": -210.74095990802306, "system_level_velocity_max": 17.643855826949917, "outflow_rate_mean": 1015.5137627499269, "system_level_velocity_min": 9.502793194020262, "cost2_mean": -177.89679684593983}}
{"timesteps_total": 2326610, "time_this_iter_s": 40.703962326049805, "num_metric_batches_dropped": 0, "episodes_this_iter": 54, "episodes_total": 920, "episode_reward_max": 964.2791188613957, "node_ip": "10.138.0.2", "timesteps_since_restore": 2326610, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 693.27, "timesteps_this_iter": 126094, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a68b70>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a689e8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a68828>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 19, "done": false, "info": {"update_time_ms": 11.567, "default": {"entropy": 1.226930856704712, "vf_explained_var": 0.6710363626480103, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0009166781092062593, "cur_lr": 0.0005000000237487257, "total_loss": 17.05641746520996, "kl": 0.007892045192420483, "vf_loss": 17.0571346282959}, "num_steps_sampled": 2326610, "load_time_ms": 9.848, "num_steps_trained": 2326610, "sample_time_ms": 14900.777, "grad_time_ms": 23981.215}, "training_iteration": 19, "pid": 64382, "episode_reward_mean": 836.9844254046476, "timestamp": 1556417088, "time_total_s": 772.3260776996613, "date": "2019-04-28_02-04-48", "episode_reward_min": 37.23540890572163, "time_since_restore": 772.3260776996613, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -18.186719150258565, "system_level_velocity_mean": 11.561977956550251, "outflow_rate_max": 1163.0990260440649, "cost1_min": 17.82617686935755, "outflow_rate_min": 492.0625426222078, "cost1_mean": 301.6524112269615, "cost1_max": 361.3077719270866, "cost2_min": -213.28776555422363, "system_level_velocity_max": 17.643855826949917, "outflow_rate_mean": 1027.508923345118, "system_level_velocity_min": 9.534251105915883, "cost2_mean": -179.2389396770802}}
{"timesteps_total": 2451888, "time_this_iter_s": 39.68294024467468, "num_metric_batches_dropped": 0, "episodes_this_iter": 50, "episodes_total": 970, "episode_reward_max": 964.2791188613957, "node_ip": "10.138.0.2", "timesteps_since_restore": 2451888, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 125278, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77470>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a779b0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a772b0>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 20, "done": false, "info": {"update_time_ms": 11.71, "default": {"entropy": 1.2153016328811646, "vf_explained_var": 0.6853553056716919, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.00045925358426757157, "cur_lr": 0.0005000000237487257, "total_loss": 17.705974578857422, "kl": 0.006061858963221312, "vf_loss": 17.706281661987305}, "num_steps_sampled": 2451888, "load_time_ms": 9.698, "num_steps_trained": 2451888, "sample_time_ms": 14946.121, "grad_time_ms": 24035.775}, "training_iteration": 20, "pid": 64382, "episode_reward_mean": 841.6737059587775, "timestamp": 1556417128, "time_total_s": 812.0090179443359, "date": "2019-04-28_02-05-28", "episode_reward_min": 698.6151734669105, "time_since_restore": 812.0090179443359, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -146.4132313703898, "system_level_velocity_mean": 11.423022127880154, "outflow_rate_max": 1163.0990260440649, "cost1_min": 219.44685563538224, "outflow_rate_min": 829.6793674217787, "cost1_mean": 301.9217092534267, "cost1_max": 361.3077719270866, "cost2_min": -215.1961495097134, "system_level_velocity_max": 13.504451543458318, "outflow_rate_mean": 1028.9547748164123, "system_level_velocity_min": 8.370016623631903, "cost2_mean": -182.95077299785575}}
{"timesteps_total": 2575347, "time_this_iter_s": 39.23216438293457, "num_metric_batches_dropped": 0, "episodes_this_iter": 52, "episodes_total": 1022, "episode_reward_max": 967.640681157242, "node_ip": "10.138.0.2", "timesteps_since_restore": 2575347, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 123459, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75208>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75278>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a753c8>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 21, "done": false, "info": {"update_time_ms": 11.643, "default": {"entropy": 1.2160801887512207, "vf_explained_var": 0.7065527439117432, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0005624195327982306, "cur_lr": 0.0005000000237487257, "total_loss": 17.71547508239746, "kl": 0.006470001768320799, "vf_loss": 17.71587371826172}, "num_steps_sampled": 2575347, "load_time_ms": 9.532, "num_steps_trained": 2575347, "sample_time_ms": 15000.894, "grad_time_ms": 24186.662}, "training_iteration": 21, "pid": 64382, "episode_reward_mean": 838.843952403002, "timestamp": 1556417167, "time_total_s": 851.2411823272705, "date": "2019-04-28_02-06-07", "episode_reward_min": 698.6151734669105, "time_since_restore": 851.2411823272705, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -146.4132313703898, "system_level_velocity_mean": 11.410546212537733, "outflow_rate_max": 1176.6985403133772, "cost1_min": 219.44685563538224, "outflow_rate_min": 829.6793674217787, "cost1_mean": 301.5993423339811, "cost1_max": 361.43399415997123, "cost2_min": -219.51186746709647, "system_level_velocity_max": 13.462233092886182, "outflow_rate_mean": 1031.5880395805812, "system_level_velocity_min": 8.370016623631903, "cost2_mean": -184.8927103701426}}
{"timesteps_total": 2701719, "time_this_iter_s": 39.27473592758179, "num_metric_batches_dropped": 0, "episodes_this_iter": 52, "episodes_total": 1074, "episode_reward_max": 967.640681157242, "node_ip": "10.138.0.2", "timesteps_since_restore": 2701719, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 126372, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a776a0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77940>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77898>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 22, "done": false, "info": {"update_time_ms": 11.028, "default": {"entropy": 1.210315227508545, "vf_explained_var": 0.6654370427131653, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.0008503590943291783, "cur_lr": 0.0005000000237487257, "total_loss": 18.713260650634766, "kl": 0.006910580676048994, "vf_loss": 18.713937759399414}, "num_steps_sampled": 2701719, "load_time_ms": 9.439, "num_steps_trained": 2701719, "sample_time_ms": 15028.754, "grad_time_ms": 24157.518}, "training_iteration": 22, "pid": 64382, "episode_reward_mean": 837.0925988555873, "timestamp": 1556417206, "time_total_s": 890.5159182548523, "date": "2019-04-28_02-06-46", "episode_reward_min": 738.1740155758812, "time_since_restore": 890.5159182548523, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -165.67994326274908, "system_level_velocity_mean": 11.530801582694552, "outflow_rate_max": 1176.6985403133772, "cost1_min": 253.27536818506286, "outflow_rate_min": 921.3273093897579, "cost1_mean": 304.2414606251337, "cost1_max": 361.43399415997123, "cost2_min": -219.51186746709647, "system_level_velocity_max": 13.462233092886182, "outflow_rate_mean": 1039.6454850164978, "system_level_velocity_min": 9.718404995673286, "cost2_mean": -186.05245187197772}}
{"timesteps_total": 2828502, "time_this_iter_s": 39.50860643386841, "num_metric_batches_dropped": 0, "episodes_this_iter": 33, "episodes_total": 1107, "episode_reward_max": 961.1621908921605, "node_ip": "10.138.0.2", "timesteps_since_restore": 2828502, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 126783, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75a90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75e80>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a753c8>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 23, "done": false, "info": {"update_time_ms": 11.131, "default": {"entropy": 1.1944544315338135, "vf_explained_var": 0.7670825719833374, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0004061071667820215, "cur_lr": 0.0005000000237487257, "total_loss": 13.774046897888184, "kl": 0.006850825157016516, "vf_loss": 13.77428150177002}, "num_steps_sampled": 2828502, "load_time_ms": 9.51, "num_steps_trained": 2828502, "sample_time_ms": 15053.425, "grad_time_ms": 24209.892}, "training_iteration": 23, "pid": 64382, "episode_reward_mean": 834.0431733275726, "timestamp": 1556417246, "time_total_s": 930.0245246887207, "date": "2019-04-28_02-07-26", "episode_reward_min": 738.1740155758812, "time_since_restore": 930.0245246887207, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -168.22719268372876, "system_level_velocity_mean": 11.532938937314887, "outflow_rate_max": 1131.7335444136643, "cost1_min": 253.27536818506286, "outflow_rate_min": 921.3273093897579, "cost1_mean": 304.0026120000099, "cost1_max": 344.61885600736144, "cost2_min": -219.51186746709647, "system_level_velocity_max": 12.961345597237406, "outflow_rate_mean": 1038.8566781852999, "system_level_velocity_min": 9.718404995673286, "cost2_mean": -185.94173940062998}}
{"timesteps_total": 2954275, "time_this_iter_s": 39.24900579452515, "num_metric_batches_dropped": 0, "episodes_this_iter": 53, "episodes_total": 1160, "episode_reward_max": 948.1257487825105, "node_ip": "10.138.0.2", "timesteps_since_restore": 2954275, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 125773, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77f98>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77358>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a775c0>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 24, "done": false, "info": {"update_time_ms": 11.43, "default": {"entropy": 1.18838369846344, "vf_explained_var": 0.7410635948181152, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.0002428160369163379, "cur_lr": 0.0005000000237487257, "total_loss": 20.846542358398438, "kl": 0.005898464936763048, "vf_loss": 20.846637725830078}, "num_steps_sampled": 2954275, "load_time_ms": 9.245, "num_steps_trained": 2954275, "sample_time_ms": 15049.144, "grad_time_ms": 24042.505}, "training_iteration": 24, "pid": 64382, "episode_reward_mean": 831.482425839961, "timestamp": 1556417285, "time_total_s": 969.2735304832458, "date": "2019-04-28_02-08-05", "episode_reward_min": 742.3046037735946, "time_since_restore": 969.2735304832458, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -159.6813911268945, "system_level_velocity_mean": 11.535101976047859, "outflow_rate_max": 1170.2720250091616, "cost1_min": 243.72147713926833, "outflow_rate_min": 924.3199043328618, "cost1_mean": 304.1577297133785, "cost1_max": 359.4314408445734, "cost2_min": -213.82905585991153, "system_level_velocity_max": 13.43637266338845, "outflow_rate_mean": 1038.9895216096206, "system_level_velocity_min": 9.352069399124536, "cost2_mean": -182.2631840597458}}
{"timesteps_total": 3079024, "time_this_iter_s": 40.31109428405762, "num_metric_batches_dropped": 0, "episodes_this_iter": 50, "episodes_total": 1210, "episode_reward_max": 951.9415329984301, "node_ip": "10.138.0.2", "timesteps_since_restore": 3079024, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 124749, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75e80>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a753c8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75a90>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 25, "done": false, "info": {"update_time_ms": 11.17, "default": {"entropy": 1.1820570230484009, "vf_explained_var": 0.7414982914924622, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.00024081525043584406, "cur_lr": 0.0005000000237487257, "total_loss": 21.326688766479492, "kl": 0.006104819010943174, "vf_loss": 21.326778411865234}, "num_steps_sampled": 3079024, "load_time_ms": 9.417, "num_steps_trained": 3079024, "sample_time_ms": 14988.889, "grad_time_ms": 24061.389}, "training_iteration": 25, "pid": 64382, "episode_reward_mean": 850.2017021291249, "timestamp": 1556417325, "time_total_s": 1009.5846247673035, "date": "2019-04-28_02-08-45", "episode_reward_min": 749.565757520707, "time_since_restore": 1009.5846247673035, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -150.33841993234876, "system_level_velocity_mean": 11.945809548481625, "outflow_rate_max": 1180.5364949738432, "cost1_min": 243.72147713926833, "outflow_rate_min": 924.3199043328618, "cost1_mean": 314.91112133775437, "cost1_max": 369.175861766014, "cost2_min": -213.82905585991153, "system_level_velocity_max": 13.946414482472646, "outflow_rate_mean": 1064.8131531039533, "system_level_velocity_min": 9.352069399124536, "cost2_mean": -179.3285555234149}}
{"timesteps_total": 3201349, "time_this_iter_s": 38.17405962944031, "num_metric_batches_dropped": 0, "episodes_this_iter": 54, "episodes_total": 1264, "episode_reward_max": 961.1546758213645, "node_ip": "10.138.0.2", "timesteps_since_restore": 3201349, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 122325, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77160>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77ac8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a775f8>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 26, "done": false, "info": {"update_time_ms": 11.381, "default": {"entropy": 1.1889921426773071, "vf_explained_var": 0.7451812028884888, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0007468571420758963, "cur_lr": 0.0005000000237487257, "total_loss": 21.134090423583984, "kl": 0.007400815840810537, "vf_loss": 21.134653091430664}, "num_steps_sampled": 3201349, "load_time_ms": 9.496, "num_steps_trained": 3201349, "sample_time_ms": 14966.505, "grad_time_ms": 24011.543}, "training_iteration": 26, "pid": 64382, "episode_reward_mean": 864.0569430232042, "timestamp": 1556417364, "time_total_s": 1047.7586843967438, "date": "2019-04-28_02-09-24", "episode_reward_min": 756.403124639358, "time_since_restore": 1047.7586843967438, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -150.33841993234876, "system_level_velocity_mean": 12.260849529726661, "outflow_rate_max": 1208.8246654079903, "cost1_min": 255.28851932974604, "outflow_rate_min": 923.8028543406676, "cost1_mean": 323.03750254597486, "cost1_max": 380.1380030436816, "cost2_min": -215.94587925292848, "system_level_velocity_max": 14.28485076467256, "outflow_rate_mean": 1084.0166547207336, "system_level_velocity_min": 9.943820592775621, "cost2_mean": -179.66034162454955}}
{"timesteps_total": 3327223, "time_this_iter_s": 39.670405864715576, "num_metric_batches_dropped": 0, "episodes_this_iter": 52, "episodes_total": 1316, "episode_reward_max": 970.9844099930361, "node_ip": "10.138.0.2", "timesteps_since_restore": 3327223, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 125874, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e7b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e940>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e978>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 27, "done": false, "info": {"update_time_ms": 11.421, "default": {"entropy": 1.1825170516967773, "vf_explained_var": 0.7492809891700745, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0007666287710890174, "cur_lr": 0.0005000000237487257, "total_loss": 18.65613555908203, "kl": 0.007117922883480787, "vf_loss": 18.656723022460938}, "num_steps_sampled": 3327223, "load_time_ms": 9.391, "num_steps_trained": 3327223, "sample_time_ms": 14925.972, "grad_time_ms": 24150.215}, "training_iteration": 27, "pid": 64382, "episode_reward_mean": 852.0247093178976, "timestamp": 1556417403, "time_total_s": 1087.4290902614594, "date": "2019-04-28_02-10-03", "episode_reward_min": 756.403124639358, "time_since_restore": 1087.4290902614594, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -151.79564231446085, "system_level_velocity_mean": 11.921882929728056, "outflow_rate_max": 1208.8246654079903, "cost1_min": 255.28851932974604, "outflow_rate_min": 923.8028543406676, "cost1_mean": 314.5606173010314, "cost1_max": 380.1380030436816, "cost2_min": -215.94587925292848, "system_level_velocity_max": 14.28485076467256, "outflow_rate_mean": 1062.6172254001021, "system_level_velocity_min": 9.943820592775621, "cost2_mean": -181.34117990331654}}
{"timesteps_total": 3452512, "time_this_iter_s": 40.361109256744385, "num_metric_batches_dropped": 0, "episodes_this_iter": 36, "episodes_total": 1352, "episode_reward_max": 970.9844099930361, "node_ip": "10.138.0.2", "timesteps_since_restore": 3452512, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 125289, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75d30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77748>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75da0>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 28, "done": false, "info": {"update_time_ms": 11.751, "default": {"entropy": 1.177219271659851, "vf_explained_var": 0.8016486167907715, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0010575026972219348, "cur_lr": 0.0005000000237487257, "total_loss": 19.87240219116211, "kl": 0.007105771917849779, "vf_loss": 19.87328338623047}, "num_steps_sampled": 3452512, "load_time_ms": 9.426, "num_steps_trained": 3452512, "sample_time_ms": 14969.407, "grad_time_ms": 24395.344}, "training_iteration": 28, "pid": 64382, "episode_reward_mean": 838.8455110280618, "timestamp": 1556417444, "time_total_s": 1127.7901995182037, "date": "2019-04-28_02-10-44", "episode_reward_min": 680.7018535252882, "time_since_restore": 1127.7901995182037, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -151.79564231446085, "system_level_velocity_mean": 11.686138949943757, "outflow_rate_max": 1179.2468004028328, "cost1_min": 230.77955864099874, "outflow_rate_min": 846.156508337784, "cost1_mean": 307.9895706238247, "cost1_max": 363.2063553860197, "cost2_min": -216.43990637048245, "system_level_velocity_max": 13.657371176987814, "outflow_rate_mean": 1046.599711896195, "system_level_velocity_min": 8.92242889456254, "cost2_mean": -183.80512452169864}}
{"timesteps_total": 3578246, "time_this_iter_s": 39.113116979599, "num_metric_batches_dropped": 0, "episodes_this_iter": 53, "episodes_total": 1405, "episode_reward_max": 982.2471005597718, "node_ip": "10.138.0.2", "timesteps_since_restore": 3578246, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 125734, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e9e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e860>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e7f0>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 29, "done": false, "info": {"update_time_ms": 11.847, "default": {"entropy": 1.1655522584915161, "vf_explained_var": 0.7651799917221069, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.0008321781060658395, "cur_lr": 0.0005000000237487257, "total_loss": 25.034944534301758, "kl": 0.007643107324838638, "vf_loss": 25.035585403442383}, "num_steps_sampled": 3578246, "load_time_ms": 9.468, "num_steps_trained": 3578246, "sample_time_ms": 14991.667, "grad_time_ms": 24212.691}, "training_iteration": 29, "pid": 64382, "episode_reward_mean": 838.1564621350622, "timestamp": 1556417483, "time_total_s": 1166.9033164978027, "date": "2019-04-28_02-11-23", "episode_reward_min": 680.7018535252882, "time_since_restore": 1166.9033164978027, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -156.60002978312454, "system_level_velocity_mean": 11.885692552553506, "outflow_rate_max": 1236.3843455098784, "cost1_min": 230.77955864099874, "outflow_rate_min": 846.156508337784, "cost1_mean": 312.0174844828102, "cost1_max": 388.29263799160924, "cost2_min": -216.43990637048245, "system_level_velocity_max": 14.565172694589403, "outflow_rate_mean": 1058.2310938434148, "system_level_velocity_min": 8.92242889456254, "cost2_mean": -185.23233314367255}}
{"timesteps_total": 3704686, "time_this_iter_s": 39.73184514045715, "num_metric_batches_dropped": 0, "episodes_this_iter": 47, "episodes_total": 1452, "episode_reward_max": 982.2471005597718, "node_ip": "10.138.0.2", "timesteps_since_restore": 3704686, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 126440, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77a20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77ac8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77d30>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 30, "done": false, "info": {"update_time_ms": 11.708, "default": {"entropy": 1.167205572128296, "vf_explained_var": 0.7673221826553345, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.000703055935446173, "cur_lr": 0.0005000000237487257, "total_loss": 23.66697120666504, "kl": 0.007568000350147486, "vf_loss": 23.6674861907959}, "num_steps_sampled": 3704686, "load_time_ms": 9.639, "num_steps_trained": 3704686, "sample_time_ms": 14955.94, "grad_time_ms": 24252.429}, "training_iteration": 30, "pid": 64382, "episode_reward_mean": 851.3689604812582, "timestamp": 1556417523, "time_total_s": 1206.63516163826, "date": "2019-04-28_02-12-03", "episode_reward_min": 738.5292618871225, "time_since_restore": 1206.63516163826, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -160.84397862215323, "system_level_velocity_mean": 12.240979086139582, "outflow_rate_max": 1236.3843455098784, "cost1_min": 254.50957515320252, "outflow_rate_min": 918.3448918272998, "cost1_mean": 321.16833479288493, "cost1_max": 388.29263799160924, "cost2_min": -213.77780518755344, "system_level_velocity_max": 14.565172694589403, "outflow_rate_mean": 1083.0230776201563, "system_level_velocity_min": 9.952799561664296, "cost2_mean": -184.54975951386777}}
{"timesteps_total": 3825911, "time_this_iter_s": 36.46302533149719, "num_metric_batches_dropped": 0, "episodes_this_iter": 53, "episodes_total": 1505, "episode_reward_max": 972.575097124522, "node_ip": "10.138.0.2", "timesteps_since_restore": 3825911, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 693.37, "timesteps_this_iter": 121225, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ecf8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ea20>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 31, "done": false, "info": {"update_time_ms": 11.566, "default": {"entropy": 1.1639904975891113, "vf_explained_var": 0.753024697303772, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.00046678405487909913, "cur_lr": 0.0005000000237487257, "total_loss": 27.182933807373047, "kl": 0.007185567170381546, "vf_loss": 27.1832218170166}, "num_steps_sampled": 3825911, "load_time_ms": 10.079, "num_steps_trained": 3825911, "sample_time_ms": 14880.376, "grad_time_ms": 24051.813}, "training_iteration": 31, "pid": 64382, "episode_reward_mean": 842.6519228991691, "timestamp": 1556417559, "time_total_s": 1243.098186969757, "date": "2019-04-28_02-12-39", "episode_reward_min": 52.3872655379493, "time_since_restore": 1243.098186969757, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -25.322170765706524, "system_level_velocity_mean": 12.236670207505282, "outflow_rate_max": 1230.2473177280133, "cost1_min": 24.416498896071772, "outflow_rate_min": 482.03239490434686, "cost1_mean": 316.29136224440435, "cost1_max": 385.3217772562467, "cost2_min": -213.9766823092509, "system_level_velocity_max": 18.614764104191295, "outflow_rate_mean": 1073.6490519464014, "system_level_velocity_min": 9.952799561664296, "cost2_mean": -184.5804877122183}}
{"timesteps_total": 3947378, "time_this_iter_s": 38.96852731704712, "num_metric_batches_dropped": 0, "episodes_this_iter": 55, "episodes_total": 1560, "episode_reward_max": 1053.5832560912145, "node_ip": "10.138.0.2", "timesteps_since_restore": 3947378, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 693.37, "timesteps_this_iter": 121467, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a775f8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77c18>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77898>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 32, "done": false, "info": {"update_time_ms": 11.597, "default": {"entropy": 1.1682963371276855, "vf_explained_var": 0.7534958720207214, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0004884989466518164, "cur_lr": 0.0005000000237487257, "total_loss": 28.562171936035156, "kl": 0.006519316229969263, "vf_loss": 28.562498092651367}, "num_steps_sampled": 3947378, "load_time_ms": 10.297, "num_steps_trained": 3947378, "sample_time_ms": 14899.195, "grad_time_ms": 24001.719}, "training_iteration": 32, "pid": 64382, "episode_reward_mean": 838.3002980786295, "timestamp": 1556417598, "time_total_s": 1282.0667142868042, "date": "2019-04-28_02-13-18", "episode_reward_min": 52.3872655379493, "time_since_restore": 1282.0667142868042, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -25.322170765706524, "system_level_velocity_mean": 12.193636055785776, "outflow_rate_max": 1294.9450581312635, "cost1_min": 24.416498896071772, "outflow_rate_min": 482.03239490434686, "cost1_mean": 314.41040770145855, "cost1_max": 418.9963879100378, "cost2_min": -212.76854706911934, "system_level_velocity_max": 18.614764104191295, "outflow_rate_mean": 1067.3784707514515, "system_level_velocity_min": 9.683776670207722, "cost2_mean": -185.40498018158294}}
{"timesteps_total": 4069778, "time_this_iter_s": 40.378382205963135, "num_metric_batches_dropped": 0, "episodes_this_iter": 47, "episodes_total": 1607, "episode_reward_max": 1098.467029427785, "node_ip": "10.138.0.2", "timesteps_since_restore": 4069778, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 122400, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e9b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ebe0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e7b8>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 33, "done": false, "info": {"update_time_ms": 11.501, "default": {"entropy": 1.1587308645248413, "vf_explained_var": 0.7607715725898743, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -0.0011329049011692405, "cur_lr": 0.0005000000237487257, "total_loss": 26.930198669433594, "kl": 0.007683934643864632, "vf_loss": 26.93113899230957}, "num_steps_sampled": 4069778, "load_time_ms": 10.164, "num_steps_trained": 4069778, "sample_time_ms": 14875.716, "grad_time_ms": 24116.803}, "training_iteration": 33, "pid": 64382, "episode_reward_mean": 853.9582242174707, "timestamp": 1556417639, "time_total_s": 1322.4450964927673, "date": "2019-04-28_02-13-59", "episode_reward_min": 736.3721293687775, "time_since_restore": 1322.4450964927673, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -162.7384948433145, "system_level_velocity_mean": 12.37038661072295, "outflow_rate_max": 1315.8912963506402, "cost1_min": 240.05760627382054, "outflow_rate_min": 902.3015423612387, "cost1_mean": 323.17257528433004, "cost1_max": 438.9723362506075, "cost2_min": -247.47913189814176, "system_level_velocity_max": 16.433321913805504, "outflow_rate_mean": 1087.213132256837, "system_level_velocity_min": 9.215123802881756, "cost2_mean": -185.50357680972576}}
{"timesteps_total": 4192482, "time_this_iter_s": 42.121408462524414, "num_metric_batches_dropped": 0, "episodes_this_iter": 49, "episodes_total": 1656, "episode_reward_max": 1098.467029427785, "node_ip": "10.138.0.2", "timesteps_since_restore": 4192482, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 122704, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77f98>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77940>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77208>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 34, "done": false, "info": {"update_time_ms": 11.224, "default": {"entropy": 1.1514160633087158, "vf_explained_var": 0.7566947937011719, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0007549213478341699, "cur_lr": 0.0005000000237487257, "total_loss": 30.12647819519043, "kl": 0.007620767690241337, "vf_loss": 30.127042770385742}, "num_steps_sampled": 4192482, "load_time_ms": 10.74, "num_steps_trained": 4192482, "sample_time_ms": 15079.521, "grad_time_ms": 24194.896}, "training_iteration": 34, "pid": 64382, "episode_reward_mean": 848.3109566510564, "timestamp": 1556417681, "time_total_s": 1364.5665049552917, "date": "2019-04-28_02-14-41", "episode_reward_min": 668.3708907008718, "time_since_restore": 1364.5665049552917, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -162.7384948433145, "system_level_velocity_mean": 12.38534557275478, "outflow_rate_max": 1315.8912963506402, "cost1_min": 215.00158161795974, "outflow_rate_min": 838.5638995634051, "cost1_mean": 323.1815987730514, "cost1_max": 438.9723362506075, "cost2_min": -247.47913189814176, "system_level_velocity_max": 16.433321913805504, "outflow_rate_mean": 1087.3141705098817, "system_level_velocity_min": 8.411661277627429, "cost2_mean": -185.29515387013464}}
{"timesteps_total": 4314741, "time_this_iter_s": 39.798935651779175, "num_metric_batches_dropped": 0, "episodes_this_iter": 40, "episodes_total": 1696, "episode_reward_max": 1055.2786791964702, "node_ip": "10.138.0.2", "timesteps_since_restore": 4314741, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 122259, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ec88>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7eac8>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 35, "done": false, "info": {"update_time_ms": 11.446, "default": {"entropy": 1.1370524168014526, "vf_explained_var": 0.7741158604621887, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0003642384835984558, "cur_lr": 0.0005000000237487257, "total_loss": 29.15619468688965, "kl": 0.0076993852853775024, "vf_loss": 29.15636444091797}, "num_steps_sampled": 4314741, "load_time_ms": 10.771, "num_steps_trained": 4314741, "sample_time_ms": 15134.592, "grad_time_ms": 24088.162}, "training_iteration": 35, "pid": 64382, "episode_reward_mean": 858.7110921491695, "timestamp": 1556417721, "time_total_s": 1404.365440607071, "date": "2019-04-28_02-15-21", "episode_reward_min": 668.3708907008718, "time_since_restore": 1404.365440607071, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -162.7384948433145, "system_level_velocity_mean": 12.645700126332583, "outflow_rate_max": 1306.7951131864374, "cost1_min": 215.00158161795974, "outflow_rate_min": 838.5638995634051, "cost1_mean": 330.0726557303022, "cost1_max": 427.8882689149199, "cost2_min": -221.21406306438928, "system_level_velocity_max": 16.12406745699747, "outflow_rate_mean": 1102.7653619222451, "system_level_velocity_min": 8.411661277627429, "cost2_mean": -185.22289618313408}}
{"timesteps_total": 4435936, "time_this_iter_s": 37.98961567878723, "num_metric_batches_dropped": 0, "episodes_this_iter": 55, "episodes_total": 1751, "episode_reward_max": 1055.2786791964702, "node_ip": "10.138.0.2", "timesteps_since_restore": 4435936, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 121195, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77d30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77978>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77208>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 36, "done": false, "info": {"update_time_ms": 11.364, "default": {"entropy": 1.1229873895645142, "vf_explained_var": 0.7712319493293762, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -0.00042667638626880944, "cur_lr": 0.0005000000237487257, "total_loss": 32.25905227661133, "kl": 0.007549315690994263, "vf_loss": 32.25929260253906}, "num_steps_sampled": 4435936, "load_time_ms": 10.882, "num_steps_trained": 4435936, "sample_time_ms": 15200.839, "grad_time_ms": 24004.504}, "training_iteration": 36, "pid": 64382, "episode_reward_mean": 866.9560181536548, "timestamp": 1556417759, "time_total_s": 1442.3550562858582, "date": "2019-04-28_02-15-59", "episode_reward_min": 723.2197130556849, "time_since_restore": 1442.3550562858582, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -165.59312343536368, "system_level_velocity_mean": 12.852326145679514, "outflow_rate_max": 1306.7951131864374, "cost1_min": 248.26440334056844, "outflow_rate_min": 915.4896015484699, "cost1_mean": 335.3944692980882, "cost1_max": 428.2757229834708, "cost2_min": -235.05329311636203, "system_level_velocity_max": 16.17712231959267, "outflow_rate_mean": 1114.3227721955539, "system_level_velocity_min": 9.713977686541947, "cost2_mean": -188.18899893061345}}
{"timesteps_total": 4556762, "time_this_iter_s": 39.62882041931152, "num_metric_batches_dropped": 0, "episodes_this_iter": 55, "episodes_total": 1806, "episode_reward_max": 1064.6015580437459, "node_ip": "10.138.0.2", "timesteps_since_restore": 4556762, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 120826, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ed30>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ec50>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 37, "done": false, "info": {"update_time_ms": 11.338, "default": {"entropy": 1.1194205284118652, "vf_explained_var": 0.7653664946556091, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0006180082564242184, "cur_lr": 0.0005000000237487257, "total_loss": 32.71262741088867, "kl": 0.008235779590904713, "vf_loss": 32.71303939819336}, "num_steps_sampled": 4556762, "load_time_ms": 10.962, "num_steps_trained": 4556762, "sample_time_ms": 15245.857, "grad_time_ms": 23966.659}, "training_iteration": 37, "pid": 64382, "episode_reward_mean": 858.5575119884556, "timestamp": 1556417798, "time_total_s": 1481.9838767051697, "date": "2019-04-28_02-16-38", "episode_reward_min": 723.2197130556849, "time_since_restore": 1481.9838767051697, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -166.43575017786026, "system_level_velocity_mean": 12.75070181913426, "outflow_rate_max": 1308.3989309539495, "cost1_min": 248.26440334056844, "outflow_rate_min": 888.6454599896239, "cost1_mean": 331.89470719976686, "cost1_max": 430.1284597991791, "cost2_min": -226.2920301658841, "system_level_velocity_max": 16.22765697325495, "outflow_rate_mean": 1105.383323196479, "system_level_velocity_min": 9.713977686541947, "cost2_mean": -187.46423020528192}}
{"timesteps_total": 4677687, "time_this_iter_s": 39.618083000183105, "num_metric_batches_dropped": 0, "episodes_this_iter": 47, "episodes_total": 1853, "episode_reward_max": 1064.6015580437459, "node_ip": "10.138.0.2", "timesteps_since_restore": 4677687, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 120925, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77208>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77c18>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77978>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 38, "done": false, "info": {"update_time_ms": 11.149, "default": {"entropy": 1.1037659645080566, "vf_explained_var": 0.7876887917518616, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.001062934286892414, "cur_lr": 0.0005000000237487257, "total_loss": 28.84181785583496, "kl": 0.009075510315597057, "vf_loss": 28.842655181884766}, "num_steps_sampled": 4677687, "load_time_ms": 10.952, "num_steps_trained": 4677687, "sample_time_ms": 15239.115, "grad_time_ms": 23900.713}, "training_iteration": 38, "pid": 64382, "episode_reward_mean": 859.1406446230575, "timestamp": 1556417838, "time_total_s": 1521.6019597053528, "date": "2019-04-28_02-17-18", "episode_reward_min": 703.6573830388273, "time_since_restore": 1521.6019597053528, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -161.18581209296087, "system_level_velocity_mean": 12.75634114151135, "outflow_rate_max": 1308.3989309539495, "cost1_min": 246.94506929915835, "outflow_rate_min": 888.6454599896239, "cost1_mean": 331.66928767377686, "cost1_max": 430.1284597991791, "cost2_min": -219.27075212788043, "system_level_velocity_max": 16.22765697325495, "outflow_rate_mean": 1103.7287161695508, "system_level_velocity_min": 9.70057055732045, "cost2_mean": -184.76513401035828}}
{"timesteps_total": 4798559, "time_this_iter_s": 37.794339656829834, "num_metric_batches_dropped": 0, "episodes_this_iter": 52, "episodes_total": 1905, "episode_reward_max": 1032.101006442188, "node_ip": "10.138.0.2", "timesteps_since_restore": 4798559, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 693.27, "timesteps_this_iter": 120872, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ee48>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e978>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e358>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 39, "done": false, "info": {"update_time_ms": 11.209, "default": {"entropy": 1.1085284948349, "vf_explained_var": 0.7804391980171204, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0008550123893655837, "cur_lr": 0.0005000000237487257, "total_loss": 30.266952514648438, "kl": 0.008813749998807907, "vf_loss": 30.26758575439453}, "num_steps_sampled": 4798559, "load_time_ms": 10.553, "num_steps_trained": 4798559, "sample_time_ms": 15176.735, "grad_time_ms": 23833.267}, "training_iteration": 39, "pid": 64382, "episode_reward_mean": 850.4969277555804, "timestamp": 1556417876, "time_total_s": 1559.3962993621826, "date": "2019-04-28_02-17-56", "episode_reward_min": 40.41156943980135, "time_since_restore": 1559.3962993621826, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -20.584768008468753, "system_level_velocity_mean": 12.765933512775675, "outflow_rate_max": 1280.711791429509, "cost1_min": 17.794554105315843, "outflow_rate_min": 440.0050268646629, "cost1_mean": 328.4601628323617, "cost1_max": 415.4480228344661, "cost2_min": -223.09124868786049, "system_level_velocity_max": 17.047093667790005, "outflow_rate_mean": 1096.350886470903, "system_level_velocity_min": 9.70057055732045, "cost2_mean": -180.37726119736638}}
{"timesteps_total": 4922967, "time_this_iter_s": 37.179471015930176, "num_metric_batches_dropped": 0, "episodes_this_iter": 45, "episodes_total": 1950, "episode_reward_max": 1034.7104490856873, "node_ip": "10.138.0.2", "timesteps_since_restore": 4922967, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 693.27, "timesteps_this_iter": 124408, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77208>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77f28>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 40, "done": false, "info": {"update_time_ms": 11.457, "default": {"entropy": 1.0971554517745972, "vf_explained_var": 0.8125795125961304, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0011202027089893818, "cur_lr": 0.0005000000237487257, "total_loss": 28.043306350708008, "kl": 0.00889001227915287, "vf_loss": 28.044204711914062}, "num_steps_sampled": 4922967, "load_time_ms": 10.516, "num_steps_trained": 4922967, "sample_time_ms": 15194.176, "grad_time_ms": 23560.27}, "training_iteration": 40, "pid": 64382, "episode_reward_mean": 840.24463904633, "timestamp": 1556417913, "time_total_s": 1596.5757703781128, "date": "2019-04-28_02-18-33", "episode_reward_min": 40.41156943980135, "time_since_restore": 1596.5757703781128, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -20.584768008468753, "system_level_velocity_mean": 12.563398912070006, "outflow_rate_max": 1273.398033420676, "cost1_min": 17.794554105315843, "outflow_rate_min": 440.0050268646629, "cost1_mean": 323.16963082582583, "cost1_max": 416.91799924408065, "cost2_min": -223.09124868786049, "system_level_velocity_max": 17.047093667790005, "outflow_rate_mean": 1081.6237141384531, "system_level_velocity_min": 9.399792585268214, "cost2_mean": -177.648289012745}}
{"timesteps_total": 5046063, "time_this_iter_s": 42.491488218307495, "num_metric_batches_dropped": 0, "episodes_this_iter": 52, "episodes_total": 2002, "episode_reward_max": 1087.971933668832, "node_ip": "10.138.0.2", "timesteps_since_restore": 5046063, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 123096, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e080>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e7f0>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 41, "done": false, "info": {"update_time_ms": 11.578, "default": {"entropy": 1.0926616191864014, "vf_explained_var": 0.7954735159873962, "cur_kl_coeff": 0.02500000409781933, "policy_loss": 9.512554242974147e-06, "cur_lr": 0.0005000000237487257, "total_loss": 31.532310485839844, "kl": 0.007517896126955748, "vf_loss": 31.53211212158203}, "num_steps_sampled": 5046063, "load_time_ms": 10.753, "num_steps_trained": 5046063, "sample_time_ms": 15310.469, "grad_time_ms": 24045.396}, "training_iteration": 41, "pid": 64382, "episode_reward_mean": 844.9160607691708, "timestamp": 1556417955, "time_total_s": 1639.0672585964203, "date": "2019-04-28_02-19-15", "episode_reward_min": 674.4474798155364, "time_since_restore": 1639.0672585964203, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -157.4433200294012, "system_level_velocity_mean": 12.408796719179017, "outflow_rate_max": 1278.2085134867034, "cost1_min": 228.0138394635766, "outflow_rate_min": 843.9311615067525, "cost1_mean": 323.5343891375724, "cost1_max": 424.14108133868865, "cost2_min": -212.6438005355971, "system_level_velocity_max": 15.833875513381871, "outflow_rate_mean": 1079.5983081276788, "system_level_velocity_min": 8.999769655111411, "cost2_mean": -175.97673615060245}}
{"timesteps_total": 5168496, "time_this_iter_s": 38.435598373413086, "num_metric_batches_dropped": 0, "episodes_this_iter": 46, "episodes_total": 2048, "episode_reward_max": 1087.971933668832, "node_ip": "10.138.0.2", "timesteps_since_restore": 5168496, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 122433, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a5b7b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77160>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a75080>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 42, "done": false, "info": {"update_time_ms": 11.933, "default": {"entropy": 1.0795265436172485, "vf_explained_var": 0.8074592351913452, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -0.0010578908259049058, "cur_lr": 0.0005000000237487257, "total_loss": 30.669124603271484, "kl": 0.009162761270999908, "vf_loss": 30.669954299926758}, "num_steps_sampled": 5168496, "load_time_ms": 10.339, "num_steps_trained": 5168496, "sample_time_ms": 15259.534, "grad_time_ms": 24043.451}, "training_iteration": 42, "pid": 64382, "episode_reward_mean": 850.9926554003708, "timestamp": 1556417994, "time_total_s": 1677.5028569698334, "date": "2019-04-28_02-19-54", "episode_reward_min": 674.4474798155364, "time_since_restore": 1677.5028569698334, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -153.5778035156994, "system_level_velocity_mean": 12.545503941009464, "outflow_rate_max": 1278.2085134867034, "cost1_min": 228.0138394635766, "outflow_rate_min": 843.9311615067525, "cost1_mean": 327.89641561995535, "cost1_max": 424.14108133868865, "cost2_min": -205.47169797454026, "system_level_velocity_max": 15.833875513381871, "outflow_rate_mean": 1091.3512983155554, "system_level_velocity_min": 8.999769655111411, "cost2_mean": -175.0251069210848}}
{"timesteps_total": 5292573, "time_this_iter_s": 39.00052094459534, "num_metric_batches_dropped": 0, "episodes_this_iter": 47, "episodes_total": 2095, "episode_reward_max": 985.6711405793735, "node_ip": "10.138.0.2", "timesteps_since_restore": 5292573, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 124077, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e4e0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e710>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ec50>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 43, "done": false, "info": {"update_time_ms": 11.892, "default": {"entropy": 1.0762763023376465, "vf_explained_var": 0.8037461042404175, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0005693567218258977, "cur_lr": 0.0005000000237487257, "total_loss": 33.04335021972656, "kl": 0.008829253725707531, "vf_loss": 33.043701171875}, "num_steps_sampled": 5292573, "load_time_ms": 10.496, "num_steps_trained": 5292573, "sample_time_ms": 15281.156, "grad_time_ms": 23880.198}, "training_iteration": 43, "pid": 64382, "episode_reward_mean": 845.3981946461594, "timestamp": 1556418033, "time_total_s": 1716.5033779144287, "date": "2019-04-28_02-20-33", "episode_reward_min": 692.0229467387305, "time_since_restore": 1716.5033779144287, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -152.436316705636, "system_level_velocity_mean": 12.435820839367123, "outflow_rate_max": 1250.3587444520683, "cost1_min": 230.5088867412728, "outflow_rate_min": 856.9743922684621, "cost1_mean": 324.3450609090782, "cost1_max": 398.24212113436056, "cost2_min": -206.87241050464183, "system_level_velocity_max": 15.06484102047611, "outflow_rate_mean": 1084.9138265802628, "system_level_velocity_min": 9.151968530135763, "cost2_mean": -174.12001868707995}}
{"timesteps_total": 5415233, "time_this_iter_s": 38.961825132369995, "num_metric_batches_dropped": 0, "episodes_this_iter": 53, "episodes_total": 2148, "episode_reward_max": 1034.8288485107785, "node_ip": "10.138.0.2", "timesteps_since_restore": 5415233, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 122660, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77898>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77160>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77780>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 44, "done": false, "info": {"update_time_ms": 11.89, "default": {"entropy": 1.062355637550354, "vf_explained_var": 0.8089586496353149, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0008852498140186071, "cur_lr": 0.0005000000237487257, "total_loss": 34.4840202331543, "kl": 0.0077805230394005775, "vf_loss": 34.484710693359375}, "num_steps_sampled": 5415233, "load_time_ms": 10.039, "num_steps_trained": 5415233, "sample_time_ms": 15127.576, "grad_time_ms": 23722.09}, "training_iteration": 44, "pid": 64382, "episode_reward_mean": 845.2150690194393, "timestamp": 1556418072, "time_total_s": 1755.4652030467987, "date": "2019-04-28_02-21-12", "episode_reward_min": 681.8868373637107, "time_since_restore": 1755.4652030467987, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -152.436316705636, "system_level_velocity_mean": 12.52388227154758, "outflow_rate_max": 1301.0732441985401, "cost1_min": 230.5088867412728, "outflow_rate_min": 856.9743922684621, "cost1_mean": 326.24787635593066, "cost1_max": 423.5779208599721, "cost2_min": -206.87241050464183, "system_level_velocity_max": 15.995546973210226, "outflow_rate_mean": 1090.4849304110744, "system_level_velocity_min": 9.122513561721865, "cost2_mean": -172.1584396112492}}
{"timesteps_total": 5537157, "time_this_iter_s": 37.25114059448242, "num_metric_batches_dropped": 0, "episodes_this_iter": 50, "episodes_total": 2198, "episode_reward_max": 1109.7248637962402, "node_ip": "10.138.0.2", "timesteps_since_restore": 5537157, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 121924, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e908>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e358>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e630>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 45, "done": false, "info": {"update_time_ms": 11.871, "default": {"entropy": 1.0340923070907593, "vf_explained_var": 0.8053728342056274, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.00101857737172395, "cur_lr": 0.0005000000237487257, "total_loss": 34.68436813354492, "kl": 0.00894687045365572, "vf_loss": 34.68516159057617}, "num_steps_sampled": 5537157, "load_time_ms": 10.295, "num_steps_trained": 5537157, "sample_time_ms": 15100.612, "grad_time_ms": 23497.042}, "training_iteration": 45, "pid": 64382, "episode_reward_mean": 845.9884293996104, "timestamp": 1556418109, "time_total_s": 1792.7163436412811, "date": "2019-04-28_02-21-49", "episode_reward_min": 681.8868373637107, "time_since_restore": 1792.7163436412811, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -154.7384401814283, "system_level_velocity_mean": 12.608656896410864, "outflow_rate_max": 1332.9577675333353, "cost1_min": 230.63844314557008, "outflow_rate_min": 858.7274323191502, "cost1_mean": 328.22330765089066, "cost1_max": 452.63138305204484, "cost2_min": -197.2642899263709, "system_level_velocity_max": 17.07347594364403, "outflow_rate_mean": 1096.5523269828686, "system_level_velocity_min": 9.122513561721865, "cost2_mean": -171.98501190850732}}
{"timesteps_total": 5659090, "time_this_iter_s": 39.89555525779724, "num_metric_batches_dropped": 0, "episodes_this_iter": 53, "episodes_total": 2251, "episode_reward_max": 1109.7248637962402, "node_ip": "10.138.0.2", "timesteps_since_restore": 5659090, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 121933, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77898>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77c18>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 46, "done": false, "info": {"update_time_ms": 12.042, "default": {"entropy": 1.017838716506958, "vf_explained_var": 0.8069120645523071, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0014878999209031463, "cur_lr": 0.0005000000237487257, "total_loss": 34.1855354309082, "kl": 0.009263088926672935, "vf_loss": 34.186790466308594}, "num_steps_sampled": 5659090, "load_time_ms": 10.231, "num_steps_trained": 5659090, "sample_time_ms": 15080.1, "grad_time_ms": 23707.526}, "training_iteration": 46, "pid": 64382, "episode_reward_mean": 832.3236053297042, "timestamp": 1556418149, "time_total_s": 1832.6118988990784, "date": "2019-04-28_02-22-29", "episode_reward_min": 687.0460400347533, "time_since_restore": 1832.6118988990784, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -157.48935213920603, "system_level_velocity_mean": 12.331290751848462, "outflow_rate_max": 1332.9577675333353, "cost1_min": 234.51670202104273, "outflow_rate_min": 860.6750088348898, "cost1_mean": 319.75254709408307, "cost1_max": 452.63138305204484, "cost2_min": -197.2642899263709, "system_level_velocity_max": 17.07347594364403, "outflow_rate_mean": 1078.5848494171441, "system_level_velocity_min": 9.206718370945975, "cost2_mean": -171.69355274091674}}
{"timesteps_total": 5779137, "time_this_iter_s": 39.46119928359985, "num_metric_batches_dropped": 0, "episodes_this_iter": 45, "episodes_total": 2296, "episode_reward_max": 1110.054784623063, "node_ip": "10.138.0.2", "timesteps_since_restore": 5779137, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 120047, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7eb38>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ecc0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ecf8>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 47, "done": false, "info": {"update_time_ms": 12.125, "default": {"entropy": 1.0129432678222656, "vf_explained_var": 0.8039968609809875, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -0.0007123356917873025, "cur_lr": 0.0005000000237487257, "total_loss": 36.843074798583984, "kl": 0.00910763256251812, "vf_loss": 36.84355545043945}, "num_steps_sampled": 5779137, "load_time_ms": 10.342, "num_steps_trained": 5779137, "sample_time_ms": 15064.58, "grad_time_ms": 23706.38}, "training_iteration": 47, "pid": 64382, "episode_reward_mean": 843.3454624762605, "timestamp": 1556418189, "time_total_s": 1872.0730981826782, "date": "2019-04-28_02-23-09", "episode_reward_min": 687.0460400347533, "time_since_restore": 1872.0730981826782, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -157.48935213920603, "system_level_velocity_mean": 12.49205451664166, "outflow_rate_max": 1324.879330923948, "cost1_min": 237.14245435548042, "outflow_rate_min": 866.0817358195609, "cost1_mean": 324.012236363322, "cost1_max": 440.4510108121061, "cost2_min": -193.6572162016084, "system_level_velocity_max": 16.49459868571237, "outflow_rate_mean": 1088.20422378456, "system_level_velocity_min": 9.287010884426204, "cost2_mean": -171.03476244155584}}
{"timesteps_total": 5901664, "time_this_iter_s": 37.46880054473877, "num_metric_batches_dropped": 0, "episodes_this_iter": 51, "episodes_total": 2347, "episode_reward_max": 1110.054784623063, "node_ip": "10.138.0.2", "timesteps_since_restore": 5901664, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 122527, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a77e48>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a777f0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e2b0>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 48, "done": false, "info": {"update_time_ms": 12.062, "default": {"entropy": 1.0117135047912598, "vf_explained_var": 0.814334511756897, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.00047471930156461895, "cur_lr": 0.0005000000237487257, "total_loss": 35.61572265625, "kl": 0.007723638322204351, "vf_loss": 35.616004943847656}, "num_steps_sampled": 5901664, "load_time_ms": 10.553, "num_steps_trained": 5901664, "sample_time_ms": 15024.937, "grad_time_ms": 23532.118}, "training_iteration": 48, "pid": 64382, "episode_reward_mean": 858.0448392996374, "timestamp": 1556418226, "time_total_s": 1909.541898727417, "date": "2019-04-28_02-23-46", "episode_reward_min": 703.7709346332904, "time_since_restore": 1909.541898727417, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -157.5755182863918, "system_level_velocity_mean": 12.733561996137015, "outflow_rate_max": 1324.879330923948, "cost1_min": 244.15469704478926, "outflow_rate_min": 857.9726309386424, "cost1_mean": 330.9533973378976, "cost1_max": 440.4510108121061, "cost2_min": -191.35521160904796, "system_level_velocity_max": 16.49459868571237, "outflow_rate_mean": 1104.8856629641969, "system_level_velocity_min": 9.537084050388026, "cost2_mean": -170.81622197224573}}
{"timesteps_total": 6024019, "time_this_iter_s": 40.34380006790161, "num_metric_batches_dropped": 0, "episodes_this_iter": 51, "episodes_total": 2398, "episode_reward_max": 1114.6244828137949, "node_ip": "10.138.0.2", "timesteps_since_restore": 6024019, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 122355, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7ea58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e358>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e860>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 49, "done": false, "info": {"update_time_ms": 12.065, "default": {"entropy": 0.9997318387031555, "vf_explained_var": 0.8099043369293213, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0013510050484910607, "cur_lr": 0.0005000000237487257, "total_loss": 35.576351165771484, "kl": 0.008733157999813557, "vf_loss": 35.57748031616211}, "num_steps_sampled": 6024019, "load_time_ms": 10.533, "num_steps_trained": 6024019, "sample_time_ms": 15059.26, "grad_time_ms": 23752.66}, "training_iteration": 49, "pid": 64382, "episode_reward_mean": 845.5241624900382, "timestamp": 1556418266, "time_total_s": 1949.8856987953186, "date": "2019-04-28_02-24-26", "episode_reward_min": 678.7533071350762, "time_since_restore": 1949.8856987953186, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -148.63912056670205, "system_level_velocity_mean": 12.575551091781968, "outflow_rate_max": 1322.2932882401678, "cost1_min": 229.3988181827347, "outflow_rate_min": 857.9726309386424, "cost1_mean": 326.84321180851606, "cost1_max": 439.591365291425, "cost2_min": -189.78381086095033, "system_level_velocity_max": 16.42035343657972, "outflow_rate_mean": 1096.1586639838956, "system_level_velocity_min": 8.97971973181445, "cost2_mean": -168.85185894711728}}
{"timesteps_total": 6145187, "time_this_iter_s": 37.45337772369385, "num_metric_batches_dropped": 0, "episodes_this_iter": 45, "episodes_total": 2443, "episode_reward_max": 1174.0143352800035, "node_ip": "10.138.0.2", "timesteps_since_restore": 6145187, "experiment_id": "1bb09a68d68747a4a9c16bc36e3db4e0", "episode_len_mean": 700.0, "timesteps_this_iter": 121168, "config": {"lr_schedule": null, "train_batch_size": 90000, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "entropy_coeff": 0.0, "vf_loss_coeff": 1.0, "sample_batch_size": 200, "output_max_file_size": 67108864, "num_gpus": 0, "env": "MultiWaveAttenuationMergePOEnvOutFlowRew-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e2e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a9be10>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f7863a7e208>", "on_sample_end": null}, "use_gae": true, "num_gpus_per_worker": 0, "clip_actions": false, "vf_clip_param": 1000000.0, "vf_share_layers": false, "num_sgd_iter": 10, "num_envs_per_worker": 1, "observation_filter": "NoFilter", "input_evaluation": null, "collect_metrics_timeout": 180, "batch_mode": "truncate_episodes", "simple_optimizer": false, "num_cpus_per_worker": 1, "tf_session_args": {"device_count": {"CPU": 1}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "model": {"channel_major": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_cell_size": 256, "free_log_std": false, "fcnet_hiddens": [100, 50, 25], "dim": 84, "use_lstm": false, "framestack": true, "custom_model": null, "custom_options": {}, "zero_mean": true, "lstm_use_prev_action_reward": false, "squash_to_range": false, "conv_activation": "relu", "custom_preprocessor": null, "grayscale": false}, "sample_async": false, "kl_coeff": 0.2, "synchronize_filters": true, "optimizer": {}, "monitor": false, "lambda": 0.97, "num_cpus_for_driver": 1, "compress_observations": false, "clip_rewards": null, "kl_target": 0.01, "horizon": 1500, "clip_param": 0.3, "lr": 0.0005, "output": null, "num_workers": 60, "gamma": 0.99, "output_compress_columns": ["obs", "new_obs"], "input": "sampler", "custom_resources_per_worker": {}, "log_level": "INFO", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "straggler_mitigation": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind"}, "hostname": "flow-main", "iterations_since_restore": 50, "done": true, "info": {"update_time_ms": 11.708, "default": {"entropy": 0.9892520904541016, "vf_explained_var": 0.8141023516654968, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -0.00048531676293350756, "cur_lr": 0.0005000000237487257, "total_loss": 35.08330154418945, "kl": 0.008496591821312904, "vf_loss": 35.08357620239258}, "num_steps_sampled": 6145187, "load_time_ms": 10.334, "num_steps_trained": 6145187, "sample_time_ms": 15031.976, "grad_time_ms": 23808.686}, "training_iteration": 50, "pid": 64382, "episode_reward_mean": 847.086071943964, "timestamp": 1556418304, "time_total_s": 1987.3390765190125, "date": "2019-04-28_02-25-04", "episode_reward_min": 678.7533071350762, "time_since_restore": 1987.3390765190125, "policy_reward_mean": {}, "custom_metrics": {"cost2_max": -148.63912056670205, "system_level_velocity_mean": 12.562707188944296, "outflow_rate_max": 1342.8385189457397, "cost1_min": 229.3988181827347, "outflow_rate_min": 852.0779942560342, "cost1_mean": 327.066841484344, "cost1_max": 459.1017616234327, "cost2_min": -189.5468236458268, "system_level_velocity_max": 17.172087300564584, "outflow_rate_mean": 1095.781882852905, "system_level_velocity_min": 8.97971973181445, "cost2_mean": -167.96387429640487}}

{"timesteps_since_restore": 44074, "policy_reward_mean": {}, "episode_reward_max": 489.19199988865194, "time_total_s": 65.348153591156, "info": {"num_steps_sampled": 44074, "sample_time_ms": 52779.072, "grad_time_ms": 9773.007, "update_time_ms": 2608.274, "default": {"kl": 0.0007947112317197025, "entropy": 1.4255366325378418, "cur_lr": 0.0005000000237487257, "total_loss": 1.8816847801208496, "policy_loss": -7.450077828252688e-05, "vf_explained_var": 0.8783894777297974, "vf_loss": 1.881600260734558, "cur_kl_coeff": 0.20000003278255463}, "num_steps_trained": 44074, "load_time_ms": 71.259}, "custom_metrics": {"cost1_mean": 206.82406863201808, "outflow_rate_max": 694.1441128398941, "system_level_velocity_mean": 8.053814737937541, "cost1_min": 188.00822304350353, "cost1_max": 228.83703976738758, "outflow_rate_min": 532.196180574999, "cost2_mean": -95.39036407274165, "outflow_rate_mean": 620.4291779552688, "system_level_velocity_min": 7.426654027221985, "cost2_min": -107.38161994734058, "system_level_velocity_max": 8.811561939450456, "cost2_max": -80.83734273249347}, "node_ip": "10.138.0.2", "iterations_since_restore": 1, "done": false, "episodes_total": 6, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625fb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625ffd0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 455.77989739638105, "episode_reward_min": 417.3155388589494, "timesteps_total": 44074, "time_since_restore": 65.348153591156, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 44074, "pid": 25319, "episodes_this_iter": 6, "timestamp": 1557189646, "time_this_iter_s": 65.348153591156, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 1, "date": "2019-05-07_00-40-46", "episode_len_mean": 700.0}
{"timesteps_since_restore": 85905, "policy_reward_mean": {}, "episode_reward_max": 630.9463065982746, "time_total_s": 91.34763669967651, "info": {"num_steps_sampled": 85905, "sample_time_ms": 33729.566, "grad_time_ms": 10488.517, "update_time_ms": 1307.648, "default": {"kl": 0.0030776422936469316, "entropy": 1.4447882175445557, "cur_lr": 0.0005000000237487257, "total_loss": 1.0476012229919434, "policy_loss": -0.0006841996219009161, "vf_explained_var": 0.9654629826545715, "vf_loss": 1.0479776859283447, "cur_kl_coeff": 0.10000001639127731}, "num_steps_trained": 85905, "load_time_ms": 41.831}, "custom_metrics": {"cost1_mean": 234.42537106400593, "outflow_rate_max": 927.3910144051033, "system_level_velocity_mean": 9.006977791773647, "cost1_min": 188.00822304350353, "cost1_max": 304.41932802167196, "outflow_rate_min": 514.8582032592071, "cost2_mean": -101.28618321813201, "outflow_rate_mean": 683.5385506711871, "system_level_velocity_min": 7.426654027221985, "cost2_min": -125.08601774663434, "system_level_velocity_max": 11.491859793063208, "cost2_max": -80.83734273249347}, "node_ip": "10.138.0.2", "iterations_since_restore": 2, "done": false, "episodes_total": 23, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a50b8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 480.3208483470179, "episode_reward_min": 406.0771663919557, "timesteps_total": 85905, "time_since_restore": 91.34763669967651, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 41831, "pid": 25319, "episodes_this_iter": 17, "timestamp": 1557189672, "time_this_iter_s": 25.999483108520508, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 2, "date": "2019-05-07_00-41-12", "episode_len_mean": 700.0}
{"timesteps_since_restore": 131486, "policy_reward_mean": {}, "episode_reward_max": 630.9463065982746, "time_total_s": 116.32308030128479, "info": {"num_steps_sampled": 131486, "sample_time_ms": 27369.576, "grad_time_ms": 10400.869, "update_time_ms": 875.621, "default": {"kl": 0.0050174780189991, "entropy": 1.441887378692627, "cur_lr": 0.0005000000237487257, "total_loss": 0.9088571667671204, "policy_loss": -0.0014685060596093535, "vf_explained_var": 0.9679473638534546, "vf_loss": 0.9100748300552368, "cur_kl_coeff": 0.05000000819563866}, "num_steps_trained": 131486, "load_time_ms": 32.363}, "custom_metrics": {"cost1_mean": 233.24409951502258, "outflow_rate_max": 927.3910144051033, "system_level_velocity_mean": 8.949477039303394, "cost1_min": 156.6696993624463, "cost1_max": 304.41932802167196, "outflow_rate_min": 373.8707058657711, "cost2_mean": -101.02345073369077, "outflow_rate_mean": 672.1026035133925, "system_level_velocity_min": 6.195165988437692, "cost2_min": -128.24071067194907, "system_level_velocity_max": 11.491859793063208, "cost2_max": -72.58730406460334}, "node_ip": "10.138.0.2", "iterations_since_restore": 3, "done": false, "episodes_total": 40, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f840f0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 479.37957956108386, "episode_reward_min": 323.98103624827223, "timesteps_total": 131486, "time_since_restore": 116.32308030128479, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 45581, "pid": 25319, "episodes_this_iter": 17, "timestamp": 1557189697, "time_this_iter_s": 24.975443601608276, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 3, "date": "2019-05-07_00-41-37", "episode_len_mean": 700.0}
{"timesteps_since_restore": 175095, "policy_reward_mean": {}, "episode_reward_max": 630.9463065982746, "time_total_s": 139.51390504837036, "info": {"num_steps_sampled": 175095, "sample_time_ms": 23684.37, "grad_time_ms": 10416.788, "update_time_ms": 658.329, "default": {"kl": 0.00355845270678401, "entropy": 1.4429367780685425, "cur_lr": 0.0005000000237487257, "total_loss": 0.8249717950820923, "policy_loss": -0.001943676732480526, "vf_explained_var": 0.9822613596916199, "vf_loss": 0.8267374634742737, "cur_kl_coeff": 0.050000011920928955}, "num_steps_trained": 175095, "load_time_ms": 27.342}, "custom_metrics": {"cost1_mean": 229.94181620578843, "outflow_rate_max": 927.3910144051033, "system_level_velocity_mean": 8.825497831416724, "cost1_min": 156.6696993624463, "cost1_max": 304.41932802167196, "outflow_rate_min": 373.8707058657711, "cost2_mean": -100.47972014981107, "outflow_rate_mean": 661.7296391043333, "system_level_velocity_min": 6.195165988437692, "cost2_min": -128.24071067194907, "system_level_velocity_max": 11.491859793063208, "cost2_max": -72.58730406460334}, "node_ip": "10.138.0.2", "iterations_since_restore": 4, "done": false, "episodes_total": 47, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5198>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 476.0406308242768, "episode_reward_min": 323.98103624827223, "timesteps_total": 175095, "time_since_restore": 139.51390504837036, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 43609, "pid": 25319, "episodes_this_iter": 7, "timestamp": 1557189720, "time_this_iter_s": 23.19082474708557, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 4, "date": "2019-05-07_00-42-00", "episode_len_mean": 700.0}
{"timesteps_since_restore": 219504, "policy_reward_mean": {}, "episode_reward_max": 630.9463065982746, "time_total_s": 163.1153802871704, "info": {"num_steps_sampled": 219504, "sample_time_ms": 21626.525, "grad_time_ms": 10355.054, "update_time_ms": 528.006, "default": {"kl": 0.005204008426517248, "entropy": 1.434218168258667, "cur_lr": 0.0005000000237487257, "total_loss": 1.43394136428833, "policy_loss": -0.0031512558925896883, "vf_explained_var": 0.9717861413955688, "vf_loss": 1.4369624853134155, "cur_kl_coeff": 0.02500000409781933}, "num_steps_trained": 219504, "load_time_ms": 24.789}, "custom_metrics": {"cost1_mean": 218.67330550076926, "outflow_rate_max": 927.3910144051033, "system_level_velocity_mean": 8.680719598806885, "cost1_min": 26.886289439590513, "cost1_max": 304.41932802167196, "outflow_rate_min": 341.4188626498589, "cost2_mean": -95.13737821885877, "outflow_rate_mean": 635.7369586568453, "system_level_velocity_min": 5.992440023625212, "cost2_min": -128.24071067194907, "system_level_velocity_max": 18.436170678494943, "cost2_max": -20.304939890575078}, "node_ip": "10.138.0.2", "iterations_since_restore": 5, "done": false, "episodes_total": 62, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84518>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 452.07350731962623, "episode_reward_min": 45.639629410449096, "timesteps_total": 219504, "time_since_restore": 163.1153802871704, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 44409, "pid": 25319, "episodes_this_iter": 15, "timestamp": 1557189743, "time_this_iter_s": 23.60147523880005, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 5, "date": "2019-05-07_00-42-23", "episode_len_mean": 689.3548387096774}
{"timesteps_since_restore": 263870, "policy_reward_mean": {}, "episode_reward_max": 630.9463065982746, "time_total_s": 187.53578925132751, "info": {"num_steps_sampled": 263870, "sample_time_ms": 20349.935, "grad_time_ms": 10354.909, "update_time_ms": 441.139, "default": {"kl": 0.006772961933165789, "entropy": 1.415970802307129, "cur_lr": 0.0005000000237487257, "total_loss": 1.7062737941741943, "policy_loss": -0.0016706439200788736, "vf_explained_var": 0.9713564515113831, "vf_loss": 1.7077749967575073, "cur_kl_coeff": 0.02500000409781933}, "num_steps_trained": 263870, "load_time_ms": 22.105}, "custom_metrics": {"cost1_mean": 208.58812779170788, "outflow_rate_max": 927.3910144051033, "system_level_velocity_mean": 8.227134037118587, "cost1_min": 26.886289439590513, "cost1_max": 304.41932802167196, "outflow_rate_min": 341.4188626498589, "cost2_mean": -90.82726249193833, "outflow_rate_mean": 597.0893407292475, "system_level_velocity_min": 5.7113205483432985, "cost2_min": -128.24071067194907, "system_level_velocity_max": 18.436170678494943, "cost2_max": -20.304939890575078}, "node_ip": "10.138.0.2", "iterations_since_restore": 6, "done": false, "episodes_total": 81, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a54e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248c18>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 434.58531353579315, "episode_reward_min": 45.639629410449096, "timesteps_total": 263870, "time_since_restore": 187.53578925132751, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 44366, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557189768, "time_this_iter_s": 24.420408964157104, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 6, "date": "2019-05-07_00-42-48", "episode_len_mean": 691.8518518518518}
{"timesteps_since_restore": 304253, "policy_reward_mean": {}, "episode_reward_max": 630.9463065982746, "time_total_s": 210.45673775672913, "info": {"num_steps_sampled": 304253, "sample_time_ms": 19326.333, "grad_time_ms": 10252.17, "update_time_ms": 379.29, "default": {"kl": 0.011033848859369755, "entropy": 1.4042848348617554, "cur_lr": 0.0005000000237487257, "total_loss": 2.2598021030426025, "policy_loss": -0.0042339228093624115, "vf_explained_var": 0.9669618606567383, "vf_loss": 2.2637603282928467, "cur_kl_coeff": 0.02500000223517418}, "num_steps_trained": 304253, "load_time_ms": 20.851}, "custom_metrics": {"cost1_mean": 206.9666521959139, "outflow_rate_max": 927.3910144051033, "system_level_velocity_mean": 8.123156946889567, "cost1_min": 26.886289439590513, "cost1_max": 304.41932802167196, "outflow_rate_min": 341.4188626498589, "cost2_mean": -91.42627791596453, "outflow_rate_mean": 598.9836936513062, "system_level_velocity_min": 5.7113205483432985, "cost2_min": -128.24071067194907, "system_level_velocity_max": 18.436170678494943, "cost2_max": -20.304939890575078}, "node_ip": "10.138.0.2", "iterations_since_restore": 7, "done": false, "episodes_total": 96, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84fd0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 439.56887600624503, "episode_reward_min": 45.639629410449096, "timesteps_total": 304253, "time_since_restore": 210.45673775672913, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 40383, "pid": 25319, "episodes_this_iter": 15, "timestamp": 1557189791, "time_this_iter_s": 22.92094850540161, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 7, "date": "2019-05-07_00-43-11", "episode_len_mean": 693.125}
{"timesteps_since_restore": 344052, "policy_reward_mean": {}, "episode_reward_max": 630.9463065982746, "time_total_s": 232.4661898612976, "info": {"num_steps_sampled": 344052, "sample_time_ms": 18492.868, "grad_time_ms": 10126.666, "update_time_ms": 332.684, "default": {"kl": 0.00908851157873869, "entropy": 1.3885252475738525, "cur_lr": 0.0005000000237487257, "total_loss": 5.132894992828369, "policy_loss": -0.003028165316209197, "vf_explained_var": 0.903903603553772, "vf_loss": 5.1356964111328125, "cur_kl_coeff": 0.02500000409781933}, "num_steps_trained": 344052, "load_time_ms": 19.867}, "custom_metrics": {"cost1_mean": 205.38018840012074, "outflow_rate_max": 927.3910144051033, "system_level_velocity_mean": 8.03759268165772, "cost1_min": 26.886289439590513, "cost1_max": 304.41932802167196, "outflow_rate_min": 341.4188626498589, "cost2_mean": -94.31852159894461, "outflow_rate_mean": 612.3560923072716, "system_level_velocity_min": 5.7113205483432985, "cost2_min": -133.42168853412602, "system_level_velocity_max": 18.436170678494943, "cost2_max": -20.304939890575078}, "node_ip": "10.138.0.2", "iterations_since_restore": 8, "done": false, "episodes_total": 116, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a52b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5080>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 456.6657014166321, "episode_reward_min": 45.639629410449096, "timesteps_total": 344052, "time_since_restore": 232.4661898612976, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 39799, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557189813, "time_this_iter_s": 22.00945210456848, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 8, "date": "2019-05-07_00-43-33", "episode_len_mean": 693.4}
{"timesteps_since_restore": 384667, "policy_reward_mean": {}, "episode_reward_max": 678.1484626987169, "time_total_s": 254.37177729606628, "info": {"num_steps_sampled": 384667, "sample_time_ms": 17839.86, "grad_time_ms": 10023.377, "update_time_ms": 296.476, "default": {"kl": 0.009455458261072636, "entropy": 1.3788996934890747, "cur_lr": 0.0005000000237487257, "total_loss": 4.071786403656006, "policy_loss": -0.0024598129093647003, "vf_explained_var": 0.9155616164207458, "vf_loss": 4.074009895324707, "cur_kl_coeff": 0.02500000409781933}, "num_steps_trained": 384667, "load_time_ms": 19.25}, "custom_metrics": {"cost1_mean": 205.56159520757555, "outflow_rate_max": 877.1148301270357, "system_level_velocity_mean": 8.033074674673042, "cost1_min": 26.886289439590513, "cost1_max": 278.0057152457356, "outflow_rate_min": 341.4188626498589, "cost2_mean": -97.63533821083522, "outflow_rate_mean": 625.879410125983, "system_level_velocity_min": 5.7113205483432985, "cost2_min": -148.24738435778573, "system_level_velocity_max": 18.436170678494943, "cost2_max": -20.304939890575078}, "node_ip": "10.138.0.2", "iterations_since_restore": 9, "done": false, "episodes_total": 128, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84fd0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 474.23684267968054, "episode_reward_min": 45.639629410449096, "timesteps_total": 384667, "time_since_restore": 254.37177729606628, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 40615, "pid": 25319, "episodes_this_iter": 12, "timestamp": 1557189835, "time_this_iter_s": 21.905587434768677, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 9, "date": "2019-05-07_00-43-55", "episode_len_mean": 693.4}
{"timesteps_since_restore": 424922, "policy_reward_mean": {}, "episode_reward_max": 735.4358347869355, "time_total_s": 276.4144926071167, "info": {"num_steps_sampled": 424922, "sample_time_ms": 17329.21, "grad_time_ms": 9942.922, "update_time_ms": 267.49, "default": {"kl": 0.00764419324696064, "entropy": 1.372793197631836, "cur_lr": 0.0005000000237487257, "total_loss": 6.265453815460205, "policy_loss": -0.002250197809189558, "vf_explained_var": 0.8841459155082703, "vf_loss": 6.267513275146484, "cur_kl_coeff": 0.02500000409781933}, "num_steps_trained": 424922, "load_time_ms": 18.581}, "custom_metrics": {"cost1_mean": 206.68024410279702, "outflow_rate_max": 906.5422620375285, "system_level_velocity_mean": 8.224422499709949, "cost1_min": 26.886289439590513, "cost1_max": 284.50212294211184, "outflow_rate_min": 341.4188626498589, "cost2_mean": -102.79609979534708, "outflow_rate_mean": 650.2696612719066, "system_level_velocity_min": 5.7113205483432985, "cost2_min": -178.10389697376286, "system_level_velocity_max": 18.436170678494943, "cost2_max": -20.304939890575078}, "node_ip": "10.138.0.2", "iterations_since_restore": 10, "done": false, "episodes_total": 144, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540626ab00>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 497.17103463557555, "episode_reward_min": 45.639629410449096, "timesteps_total": 424922, "time_since_restore": 276.4144926071167, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 40255, "pid": 25319, "episodes_this_iter": 16, "timestamp": 1557189857, "time_this_iter_s": 22.042715311050415, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 10, "date": "2019-05-07_00-44-17", "episode_len_mean": 686.95}
{"timesteps_since_restore": 465364, "policy_reward_mean": {}, "episode_reward_max": 742.066875114798, "time_total_s": 298.1618959903717, "info": {"num_steps_sampled": 465364, "sample_time_ms": 13262.338, "grad_time_ms": 9916.843, "update_time_ms": 7.344, "default": {"kl": 0.004340687766671181, "entropy": 1.3532851934432983, "cur_lr": 0.0005000000237487257, "total_loss": 6.305989742279053, "policy_loss": -0.00040589552372694016, "vf_explained_var": 0.89398592710495, "vf_loss": 6.3062872886657715, "cur_kl_coeff": 0.02500000223517418}, "num_steps_trained": 465364, "load_time_ms": 12.781}, "custom_metrics": {"cost1_mean": 219.6225149576967, "outflow_rate_max": 933.5106483852426, "system_level_velocity_mean": 8.517873326219336, "cost1_min": 35.89544493139801, "cost1_max": 287.30188759523116, "outflow_rate_min": 357.81502145635744, "cost2_mean": -116.23834305333408, "outflow_rate_mean": 707.7475689852247, "system_level_velocity_min": 5.7113205483432985, "cost2_min": -178.11545986739867, "system_level_velocity_max": 17.933651835055986, "cost2_max": -24.438314049768277}, "node_ip": "10.138.0.2", "iterations_since_restore": 11, "done": false, "episodes_total": 163, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f846a0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 553.5807714971183, "episode_reward_min": 67.46743332895983, "timesteps_total": 465364, "time_since_restore": 298.1618959903717, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 40442, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557189879, "time_this_iter_s": 21.747403383255005, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 11, "date": "2019-05-07_00-44-39", "episode_len_mean": 693.55}
{"timesteps_since_restore": 505040, "policy_reward_mean": {}, "episode_reward_max": 781.8452700381821, "time_total_s": 318.93366861343384, "info": {"num_steps_sampled": 505040, "sample_time_ms": 13010.519, "grad_time_ms": 9648.9, "update_time_ms": 7.372, "default": {"kl": 0.007033263798803091, "entropy": 1.3562215566635132, "cur_lr": 0.0005000000237487257, "total_loss": 7.290754318237305, "policy_loss": -0.0013264816952869296, "vf_explained_var": 0.8726014494895935, "vf_loss": 7.291993141174316, "cur_kl_coeff": 0.012500002048909664}, "num_steps_trained": 505040, "load_time_ms": 12.596}, "custom_metrics": {"cost1_mean": 232.9904162581754, "outflow_rate_max": 933.5106483852426, "system_level_velocity_mean": 9.008196208702156, "cost1_min": 35.89544493139801, "cost1_max": 288.12787328701114, "outflow_rate_min": 381.5673857193268, "cost2_mean": -128.8816445107774, "outflow_rate_mean": 772.3605412089186, "system_level_velocity_min": 6.2180600978825495, "cost2_min": -184.85326133513985, "system_level_velocity_max": 17.933651835055986, "cost2_max": -24.438314049768277}, "node_ip": "10.138.0.2", "iterations_since_restore": 12, "done": false, "episodes_total": 182, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a52b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a52e8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 606.3624670447444, "episode_reward_min": 67.46743332895983, "timesteps_total": 505040, "time_since_restore": 318.93366861343384, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 39676, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557189899, "time_this_iter_s": 20.771772623062134, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 12, "date": "2019-05-07_00-44-59", "episode_len_mean": 693.55}
{"timesteps_since_restore": 543654, "policy_reward_mean": {}, "episode_reward_max": 781.8452700381821, "time_total_s": 340.9069950580597, "info": {"num_steps_sampled": 543654, "sample_time_ms": 12786.281, "grad_time_ms": 9571.818, "update_time_ms": 6.856, "default": {"kl": 0.009137436747550964, "entropy": 1.3297879695892334, "cur_lr": 0.0005000000237487257, "total_loss": 8.388879776000977, "policy_loss": -0.0021051717922091484, "vf_explained_var": 0.8269874453544617, "vf_loss": 8.390870094299316, "cur_kl_coeff": 0.012500002980232239}, "num_steps_trained": 543654, "load_time_ms": 12.651}, "custom_metrics": {"cost1_mean": 241.51593920584722, "outflow_rate_max": 969.7825254240851, "system_level_velocity_mean": 9.30918872966619, "cost1_min": 35.89544493139801, "cost1_max": 312.3471762323411, "outflow_rate_min": 463.8315154076835, "cost2_mean": -135.4580666897119, "outflow_rate_mean": 808.3343456893854, "system_level_velocity_min": 6.724826367106351, "cost2_min": -184.85326133513985, "system_level_velocity_max": 17.933651835055986, "cost2_max": -24.438314049768277}, "node_ip": "10.138.0.2", "iterations_since_restore": 13, "done": false, "episodes_total": 200, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84208>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 634.823669289069, "episode_reward_min": 67.46743332895983, "timesteps_total": 543654, "time_since_restore": 340.9069950580597, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38614, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557189921, "time_this_iter_s": 21.973326444625854, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 13, "date": "2019-05-07_00-45-21", "episode_len_mean": 693.55}
{"timesteps_since_restore": 581897, "policy_reward_mean": {}, "episode_reward_max": 781.8452700381821, "time_total_s": 361.1697528362274, "info": {"num_steps_sampled": 581897, "sample_time_ms": 12669.033, "grad_time_ms": 9396.932, "update_time_ms": 7.248, "default": {"kl": 0.00763467513024807, "entropy": 1.332628846168518, "cur_lr": 0.0005000000237487257, "total_loss": 4.948620796203613, "policy_loss": -0.002160236705094576, "vf_explained_var": 0.9152621030807495, "vf_loss": 4.950685024261475, "cur_kl_coeff": 0.01250000111758709}, "num_steps_trained": 581897, "load_time_ms": 12.586}, "custom_metrics": {"cost1_mean": 247.47269705570127, "outflow_rate_max": 969.7825254240851, "system_level_velocity_mean": 9.524590525393828, "cost1_min": 35.89544493139801, "cost1_max": 312.3471762323411, "outflow_rate_min": 463.8315154076835, "cost2_mean": -137.10076873461233, "outflow_rate_mean": 827.7057658902761, "system_level_velocity_min": 8.085585274526682, "cost2_min": -184.85326133513985, "system_level_velocity_max": 17.933651835055986, "cost2_max": -24.438314049768277}, "node_ip": "10.138.0.2", "iterations_since_restore": 14, "done": false, "episodes_total": 212, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540626a2b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540626a7b8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 647.2043167449968, "episode_reward_min": 67.46743332895983, "timesteps_total": 581897, "time_since_restore": 361.1697528362274, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38243, "pid": 25319, "episodes_this_iter": 12, "timestamp": 1557189942, "time_this_iter_s": 20.262757778167725, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 14, "date": "2019-05-07_00-45-42", "episode_len_mean": 693.55}
{"timesteps_since_restore": 620716, "policy_reward_mean": {}, "episode_reward_max": 781.8452700381821, "time_total_s": 382.5739905834198, "info": {"num_steps_sampled": 620716, "sample_time_ms": 12742.42, "grad_time_ms": 9104.538, "update_time_ms": 7.391, "default": {"kl": 0.008005019277334213, "entropy": 1.3319122791290283, "cur_lr": 0.0005000000237487257, "total_loss": 7.535414695739746, "policy_loss": -0.00256808171980083, "vf_explained_var": 0.8720003962516785, "vf_loss": 7.5378828048706055, "cur_kl_coeff": 0.012500002980232239}, "num_steps_trained": 620716, "load_time_ms": 12.463}, "custom_metrics": {"cost1_mean": 249.84231435098079, "outflow_rate_max": 969.7825254240851, "system_level_velocity_mean": 9.621584290873093, "cost1_min": 35.89544493139801, "cost1_max": 312.3471762323411, "outflow_rate_min": 463.8315154076835, "cost2_mean": -135.08063013026097, "outflow_rate_mean": 835.2499432336745, "system_level_velocity_min": 8.085585274526682, "cost2_min": -184.85326133513985, "system_level_velocity_max": 17.933651835055986, "cost2_max": -24.438314049768277}, "node_ip": "10.138.0.2", "iterations_since_restore": 15, "done": false, "episodes_total": 232, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f840f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f845f8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 645.3731633439065, "episode_reward_min": 67.46743332895983, "timesteps_total": 620716, "time_since_restore": 382.5739905834198, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38819, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557189963, "time_this_iter_s": 21.404237747192383, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 15, "date": "2019-05-07_00-46-03", "episode_len_mean": 693.55}
{"timesteps_since_restore": 659593, "policy_reward_mean": {}, "episode_reward_max": 781.8452700381821, "time_total_s": 404.55012035369873, "info": {"num_steps_sampled": 659593, "sample_time_ms": 12686.756, "grad_time_ms": 8917.716, "update_time_ms": 7.305, "default": {"kl": 0.008899248205125332, "entropy": 1.3210861682891846, "cur_lr": 0.0005000000237487257, "total_loss": 8.06319522857666, "policy_loss": -0.0024764826521277428, "vf_explained_var": 0.8705861568450928, "vf_loss": 8.065561294555664, "cur_kl_coeff": 0.012500002980232239}, "num_steps_trained": 659593, "load_time_ms": 12.287}, "custom_metrics": {"cost1_mean": 253.9191797407819, "outflow_rate_max": 969.7825254240851, "system_level_velocity_mean": 9.63050482010317, "cost1_min": 210.35215232926308, "cost1_max": 312.3471762323411, "outflow_rate_min": 744.8298609327417, "cost2_mean": -130.515838903905, "outflow_rate_mean": 842.6732951225981, "system_level_velocity_min": 8.085585274526682, "cost2_min": -184.85326133513985, "system_level_velocity_max": 11.559947606135077, "cost2_max": -90.85549948496813}, "node_ip": "10.138.0.2", "iterations_since_restore": 16, "done": false, "episodes_total": 252, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a51d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a50f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5c88>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 642.6618630729589, "episode_reward_min": 559.6858156584901, "timesteps_total": 659593, "time_since_restore": 404.55012035369873, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38877, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557189985, "time_this_iter_s": 21.97612977027893, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 16, "date": "2019-05-07_00-46-25", "episode_len_mean": 700.0}
{"timesteps_since_restore": 698053, "policy_reward_mean": {}, "episode_reward_max": 792.6425998046471, "time_total_s": 425.9296979904175, "info": {"num_steps_sampled": 698053, "sample_time_ms": 12631.605, "grad_time_ms": 8819.918, "update_time_ms": 7.149, "default": {"kl": 0.00987070333212614, "entropy": 1.306373119354248, "cur_lr": 0.0005000000237487257, "total_loss": 8.433095932006836, "policy_loss": -0.0018880502320826054, "vf_explained_var": 0.8487997651100159, "vf_loss": 8.434861183166504, "cur_kl_coeff": 0.012500002048909664}, "num_steps_trained": 698053, "load_time_ms": 12.146}, "custom_metrics": {"cost1_mean": 257.13559185454454, "outflow_rate_max": 984.9756934268954, "system_level_velocity_mean": 9.737153295736755, "cost1_min": 210.35215232926308, "cost1_max": 312.3471762323411, "outflow_rate_min": 744.8298609327417, "cost2_mean": -128.77483446592578, "outflow_rate_mean": 850.5587084803337, "system_level_velocity_min": 8.085585274526682, "cost2_min": -184.85326133513985, "system_level_velocity_max": 11.590492225300636, "cost2_max": -90.85549948496813}, "node_ip": "10.138.0.2", "iterations_since_restore": 17, "done": false, "episodes_total": 268, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84160>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 647.7747584675864, "episode_reward_min": 559.6858156584901, "timesteps_total": 698053, "time_since_restore": 425.9296979904175, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38460, "pid": 25319, "episodes_this_iter": 16, "timestamp": 1557190007, "time_this_iter_s": 21.37957763671875, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 17, "date": "2019-05-07_00-46-47", "episode_len_mean": 700.0}
{"timesteps_since_restore": 735446, "policy_reward_mean": {}, "episode_reward_max": 792.6425998046471, "time_total_s": 446.3191316127777, "info": {"num_steps_sampled": 735446, "sample_time_ms": 12509.691, "grad_time_ms": 8781.078, "update_time_ms": 7.172, "default": {"kl": 0.008807225152850151, "entropy": 1.3056377172470093, "cur_lr": 0.0005000000237487257, "total_loss": 6.593855381011963, "policy_loss": -0.0018631166312843561, "vf_explained_var": 0.9010624289512634, "vf_loss": 6.595608711242676, "cur_kl_coeff": 0.01250000111758709}, "num_steps_trained": 735446, "load_time_ms": 11.988}, "custom_metrics": {"cost1_mean": 259.97515792612074, "outflow_rate_max": 1011.5147819477527, "system_level_velocity_mean": 9.851774264215116, "cost1_min": 211.53570784309127, "cost1_max": 325.3022069802019, "outflow_rate_min": 762.1495353826843, "cost2_mean": -125.06812067227467, "outflow_rate_mean": 857.7600704366005, "system_level_velocity_min": 8.188495076257762, "cost2_min": -161.67368989033795, "system_level_velocity_max": 12.071850252048884, "cost2_max": -90.85549948496813}, "node_ip": "10.138.0.2", "iterations_since_restore": 18, "done": false, "episodes_total": 283, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a50f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a51d0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 646.9150138896904, "episode_reward_min": 559.6858156584901, "timesteps_total": 735446, "time_since_restore": 446.3191316127777, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37393, "pid": 25319, "episodes_this_iter": 15, "timestamp": 1557190027, "time_this_iter_s": 20.38943362236023, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 18, "date": "2019-05-07_00-47-07", "episode_len_mean": 700.0}
{"timesteps_since_restore": 773805, "policy_reward_mean": {}, "episode_reward_max": 792.6425998046471, "time_total_s": 468.1462173461914, "info": {"num_steps_sampled": 773805, "sample_time_ms": 12535.807, "grad_time_ms": 8747.522, "update_time_ms": 7.142, "default": {"kl": 0.010349092073738575, "entropy": 1.3132781982421875, "cur_lr": 0.0005000000237487257, "total_loss": 7.94549560546875, "policy_loss": -0.0019823056645691395, "vf_explained_var": 0.8871476054191589, "vf_loss": 7.9473490715026855, "cur_kl_coeff": 0.012500002048909664}, "num_steps_trained": 773805, "load_time_ms": 11.779}, "custom_metrics": {"cost1_mean": 264.92839826023817, "outflow_rate_max": 1024.9106003561267, "system_level_velocity_mean": 10.044968879683507, "cost1_min": 211.53570784309127, "cost1_max": 337.26203525795364, "outflow_rate_min": 762.8581851172007, "cost2_mean": -121.67246546345348, "outflow_rate_mean": 867.6584757839141, "system_level_velocity_min": 8.188495076257762, "cost2_min": -158.074551009445, "system_level_velocity_max": 12.47832891410368, "cost2_max": -90.85549948496813}, "node_ip": "10.138.0.2", "iterations_since_restore": 19, "done": false, "episodes_total": 302, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84f28>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 651.2900903916063, "episode_reward_min": 559.6858156584901, "timesteps_total": 773805, "time_since_restore": 468.1462173461914, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38359, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557190049, "time_this_iter_s": 21.827085733413696, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 19, "date": "2019-05-07_00-47-29", "episode_len_mean": 700.0}
{"timesteps_since_restore": 811863, "policy_reward_mean": {}, "episode_reward_max": 792.6425998046471, "time_total_s": 490.4340260028839, "info": {"num_steps_sampled": 811863, "sample_time_ms": 12645.019, "grad_time_ms": 8662.567, "update_time_ms": 7.207, "default": {"kl": 0.01109752431511879, "entropy": 1.309235692024231, "cur_lr": 0.0005000000237487257, "total_loss": 8.333385467529297, "policy_loss": -0.0023427847772836685, "vf_explained_var": 0.8559365272521973, "vf_loss": 8.335589408874512, "cur_kl_coeff": 0.012500002048909664}, "num_steps_trained": 811863, "load_time_ms": 11.673}, "custom_metrics": {"cost1_mean": 267.92540913450296, "outflow_rate_max": 1040.035721447041, "system_level_velocity_mean": 10.175004007294385, "cost1_min": 211.53570784309127, "cost1_max": 338.76766391392914, "outflow_rate_min": 762.8581851172007, "cost2_mean": -119.28822073112887, "outflow_rate_mean": 874.5842279605829, "system_level_velocity_min": 8.188495076257762, "cost2_min": -158.03033924880665, "system_level_velocity_max": 12.660944947835269, "cost2_max": -90.85549948496813}, "node_ip": "10.138.0.2", "iterations_since_restore": 20, "done": false, "episodes_total": 322, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a59b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a52e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5390>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 649.9653817635609, "episode_reward_min": 527.4145664238719, "timesteps_total": 811863, "time_since_restore": 490.4340260028839, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38058, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557190071, "time_this_iter_s": 22.287808656692505, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 20, "date": "2019-05-07_00-47-51", "episode_len_mean": 700.0}
{"timesteps_since_restore": 850169, "policy_reward_mean": {}, "episode_reward_max": 792.6425998046471, "time_total_s": 514.1193294525146, "info": {"num_steps_sampled": 850169, "sample_time_ms": 12783.411, "grad_time_ms": 8721.694, "update_time_ms": 7.203, "default": {"kl": 0.010321291163563728, "entropy": 1.296649694442749, "cur_lr": 0.0005000000237487257, "total_loss": 6.014663219451904, "policy_loss": -0.001220460282638669, "vf_explained_var": 0.9136309623718262, "vf_loss": 6.015754699707031, "cur_kl_coeff": 0.012500002048909664}, "num_steps_trained": 850169, "load_time_ms": 11.57}, "custom_metrics": {"cost1_mean": 270.7746333810096, "outflow_rate_max": 1040.035721447041, "system_level_velocity_mean": 10.280834244729226, "cost1_min": 211.53570784309127, "cost1_max": 338.76766391392914, "outflow_rate_min": 762.8581851172007, "cost2_mean": -120.50457673789393, "outflow_rate_mean": 879.3203556782335, "system_level_velocity_min": 8.188495076257762, "cost2_min": -159.92438245356703, "system_level_velocity_max": 12.660944947835269, "cost2_max": -94.81898094978365}, "node_ip": "10.138.0.2", "iterations_since_restore": 21, "done": false, "episodes_total": 336, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f846a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84d68>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 651.2374249858677, "episode_reward_min": 527.4145664238719, "timesteps_total": 850169, "time_since_restore": 514.1193294525146, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38306, "pid": 25319, "episodes_this_iter": 14, "timestamp": 1557190095, "time_this_iter_s": 23.685303449630737, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 21, "date": "2019-05-07_00-48-15", "episode_len_mean": 700.0}
{"timesteps_since_restore": 887647, "policy_reward_mean": {}, "episode_reward_max": 800.5240264557353, "time_total_s": 537.5734851360321, "info": {"num_steps_sampled": 887647, "sample_time_ms": 13039.782, "grad_time_ms": 8732.571, "update_time_ms": 7.208, "default": {"kl": 0.012612470425665379, "entropy": 1.2791252136230469, "cur_lr": 0.0005000000237487257, "total_loss": 8.510054588317871, "policy_loss": -0.003936060704290867, "vf_explained_var": 0.8603478074073792, "vf_loss": 8.513833999633789, "cur_kl_coeff": 0.01250000111758709}, "num_steps_trained": 887647, "load_time_ms": 11.747}, "custom_metrics": {"cost1_mean": 273.3543434318745, "outflow_rate_max": 1041.9913176540347, "system_level_velocity_mean": 10.38424698946273, "cost1_min": 211.53570784309127, "cost1_max": 338.76766391392914, "outflow_rate_min": 762.8581851172007, "cost2_mean": -122.23589815267323, "outflow_rate_mean": 886.2629518974177, "system_level_velocity_min": 8.188495076257762, "cost2_min": -159.92438245356703, "system_level_velocity_max": 12.660944947835269, "cost2_max": -94.81898094978365}, "node_ip": "10.138.0.2", "iterations_since_restore": 22, "done": false, "episodes_total": 357, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a50f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a50b8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 656.4851256755536, "episode_reward_min": 527.4145664238719, "timesteps_total": 887647, "time_since_restore": 537.5734851360321, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37478, "pid": 25319, "episodes_this_iter": 21, "timestamp": 1557190118, "time_this_iter_s": 23.454155683517456, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 22, "date": "2019-05-07_00-48-38", "episode_len_mean": 700.0}
{"timesteps_since_restore": 925483, "policy_reward_mean": {}, "episode_reward_max": 800.5240264557353, "time_total_s": 559.3482990264893, "info": {"num_steps_sampled": 925483, "sample_time_ms": 13092.536, "grad_time_ms": 8662.386, "update_time_ms": 7.289, "default": {"kl": 0.009531409479677677, "entropy": 1.2835391759872437, "cur_lr": 0.0005000000237487257, "total_loss": 6.846276760101318, "policy_loss": -0.0030568097718060017, "vf_explained_var": 0.8815872669219971, "vf_loss": 6.849214553833008, "cur_kl_coeff": 0.01250000111758709}, "num_steps_trained": 925483, "load_time_ms": 11.437}, "custom_metrics": {"cost1_mean": 274.26537963417564, "outflow_rate_max": 1041.9913176540347, "system_level_velocity_mean": 10.442694719717506, "cost1_min": 211.53570784309127, "cost1_max": 338.76766391392914, "outflow_rate_min": 762.8581851172007, "cost2_mean": -120.14548112524943, "outflow_rate_mean": 887.4920463718765, "system_level_velocity_min": 8.188495076257762, "cost2_min": -159.92438245356703, "system_level_velocity_max": 12.660944947835269, "cost2_max": -94.81898094978365}, "node_ip": "10.138.0.2", "iterations_since_restore": 23, "done": false, "episodes_total": 375, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f840f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540622e358>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 647.0794558661121, "episode_reward_min": 527.4145664238719, "timesteps_total": 925483, "time_since_restore": 559.3482990264893, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37836, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557190140, "time_this_iter_s": 21.774813890457153, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 23, "date": "2019-05-07_00-49-00", "episode_len_mean": 700.0}
{"timesteps_since_restore": 964398, "policy_reward_mean": {}, "episode_reward_max": 800.5240264557353, "time_total_s": 580.5235147476196, "info": {"num_steps_sampled": 964398, "sample_time_ms": 13150.697, "grad_time_ms": 8695.472, "update_time_ms": 7.012, "default": {"kl": 0.00990714319050312, "entropy": 1.2713936567306519, "cur_lr": 0.0005000000237487257, "total_loss": 6.121333122253418, "policy_loss": -0.0015146686928346753, "vf_explained_var": 0.8669958710670471, "vf_loss": 6.1227240562438965, "cur_kl_coeff": 0.01250000111758709}, "num_steps_trained": 964398, "load_time_ms": 11.446}, "custom_metrics": {"cost1_mean": 272.0404777437982, "outflow_rate_max": 1041.9913176540347, "system_level_velocity_mean": 10.377242648509538, "cost1_min": 225.27547210732718, "cost1_max": 338.76766391392914, "outflow_rate_min": 767.2522932474523, "cost2_mean": -119.61578266625992, "outflow_rate_mean": 881.6143335563414, "system_level_velocity_min": 8.757297401153727, "cost2_min": -159.92438245356703, "system_level_velocity_max": 12.660944947835269, "cost2_max": -96.82977430604359}, "node_ip": "10.138.0.2", "iterations_since_restore": 24, "done": false, "episodes_total": 391, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a59e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625fb70>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 642.7966551211246, "episode_reward_min": 527.4145664238719, "timesteps_total": 964398, "time_since_restore": 580.5235147476196, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38915, "pid": 25319, "episodes_this_iter": 16, "timestamp": 1557190161, "time_this_iter_s": 21.17521572113037, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 24, "date": "2019-05-07_00-49-21", "episode_len_mean": 700.0}
{"timesteps_since_restore": 1002719, "policy_reward_mean": {}, "episode_reward_max": 800.5240264557353, "time_total_s": 600.8526258468628, "info": {"num_steps_sampled": 1002719, "sample_time_ms": 12912.25, "grad_time_ms": 8826.634, "update_time_ms": 6.769, "default": {"kl": 0.012799015268683434, "entropy": 1.2513928413391113, "cur_lr": 0.0005000000237487257, "total_loss": 6.1516571044921875, "policy_loss": -0.0037747935857623816, "vf_explained_var": 0.8892882466316223, "vf_loss": 6.155272006988525, "cur_kl_coeff": 0.012500002048909664}, "num_steps_trained": 1002719, "load_time_ms": 11.29}, "custom_metrics": {"cost1_mean": 268.2453270162194, "outflow_rate_max": 1041.9913176540347, "system_level_velocity_mean": 10.257297236334976, "cost1_min": 222.20685631620177, "cost1_max": 338.76766391392914, "outflow_rate_min": 739.2499852769856, "cost2_mean": -120.35000486792065, "outflow_rate_mean": 873.9805010534712, "system_level_velocity_min": 8.605050656523991, "cost2_min": -159.92438245356703, "system_level_velocity_max": 12.660944947835269, "cost2_max": -100.11814465015469}, "node_ip": "10.138.0.2", "iterations_since_restore": 25, "done": false, "episodes_total": 405, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84fd0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 642.0379986630529, "episode_reward_min": 527.4145664238719, "timesteps_total": 1002719, "time_since_restore": 600.8526258468628, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38321, "pid": 25319, "episodes_this_iter": 14, "timestamp": 1557190182, "time_this_iter_s": 20.329111099243164, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 25, "date": "2019-05-07_00-49-42", "episode_len_mean": 700.0}
{"timesteps_since_restore": 1042760, "policy_reward_mean": {}, "episode_reward_max": 800.5240264557353, "time_total_s": 623.5611083507538, "info": {"num_steps_sampled": 1042760, "sample_time_ms": 12949.61, "grad_time_ms": 8861.113, "update_time_ms": 6.918, "default": {"kl": 0.015763362869620323, "entropy": 1.24164879322052, "cur_lr": 0.0005000000237487257, "total_loss": 10.03372573852539, "policy_loss": -0.003151852637529373, "vf_explained_var": 0.8395448327064514, "vf_loss": 10.036680221557617, "cur_kl_coeff": 0.012500002048909664}, "num_steps_trained": 1042760, "load_time_ms": 11.813}, "custom_metrics": {"cost1_mean": 266.3635581124665, "outflow_rate_max": 1041.9913176540347, "system_level_velocity_mean": 10.198740816424724, "cost1_min": 222.20685631620177, "cost1_max": 332.0694801501552, "outflow_rate_min": 739.2499852769856, "cost2_mean": -123.6261180803877, "outflow_rate_mean": 872.0265991860139, "system_level_velocity_min": 8.605050656523991, "cost2_min": -180.36250375969865, "system_level_velocity_max": 12.472164419873458, "cost2_max": -100.11814465015469}, "node_ip": "10.138.0.2", "iterations_since_restore": 26, "done": false, "episodes_total": 425, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5208>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 653.9319729138404, "episode_reward_min": 564.4716289303316, "timesteps_total": 1042760, "time_since_restore": 623.5611083507538, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 40041, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557190204, "time_this_iter_s": 22.70848250389099, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 26, "date": "2019-05-07_00-50-04", "episode_len_mean": 700.0}
{"timesteps_since_restore": 1082079, "policy_reward_mean": {}, "episode_reward_max": 823.756929315914, "time_total_s": 645.9133026599884, "info": {"num_steps_sampled": 1082079, "sample_time_ms": 12998.883, "grad_time_ms": 8908.901, "update_time_ms": 6.904, "default": {"kl": 0.011086954735219479, "entropy": 1.238000750541687, "cur_lr": 0.0005000000237487257, "total_loss": 10.895891189575195, "policy_loss": -0.002598878927528858, "vf_explained_var": 0.8196020126342773, "vf_loss": 10.898351669311523, "cur_kl_coeff": 0.012500002048909664}, "num_steps_trained": 1082079, "load_time_ms": 11.816}, "custom_metrics": {"cost1_mean": 266.5825493688915, "outflow_rate_max": 1014.4641956727465, "system_level_velocity_mean": 10.2166202371994, "cost1_min": 222.20685631620177, "cost1_max": 343.3457950377896, "outflow_rate_min": 739.2499852769856, "cost2_mean": -126.56381149854737, "outflow_rate_mean": 873.1856993450792, "system_level_velocity_min": 8.605050656523991, "cost2_min": -180.36250375969865, "system_level_velocity_max": 13.034630451636184, "cost2_max": -100.49561480907455}, "node_ip": "10.138.0.2", "iterations_since_restore": 27, "done": false, "episodes_total": 445, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f805c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80080>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 665.538514888522, "episode_reward_min": 564.4716289303316, "timesteps_total": 1082079, "time_since_restore": 645.9133026599884, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 39319, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557190227, "time_this_iter_s": 22.35219430923462, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 27, "date": "2019-05-07_00-50-27", "episode_len_mean": 700.0}
{"timesteps_since_restore": 1120037, "policy_reward_mean": {}, "episode_reward_max": 823.756929315914, "time_total_s": 667.4685454368591, "info": {"num_steps_sampled": 1120037, "sample_time_ms": 13141.622, "grad_time_ms": 8883.18, "update_time_ms": 6.909, "default": {"kl": 0.014440401457250118, "entropy": 1.2113336324691772, "cur_lr": 0.0005000000237487257, "total_loss": 7.183501243591309, "policy_loss": -0.003826744621619582, "vf_explained_var": 0.8973360061645508, "vf_loss": 7.18714714050293, "cur_kl_coeff": 0.01250000111758709}, "num_steps_trained": 1120037, "load_time_ms": 11.868}, "custom_metrics": {"cost1_mean": 268.9779282245104, "outflow_rate_max": 1014.4641956727465, "system_level_velocity_mean": 10.312083912694076, "cost1_min": 222.20685631620177, "cost1_max": 343.3457950377896, "outflow_rate_min": 739.2499852769856, "cost2_mean": -128.02549504776462, "outflow_rate_mean": 877.1458105229276, "system_level_velocity_min": 8.605050656523991, "cost2_min": -180.36250375969865, "system_level_velocity_max": 13.034630451636184, "cost2_max": -101.02346797657665}, "node_ip": "10.138.0.2", "iterations_since_restore": 28, "done": false, "episodes_total": 459, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a52b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5470>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 670.2420202973702, "episode_reward_min": 564.4716289303316, "timesteps_total": 1120037, "time_since_restore": 667.4685454368591, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37958, "pid": 25319, "episodes_this_iter": 14, "timestamp": 1557190248, "time_this_iter_s": 21.555242776870728, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 28, "date": "2019-05-07_00-50-48", "episode_len_mean": 700.0}
{"timesteps_since_restore": 1157763, "policy_reward_mean": {}, "episode_reward_max": 835.3220680052913, "time_total_s": 689.6426627635956, "info": {"num_steps_sampled": 1157763, "sample_time_ms": 13187.67, "grad_time_ms": 8872.15, "update_time_ms": 6.921, "default": {"kl": 0.014578388072550297, "entropy": 1.206686019897461, "cur_lr": 0.0005000000237487257, "total_loss": 11.057125091552734, "policy_loss": -0.0036148198414593935, "vf_explained_var": 0.8557053208351135, "vf_loss": 11.06055736541748, "cur_kl_coeff": 0.012500000186264515}, "num_steps_trained": 1157763, "load_time_ms": 11.745}, "custom_metrics": {"cost1_mean": 272.41732304317355, "outflow_rate_max": 1105.0050471193074, "system_level_velocity_mean": 10.455196888611082, "cost1_min": 222.20685631620177, "cost1_max": 358.5652808836343, "outflow_rate_min": 739.2499852769856, "cost2_mean": -131.69634454958907, "outflow_rate_mean": 885.9123104173857, "system_level_velocity_min": 8.605050656523991, "cost2_min": -180.36250375969865, "system_level_velocity_max": 13.47417257947376, "cost2_max": -101.02346797657665}, "node_ip": "10.138.0.2", "iterations_since_restore": 29, "done": false, "episodes_total": 479, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c4a8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 683.7731701217392, "episode_reward_min": 564.4716289303316, "timesteps_total": 1157763, "time_since_restore": 689.6426627635956, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37726, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557190271, "time_this_iter_s": 22.17411732673645, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 29, "date": "2019-05-07_00-51-11", "episode_len_mean": 700.0}
{"timesteps_since_restore": 1195824, "policy_reward_mean": {}, "episode_reward_max": 835.3220680052913, "time_total_s": 711.3656339645386, "info": {"num_steps_sampled": 1195824, "sample_time_ms": 13095.908, "grad_time_ms": 8908.001, "update_time_ms": 6.874, "default": {"kl": 0.016057921573519707, "entropy": 1.1976135969161987, "cur_lr": 0.0005000000237487257, "total_loss": 9.780223846435547, "policy_loss": -0.004459912423044443, "vf_explained_var": 0.8595804572105408, "vf_loss": 9.784483909606934, "cur_kl_coeff": 0.012500002048909664}, "num_steps_trained": 1195824, "load_time_ms": 11.744}, "custom_metrics": {"cost1_mean": 275.9299141459788, "outflow_rate_max": 1105.0050471193074, "system_level_velocity_mean": 10.775967969766326, "cost1_min": 30.214219785882552, "cost1_max": 358.5652808836343, "outflow_rate_min": 450.5250931082574, "cost2_mean": -131.95593322382786, "outflow_rate_mean": 893.1940037926022, "system_level_velocity_min": 8.673511237936985, "cost2_min": -180.36250375969865, "system_level_velocity_max": 18.089173715807046, "cost2_max": -23.80875314942001}, "node_ip": "10.138.0.2", "iterations_since_restore": 30, "done": false, "episodes_total": 498, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a51d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266c88>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 685.0276670731569, "episode_reward_min": 55.7251344740006, "timesteps_total": 1195824, "time_since_restore": 711.3656339645386, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38061, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557190292, "time_this_iter_s": 21.722971200942993, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 30, "date": "2019-05-07_00-51-32", "episode_len_mean": 693.45}
{"timesteps_since_restore": 1232850, "policy_reward_mean": {}, "episode_reward_max": 835.3220680052913, "time_total_s": 733.485292673111, "info": {"num_steps_sampled": 1232850, "sample_time_ms": 13110.655, "grad_time_ms": 8735.887, "update_time_ms": 6.969, "default": {"kl": 0.011079616844654083, "entropy": 1.1943731307983398, "cur_lr": 0.0005000000237487257, "total_loss": 10.577086448669434, "policy_loss": -0.002483549527823925, "vf_explained_var": 0.8394681215286255, "vf_loss": 10.579432487487793, "cur_kl_coeff": 0.01250000111758709}, "num_steps_trained": 1232850, "load_time_ms": 11.676}, "custom_metrics": {"cost1_mean": 280.7058167095432, "outflow_rate_max": 1105.0050471193074, "system_level_velocity_mean": 10.970690140557743, "cost1_min": 30.214219785882552, "cost1_max": 358.5652808836343, "outflow_rate_min": 450.5250931082574, "cost2_mean": -132.51927002274329, "outflow_rate_mean": 903.4020454597313, "system_level_velocity_min": 8.837848987777118, "cost2_min": -180.36250375969865, "system_level_velocity_max": 18.089173715807046, "cost2_max": -23.80875314942001}, "node_ip": "10.138.0.2", "iterations_since_restore": 31, "done": false, "episodes_total": 516, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289438>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 687.6266765659913, "episode_reward_min": 55.7251344740006, "timesteps_total": 1232850, "time_since_restore": 733.485292673111, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37026, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557190315, "time_this_iter_s": 22.119658708572388, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 31, "date": "2019-05-07_00-51-55", "episode_len_mean": 693.45}
{"timesteps_since_restore": 1269282, "policy_reward_mean": {}, "episode_reward_max": 835.3220680052913, "time_total_s": 755.3104343414307, "info": {"num_steps_sampled": 1269282, "sample_time_ms": 12972.046, "grad_time_ms": 8712.241, "update_time_ms": 6.922, "default": {"kl": 0.013959571719169617, "entropy": 1.1932697296142578, "cur_lr": 0.0005000000237487257, "total_loss": 9.705881118774414, "policy_loss": -0.003831467591226101, "vf_explained_var": 0.8698923587799072, "vf_loss": 9.709538459777832, "cur_kl_coeff": 0.01250000111758709}, "num_steps_trained": 1269282, "load_time_ms": 11.604}, "custom_metrics": {"cost1_mean": 282.82312721276236, "outflow_rate_max": 1105.0050471193074, "system_level_velocity_mean": 11.216660161184086, "cost1_min": 30.214219785882552, "cost1_max": 358.5652808836343, "outflow_rate_min": 450.5250931082574, "cost2_mean": -131.53226185080172, "outflow_rate_mean": 908.1082728246795, "system_level_velocity_min": 9.40669428655777, "cost2_min": -172.19889210452544, "system_level_velocity_max": 18.324696173406213, "cost2_max": -23.80875314942001}, "node_ip": "10.138.0.2", "iterations_since_restore": 32, "done": false, "episodes_total": 532, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062337b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c9e8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 679.5433176779858, "episode_reward_min": 55.7251344740006, "timesteps_total": 1269282, "time_since_restore": 755.3104343414307, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36432, "pid": 25319, "episodes_this_iter": 16, "timestamp": 1557190336, "time_this_iter_s": 21.825141668319702, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 32, "date": "2019-05-07_00-52-16", "episode_len_mean": 687.68}
{"timesteps_since_restore": 1307071, "policy_reward_mean": {}, "episode_reward_max": 835.3220680052913, "time_total_s": 777.945652961731, "info": {"num_steps_sampled": 1307071, "sample_time_ms": 13057.084, "grad_time_ms": 8712.339, "update_time_ms": 6.887, "default": {"kl": 0.013274853117763996, "entropy": 1.1746662855148315, "cur_lr": 0.0005000000237487257, "total_loss": 11.38370132446289, "policy_loss": -0.0027128858491778374, "vf_explained_var": 0.8623207807540894, "vf_loss": 11.386248588562012, "cur_kl_coeff": 0.01250000111758709}, "num_steps_trained": 1307071, "load_time_ms": 11.882}, "custom_metrics": {"cost1_mean": 281.86624347997275, "outflow_rate_max": 1105.0050471193074, "system_level_velocity_mean": 11.37039183675313, "cost1_min": 30.214219785882552, "cost1_max": 361.3870835945828, "outflow_rate_min": 450.5250931082574, "cost2_mean": -128.32572064008068, "outflow_rate_mean": 907.4835702788616, "system_level_velocity_min": 9.42549338149171, "cost2_min": -162.16708776542572, "system_level_velocity_max": 18.324696173406213, "cost2_max": -23.80875314942001}, "node_ip": "10.138.0.2", "iterations_since_restore": 33, "done": false, "episodes_total": 552, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a52b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5518>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 667.2633920975587, "episode_reward_min": 55.7251344740006, "timesteps_total": 1307071, "time_since_restore": 777.945652961731, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37789, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557190359, "time_this_iter_s": 22.635218620300293, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 33, "date": "2019-05-07_00-52-39", "episode_len_mean": 681.17}
{"timesteps_since_restore": 1344938, "policy_reward_mean": {}, "episode_reward_max": 802.3334762893778, "time_total_s": 799.9919934272766, "info": {"num_steps_sampled": 1344938, "sample_time_ms": 13207.244, "grad_time_ms": 8649.896, "update_time_ms": 6.74, "default": {"kl": 0.009724953211843967, "entropy": 1.16804039478302, "cur_lr": 0.0005000000237487257, "total_loss": 11.798911094665527, "policy_loss": -0.003943487536162138, "vf_explained_var": 0.8299676179885864, "vf_loss": 11.802734375, "cur_kl_coeff": 0.01250000111758709}, "num_steps_trained": 1344938, "load_time_ms": 11.532}, "custom_metrics": {"cost1_mean": 282.7589245597959, "outflow_rate_max": 1079.7333088565897, "system_level_velocity_mean": 11.40851203285941, "cost1_min": 30.214219785882552, "cost1_max": 361.3870835945828, "outflow_rate_min": 450.5250931082574, "cost2_mean": -125.71985071588551, "outflow_rate_mean": 909.0429862114837, "system_level_velocity_min": 9.42549338149171, "cost2_min": -162.16708776542572, "system_level_velocity_max": 18.324696173406213, "cost2_max": -23.80875314942001}, "node_ip": "10.138.0.2", "iterations_since_restore": 34, "done": false, "episodes_total": 572, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289550>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 665.3933176573793, "episode_reward_min": 55.7251344740006, "timesteps_total": 1344938, "time_since_restore": 799.9919934272766, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37867, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557190381, "time_this_iter_s": 22.046340465545654, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 34, "date": "2019-05-07_00-53-01", "episode_len_mean": 681.17}
{"timesteps_since_restore": 1381127, "policy_reward_mean": {}, "episode_reward_max": 783.1318074394312, "time_total_s": 822.9856607913971, "info": {"num_steps_sampled": 1381127, "sample_time_ms": 13373.936, "grad_time_ms": 8749.894, "update_time_ms": 6.988, "default": {"kl": 0.01892038993537426, "entropy": 1.1444275379180908, "cur_lr": 0.0005000000237487257, "total_loss": 9.472028732299805, "policy_loss": -0.005722550675272942, "vf_explained_var": 0.8973385095596313, "vf_loss": 9.47751522064209, "cur_kl_coeff": 0.01250000111758709}, "num_steps_trained": 1381127, "load_time_ms": 11.517}, "custom_metrics": {"cost1_mean": 280.266751474883, "outflow_rate_max": 1079.7333088565897, "system_level_velocity_mean": 11.332180186729772, "cost1_min": 30.214219785882552, "cost1_max": 361.3870835945828, "outflow_rate_min": 450.5250931082574, "cost2_mean": -123.99394679347154, "outflow_rate_mean": 903.0144184902134, "system_level_velocity_min": 9.42549338149171, "cost2_min": -150.05964836757448, "system_level_velocity_max": 18.324696173406213, "cost2_max": -23.80875314942001}, "node_ip": "10.138.0.2", "iterations_since_restore": 35, "done": false, "episodes_total": 588, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540626aa90>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 654.0092643671917, "episode_reward_min": 55.7251344740006, "timesteps_total": 1381127, "time_since_restore": 822.9856607913971, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36189, "pid": 25319, "episodes_this_iter": 16, "timestamp": 1557190404, "time_this_iter_s": 22.993667364120483, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 35, "date": "2019-05-07_00-53-24", "episode_len_mean": 681.17}
{"timesteps_since_restore": 1417686, "policy_reward_mean": {}, "episode_reward_max": 782.856007605953, "time_total_s": 844.8496854305267, "info": {"num_steps_sampled": 1417686, "sample_time_ms": 13339.351, "grad_time_ms": 8700.264, "update_time_ms": 6.955, "default": {"kl": 0.013036223128437996, "entropy": 1.1299560070037842, "cur_lr": 0.0005000000237487257, "total_loss": 9.904791831970215, "policy_loss": -0.003934266045689583, "vf_explained_var": 0.8824959993362427, "vf_loss": 9.908562660217285, "cur_kl_coeff": 0.012500002048909664}, "num_steps_trained": 1417686, "load_time_ms": 11.617}, "custom_metrics": {"cost1_mean": 283.4711888910216, "outflow_rate_max": 1079.7333088565897, "system_level_velocity_mean": 11.285925669517855, "cost1_min": 32.060050885662164, "cost1_max": 361.3870835945828, "outflow_rate_min": 459.1491483641131, "cost2_mean": -125.3684206148171, "outflow_rate_mean": 910.1074351595969, "system_level_velocity_min": 9.42549338149171, "cost2_min": -150.05964836757448, "system_level_velocity_max": 18.324696173406213, "cost2_max": -25.835995407935545}, "node_ip": "10.138.0.2", "iterations_since_restore": 36, "done": false, "episodes_total": 608, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f807b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80a20>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 653.4373358692001, "episode_reward_min": 58.59390820757471, "timesteps_total": 1417686, "time_since_restore": 844.8496854305267, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36559, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557190426, "time_this_iter_s": 21.86402463912964, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 36, "date": "2019-05-07_00-53-46", "episode_len_mean": 687.72}
{"timesteps_since_restore": 1454976, "policy_reward_mean": {}, "episode_reward_max": 782.856007605953, "time_total_s": 866.6207828521729, "info": {"num_steps_sampled": 1454976, "sample_time_ms": 13332.724, "grad_time_ms": 8649.105, "update_time_ms": 7.08, "default": {"kl": 0.015625329688191414, "entropy": 1.1147093772888184, "cur_lr": 0.0005000000237487257, "total_loss": 9.130701065063477, "policy_loss": -0.0050839148461818695, "vf_explained_var": 0.8998128771781921, "vf_loss": 9.135589599609375, "cur_kl_coeff": 0.01250000111758709}, "num_steps_trained": 1454976, "load_time_ms": 11.695}, "custom_metrics": {"cost1_mean": 285.15811094815734, "outflow_rate_max": 1079.7333088565897, "system_level_velocity_mean": 11.202342530398507, "cost1_min": 32.060050885662164, "cost1_max": 361.3870835945828, "outflow_rate_min": 459.1491483641131, "cost2_mean": -124.19625422283927, "outflow_rate_mean": 911.1682943914759, "system_level_velocity_min": 9.487290085949512, "cost2_min": -150.05964836757448, "system_level_velocity_max": 18.12214031145283, "cost2_max": -25.835995407935545}, "node_ip": "10.138.0.2", "iterations_since_restore": 37, "done": false, "episodes_total": 625, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540626a7b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540626a4e0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 649.8733617685598, "episode_reward_min": 58.59390820757471, "timesteps_total": 1454976, "time_since_restore": 866.6207828521729, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37290, "pid": 25319, "episodes_this_iter": 17, "timestamp": 1557190448, "time_this_iter_s": 21.771097421646118, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 37, "date": "2019-05-07_00-54-08", "episode_len_mean": 693.49}
{"timesteps_since_restore": 1492440, "policy_reward_mean": {}, "episode_reward_max": 761.6446884961165, "time_total_s": 888.4870183467865, "info": {"num_steps_sampled": 1492440, "sample_time_ms": 13400.285, "grad_time_ms": 8612.327, "update_time_ms": 7.138, "default": {"kl": 0.01735447160899639, "entropy": 1.1289315223693848, "cur_lr": 0.0005000000237487257, "total_loss": 10.656109809875488, "policy_loss": -0.004618694074451923, "vf_explained_var": 0.8757904767990112, "vf_loss": 10.660511016845703, "cur_kl_coeff": 0.01250000111758709}, "num_steps_trained": 1492440, "load_time_ms": 11.642}, "custom_metrics": {"cost1_mean": 284.6494821053504, "outflow_rate_max": 1077.202101536076, "system_level_velocity_mean": 11.176288229818512, "cost1_min": 32.060050885662164, "cost1_max": 354.4232331291465, "outflow_rate_min": 459.1491483641131, "cost2_mean": -123.21097137551764, "outflow_rate_mean": 911.5011681263528, "system_level_velocity_min": 9.041875552025129, "cost2_min": -157.70754147287278, "system_level_velocity_max": 18.12214031145283, "cost2_max": -25.835995407935545}, "node_ip": "10.138.0.2", "iterations_since_restore": 38, "done": false, "episodes_total": 645, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cc88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c160>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 649.6557411067237, "episode_reward_min": 58.59390820757471, "timesteps_total": 1492440, "time_since_restore": 888.4870183467865, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37464, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557190470, "time_this_iter_s": 21.866235494613647, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 38, "date": "2019-05-07_00-54-30", "episode_len_mean": 693.49}
{"timesteps_since_restore": 1529322, "policy_reward_mean": {}, "episode_reward_max": 748.9505403058361, "time_total_s": 909.8915235996246, "info": {"num_steps_sampled": 1529322, "sample_time_ms": 13380.836, "grad_time_ms": 8553.994, "update_time_ms": 7.191, "default": {"kl": 0.012496409937739372, "entropy": 1.1243869066238403, "cur_lr": 0.0005000000237487257, "total_loss": 9.039806365966797, "policy_loss": -0.0022605890408158302, "vf_explained_var": 0.9062072038650513, "vf_loss": 9.041910171508789, "cur_kl_coeff": 0.01250000111758709}, "num_steps_trained": 1529322, "load_time_ms": 11.705}, "custom_metrics": {"cost1_mean": 284.1045360656667, "outflow_rate_max": 1077.202101536076, "system_level_velocity_mean": 11.15945520117716, "cost1_min": 32.13068212929672, "cost1_max": 354.4232331291465, "outflow_rate_min": 444.74840099902235, "cost2_mean": -123.68048727562949, "outflow_rate_mean": 910.72288908498, "system_level_velocity_min": 9.041875552025129, "cost2_min": -157.70754147287278, "system_level_velocity_max": 18.455042725853517, "cost2_max": -23.366909251477928}, "node_ip": "10.138.0.2", "iterations_since_restore": 39, "done": false, "episodes_total": 661, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5048>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 647.0859078187566, "episode_reward_min": 56.7870467620744, "timesteps_total": 1529322, "time_since_restore": 909.8915235996246, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36882, "pid": 25319, "episodes_this_iter": 16, "timestamp": 1557190491, "time_this_iter_s": 21.404505252838135, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 39, "date": "2019-05-07_00-54-51", "episode_len_mean": 693.48}
{"timesteps_since_restore": 1566735, "policy_reward_mean": {}, "episode_reward_max": 769.4646760535335, "time_total_s": 931.7263848781586, "info": {"num_steps_sampled": 1566735, "sample_time_ms": 13477.675, "grad_time_ms": 8467.601, "update_time_ms": 7.236, "default": {"kl": 0.014294938184320927, "entropy": 1.1086699962615967, "cur_lr": 0.0005000000237487257, "total_loss": 10.782870292663574, "policy_loss": -0.004285665228962898, "vf_explained_var": 0.8873788714408875, "vf_loss": 10.78697681427002, "cur_kl_coeff": 0.01250000111758709}, "num_steps_trained": 1566735, "load_time_ms": 11.693}, "custom_metrics": {"cost1_mean": 286.9454211961607, "outflow_rate_max": 1122.6596045768583, "system_level_velocity_mean": 11.255414008621745, "cost1_min": 32.13068212929672, "cost1_max": 412.8239412376786, "outflow_rate_min": 444.74840099902235, "cost2_mean": -126.24656694674658, "outflow_rate_mean": 917.2854461808314, "system_level_velocity_min": 9.041875552025129, "cost2_min": -158.0321459365281, "system_level_velocity_max": 18.455042725853517, "cost2_max": -23.366909251477928}, "node_ip": "10.138.0.2", "iterations_since_restore": 40, "done": false, "episodes_total": 680, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062898d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289e48>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 651.8637927751989, "episode_reward_min": 56.7870467620744, "timesteps_total": 1566735, "time_since_restore": 931.7263848781586, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37413, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557190513, "time_this_iter_s": 21.834861278533936, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 40, "date": "2019-05-07_00-55-13", "episode_len_mean": 693.48}
{"timesteps_since_restore": 1604475, "policy_reward_mean": {}, "episode_reward_max": 783.4712725867195, "time_total_s": 954.074378490448, "info": {"num_steps_sampled": 1604475, "sample_time_ms": 13458.559, "grad_time_ms": 8509.573, "update_time_ms": 7.145, "default": {"kl": 0.014129547402262688, "entropy": 1.1051305532455444, "cur_lr": 0.0005000000237487257, "total_loss": 11.355513572692871, "policy_loss": -0.0031456248834729195, "vf_explained_var": 0.877243161201477, "vf_loss": 11.358482360839844, "cur_kl_coeff": 0.012500000186264515}, "num_steps_trained": 1604475, "load_time_ms": 11.823}, "custom_metrics": {"cost1_mean": 286.7731770334729, "outflow_rate_max": 1122.6596045768583, "system_level_velocity_mean": 11.254698818770082, "cost1_min": 32.13068212929672, "cost1_max": 412.8239412376786, "outflow_rate_min": 444.74840099902235, "cost2_mean": -127.45996040300763, "outflow_rate_mean": 918.3873177286313, "system_level_velocity_min": 9.041875552025129, "cost2_min": -158.0321459365281, "system_level_velocity_max": 18.455042725853517, "cost2_max": -23.366909251477928}, "node_ip": "10.138.0.2", "iterations_since_restore": 41, "done": false, "episodes_total": 698, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5080>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 657.0522188446307, "episode_reward_min": 56.7870467620744, "timesteps_total": 1604475, "time_since_restore": 954.074378490448, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37740, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557190535, "time_this_iter_s": 22.34799361228943, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 41, "date": "2019-05-07_00-55-35", "episode_len_mean": 693.48}
{"timesteps_since_restore": 1641799, "policy_reward_mean": {}, "episode_reward_max": 807.9379241438633, "time_total_s": 975.4272332191467, "info": {"num_steps_sampled": 1641799, "sample_time_ms": 13456.785, "grad_time_ms": 8463.83, "update_time_ms": 7.135, "default": {"kl": 0.015537810511887074, "entropy": 1.0884734392166138, "cur_lr": 0.0005000000237487257, "total_loss": 10.604341506958008, "policy_loss": -0.0037005075719207525, "vf_explained_var": 0.8866226673126221, "vf_loss": 10.607848167419434, "cur_kl_coeff": 0.01250000111758709}, "num_steps_trained": 1641799, "load_time_ms": 11.937}, "custom_metrics": {"cost1_mean": 287.62007989474245, "outflow_rate_max": 1122.6596045768583, "system_level_velocity_mean": 11.288032230722159, "cost1_min": 32.13068212929672, "cost1_max": 412.8239412376786, "outflow_rate_min": 444.74840099902235, "cost2_mean": -129.27473366305261, "outflow_rate_mean": 921.6731215366468, "system_level_velocity_min": 9.041875552025129, "cost2_min": -158.0321459365281, "system_level_velocity_max": 18.455042725853517, "cost2_max": -23.366909251477928}, "node_ip": "10.138.0.2", "iterations_since_restore": 42, "done": false, "episodes_total": 715, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f807f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f806a0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 664.9615108266913, "episode_reward_min": 56.7870467620744, "timesteps_total": 1641799, "time_since_restore": 975.4272332191467, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37324, "pid": 25319, "episodes_this_iter": 17, "timestamp": 1557190557, "time_this_iter_s": 21.35285472869873, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 42, "date": "2019-05-07_00-55-57", "episode_len_mean": 693.48}
{"timesteps_since_restore": 1678964, "policy_reward_mean": {}, "episode_reward_max": 826.5582636519691, "time_total_s": 997.293160200119, "info": {"num_steps_sampled": 1678964, "sample_time_ms": 13406.405, "grad_time_ms": 8438.609, "update_time_ms": 7.156, "default": {"kl": 0.01666993647813797, "entropy": 1.0773628950119019, "cur_lr": 0.0005000000237487257, "total_loss": 12.538050651550293, "policy_loss": -0.0031805525068193674, "vf_explained_var": 0.8562959432601929, "vf_loss": 12.541024208068848, "cur_kl_coeff": 0.012500002048909664}, "num_steps_trained": 1678964, "load_time_ms": 11.717}, "custom_metrics": {"cost1_mean": 289.9782595969922, "outflow_rate_max": 1133.9068332301094, "system_level_velocity_mean": 11.378348960873721, "cost1_min": 32.13068212929672, "cost1_max": 412.8239412376786, "outflow_rate_min": 444.74840099902235, "cost2_mean": -133.58045670233068, "outflow_rate_mean": 929.479423664834, "system_level_velocity_min": 9.041875552025129, "cost2_min": -169.7551518457428, "system_level_velocity_max": 18.455042725853517, "cost2_max": -23.366909251477928}, "node_ip": "10.138.0.2", "iterations_since_restore": 43, "done": false, "episodes_total": 734, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540626a780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540626a6a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540626ab00>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 676.517019919266, "episode_reward_min": 56.7870467620744, "timesteps_total": 1678964, "time_since_restore": 997.293160200119, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37165, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557190579, "time_this_iter_s": 21.86592698097229, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 43, "date": "2019-05-07_00-56-19", "episode_len_mean": 693.48}
{"timesteps_since_restore": 1717040, "policy_reward_mean": {}, "episode_reward_max": 826.5582636519691, "time_total_s": 1019.4491968154907, "info": {"num_steps_sampled": 1717040, "sample_time_ms": 13375.809, "grad_time_ms": 8480.4, "update_time_ms": 7.285, "default": {"kl": 0.014693237841129303, "entropy": 1.0858486890792847, "cur_lr": 0.0005000000237487257, "total_loss": 10.10073471069336, "policy_loss": -0.003953493665903807, "vf_explained_var": 0.874137282371521, "vf_loss": 10.104504585266113, "cur_kl_coeff": 0.012500002048909664}, "num_steps_trained": 1717040, "load_time_ms": 12.199}, "custom_metrics": {"cost1_mean": 291.3591378293377, "outflow_rate_max": 1133.9068332301094, "system_level_velocity_mean": 11.420375013581417, "cost1_min": 32.13068212929672, "cost1_max": 412.8239412376786, "outflow_rate_min": 444.74840099902235, "cost2_mean": -136.96013869372484, "outflow_rate_mean": 933.0457978314731, "system_level_velocity_min": 9.34919494569006, "cost2_min": -169.7551518457428, "system_level_velocity_max": 18.455042725853517, "cost2_max": -23.366909251477928}, "node_ip": "10.138.0.2", "iterations_since_restore": 44, "done": false, "episodes_total": 749, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c4a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cdd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c128>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 682.0961030132913, "episode_reward_min": 56.7870467620744, "timesteps_total": 1717040, "time_since_restore": 1019.4491968154907, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38076, "pid": 25319, "episodes_this_iter": 15, "timestamp": 1557190601, "time_this_iter_s": 22.156036615371704, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 44, "date": "2019-05-07_00-56-41", "episode_len_mean": 693.48}
{"timesteps_since_restore": 1755746, "policy_reward_mean": {}, "episode_reward_max": 826.5582636519691, "time_total_s": 1041.2788336277008, "info": {"num_steps_sampled": 1755746, "sample_time_ms": 13364.921, "grad_time_ms": 8374.196, "update_time_ms": 7.115, "default": {"kl": 0.014421112835407257, "entropy": 1.0674118995666504, "cur_lr": 0.0005000000237487257, "total_loss": 13.692938804626465, "policy_loss": -0.003608608851209283, "vf_explained_var": 0.8551498055458069, "vf_loss": 13.696366310119629, "cur_kl_coeff": 0.012500002048909664}, "num_steps_trained": 1755746, "load_time_ms": 12.519}, "custom_metrics": {"cost1_mean": 291.2195110975824, "outflow_rate_max": 1133.9068332301094, "system_level_velocity_mean": 11.427161578773621, "cost1_min": 28.90416593997763, "cost1_max": 412.8239412376786, "outflow_rate_min": 447.5935806508986, "cost2_mean": -142.44660284093487, "outflow_rate_mean": 935.0916647187581, "system_level_velocity_min": 9.34919494569006, "cost2_min": -187.1406479493665, "system_level_velocity_max": 18.836464454548477, "cost2_max": -24.162276521291155}, "node_ip": "10.138.0.2", "iterations_since_restore": 45, "done": false, "episodes_total": 769, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a59b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c4e0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 690.8804096334306, "episode_reward_min": 48.00631225536986, "timesteps_total": 1755746, "time_since_restore": 1041.2788336277008, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38706, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557190623, "time_this_iter_s": 21.829636812210083, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 45, "date": "2019-05-07_00-57-03", "episode_len_mean": 693.43}
{"timesteps_since_restore": 1793937, "policy_reward_mean": {}, "episode_reward_max": 826.5582636519691, "time_total_s": 1064.096423149109, "info": {"num_steps_sampled": 1793937, "sample_time_ms": 13388.216, "grad_time_ms": 8446.567, "update_time_ms": 7.177, "default": {"kl": 0.017636975273489952, "entropy": 1.0610665082931519, "cur_lr": 0.0005000000237487257, "total_loss": 11.054266929626465, "policy_loss": -0.00410583196207881, "vf_explained_var": 0.8914555311203003, "vf_loss": 11.05815315246582, "cur_kl_coeff": 0.01250000111758709}, "num_steps_trained": 1793937, "load_time_ms": 12.471}, "custom_metrics": {"cost1_mean": 293.53489070962297, "outflow_rate_max": 1133.9068332301094, "system_level_velocity_mean": 11.505706316643444, "cost1_min": 28.90416593997763, "cost1_max": 382.03489455905355, "outflow_rate_min": 447.5935806508986, "cost2_mean": -147.9864186259318, "outflow_rate_mean": 941.4377877875128, "system_level_velocity_min": 9.34919494569006, "cost2_min": -193.1065477390358, "system_level_velocity_max": 18.836464454548477, "cost2_max": -24.162276521291155}, "node_ip": "10.138.0.2", "iterations_since_restore": 46, "done": false, "episodes_total": 786, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8ca58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cba8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 695.5244585381647, "episode_reward_min": 48.00631225536986, "timesteps_total": 1793937, "time_since_restore": 1064.096423149109, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38191, "pid": 25319, "episodes_this_iter": 17, "timestamp": 1557190646, "time_this_iter_s": 22.81758952140808, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 46, "date": "2019-05-07_00-57-26", "episode_len_mean": 693.43}
{"timesteps_since_restore": 1832593, "policy_reward_mean": {}, "episode_reward_max": 828.863477593436, "time_total_s": 1086.4360377788544, "info": {"num_steps_sampled": 1832593, "sample_time_ms": 13417.323, "grad_time_ms": 8473.558, "update_time_ms": 6.993, "default": {"kl": 0.016185959801077843, "entropy": 1.0536882877349854, "cur_lr": 0.0005000000237487257, "total_loss": 13.580771446228027, "policy_loss": -0.003740218235179782, "vf_explained_var": 0.8836031556129456, "vf_loss": 13.584310531616211, "cur_kl_coeff": 0.012500002048909664}, "num_steps_trained": 1832593, "load_time_ms": 12.526}, "custom_metrics": {"cost1_mean": 292.29693922427737, "outflow_rate_max": 1143.1439012583346, "system_level_velocity_mean": 11.635806246310603, "cost1_min": 24.501105082807783, "cost1_max": 386.5697518692325, "outflow_rate_min": 445.63998753355827, "cost2_mean": -151.03607711431658, "outflow_rate_mean": 940.7021519417118, "system_level_velocity_min": 9.721386207570276, "cost2_min": -193.1065477390358, "system_level_velocity_max": 19.136517838534054, "cost2_max": -19.955444604063725}, "node_ip": "10.138.0.2", "iterations_since_restore": 47, "done": false, "episodes_total": 804, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062897b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289a20>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 692.0511635270134, "episode_reward_min": 46.68558924384733, "timesteps_total": 1832593, "time_since_restore": 1086.4360377788544, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38656, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557190668, "time_this_iter_s": 22.339614629745483, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 47, "date": "2019-05-07_00-57-48", "episode_len_mean": 686.8}
{"timesteps_since_restore": 1870671, "policy_reward_mean": {}, "episode_reward_max": 828.863477593436, "time_total_s": 1108.885376214981, "info": {"num_steps_sampled": 1870671, "sample_time_ms": 13422.763, "grad_time_ms": 8525.511, "update_time_ms": 7.024, "default": {"kl": 0.0163645688444376, "entropy": 1.049673318862915, "cur_lr": 0.0005000000237487257, "total_loss": 11.761752128601074, "policy_loss": -0.004652213305234909, "vf_explained_var": 0.8944469690322876, "vf_loss": 11.766200065612793, "cur_kl_coeff": 0.012500002048909664}, "num_steps_trained": 1870671, "load_time_ms": 12.738}, "custom_metrics": {"cost1_mean": 294.43062488597604, "outflow_rate_max": 1165.2341458267254, "system_level_velocity_mean": 11.710842414200448, "cost1_min": 24.501105082807783, "cost1_max": 388.0078569169352, "outflow_rate_min": 445.63998753355827, "cost2_mean": -156.62067294675154, "outflow_rate_mean": 944.7912763266482, "system_level_velocity_min": 9.721386207570276, "cost2_min": -199.7083580769094, "system_level_velocity_max": 19.136517838534054, "cost2_max": -19.955444604063725}, "node_ip": "10.138.0.2", "iterations_since_restore": 48, "done": false, "episodes_total": 822, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c1d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c208>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 696.1754947021394, "episode_reward_min": 46.68558924384733, "timesteps_total": 1870671, "time_since_restore": 1108.885376214981, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38078, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557190690, "time_this_iter_s": 22.44933843612671, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 48, "date": "2019-05-07_00-58-10", "episode_len_mean": 686.8}
{"timesteps_since_restore": 1908949, "policy_reward_mean": {}, "episode_reward_max": 828.863477593436, "time_total_s": 1132.8805558681488, "info": {"num_steps_sampled": 1908949, "sample_time_ms": 13474.002, "grad_time_ms": 8733.201, "update_time_ms": 7.034, "default": {"kl": 0.01682095229625702, "entropy": 1.0465270280838013, "cur_lr": 0.0005000000237487257, "total_loss": 13.980670928955078, "policy_loss": -0.0048022340051829815, "vf_explained_var": 0.8892472386360168, "vf_loss": 13.985264778137207, "cur_kl_coeff": 0.012500002048909664}, "num_steps_trained": 1908949, "load_time_ms": 12.943}, "custom_metrics": {"cost1_mean": 298.41611133701184, "outflow_rate_max": 1165.2341458267254, "system_level_velocity_mean": 11.854691467694252, "cost1_min": 24.501105082807783, "cost1_max": 388.0078569169352, "outflow_rate_min": 445.63998753355827, "cost2_mean": -161.76417712591493, "outflow_rate_mean": 952.9219303853823, "system_level_velocity_min": 10.146368827829294, "cost2_min": -199.7083580769094, "system_level_velocity_max": 19.136517838534054, "cost2_max": -19.955444604063725}, "node_ip": "10.138.0.2", "iterations_since_restore": 49, "done": false, "episodes_total": 842, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540626a780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540626a908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84518>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 701.3738625469008, "episode_reward_min": 46.68558924384733, "timesteps_total": 1908949, "time_since_restore": 1132.8805558681488, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38278, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557190714, "time_this_iter_s": 23.995179653167725, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 49, "date": "2019-05-07_00-58-34", "episode_len_mean": 686.8}
{"timesteps_since_restore": 1947006, "policy_reward_mean": {}, "episode_reward_max": 828.863477593436, "time_total_s": 1154.899453163147, "info": {"num_steps_sampled": 1947006, "sample_time_ms": 13440.979, "grad_time_ms": 8784.323, "update_time_ms": 7.106, "default": {"kl": 0.012976187281310558, "entropy": 1.0548412799835205, "cur_lr": 0.0005000000237487257, "total_loss": 11.614459991455078, "policy_loss": -0.0035378066822886467, "vf_explained_var": 0.8713977932929993, "vf_loss": 11.61783504486084, "cur_kl_coeff": 0.012500002048909664}, "num_steps_trained": 1947006, "load_time_ms": 13.107}, "custom_metrics": {"cost1_mean": 301.05545478661674, "outflow_rate_max": 1165.2341458267254, "system_level_velocity_mean": 11.959366501992502, "cost1_min": 24.501105082807783, "cost1_max": 388.0078569169352, "outflow_rate_min": 445.63998753355827, "cost2_mean": -164.2494644034288, "outflow_rate_mean": 959.4328758652176, "system_level_velocity_min": 10.146368827829294, "cost2_min": -199.7083580769094, "system_level_velocity_max": 19.136517838534054, "cost2_max": -19.955444604063725}, "node_ip": "10.138.0.2", "iterations_since_restore": 50, "done": false, "episodes_total": 860, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625fb70>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 704.4752032900412, "episode_reward_min": 46.68558924384733, "timesteps_total": 1947006, "time_since_restore": 1154.899453163147, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38057, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557190736, "time_this_iter_s": 22.01889729499817, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 50, "date": "2019-05-07_00-58-56", "episode_len_mean": 686.8}
{"timesteps_since_restore": 1985115, "policy_reward_mean": {}, "episode_reward_max": 828.863477593436, "time_total_s": 1177.136729001999, "info": {"num_steps_sampled": 1985115, "sample_time_ms": 13439.807, "grad_time_ms": 8775.283, "update_time_ms": 7.169, "default": {"kl": 0.015065870247781277, "entropy": 1.0330705642700195, "cur_lr": 0.0005000000237487257, "total_loss": 9.294435501098633, "policy_loss": -0.004037665203213692, "vf_explained_var": 0.9127204418182373, "vf_loss": 9.298283576965332, "cur_kl_coeff": 0.012500002048909664}, "num_steps_trained": 1985115, "load_time_ms": 12.773}, "custom_metrics": {"cost1_mean": 305.67491123900913, "outflow_rate_max": 1165.2341458267254, "system_level_velocity_mean": 11.957424835969748, "cost1_min": 24.501105082807783, "cost1_max": 388.0078569169352, "outflow_rate_min": 445.63998753355827, "cost2_mean": -166.7587138690914, "outflow_rate_mean": 967.8650596013414, "system_level_velocity_min": 10.233150885608664, "cost2_min": -199.7083580769094, "system_level_velocity_max": 19.136517838534054, "cost2_max": -19.955444604063725}, "node_ip": "10.138.0.2", "iterations_since_restore": 51, "done": false, "episodes_total": 874, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f845f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540626a9b0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 710.0875672789318, "episode_reward_min": 46.68558924384733, "timesteps_total": 1985115, "time_since_restore": 1177.136729001999, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38109, "pid": 25319, "episodes_this_iter": 14, "timestamp": 1557190759, "time_this_iter_s": 22.23727583885193, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 51, "date": "2019-05-07_00-59-19", "episode_len_mean": 693.37}
{"timesteps_since_restore": 2023651, "policy_reward_mean": {}, "episode_reward_max": 840.8950931295301, "time_total_s": 1197.8938307762146, "info": {"num_steps_sampled": 2023651, "sample_time_ms": 13291.891, "grad_time_ms": 8863.258, "update_time_ms": 7.194, "default": {"kl": 0.016735346987843513, "entropy": 1.0260639190673828, "cur_lr": 0.0005000000237487257, "total_loss": 11.64818000793457, "policy_loss": -0.004106509033590555, "vf_explained_var": 0.874855637550354, "vf_loss": 11.652076721191406, "cur_kl_coeff": 0.012500002980232239}, "num_steps_trained": 2023651, "load_time_ms": 12.731}, "custom_metrics": {"cost1_mean": 304.5887462084454, "outflow_rate_max": 1165.2341458267254, "system_level_velocity_mean": 11.920991409628563, "cost1_min": 24.501105082807783, "cost1_max": 388.0078569169352, "outflow_rate_min": 445.63998753355827, "cost2_mean": -167.13531584705916, "outflow_rate_mean": 965.4474035830515, "system_level_velocity_min": 9.671817744838142, "cost2_min": -199.7083580769094, "system_level_velocity_max": 19.136517838534054, "cost2_max": -19.955444604063725}, "node_ip": "10.138.0.2", "iterations_since_restore": 52, "done": false, "episodes_total": 893, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80da0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 710.1471496118087, "episode_reward_min": 46.68558924384733, "timesteps_total": 2023651, "time_since_restore": 1197.8938307762146, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38536, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557190779, "time_this_iter_s": 20.7571017742157, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 52, "date": "2019-05-07_00-59-39", "episode_len_mean": 693.37}
{"timesteps_since_restore": 2062152, "policy_reward_mean": {}, "episode_reward_max": 840.8950931295301, "time_total_s": 1219.8023455142975, "info": {"num_steps_sampled": 2062152, "sample_time_ms": 13281.189, "grad_time_ms": 8877.946, "update_time_ms": 7.1, "default": {"kl": 0.018194420263171196, "entropy": 0.9971243143081665, "cur_lr": 0.0005000000237487257, "total_loss": 12.987421035766602, "policy_loss": -0.00405792286619544, "vf_explained_var": 0.8696925044059753, "vf_loss": 12.991251945495605, "cur_kl_coeff": 0.012500002048909664}, "num_steps_trained": 2062152, "load_time_ms": 12.764}, "custom_metrics": {"cost1_mean": 301.3298089679878, "outflow_rate_max": 1096.2173450044431, "system_level_velocity_mean": 11.809860033369482, "cost1_min": 28.44655317380846, "cost1_max": 373.7548497467057, "outflow_rate_min": 445.9949805589032, "cost2_mean": -165.59782848356926, "outflow_rate_mean": 959.4972559361844, "system_level_velocity_min": 9.671817744838142, "cost2_min": -194.92627015976555, "system_level_velocity_max": 18.60638154050286, "cost2_max": -22.160365333243412}, "node_ip": "10.138.0.2", "iterations_since_restore": 53, "done": false, "episodes_total": 912, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84940>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 707.9904198370575, "episode_reward_min": 48.66683292744283, "timesteps_total": 2062152, "time_since_restore": 1219.8023455142975, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38501, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557190801, "time_this_iter_s": 21.908514738082886, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 53, "date": "2019-05-07_01-00-01", "episode_len_mean": 693.43}
{"timesteps_since_restore": 2100411, "policy_reward_mean": {}, "episode_reward_max": 840.8950931295301, "time_total_s": 1241.55814743042, "info": {"num_steps_sampled": 2100411, "sample_time_ms": 13252.5, "grad_time_ms": 8865.958, "update_time_ms": 7.066, "default": {"kl": 0.01835106685757637, "entropy": 0.9874191880226135, "cur_lr": 0.0005000000237487257, "total_loss": 11.95794677734375, "policy_loss": -0.005642358213663101, "vf_explained_var": 0.8650809526443481, "vf_loss": 11.963360786437988, "cur_kl_coeff": 0.01250000111758709}, "num_steps_trained": 2100411, "load_time_ms": 12.66}, "custom_metrics": {"cost1_mean": 297.8538264567029, "outflow_rate_max": 1082.9259610171243, "system_level_velocity_mean": 11.696573490996645, "cost1_min": 28.44655317380846, "cost1_max": 360.99641636131906, "outflow_rate_min": 445.9949805589032, "cost2_mean": -164.9365025990264, "outflow_rate_mean": 953.6320986257954, "system_level_velocity_min": 9.57972223885849, "cost2_min": -194.92627015976555, "system_level_velocity_max": 18.60638154050286, "cost2_max": -22.160365333243412}, "node_ip": "10.138.0.2", "iterations_since_restore": 54, "done": false, "episodes_total": 930, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062668d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540626ab00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266710>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 705.1155249719883, "episode_reward_min": 48.66683292744283, "timesteps_total": 2100411, "time_since_restore": 1241.55814743042, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38259, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557190823, "time_this_iter_s": 21.755801916122437, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 54, "date": "2019-05-07_01-00-23", "episode_len_mean": 693.43}
{"timesteps_since_restore": 2137888, "policy_reward_mean": {}, "episode_reward_max": 840.8950931295301, "time_total_s": 1262.9692509174347, "info": {"num_steps_sampled": 2137888, "sample_time_ms": 13190.069, "grad_time_ms": 8887.442, "update_time_ms": 7.106, "default": {"kl": 0.020276347175240517, "entropy": 0.9784995317459106, "cur_lr": 0.0005000000237487257, "total_loss": 10.940765380859375, "policy_loss": -0.004605019930750132, "vf_explained_var": 0.8943935036659241, "vf_loss": 10.945116996765137, "cur_kl_coeff": 0.01250000111758709}, "num_steps_trained": 2137888, "load_time_ms": 12.343}, "custom_metrics": {"cost1_mean": 295.7697008071707, "outflow_rate_max": 1087.4044885041053, "system_level_velocity_mean": 11.62024044397934, "cost1_min": 28.44655317380846, "cost1_max": 362.3256924200356, "outflow_rate_min": 445.9949805589032, "cost2_mean": -163.6062436835882, "outflow_rate_mean": 950.9950380863587, "system_level_velocity_min": 9.57972223885849, "cost2_min": -194.92627015976555, "system_level_velocity_max": 18.60638154050286, "cost2_max": -22.160365333243412}, "node_ip": "10.138.0.2", "iterations_since_restore": 55, "done": false, "episodes_total": 946, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f846a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f849b0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 703.9871843669871, "episode_reward_min": 48.66683292744283, "timesteps_total": 2137888, "time_since_restore": 1262.9692509174347, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37477, "pid": 25319, "episodes_this_iter": 16, "timestamp": 1557190845, "time_this_iter_s": 21.41110348701477, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 55, "date": "2019-05-07_01-00-45", "episode_len_mean": 693.43}
{"timesteps_since_restore": 2175622, "policy_reward_mean": {}, "episode_reward_max": 840.8950931295301, "time_total_s": 1285.9533383846283, "info": {"num_steps_sampled": 2175622, "sample_time_ms": 13263.132, "grad_time_ms": 8830.755, "update_time_ms": 7.014, "default": {"kl": 0.01587614417076111, "entropy": 0.9730193614959717, "cur_lr": 0.0005000000237487257, "total_loss": 16.217750549316406, "policy_loss": -0.004979411605745554, "vf_explained_var": 0.8441364765167236, "vf_loss": 16.222431182861328, "cur_kl_coeff": 0.01874999701976776}, "num_steps_trained": 2175622, "load_time_ms": 12.578}, "custom_metrics": {"cost1_mean": 291.3970220254634, "outflow_rate_max": 1087.4044885041053, "system_level_velocity_mean": 11.627827941224687, "cost1_min": 25.94335873179353, "cost1_max": 362.3256924200356, "outflow_rate_min": 445.9949805589032, "cost2_mean": -159.77071935076899, "outflow_rate_mean": 942.2694785633099, "system_level_velocity_min": 9.57972223885849, "cost2_min": -194.92627015976555, "system_level_velocity_max": 19.065287202414048, "cost2_max": -20.266555385873}, "node_ip": "10.138.0.2", "iterations_since_restore": 56, "done": false, "episodes_total": 967, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a50b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a54e0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 696.3562609169705, "episode_reward_min": 48.66683292744283, "timesteps_total": 2175622, "time_since_restore": 1285.9533383846283, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37734, "pid": 25319, "episodes_this_iter": 21, "timestamp": 1557190868, "time_this_iter_s": 22.984087467193604, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 56, "date": "2019-05-07_01-01-08", "episode_len_mean": 686.82}
{"timesteps_since_restore": 2213431, "policy_reward_mean": {}, "episode_reward_max": 835.8596528386764, "time_total_s": 1308.3156988620758, "info": {"num_steps_sampled": 2213431, "sample_time_ms": 13283.069, "grad_time_ms": 8813.777, "update_time_ms": 7.068, "default": {"kl": 0.020498719066381454, "entropy": 0.963757336139679, "cur_lr": 0.0005000000237487257, "total_loss": 14.600574493408203, "policy_loss": -0.005342131946235895, "vf_explained_var": 0.8661083579063416, "vf_loss": 14.605531692504883, "cur_kl_coeff": 0.01874999701976776}, "num_steps_trained": 2213431, "load_time_ms": 12.518}, "custom_metrics": {"cost1_mean": 293.96919899284234, "outflow_rate_max": 1087.4044885041053, "system_level_velocity_mean": 11.734439314210478, "cost1_min": 25.94335873179353, "cost1_max": 379.93733127019294, "outflow_rate_min": 445.9949805589032, "cost2_mean": -157.75342455046717, "outflow_rate_mean": 946.4319977879439, "system_level_velocity_min": 9.57972223885849, "cost2_min": -197.07395805703283, "system_level_velocity_max": 19.065287202414048, "cost2_max": -20.266555385873}, "node_ip": "10.138.0.2", "iterations_since_restore": 57, "done": false, "episodes_total": 987, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a50f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a52b0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 695.3818344327354, "episode_reward_min": 48.66683292744283, "timesteps_total": 2213431, "time_since_restore": 1308.3156988620758, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37809, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557190890, "time_this_iter_s": 22.36236047744751, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 57, "date": "2019-05-07_01-01-30", "episode_len_mean": 686.82}
{"timesteps_since_restore": 2250533, "policy_reward_mean": {}, "episode_reward_max": 835.8596528386764, "time_total_s": 1329.809556722641, "info": {"num_steps_sampled": 2250533, "sample_time_ms": 13220.794, "grad_time_ms": 8781.697, "update_time_ms": 6.941, "default": {"kl": 0.020157257094979286, "entropy": 0.9564857482910156, "cur_lr": 0.0005000000237487257, "total_loss": 11.853160858154297, "policy_loss": -0.006460234522819519, "vf_explained_var": 0.8803126811981201, "vf_loss": 11.859053611755371, "cur_kl_coeff": 0.02812500111758709}, "num_steps_trained": 2250533, "load_time_ms": 12.536}, "custom_metrics": {"cost1_mean": 295.93869516459205, "outflow_rate_max": 1119.5805307687408, "system_level_velocity_mean": 11.814051567360432, "cost1_min": 25.94335873179353, "cost1_max": 379.93733127019294, "outflow_rate_min": 445.9949805589032, "cost2_mean": -157.03475810729142, "outflow_rate_mean": 949.811553819806, "system_level_velocity_min": 9.57972223885849, "cost2_min": -197.07395805703283, "system_level_velocity_max": 19.065287202414048, "cost2_max": -20.266555385873}, "node_ip": "10.138.0.2", "iterations_since_restore": 58, "done": false, "episodes_total": 1004, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062662e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84048>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 694.6626006587763, "episode_reward_min": 48.66683292744283, "timesteps_total": 2250533, "time_since_restore": 1329.809556722641, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37102, "pid": 25319, "episodes_this_iter": 17, "timestamp": 1557190912, "time_this_iter_s": 21.493857860565186, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 58, "date": "2019-05-07_01-01-52", "episode_len_mean": 686.82}
{"timesteps_since_restore": 2288253, "policy_reward_mean": {}, "episode_reward_max": 821.512063143012, "time_total_s": 1350.6667518615723, "info": {"num_steps_sampled": 2288253, "sample_time_ms": 13073.084, "grad_time_ms": 8616.623, "update_time_ms": 6.858, "default": {"kl": 0.021357759833335876, "entropy": 0.9655354619026184, "cur_lr": 0.0005000000237487257, "total_loss": 12.796343803405762, "policy_loss": -0.00646337540820241, "vf_explained_var": 0.8820509314537048, "vf_loss": 12.80190658569336, "cur_kl_coeff": 0.04218750074505806}, "num_steps_trained": 2288253, "load_time_ms": 12.397}, "custom_metrics": {"cost1_mean": 297.08035638124915, "outflow_rate_max": 1119.5805307687408, "system_level_velocity_mean": 11.855933164138726, "cost1_min": 23.88107899699074, "cost1_max": 379.93733127019294, "outflow_rate_min": 430.926785564987, "cost2_mean": -155.45399871250984, "outflow_rate_mean": 952.2094171715098, "system_level_velocity_min": 9.957180719590555, "cost2_min": -197.07395805703283, "system_level_velocity_max": 19.065287202414048, "cost2_max": -20.266555385873}, "node_ip": "10.138.0.2", "iterations_since_restore": 59, "done": false, "episodes_total": 1021, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f849b0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 695.364429856247, "episode_reward_min": 41.911448619503176, "timesteps_total": 2288253, "time_since_restore": 1350.6667518615723, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37720, "pid": 25319, "episodes_this_iter": 17, "timestamp": 1557190932, "time_this_iter_s": 20.857195138931274, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 59, "date": "2019-05-07_01-02-12", "episode_len_mean": 686.75}
{"timesteps_since_restore": 2326475, "policy_reward_mean": {}, "episode_reward_max": 882.9534461488843, "time_total_s": 1372.043127298355, "info": {"num_steps_sampled": 2326475, "sample_time_ms": 13003.855, "grad_time_ms": 8621.744, "update_time_ms": 6.711, "default": {"kl": 0.016634654253721237, "entropy": 0.9629496335983276, "cur_lr": 0.0005000000237487257, "total_loss": 11.867402076721191, "policy_loss": -0.004574936348944902, "vf_explained_var": 0.9057469964027405, "vf_loss": 11.870924949645996, "cur_kl_coeff": 0.06328124552965164}, "num_steps_trained": 2326475, "load_time_ms": 12.429}, "custom_metrics": {"cost1_mean": 300.30827070954683, "outflow_rate_max": 1205.3515377077479, "system_level_velocity_mean": 11.97522435672439, "cost1_min": 23.88107899699074, "cost1_max": 406.84427099167766, "outflow_rate_min": 430.926785564987, "cost2_mean": -154.7050757555019, "outflow_rate_mean": 959.7342426153614, "system_level_velocity_min": 9.897421134528246, "cost2_min": -197.07395805703283, "system_level_velocity_max": 19.065287202414048, "cost2_max": -20.266555385873}, "node_ip": "10.138.0.2", "iterations_since_restore": 60, "done": false, "episodes_total": 1038, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062664e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062663c8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 701.7643905789294, "episode_reward_min": 41.911448619503176, "timesteps_total": 2326475, "time_since_restore": 1372.043127298355, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38222, "pid": 25319, "episodes_this_iter": 17, "timestamp": 1557190954, "time_this_iter_s": 21.376375436782837, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 60, "date": "2019-05-07_01-02-34", "episode_len_mean": 686.75}
{"timesteps_since_restore": 2364865, "policy_reward_mean": {}, "episode_reward_max": 910.5939811636565, "time_total_s": 1394.1375453472137, "info": {"num_steps_sampled": 2364865, "sample_time_ms": 12988.998, "grad_time_ms": 8622.014, "update_time_ms": 6.612, "default": {"kl": 0.014679181389510632, "entropy": 0.9560855031013489, "cur_lr": 0.0005000000237487257, "total_loss": 13.656316757202148, "policy_loss": -0.0048478893004357815, "vf_explained_var": 0.8718409538269043, "vf_loss": 13.660237312316895, "cur_kl_coeff": 0.06328123807907104}, "num_steps_trained": 2364865, "load_time_ms": 12.861}, "custom_metrics": {"cost1_mean": 303.7958440260997, "outflow_rate_max": 1205.3515377077479, "system_level_velocity_mean": 12.104192589089141, "cost1_min": 23.88107899699074, "cost1_max": 406.84427099167766, "outflow_rate_min": 430.926785564987, "cost2_mean": -155.47514441981255, "outflow_rate_mean": 966.9877132020151, "system_level_velocity_min": 9.897421134528246, "cost2_min": -197.6829017290361, "system_level_velocity_max": 19.065287202414048, "cost2_max": -20.266555385873}, "node_ip": "10.138.0.2", "iterations_since_restore": 61, "done": false, "episodes_total": 1058, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f845f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f840f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f849b0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 706.4439184622478, "episode_reward_min": 41.911448619503176, "timesteps_total": 2364865, "time_since_restore": 1394.1375453472137, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38390, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557190976, "time_this_iter_s": 22.094418048858643, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 61, "date": "2019-05-07_01-02-56", "episode_len_mean": 686.75}
{"timesteps_since_restore": 2402399, "policy_reward_mean": {}, "episode_reward_max": 910.5939811636565, "time_total_s": 1415.8985579013824, "info": {"num_steps_sampled": 2402399, "sample_time_ms": 13109.68, "grad_time_ms": 8601.676, "update_time_ms": 6.7, "default": {"kl": 0.018419504165649414, "entropy": 0.9524471759796143, "cur_lr": 0.0005000000237487257, "total_loss": 13.795825958251953, "policy_loss": -0.007633897475898266, "vf_explained_var": 0.895341157913208, "vf_loss": 13.802294731140137, "cur_kl_coeff": 0.06328124552965164}, "num_steps_trained": 2402399, "load_time_ms": 12.975}, "custom_metrics": {"cost1_mean": 302.5977929008291, "outflow_rate_max": 1205.3515377077479, "system_level_velocity_mean": 12.065889144031516, "cost1_min": 23.88107899699074, "cost1_max": 406.84427099167766, "outflow_rate_min": 430.926785564987, "cost2_mean": -154.3459284733159, "outflow_rate_mean": 964.3994729147469, "system_level_velocity_min": 9.774985250851618, "cost2_min": -197.6829017290361, "system_level_velocity_max": 18.992203582494444, "cost2_max": -21.524935601450668}, "node_ip": "10.138.0.2", "iterations_since_restore": 62, "done": false, "episodes_total": 1076, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a52b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80a20>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 707.9811324739317, "episode_reward_min": 41.911448619503176, "timesteps_total": 2402399, "time_since_restore": 1415.8985579013824, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37534, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557190998, "time_this_iter_s": 21.7610125541687, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 62, "date": "2019-05-07_01-03-18", "episode_len_mean": 686.88}
{"timesteps_since_restore": 2439878, "policy_reward_mean": {}, "episode_reward_max": 910.5939811636565, "time_total_s": 1438.465668439865, "info": {"num_steps_sampled": 2439878, "sample_time_ms": 13135.905, "grad_time_ms": 8640.614, "update_time_ms": 6.728, "default": {"kl": 0.015923630446195602, "entropy": 0.9622271656990051, "cur_lr": 0.0005000000237487257, "total_loss": 12.41230297088623, "policy_loss": -0.006244216114282608, "vf_explained_var": 0.9043679237365723, "vf_loss": 12.4175386428833, "cur_kl_coeff": 0.06328124552965164}, "num_steps_trained": 2439878, "load_time_ms": 13.189}, "custom_metrics": {"cost1_mean": 303.1333977916155, "outflow_rate_max": 1205.3515377077479, "system_level_velocity_mean": 12.082703002377167, "cost1_min": 23.88107899699074, "cost1_max": 406.84427099167766, "outflow_rate_min": 430.926785564987, "cost2_mean": -155.60357354139896, "outflow_rate_mean": 967.2882972716084, "system_level_velocity_min": 9.774985250851618, "cost2_min": -197.6829017290361, "system_level_velocity_max": 18.992203582494444, "cost2_max": -21.524935601450668}, "node_ip": "10.138.0.2", "iterations_since_restore": 63, "done": false, "episodes_total": 1094, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062892b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289438>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 710.3551178392585, "episode_reward_min": 41.911448619503176, "timesteps_total": 2439878, "time_since_restore": 1438.465668439865, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37479, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557191020, "time_this_iter_s": 22.567110538482666, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 63, "date": "2019-05-07_01-03-40", "episode_len_mean": 686.88}
{"timesteps_since_restore": 2477436, "policy_reward_mean": {}, "episode_reward_max": 910.5939811636565, "time_total_s": 1460.6862962245941, "info": {"num_steps_sampled": 2477436, "sample_time_ms": 13216.574, "grad_time_ms": 8606.696, "update_time_ms": 6.798, "default": {"kl": 0.017219047993421555, "entropy": 0.9616327285766602, "cur_lr": 0.0005000000237487257, "total_loss": 12.575495719909668, "policy_loss": -0.0059580253437161446, "vf_explained_var": 0.8988949656486511, "vf_loss": 12.580365180969238, "cur_kl_coeff": 0.06328124552965164}, "num_steps_trained": 2477436, "load_time_ms": 13.294}, "custom_metrics": {"cost1_mean": 307.42765381099804, "outflow_rate_max": 1205.3515377077479, "system_level_velocity_mean": 12.06549780117819, "cost1_min": 35.505624891655074, "cost1_max": 435.6284878885385, "outflow_rate_min": 459.8552797754283, "cost2_mean": -154.44158864697206, "outflow_rate_mean": 973.4898257633696, "system_level_velocity_min": 9.774985250851618, "cost2_min": -197.6829017290361, "system_level_velocity_max": 18.992203582494444, "cost2_max": -26.888366347495598}, "node_ip": "10.138.0.2", "iterations_since_restore": 64, "done": false, "episodes_total": 1114, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062662e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062668d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266240>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 712.9154911027124, "episode_reward_min": 55.55779210858771, "timesteps_total": 2477436, "time_since_restore": 1460.6862962245941, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37558, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557191043, "time_this_iter_s": 22.220627784729004, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 64, "date": "2019-05-07_01-04-03", "episode_len_mean": 693.52}
{"timesteps_since_restore": 2515498, "policy_reward_mean": {}, "episode_reward_max": 910.5939811636565, "time_total_s": 1481.6146631240845, "info": {"num_steps_sampled": 2515498, "sample_time_ms": 13164.405, "grad_time_ms": 8610.512, "update_time_ms": 6.769, "default": {"kl": 0.01627967692911625, "entropy": 0.9813916683197021, "cur_lr": 0.0005000000237487257, "total_loss": 10.072508811950684, "policy_loss": -0.006734414491802454, "vf_explained_var": 0.9155895113945007, "vf_loss": 10.078213691711426, "cur_kl_coeff": 0.06328124552965164}, "num_steps_trained": 2515498, "load_time_ms": 13.338}, "custom_metrics": {"cost1_mean": 306.92729834819073, "outflow_rate_max": 1170.8948254945412, "system_level_velocity_mean": 12.046795455685418, "cost1_min": 35.505624891655074, "cost1_max": 435.6284878885385, "outflow_rate_min": 459.8552797754283, "cost2_mean": -152.65199396632082, "outflow_rate_mean": 970.4739201603901, "system_level_velocity_min": 9.774985250851618, "cost2_min": -197.6829017290361, "system_level_velocity_max": 18.992203582494444, "cost2_max": -26.888366347495598}, "node_ip": "10.138.0.2", "iterations_since_restore": 65, "done": false, "episodes_total": 1129, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289470>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 709.4518008729276, "episode_reward_min": 55.55779210858771, "timesteps_total": 2515498, "time_since_restore": 1481.6146631240845, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38062, "pid": 25319, "episodes_this_iter": 15, "timestamp": 1557191064, "time_this_iter_s": 20.928366899490356, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 65, "date": "2019-05-07_01-04-24", "episode_len_mean": 693.52}
{"timesteps_since_restore": 2553152, "policy_reward_mean": {}, "episode_reward_max": 910.5939811636565, "time_total_s": 1502.7368457317352, "info": {"num_steps_sampled": 2553152, "sample_time_ms": 12996.489, "grad_time_ms": 8592.977, "update_time_ms": 6.759, "default": {"kl": 0.016470707952976227, "entropy": 0.9835501909255981, "cur_lr": 0.0005000000237487257, "total_loss": 11.181519508361816, "policy_loss": -0.005587731022387743, "vf_explained_var": 0.9077135920524597, "vf_loss": 11.186064720153809, "cur_kl_coeff": 0.06328123807907104}, "num_steps_trained": 2553152, "load_time_ms": 13.153}, "custom_metrics": {"cost1_mean": 303.5387286795855, "outflow_rate_max": 1170.8948254945412, "system_level_velocity_mean": 11.924140691841092, "cost1_min": 35.505624891655074, "cost1_max": 435.6284878885385, "outflow_rate_min": 459.8552797754283, "cost2_mean": -150.1499435301862, "outflow_rate_mean": 962.3501717680707, "system_level_velocity_min": 9.710009237515774, "cost2_min": -197.6829017290361, "system_level_velocity_max": 18.992203582494444, "cost2_max": -26.888366347495598}, "node_ip": "10.138.0.2", "iterations_since_restore": 66, "done": false, "episodes_total": 1145, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f846a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f840f0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 703.8497767942193, "episode_reward_min": 55.55779210858771, "timesteps_total": 2553152, "time_since_restore": 1502.7368457317352, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37654, "pid": 25319, "episodes_this_iter": 16, "timestamp": 1557191085, "time_this_iter_s": 21.122182607650757, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 66, "date": "2019-05-07_01-04-45", "episode_len_mean": 693.52}
{"timesteps_since_restore": 2591290, "policy_reward_mean": {}, "episode_reward_max": 872.1670084396505, "time_total_s": 1525.0376665592194, "info": {"num_steps_sampled": 2591290, "sample_time_ms": 12980.175, "grad_time_ms": 8602.389, "update_time_ms": 6.75, "default": {"kl": 0.018591543659567833, "entropy": 0.9881780743598938, "cur_lr": 0.0005000000237487257, "total_loss": 16.528934478759766, "policy_loss": -0.005627129692584276, "vf_explained_var": 0.8934383988380432, "vf_loss": 16.533388137817383, "cur_kl_coeff": 0.06328124552965164}, "num_steps_trained": 2591290, "load_time_ms": 13.289}, "custom_metrics": {"cost1_mean": 298.91614936653224, "outflow_rate_max": 1170.8948254945412, "system_level_velocity_mean": 12.096763390240614, "cost1_min": 29.717268508806065, "cost1_max": 440.83462056942443, "outflow_rate_min": 450.7337209061858, "cost2_mean": -144.34123043008003, "outflow_rate_mean": 951.64321200174, "system_level_velocity_min": 9.710009237515774, "cost2_min": -176.507566732346, "system_level_velocity_max": 19.098748235307855, "cost2_max": -25.618579554896108}, "node_ip": "10.138.0.2", "iterations_since_restore": 67, "done": false, "episodes_total": 1169, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062895f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289a58>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 688.4535630883041, "episode_reward_min": 54.94143704458334, "timesteps_total": 2591290, "time_since_restore": 1525.0376665592194, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38138, "pid": 25319, "episodes_this_iter": 24, "timestamp": 1557191107, "time_this_iter_s": 22.30082082748413, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 67, "date": "2019-05-07_01-05-07", "episode_len_mean": 680.57}
{"timesteps_since_restore": 2628858, "policy_reward_mean": {}, "episode_reward_max": 879.5058111879722, "time_total_s": 1547.8257522583008, "info": {"num_steps_sampled": 2628858, "sample_time_ms": 13097.2, "grad_time_ms": 8613.568, "update_time_ms": 6.767, "default": {"kl": 0.016979176551103592, "entropy": 0.9968434572219849, "cur_lr": 0.0005000000237487257, "total_loss": 14.708770751953125, "policy_loss": -0.0058718109503388405, "vf_explained_var": 0.899919867515564, "vf_loss": 14.713566780090332, "cur_kl_coeff": 0.06328124552965164}, "num_steps_trained": 2628858, "load_time_ms": 13.333}, "custom_metrics": {"cost1_mean": 294.2822498184781, "outflow_rate_max": 1170.8948254945412, "system_level_velocity_mean": 12.138947889898962, "cost1_min": 29.064608880572077, "cost1_max": 440.83462056942443, "outflow_rate_min": 439.0169764106544, "cost2_mean": -138.67797518354496, "outflow_rate_mean": 941.9926994144022, "system_level_velocity_min": 9.710009237515774, "cost2_min": -173.49856305795623, "system_level_velocity_max": 19.098748235307855, "cost2_max": -25.618579554896108}, "node_ip": "10.138.0.2", "iterations_since_restore": 68, "done": false, "episodes_total": 1190, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f845f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f849b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a518>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 676.4750459931306, "episode_reward_min": 48.00480956907315, "timesteps_total": 2628858, "time_since_restore": 1547.8257522583008, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37568, "pid": 25319, "episodes_this_iter": 21, "timestamp": 1557191130, "time_this_iter_s": 22.78808569908142, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 68, "date": "2019-05-07_01-05-30", "episode_len_mean": 672.45}
{"timesteps_since_restore": 2665488, "policy_reward_mean": {}, "episode_reward_max": 879.5058111879722, "time_total_s": 1568.5560488700867, "info": {"num_steps_sampled": 2665488, "sample_time_ms": 13119.382, "grad_time_ms": 8577.835, "update_time_ms": 6.889, "default": {"kl": 0.018752317875623703, "entropy": 0.983533501625061, "cur_lr": 0.0005000000237487257, "total_loss": 11.31105899810791, "policy_loss": -0.007304886821657419, "vf_explained_var": 0.9186767339706421, "vf_loss": 11.317177772521973, "cur_kl_coeff": 0.06328123807907104}, "num_steps_trained": 2665488, "load_time_ms": 13.357}, "custom_metrics": {"cost1_mean": 296.36598226051603, "outflow_rate_max": 1154.745182741859, "system_level_velocity_mean": 12.214954244482009, "cost1_min": 29.064608880572077, "cost1_max": 440.83462056942443, "outflow_rate_min": 439.0169764106544, "cost2_mean": -136.6696653764222, "outflow_rate_mean": 945.5980080048179, "system_level_velocity_min": 9.607465317198054, "cost2_min": -161.22309525948663, "system_level_velocity_max": 19.098748235307855, "cost2_max": -25.618579554896108}, "node_ip": "10.138.0.2", "iterations_since_restore": 69, "done": false, "episodes_total": 1205, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062895c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289128>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 676.2843733878383, "episode_reward_min": 48.00480956907315, "timesteps_total": 2665488, "time_since_restore": 1568.5560488700867, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36630, "pid": 25319, "episodes_this_iter": 15, "timestamp": 1557191151, "time_this_iter_s": 20.73029661178589, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 69, "date": "2019-05-07_01-05-51", "episode_len_mean": 672.45}
{"timesteps_since_restore": 2702864, "policy_reward_mean": {}, "episode_reward_max": 879.5058111879722, "time_total_s": 1591.0589101314545, "info": {"num_steps_sampled": 2702864, "sample_time_ms": 13213.577, "grad_time_ms": 8596.471, "update_time_ms": 6.974, "default": {"kl": 0.016889892518520355, "entropy": 0.957339346408844, "cur_lr": 0.0005000000237487257, "total_loss": 14.410460472106934, "policy_loss": -0.005094282329082489, "vf_explained_var": 0.9025885462760925, "vf_loss": 14.414485931396484, "cur_kl_coeff": 0.06328124552965164}, "num_steps_trained": 2702864, "load_time_ms": 13.263}, "custom_metrics": {"cost1_mean": 297.4396675152025, "outflow_rate_max": 1173.5378539119752, "system_level_velocity_mean": 12.265590991605325, "cost1_min": 29.064608880572077, "cost1_max": 440.83462056942443, "outflow_rate_min": 439.0169764106544, "cost2_mean": -136.2544226535268, "outflow_rate_mean": 946.5300255060139, "system_level_velocity_min": 9.607465317198054, "cost2_min": -162.26563166608972, "system_level_velocity_max": 19.098748235307855, "cost2_max": -25.618579554896108}, "node_ip": "10.138.0.2", "iterations_since_restore": 70, "done": false, "episodes_total": 1225, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a52b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5898>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 678.4092388913913, "episode_reward_min": 48.00480956907315, "timesteps_total": 2702864, "time_since_restore": 1591.0589101314545, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37376, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557191173, "time_this_iter_s": 22.502861261367798, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 70, "date": "2019-05-07_01-06-13", "episode_len_mean": 672.45}
{"timesteps_since_restore": 2740248, "policy_reward_mean": {}, "episode_reward_max": 879.5058111879722, "time_total_s": 1613.9968495368958, "info": {"num_steps_sampled": 2740248, "sample_time_ms": 13288.119, "grad_time_ms": 8605.952, "update_time_ms": 7.041, "default": {"kl": 0.020501652732491493, "entropy": 0.9535121917724609, "cur_lr": 0.0005000000237487257, "total_loss": 14.51760482788086, "policy_loss": -0.006070442032068968, "vf_explained_var": 0.8973132371902466, "vf_loss": 14.522377014160156, "cur_kl_coeff": 0.06328124552965164}, "num_steps_trained": 2740248, "load_time_ms": 12.782}, "custom_metrics": {"cost1_mean": 297.86316105941046, "outflow_rate_max": 1173.5378539119752, "system_level_velocity_mean": 12.300976258499212, "cost1_min": 29.064608880572077, "cost1_max": 440.83462056942443, "outflow_rate_min": 439.0169764106544, "cost2_mean": -135.9904337013726, "outflow_rate_mean": 947.9626635447355, "system_level_velocity_min": 9.607465317198054, "cost2_min": -162.26563166608972, "system_level_velocity_max": 19.098748235307855, "cost2_max": -25.618579554896108}, "node_ip": "10.138.0.2", "iterations_since_restore": 71, "done": false, "episodes_total": 1246, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289b38>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 674.1056730669795, "episode_reward_min": 48.00480956907315, "timesteps_total": 2740248, "time_since_restore": 1613.9968495368958, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37384, "pid": 25319, "episodes_this_iter": 21, "timestamp": 1557191196, "time_this_iter_s": 22.937939405441284, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 71, "date": "2019-05-07_01-06-36", "episode_len_mean": 672.45}
{"timesteps_since_restore": 2777278, "policy_reward_mean": {}, "episode_reward_max": 879.5058111879722, "time_total_s": 1636.091427564621, "info": {"num_steps_sampled": 2777278, "sample_time_ms": 13338.213, "grad_time_ms": 8589.831, "update_time_ms": 7.003, "default": {"kl": 0.018728407099843025, "entropy": 0.9425637125968933, "cur_lr": 0.0005000000237487257, "total_loss": 12.180810928344727, "policy_loss": -0.006923730950802565, "vf_explained_var": 0.9036765694618225, "vf_loss": 12.185957908630371, "cur_kl_coeff": 0.09492187947034836}, "num_steps_trained": 2777278, "load_time_ms": 12.731}, "custom_metrics": {"cost1_mean": 302.30239395638495, "outflow_rate_max": 1173.5378539119752, "system_level_velocity_mean": 12.294971257211985, "cost1_min": 29.064608880572077, "cost1_max": 440.83462056942443, "outflow_rate_min": 439.0169764106544, "cost2_mean": -137.80883780732455, "outflow_rate_mean": 956.0005333041356, "system_level_velocity_min": 9.554023364729773, "cost2_min": -167.50030867418093, "system_level_velocity_max": 19.098748235307855, "cost2_max": -25.618579554896108}, "node_ip": "10.138.0.2", "iterations_since_restore": 72, "done": false, "episodes_total": 1261, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f840f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f845f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84d68>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 681.2678246613445, "episode_reward_min": 48.00480956907315, "timesteps_total": 2777278, "time_since_restore": 1636.091427564621, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37030, "pid": 25319, "episodes_this_iter": 15, "timestamp": 1557191218, "time_this_iter_s": 22.09457802772522, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 72, "date": "2019-05-07_01-06-58", "episode_len_mean": 678.92}
{"timesteps_since_restore": 2814366, "policy_reward_mean": {}, "episode_reward_max": 879.5058111879722, "time_total_s": 1657.6498157978058, "info": {"num_steps_sampled": 2814366, "sample_time_ms": 13323.351, "grad_time_ms": 8504.857, "update_time_ms": 7.073, "default": {"kl": 0.016139334067702293, "entropy": 0.9425395131111145, "cur_lr": 0.0005000000237487257, "total_loss": 13.555268287658691, "policy_loss": -0.00671150628477335, "vf_explained_var": 0.9063188433647156, "vf_loss": 13.560446739196777, "cur_kl_coeff": 0.09492187947034836}, "num_steps_trained": 2814366, "load_time_ms": 12.136}, "custom_metrics": {"cost1_mean": 308.24141568773564, "outflow_rate_max": 1173.5378539119752, "system_level_velocity_mean": 12.00660739890488, "cost1_min": 223.18141575409786, "cost1_max": 431.9944849230018, "outflow_rate_min": 817.6375626798698, "cost2_mean": -141.90699877992645, "outflow_rate_mean": 968.3579518188122, "system_level_velocity_min": 9.554023364729773, "cost2_min": -167.50030867418093, "system_level_velocity_max": 16.41335265082066, "cost2_max": -112.24019634510108}, "node_ip": "10.138.0.2", "iterations_since_restore": 73, "done": false, "episodes_total": 1278, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289b38>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 701.6406389244186, "episode_reward_min": 459.097828795518, "timesteps_total": 2814366, "time_since_restore": 1657.6498157978058, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37088, "pid": 25319, "episodes_this_iter": 17, "timestamp": 1557191240, "time_this_iter_s": 21.558388233184814, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 73, "date": "2019-05-07_01-07-20", "episode_len_mean": 698.45}
{"timesteps_since_restore": 2851954, "policy_reward_mean": {}, "episode_reward_max": 872.3133155548194, "time_total_s": 1680.1738142967224, "info": {"num_steps_sampled": 2851954, "sample_time_ms": 13351.545, "grad_time_ms": 8505.993, "update_time_ms": 7.111, "default": {"kl": 0.017873885110020638, "entropy": 0.9453986287117004, "cur_lr": 0.0005000000237487257, "total_loss": 16.990703582763672, "policy_loss": -0.006394502241164446, "vf_explained_var": 0.8830356001853943, "vf_loss": 16.99540138244629, "cur_kl_coeff": 0.09492187947034836}, "num_steps_trained": 2851954, "load_time_ms": 12.118}, "custom_metrics": {"cost1_mean": 307.48106245750716, "outflow_rate_max": 1173.5378539119752, "system_level_velocity_mean": 12.12621111095371, "cost1_min": 24.74511446076044, "cost1_max": 431.9944849230018, "outflow_rate_min": 439.6710191118835, "cost2_mean": -140.80369823535918, "outflow_rate_mean": 966.2619188008737, "system_level_velocity_min": 9.554023364729773, "cost2_min": -167.50030867418093, "system_level_velocity_max": 19.338988401891825, "cost2_max": -21.097287169478363}, "node_ip": "10.138.0.2", "iterations_since_restore": 74, "done": false, "episodes_total": 1299, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f846a0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 699.1448757029103, "episode_reward_min": 41.200309331803474, "timesteps_total": 2851954, "time_since_restore": 1680.1738142967224, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37588, "pid": 25319, "episodes_this_iter": 21, "timestamp": 1557191262, "time_this_iter_s": 22.523998498916626, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 74, "date": "2019-05-07_01-07-42", "episode_len_mean": 693.37}
{"timesteps_since_restore": 2890150, "policy_reward_mean": {}, "episode_reward_max": 872.3133155548194, "time_total_s": 1702.2068779468536, "info": {"num_steps_sampled": 2890150, "sample_time_ms": 13469.726, "grad_time_ms": 8497.9, "update_time_ms": 7.099, "default": {"kl": 0.017283225432038307, "entropy": 0.9398583769798279, "cur_lr": 0.0005000000237487257, "total_loss": 13.896007537841797, "policy_loss": -0.006240443326532841, "vf_explained_var": 0.8899959921836853, "vf_loss": 13.900609016418457, "cur_kl_coeff": 0.09492187947034836}, "num_steps_trained": 2890150, "load_time_ms": 12.295}, "custom_metrics": {"cost1_mean": 304.26913049995335, "outflow_rate_max": 1173.5378539119752, "system_level_velocity_mean": 12.0171545270494, "cost1_min": 24.74511446076044, "cost1_max": 431.9944849230018, "outflow_rate_min": 439.6710191118835, "cost2_mean": -140.60532563481024, "outflow_rate_mean": 961.026802356722, "system_level_velocity_min": 9.554023364729773, "cost2_min": -167.50030867418093, "system_level_velocity_max": 19.338988401891825, "cost2_max": -21.097287169478363}, "node_ip": "10.138.0.2", "iterations_since_restore": 75, "done": false, "episodes_total": 1319, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289c88>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 699.9498958309264, "episode_reward_min": 41.200309331803474, "timesteps_total": 2890150, "time_since_restore": 1702.2068779468536, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 38196, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557191284, "time_this_iter_s": 22.033063650131226, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 75, "date": "2019-05-07_01-08-04", "episode_len_mean": 693.37}
{"timesteps_since_restore": 2927351, "policy_reward_mean": {}, "episode_reward_max": 811.860151309829, "time_total_s": 1724.1292278766632, "info": {"num_steps_sampled": 2927351, "sample_time_ms": 13495.767, "grad_time_ms": 8551.078, "update_time_ms": 7.065, "default": {"kl": 0.01793409138917923, "entropy": 0.9344671964645386, "cur_lr": 0.0005000000237487257, "total_loss": 13.997027397155762, "policy_loss": -0.007110202684998512, "vf_explained_var": 0.8938776254653931, "vf_loss": 14.002434730529785, "cur_kl_coeff": 0.09492187947034836}, "num_steps_trained": 2927351, "load_time_ms": 12.258}, "custom_metrics": {"cost1_mean": 302.8985912269362, "outflow_rate_max": 1103.6635609348293, "system_level_velocity_mean": 11.970474079016732, "cost1_min": 24.74511446076044, "cost1_max": 377.0573043395874, "outflow_rate_min": 439.6710191118835, "cost2_mean": -140.33518894155512, "outflow_rate_mean": 959.3108202572414, "system_level_velocity_min": 9.554023364729773, "cost2_min": -167.50030867418093, "system_level_velocity_max": 19.338988401891825, "cost2_max": -21.097287169478363}, "node_ip": "10.138.0.2", "iterations_since_restore": 76, "done": false, "episodes_total": 1335, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8ca20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c940>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 704.1877878916275, "episode_reward_min": 41.200309331803474, "timesteps_total": 2927351, "time_since_restore": 1724.1292278766632, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37201, "pid": 25319, "episodes_this_iter": 16, "timestamp": 1557191306, "time_this_iter_s": 21.92234992980957, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 76, "date": "2019-05-07_01-08-26", "episode_len_mean": 693.37}
{"timesteps_since_restore": 2963842, "policy_reward_mean": {}, "episode_reward_max": 811.860151309829, "time_total_s": 1746.6955058574677, "info": {"num_steps_sampled": 2963842, "sample_time_ms": 13589.06, "grad_time_ms": 8485.023, "update_time_ms": 7.055, "default": {"kl": 0.016263887286186218, "entropy": 0.9323880672454834, "cur_lr": 0.0005000000237487257, "total_loss": 16.017366409301758, "policy_loss": -0.004903031513094902, "vf_explained_var": 0.887096643447876, "vf_loss": 16.020723342895508, "cur_kl_coeff": 0.09492188692092896}, "num_steps_trained": 2963842, "load_time_ms": 12.036}, "custom_metrics": {"cost1_mean": 299.93793816766504, "outflow_rate_max": 1138.504637322749, "system_level_velocity_mean": 12.026000568233924, "cost1_min": 24.74511446076044, "cost1_max": 393.9337265929336, "outflow_rate_min": 439.6710191118835, "cost2_mean": -138.26601063449664, "outflow_rate_mean": 954.5634598459925, "system_level_velocity_min": 9.62681785594732, "cost2_min": -167.50030867418093, "system_level_velocity_max": 19.338988401891825, "cost2_max": -21.097287169478363}, "node_ip": "10.138.0.2", "iterations_since_restore": 77, "done": false, "episodes_total": 1355, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f805c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80a58>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 696.504527515682, "episode_reward_min": 41.200309331803474, "timesteps_total": 2963842, "time_since_restore": 1746.6955058574677, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36491, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557191329, "time_this_iter_s": 22.566277980804443, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 77, "date": "2019-05-07_01-08-49", "episode_len_mean": 686.91}
{"timesteps_since_restore": 3000631, "policy_reward_mean": {}, "episode_reward_max": 811.6386931295186, "time_total_s": 1768.807731628418, "info": {"num_steps_sampled": 3000631, "sample_time_ms": 13537.225, "grad_time_ms": 8470.01, "update_time_ms": 7.298, "default": {"kl": 0.01872212626039982, "entropy": 0.9454062581062317, "cur_lr": 0.0005000000237487257, "total_loss": 15.683873176574707, "policy_loss": -0.00554618937894702, "vf_explained_var": 0.8817678689956665, "vf_loss": 15.687643051147461, "cur_kl_coeff": 0.09492187947034836}, "num_steps_trained": 3000631, "load_time_ms": 11.961}, "custom_metrics": {"cost1_mean": 302.4069499449946, "outflow_rate_max": 1170.577798117693, "system_level_velocity_mean": 12.13012925446893, "cost1_min": 24.74511446076044, "cost1_max": 397.57069937340935, "outflow_rate_min": 439.6710191118835, "cost2_mean": -137.13027560222207, "outflow_rate_mean": 959.8282092210487, "system_level_velocity_min": 9.931681534194578, "cost2_min": -164.5321675460167, "system_level_velocity_max": 19.338988401891825, "cost2_max": -21.097287169478363}, "node_ip": "10.138.0.2", "iterations_since_restore": 78, "done": false, "episodes_total": 1375, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c0b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c208>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 698.5948225428931, "episode_reward_min": 41.200309331803474, "timesteps_total": 3000631, "time_since_restore": 1768.807731628418, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36789, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557191351, "time_this_iter_s": 22.112225770950317, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 78, "date": "2019-05-07_01-09-11", "episode_len_mean": 686.91}
{"timesteps_since_restore": 3037172, "policy_reward_mean": {}, "episode_reward_max": 956.924982898412, "time_total_s": 1790.0826828479767, "info": {"num_steps_sampled": 3037172, "sample_time_ms": 13586.093, "grad_time_ms": 8475.943, "update_time_ms": 7.275, "default": {"kl": 0.016208361834287643, "entropy": 0.9598259925842285, "cur_lr": 0.0005000000237487257, "total_loss": 13.327866554260254, "policy_loss": -0.0067739468067884445, "vf_explained_var": 0.9003331065177917, "vf_loss": 13.333102226257324, "cur_kl_coeff": 0.09492188692092896}, "num_steps_trained": 3037172, "load_time_ms": 12.094}, "custom_metrics": {"cost1_mean": 300.82612030053593, "outflow_rate_max": 1271.0692506848918, "system_level_velocity_mean": 12.08101733570054, "cost1_min": 24.74511446076044, "cost1_max": 451.38256953104144, "outflow_rate_min": 439.6710191118835, "cost2_mean": -136.8129279937624, "outflow_rate_mean": 956.1699257019741, "system_level_velocity_min": 9.931681534194578, "cost2_min": -164.5321675460167, "system_level_velocity_max": 19.338988401891825, "cost2_max": -21.097287169478363}, "node_ip": "10.138.0.2", "iterations_since_restore": 79, "done": false, "episodes_total": 1390, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80f28>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 693.6716889211322, "episode_reward_min": 41.200309331803474, "timesteps_total": 3037172, "time_since_restore": 1790.0826828479767, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36541, "pid": 25319, "episodes_this_iter": 15, "timestamp": 1557191372, "time_this_iter_s": 21.274951219558716, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 79, "date": "2019-05-07_01-09-32", "episode_len_mean": 686.91}
{"timesteps_since_restore": 3074298, "policy_reward_mean": {}, "episode_reward_max": 956.924982898412, "time_total_s": 1812.9745848178864, "info": {"num_steps_sampled": 3074298, "sample_time_ms": 13639.1, "grad_time_ms": 8462.673, "update_time_ms": 7.326, "default": {"kl": 0.017941029742360115, "entropy": 0.9612685441970825, "cur_lr": 0.0005000000237487257, "total_loss": 16.943592071533203, "policy_loss": -0.004802496638149023, "vf_explained_var": 0.8790463209152222, "vf_loss": 16.946691513061523, "cur_kl_coeff": 0.09492187947034836}, "num_steps_trained": 3074298, "load_time_ms": 12.07}, "custom_metrics": {"cost1_mean": 301.73366390399883, "outflow_rate_max": 1271.0692506848918, "system_level_velocity_mean": 12.115331972425677, "cost1_min": 36.80443198334581, "cost1_max": 451.38256953104144, "outflow_rate_min": 473.5448867226461, "cost2_mean": -136.35723726957968, "outflow_rate_mean": 958.3208013015397, "system_level_velocity_min": 9.788592631939657, "cost2_min": -161.85756803272054, "system_level_velocity_max": 19.153476312965328, "cost2_max": -30.682933711313442}, "node_ip": "10.138.0.2", "iterations_since_restore": 80, "done": false, "episodes_total": 1409, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c1d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c8d0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 690.3692193881668, "episode_reward_min": 57.71984751555569, "timesteps_total": 3074298, "time_since_restore": 1812.9745848178864, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37126, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557191395, "time_this_iter_s": 22.891901969909668, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 80, "date": "2019-05-07_01-09-55", "episode_len_mean": 687.12}
{"timesteps_since_restore": 3111706, "policy_reward_mean": {}, "episode_reward_max": 956.924982898412, "time_total_s": 1834.5154793262482, "info": {"num_steps_sampled": 3111706, "sample_time_ms": 13536.994, "grad_time_ms": 8424.905, "update_time_ms": 7.273, "default": {"kl": 0.016536734998226166, "entropy": 0.9802874326705933, "cur_lr": 0.0005000000237487257, "total_loss": 13.628924369812012, "policy_loss": -0.006343930494040251, "vf_explained_var": 0.9040318131446838, "vf_loss": 13.633698463439941, "cur_kl_coeff": 0.09492187947034836}, "num_steps_trained": 3111706, "load_time_ms": 12.498}, "custom_metrics": {"cost1_mean": 298.6676092041109, "outflow_rate_max": 1271.0692506848918, "system_level_velocity_mean": 12.184296491418172, "cost1_min": 35.77962317736002, "cost1_max": 451.38256953104144, "outflow_rate_min": 467.2304325368074, "cost2_mean": -135.8158622972292, "outflow_rate_mean": 952.9303803226451, "system_level_velocity_min": 9.788592631939657, "cost2_min": -161.85756803272054, "system_level_velocity_max": 19.153476312965328, "cost2_max": -28.901323650453524}, "node_ip": "10.138.0.2", "iterations_since_restore": 81, "done": false, "episodes_total": 1428, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062668d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266208>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 685.1851542420865, "episode_reward_min": 53.64005455095631, "timesteps_total": 3111706, "time_since_restore": 1834.5154793262482, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37408, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557191417, "time_this_iter_s": 21.540894508361816, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 81, "date": "2019-05-07_01-10-17", "episode_len_mean": 680.65}
{"timesteps_since_restore": 3149648, "policy_reward_mean": {}, "episode_reward_max": 956.924982898412, "time_total_s": 1855.7424719333649, "info": {"num_steps_sampled": 3149648, "sample_time_ms": 13518.151, "grad_time_ms": 8356.977, "update_time_ms": 7.169, "default": {"kl": 0.016918104141950607, "entropy": 0.9608059525489807, "cur_lr": 0.0005000000237487257, "total_loss": 16.80944061279297, "policy_loss": -0.0061346436850726604, "vf_explained_var": 0.8745042681694031, "vf_loss": 16.813968658447266, "cur_kl_coeff": 0.09492187947034836}, "num_steps_trained": 3149648, "load_time_ms": 12.53}, "custom_metrics": {"cost1_mean": 298.6035111292449, "outflow_rate_max": 1271.0692506848918, "system_level_velocity_mean": 12.184624427269002, "cost1_min": 35.77962317736002, "cost1_max": 451.38256953104144, "outflow_rate_min": 467.2304325368074, "cost2_mean": -136.29278587316495, "outflow_rate_mean": 951.9111154144717, "system_level_velocity_min": 9.788592631939657, "cost2_min": -161.85756803272054, "system_level_velocity_max": 19.153476312965328, "cost2_max": -28.901323650453524}, "node_ip": "10.138.0.2", "iterations_since_restore": 82, "done": false, "episodes_total": 1448, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cdd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c4e0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 680.6412189698451, "episode_reward_min": 53.64005455095631, "timesteps_total": 3149648, "time_since_restore": 1855.7424719333649, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37942, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557191438, "time_this_iter_s": 21.2269926071167, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 82, "date": "2019-05-07_01-10-38", "episode_len_mean": 680.65}
{"timesteps_since_restore": 3187509, "policy_reward_mean": {}, "episode_reward_max": 956.924982898412, "time_total_s": 1877.5346038341522, "info": {"num_steps_sampled": 3187509, "sample_time_ms": 13533.267, "grad_time_ms": 8364.293, "update_time_ms": 7.09, "default": {"kl": 0.017271213233470917, "entropy": 0.9652079939842224, "cur_lr": 0.0005000000237487257, "total_loss": 13.319107055664062, "policy_loss": -0.007219939958304167, "vf_explained_var": 0.8895648717880249, "vf_loss": 13.324688911437988, "cur_kl_coeff": 0.09492188692092896}, "num_steps_trained": 3187509, "load_time_ms": 13.188}, "custom_metrics": {"cost1_mean": 295.38973657929523, "outflow_rate_max": 1271.0692506848918, "system_level_velocity_mean": 12.0617409956059, "cost1_min": 35.20293623527662, "cost1_max": 451.38256953104144, "outflow_rate_min": 431.8791178022117, "cost2_mean": -135.74682343728887, "outflow_rate_mean": 945.2022478730058, "system_level_velocity_min": 9.682216249581286, "cost2_min": -161.85756803272054, "system_level_velocity_max": 19.153476312965328, "cost2_max": -28.224061144347658}, "node_ip": "10.138.0.2", "iterations_since_restore": 83, "done": false, "episodes_total": 1467, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a54e0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 678.7083757872447, "episode_reward_min": 53.64005455095631, "timesteps_total": 3187509, "time_since_restore": 1877.5346038341522, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37861, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557191460, "time_this_iter_s": 21.792131900787354, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 83, "date": "2019-05-07_01-11-00", "episode_len_mean": 680.64}
{"timesteps_since_restore": 3223744, "policy_reward_mean": {}, "episode_reward_max": 828.0611479936076, "time_total_s": 1898.6853003501892, "info": {"num_steps_sampled": 3223744, "sample_time_ms": 13408.875, "grad_time_ms": 8351.772, "update_time_ms": 7.027, "default": {"kl": 0.019209660589694977, "entropy": 0.9715030789375305, "cur_lr": 0.0005000000237487257, "total_loss": 12.380331039428711, "policy_loss": -0.006879374384880066, "vf_explained_var": 0.9150336980819702, "vf_loss": 12.385387420654297, "cur_kl_coeff": 0.09492187947034836}, "num_steps_trained": 3223744, "load_time_ms": 13.11}, "custom_metrics": {"cost1_mean": 294.2278417285819, "outflow_rate_max": 1192.3809668731924, "system_level_velocity_mean": 12.015420274709252, "cost1_min": 35.20293623527662, "cost1_max": 404.50165600213523, "outflow_rate_min": 431.8791178022117, "cost2_mean": -135.63014799237763, "outflow_rate_mean": 943.5390068052704, "system_level_velocity_min": 9.682216249581286, "cost2_min": -158.98945896493248, "system_level_velocity_max": 19.153476312965328, "cost2_max": -28.224061144347658}, "node_ip": "10.138.0.2", "iterations_since_restore": 84, "done": false, "episodes_total": 1484, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c8d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cbe0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 675.3619329492395, "episode_reward_min": 53.64005455095631, "timesteps_total": 3223744, "time_since_restore": 1898.6853003501892, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36235, "pid": 25319, "episodes_this_iter": 17, "timestamp": 1557191481, "time_this_iter_s": 21.150696516036987, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 84, "date": "2019-05-07_01-11-21", "episode_len_mean": 680.64}
{"timesteps_since_restore": 3260002, "policy_reward_mean": {}, "episode_reward_max": 828.0611479936076, "time_total_s": 1919.9460444450378, "info": {"num_steps_sampled": 3260002, "sample_time_ms": 13364.166, "grad_time_ms": 8320.216, "update_time_ms": 6.963, "default": {"kl": 0.018817760050296783, "entropy": 0.9908524751663208, "cur_lr": 0.0005000000237487257, "total_loss": 13.969181060791016, "policy_loss": -0.007666087243705988, "vf_explained_var": 0.9005408883094788, "vf_loss": 13.975061416625977, "cur_kl_coeff": 0.09492187947034836}, "num_steps_trained": 3260002, "load_time_ms": 12.636}, "custom_metrics": {"cost1_mean": 294.63672349807644, "outflow_rate_max": 1192.3809668731924, "system_level_velocity_mean": 12.02854273801982, "cost1_min": 35.20293623527662, "cost1_max": 404.50165600213523, "outflow_rate_min": 431.8791178022117, "cost2_mean": -135.29220744409142, "outflow_rate_mean": 944.8017508064636, "system_level_velocity_min": 9.471085687208346, "cost2_min": -158.98945896493248, "system_level_velocity_max": 19.153476312965328, "cost2_max": -28.224061144347658}, "node_ip": "10.138.0.2", "iterations_since_restore": 85, "done": false, "episodes_total": 1503, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a54e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a59b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5550>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 674.1982722418076, "episode_reward_min": 53.64005455095631, "timesteps_total": 3260002, "time_since_restore": 1919.9460444450378, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36258, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557191502, "time_this_iter_s": 21.260744094848633, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 85, "date": "2019-05-07_01-11-42", "episode_len_mean": 680.64}
{"timesteps_since_restore": 3297385, "policy_reward_mean": {}, "episode_reward_max": 812.0131069939857, "time_total_s": 1941.714501619339, "info": {"num_steps_sampled": 3297385, "sample_time_ms": 13385.97, "grad_time_ms": 8283.728, "update_time_ms": 7.001, "default": {"kl": 0.019065571948885918, "entropy": 1.0042067766189575, "cur_lr": 0.0005000000237487257, "total_loss": 12.8218355178833, "policy_loss": -0.007004182785749435, "vf_explained_var": 0.905272364616394, "vf_loss": 12.827030181884766, "cur_kl_coeff": 0.09492187947034836}, "num_steps_trained": 3297385, "load_time_ms": 12.711}, "custom_metrics": {"cost1_mean": 296.10916863370437, "outflow_rate_max": 1095.9475256255575, "system_level_velocity_mean": 11.907023327023058, "cost1_min": 35.20293623527662, "cost1_max": 366.3754177152888, "outflow_rate_min": 431.8791178022117, "cost2_mean": -135.95115388912888, "outflow_rate_mean": 947.2362671803053, "system_level_velocity_min": 9.471085687208346, "cost2_min": -158.98945896493248, "system_level_velocity_max": 18.989515932069384, "cost2_max": -28.224061144347658}, "node_ip": "10.138.0.2", "iterations_since_restore": 86, "done": false, "episodes_total": 1521, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c9e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8ca20>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 677.6783697803077, "episode_reward_min": 53.64005455095631, "timesteps_total": 3297385, "time_since_restore": 1941.714501619339, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37383, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557191524, "time_this_iter_s": 21.768457174301147, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 86, "date": "2019-05-07_01-12-04", "episode_len_mean": 687.06}
{"timesteps_since_restore": 3334123, "policy_reward_mean": {}, "episode_reward_max": 812.0131069939857, "time_total_s": 1962.9274899959564, "info": {"num_steps_sampled": 3334123, "sample_time_ms": 13222.488, "grad_time_ms": 8311.728, "update_time_ms": 7.077, "default": {"kl": 0.019623378291726112, "entropy": 0.9666460156440735, "cur_lr": 0.0005000000237487257, "total_loss": 13.38387393951416, "policy_loss": -0.007725188042968512, "vf_explained_var": 0.9126580357551575, "vf_loss": 13.389738082885742, "cur_kl_coeff": 0.09492187947034836}, "num_steps_trained": 3334123, "load_time_ms": 12.916}, "custom_metrics": {"cost1_mean": 301.61908100676965, "outflow_rate_max": 1186.870358061926, "system_level_velocity_mean": 11.929101844057447, "cost1_min": 35.20293623527662, "cost1_max": 397.9693257866604, "outflow_rate_min": 431.8791178022117, "cost2_mean": -135.85818933331637, "outflow_rate_mean": 956.5142679792252, "system_level_velocity_min": 9.458739943819815, "cost2_min": -158.98945896493248, "system_level_velocity_max": 18.216768740035082, "cost2_max": -28.224061144347658}, "node_ip": "10.138.0.2", "iterations_since_restore": 87, "done": false, "episodes_total": 1539, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8ca58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cac8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 683.6883652153384, "episode_reward_min": 62.04832203464189, "timesteps_total": 3334123, "time_since_restore": 1962.9274899959564, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36738, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557191545, "time_this_iter_s": 21.21298837661743, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 87, "date": "2019-05-07_01-12-25", "episode_len_mean": 693.53}
{"timesteps_since_restore": 3371197, "policy_reward_mean": {}, "episode_reward_max": 885.4680659716709, "time_total_s": 1984.5544681549072, "info": {"num_steps_sampled": 3371197, "sample_time_ms": 13172.359, "grad_time_ms": 8313.458, "update_time_ms": 6.915, "default": {"kl": 0.0223536416888237, "entropy": 0.953993558883667, "cur_lr": 0.0005000000237487257, "total_loss": 14.992951393127441, "policy_loss": -0.007854169234633446, "vf_explained_var": 0.9116010069847107, "vf_loss": 14.99868392944336, "cur_kl_coeff": 0.09492187947034836}, "num_steps_trained": 3371197, "load_time_ms": 12.913}, "custom_metrics": {"cost1_mean": 306.58565732272064, "outflow_rate_max": 1237.3648077180753, "system_level_velocity_mean": 12.091631276994432, "cost1_min": 35.20293623527662, "cost1_max": 430.4721982552958, "outflow_rate_min": 431.8791178022117, "cost2_mean": -137.28068797209735, "outflow_rate_mean": 964.7152670353331, "system_level_velocity_min": 9.458739943819815, "cost2_min": -166.54640373901267, "system_level_velocity_max": 18.216768740035082, "cost2_max": -28.224061144347658}, "node_ip": "10.138.0.2", "iterations_since_restore": 88, "done": false, "episodes_total": 1559, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c5c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8ca20>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 688.3458947779997, "episode_reward_min": 62.04832203464189, "timesteps_total": 3371197, "time_since_restore": 1984.5544681549072, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37074, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557191567, "time_this_iter_s": 21.626978158950806, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 88, "date": "2019-05-07_01-12-47", "episode_len_mean": 693.53}
{"timesteps_since_restore": 3408159, "policy_reward_mean": {}, "episode_reward_max": 885.4680659716709, "time_total_s": 2005.0167925357819, "info": {"num_steps_sampled": 3408159, "sample_time_ms": 13107.296, "grad_time_ms": 8297.969, "update_time_ms": 6.946, "default": {"kl": 0.015017335303127766, "entropy": 0.98799729347229, "cur_lr": 0.0005000000237487257, "total_loss": 15.218968391418457, "policy_loss": -0.006630780175328255, "vf_explained_var": 0.8846384882926941, "vf_loss": 15.223461151123047, "cur_kl_coeff": 0.14238281548023224}, "num_steps_trained": 3408159, "load_time_ms": 12.611}, "custom_metrics": {"cost1_mean": 309.8259195325783, "outflow_rate_max": 1237.3648077180753, "system_level_velocity_mean": 12.207851297661648, "cost1_min": 36.65134147895873, "cost1_max": 430.4721982552958, "outflow_rate_min": 471.55200453487134, "cost2_mean": -137.67094970843092, "outflow_rate_mean": 970.6326419984101, "system_level_velocity_min": 9.412351441044667, "cost2_min": -166.54640373901267, "system_level_velocity_max": 19.021125296386533, "cost2_max": -29.359045510107645}, "node_ip": "10.138.0.2", "iterations_since_restore": 89, "done": false, "episodes_total": 1577, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a54e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a59e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f840f0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 691.936455190691, "episode_reward_min": 56.72102695470885, "timesteps_total": 3408159, "time_since_restore": 2005.0167925357819, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36962, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557191588, "time_this_iter_s": 20.462324380874634, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 89, "date": "2019-05-07_01-13-08", "episode_len_mean": 693.54}
{"timesteps_since_restore": 3445323, "policy_reward_mean": {}, "episode_reward_max": 885.4680659716709, "time_total_s": 2026.3208904266357, "info": {"num_steps_sampled": 3445323, "sample_time_ms": 12938.646, "grad_time_ms": 8307.699, "update_time_ms": 6.805, "default": {"kl": 0.016209088265895844, "entropy": 0.9638622403144836, "cur_lr": 0.0005000000237487257, "total_loss": 10.526751518249512, "policy_loss": -0.0068161566741764545, "vf_explained_var": 0.9177244901657104, "vf_loss": 10.531259536743164, "cur_kl_coeff": 0.14238281548023224}, "num_steps_trained": 3445323, "load_time_ms": 12.661}, "custom_metrics": {"cost1_mean": 308.05663385174097, "outflow_rate_max": 1237.3648077180753, "system_level_velocity_mean": 12.13933967012254, "cost1_min": 36.65134147895873, "cost1_max": 430.4721982552958, "outflow_rate_min": 471.55200453487134, "cost2_mean": -137.3604641299099, "outflow_rate_mean": 966.7468750663932, "system_level_velocity_min": 9.412351441044667, "cost2_min": -166.54640373901267, "system_level_velocity_max": 19.021125296386533, "cost2_max": -29.359045510107645}, "node_ip": "10.138.0.2", "iterations_since_restore": 90, "done": false, "episodes_total": 1591, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8ca20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c5c0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 695.0617551446322, "episode_reward_min": 56.72102695470885, "timesteps_total": 3445323, "time_since_restore": 2026.3208904266357, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37164, "pid": 25319, "episodes_this_iter": 14, "timestamp": 1557191609, "time_this_iter_s": 21.304097890853882, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 90, "date": "2019-05-07_01-13-29", "episode_len_mean": 693.54}
{"timesteps_since_restore": 3482614, "policy_reward_mean": {}, "episode_reward_max": 885.4680659716709, "time_total_s": 2047.7351939678192, "info": {"num_steps_sampled": 3482614, "sample_time_ms": 12941.684, "grad_time_ms": 8293.029, "update_time_ms": 6.825, "default": {"kl": 0.01646965742111206, "entropy": 0.990236759185791, "cur_lr": 0.0005000000237487257, "total_loss": 13.449481964111328, "policy_loss": -0.007503983099013567, "vf_explained_var": 0.9049808382987976, "vf_loss": 13.454641342163086, "cur_kl_coeff": 0.14238283038139343}, "num_steps_trained": 3482614, "load_time_ms": 12.553}, "custom_metrics": {"cost1_mean": 307.7373868333617, "outflow_rate_max": 1237.3648077180753, "system_level_velocity_mean": 12.121809899118482, "cost1_min": 36.65134147895873, "cost1_max": 430.4721982552958, "outflow_rate_min": 471.55200453487134, "cost2_mean": -136.82458769455607, "outflow_rate_mean": 964.5004148736741, "system_level_velocity_min": 9.412351441044667, "cost2_min": -166.54640373901267, "system_level_velocity_max": 19.021125296386533, "cost2_max": -29.359045510107645}, "node_ip": "10.138.0.2", "iterations_since_restore": 91, "done": false, "episodes_total": 1610, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a59b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f806a0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 699.6251347956234, "episode_reward_min": 56.72102695470885, "timesteps_total": 3482614, "time_since_restore": 2047.7351939678192, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37291, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557191630, "time_this_iter_s": 21.41430354118347, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 91, "date": "2019-05-07_01-13-50", "episode_len_mean": 693.54}
{"timesteps_since_restore": 3520344, "policy_reward_mean": {}, "episode_reward_max": 885.4680659716709, "time_total_s": 2070.4711747169495, "info": {"num_steps_sampled": 3520344, "sample_time_ms": 12999.415, "grad_time_ms": 8386.142, "update_time_ms": 6.872, "default": {"kl": 0.016696574166417122, "entropy": 0.9988988637924194, "cur_lr": 0.0005000000237487257, "total_loss": 14.496971130371094, "policy_loss": -0.006560459267348051, "vf_explained_var": 0.9035412073135376, "vf_loss": 14.501153945922852, "cur_kl_coeff": 0.14238281548023224}, "num_steps_trained": 3520344, "load_time_ms": 12.756}, "custom_metrics": {"cost1_mean": 304.5341025394446, "outflow_rate_max": 1237.3648077180753, "system_level_velocity_mean": 12.002166818275715, "cost1_min": 36.65134147895873, "cost1_max": 430.4721982552958, "outflow_rate_min": 471.55200453487134, "cost2_mean": -136.0476269340125, "outflow_rate_mean": 956.3844993801696, "system_level_velocity_min": 9.412351441044667, "cost2_min": -166.54640373901267, "system_level_velocity_max": 19.021125296386533, "cost2_max": -29.359045510107645}, "node_ip": "10.138.0.2", "iterations_since_restore": 92, "done": false, "episodes_total": 1630, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8ca20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c080>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 696.2488682411002, "episode_reward_min": 56.72102695470885, "timesteps_total": 3520344, "time_since_restore": 2070.4711747169495, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37730, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557191653, "time_this_iter_s": 22.73598074913025, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 92, "date": "2019-05-07_01-14-13", "episode_len_mean": 693.54}
{"timesteps_since_restore": 3557691, "policy_reward_mean": {}, "episode_reward_max": 885.4680659716709, "time_total_s": 2091.393406391144, "info": {"num_steps_sampled": 3557691, "sample_time_ms": 12921.15, "grad_time_ms": 8377.418, "update_time_ms": 6.864, "default": {"kl": 0.016288388520479202, "entropy": 0.9919414520263672, "cur_lr": 0.0005000000237487257, "total_loss": 14.613056182861328, "policy_loss": -0.007254639640450478, "vf_explained_var": 0.911267876625061, "vf_loss": 14.617993354797363, "cur_kl_coeff": 0.14238283038139343}, "num_steps_trained": 3557691, "load_time_ms": 12.635}, "custom_metrics": {"cost1_mean": 297.90097190606093, "outflow_rate_max": 1237.3648077180753, "system_level_velocity_mean": 11.940661965769394, "cost1_min": 23.500548924429584, "cost1_max": 430.4721982552958, "outflow_rate_min": 444.73258866879223, "cost2_mean": -132.35407326717544, "outflow_rate_mean": 942.170273418114, "system_level_velocity_min": 9.377405201632188, "cost2_min": -163.7623407710402, "system_level_velocity_max": 19.109265184627922, "cost2_max": -22.33838025506236}, "node_ip": "10.138.0.2", "iterations_since_restore": 93, "done": false, "episodes_total": 1649, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f809b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80fd0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 685.8628451963997, "episode_reward_min": 38.644068373436355, "timesteps_total": 3557691, "time_since_restore": 2091.393406391144, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37347, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557191674, "time_this_iter_s": 20.922231674194336, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 93, "date": "2019-05-07_01-14-34", "episode_len_mean": 686.89}
{"timesteps_since_restore": 3594641, "policy_reward_mean": {}, "episode_reward_max": 820.9193556561405, "time_total_s": 2112.3200294971466, "info": {"num_steps_sampled": 3594641, "sample_time_ms": 12894.094, "grad_time_ms": 8382.925, "update_time_ms": 6.795, "default": {"kl": 0.016022562980651855, "entropy": 1.002959132194519, "cur_lr": 0.0005000000237487257, "total_loss": 14.775436401367188, "policy_loss": -0.006896371487528086, "vf_explained_var": 0.9000992178916931, "vf_loss": 14.78005313873291, "cur_kl_coeff": 0.14238281548023224}, "num_steps_trained": 3594641, "load_time_ms": 12.747}, "custom_metrics": {"cost1_mean": 294.03790909777626, "outflow_rate_max": 1125.2311944965336, "system_level_velocity_mean": 11.797545800521807, "cost1_min": 23.500548924429584, "cost1_max": 375.29756232861735, "outflow_rate_min": 433.9289437323226, "cost2_mean": -130.31197873357252, "outflow_rate_mean": 935.4217185921852, "system_level_velocity_min": 9.377405201632188, "cost2_min": -160.48891786544868, "system_level_velocity_max": 19.109265184627922, "cost2_max": -22.33838025506236}, "node_ip": "10.138.0.2", "iterations_since_restore": 94, "done": false, "episodes_total": 1666, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c8d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f849b0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 685.6332869040885, "episode_reward_min": 38.644068373436355, "timesteps_total": 3594641, "time_since_restore": 2112.3200294971466, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36950, "pid": 25319, "episodes_this_iter": 17, "timestamp": 1557191695, "time_this_iter_s": 20.926623106002808, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 94, "date": "2019-05-07_01-14-55", "episode_len_mean": 686.77}
{"timesteps_since_restore": 3631669, "policy_reward_mean": {}, "episode_reward_max": 820.9193556561405, "time_total_s": 2133.9663286209106, "info": {"num_steps_sampled": 3631669, "sample_time_ms": 12892.946, "grad_time_ms": 8421.291, "update_time_ms": 6.815, "default": {"kl": 0.015168110840022564, "entropy": 1.016248106956482, "cur_lr": 0.0005000000237487257, "total_loss": 13.231796264648438, "policy_loss": -0.007541244849562645, "vf_explained_var": 0.926326334476471, "vf_loss": 13.23717975616455, "cur_kl_coeff": 0.14238283038139343}, "num_steps_trained": 3631669, "load_time_ms": 13.206}, "custom_metrics": {"cost1_mean": 290.9203430918817, "outflow_rate_max": 1156.5425765010039, "system_level_velocity_mean": 11.675276575911964, "cost1_min": 23.500548924429584, "cost1_max": 424.13508949369594, "outflow_rate_min": 433.9289437323226, "cost2_mean": -127.83512924406229, "outflow_rate_mean": 927.6452651820916, "system_level_velocity_min": 9.07917355392809, "cost2_min": -160.48891786544868, "system_level_velocity_max": 19.109265184627922, "cost2_max": -22.33838025506236}, "node_ip": "10.138.0.2", "iterations_since_restore": 95, "done": false, "episodes_total": 1686, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f806a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f805c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80b38>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 676.2681795876038, "episode_reward_min": 38.644068373436355, "timesteps_total": 3631669, "time_since_restore": 2133.9663286209106, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37028, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557191717, "time_this_iter_s": 21.646299123764038, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 95, "date": "2019-05-07_01-15-17", "episode_len_mean": 686.77}
{"timesteps_since_restore": 3669096, "policy_reward_mean": {}, "episode_reward_max": 825.6669230565383, "time_total_s": 2155.5698912143707, "info": {"num_steps_sampled": 3669096, "sample_time_ms": 12908.538, "grad_time_ms": 8388.979, "update_time_ms": 6.875, "default": {"kl": 0.01582726463675499, "entropy": 1.012902021408081, "cur_lr": 0.0005000000237487257, "total_loss": 13.22414779663086, "policy_loss": -0.007484440226107836, "vf_explained_var": 0.9103803038597107, "vf_loss": 13.229378700256348, "cur_kl_coeff": 0.14238281548023224}, "num_steps_trained": 3669096, "load_time_ms": 13.081}, "custom_metrics": {"cost1_mean": 288.38691162978046, "outflow_rate_max": 1156.5425765010039, "system_level_velocity_mean": 11.750480142058978, "cost1_min": 23.500548924429584, "cost1_max": 424.13508949369594, "outflow_rate_min": 433.9289437323226, "cost2_mean": -124.55977881796507, "outflow_rate_mean": 919.6727628863317, "system_level_velocity_min": 9.07917355392809, "cost2_min": -160.48891786544868, "system_level_velocity_max": 19.274240295969033, "cost2_max": -22.33838025506236}, "node_ip": "10.138.0.2", "iterations_since_restore": 96, "done": false, "episodes_total": 1707, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062668d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266cc0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 659.8325554042467, "episode_reward_min": 38.644068373436355, "timesteps_total": 3669096, "time_since_restore": 2155.5698912143707, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37427, "pid": 25319, "episodes_this_iter": 21, "timestamp": 1557191738, "time_this_iter_s": 21.603562593460083, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 96, "date": "2019-05-07_01-15-38", "episode_len_mean": 680.21}
{"timesteps_since_restore": 3705735, "policy_reward_mean": {}, "episode_reward_max": 825.6669230565383, "time_total_s": 2176.3160676956177, "info": {"num_steps_sampled": 3705735, "sample_time_ms": 12904.643, "grad_time_ms": 8346.156, "update_time_ms": 6.938, "default": {"kl": 0.015545298345386982, "entropy": 0.9968547821044922, "cur_lr": 0.0005000000237487257, "total_loss": 10.108927726745605, "policy_loss": -0.00575533090159297, "vf_explained_var": 0.9382039308547974, "vf_loss": 10.112468719482422, "cur_kl_coeff": 0.14238281548023224}, "num_steps_trained": 3705735, "load_time_ms": 13.06}, "custom_metrics": {"cost1_mean": 287.35917642196057, "outflow_rate_max": 1156.5425765010039, "system_level_velocity_mean": 11.700746688471689, "cost1_min": 23.500548924429584, "cost1_max": 424.13508949369594, "outflow_rate_min": 433.9289437323226, "cost2_mean": -124.45918869583544, "outflow_rate_mean": 917.526284539199, "system_level_velocity_min": 9.07917355392809, "cost2_min": -151.1894225620333, "system_level_velocity_max": 19.274240295969033, "cost2_max": -22.33838025506236}, "node_ip": "10.138.0.2", "iterations_since_restore": 97, "done": false, "episodes_total": 1721, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062894a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289b70>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 660.6349779858017, "episode_reward_min": 38.644068373436355, "timesteps_total": 3705735, "time_since_restore": 2176.3160676956177, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36639, "pid": 25319, "episodes_this_iter": 14, "timestamp": 1557191759, "time_this_iter_s": 20.74617648124695, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 97, "date": "2019-05-07_01-15-59", "episode_len_mean": 680.21}
{"timesteps_since_restore": 3742619, "policy_reward_mean": {}, "episode_reward_max": 825.6669230565383, "time_total_s": 2197.3460953235626, "info": {"num_steps_sampled": 3742619, "sample_time_ms": 12859.453, "grad_time_ms": 8331.61, "update_time_ms": 6.884, "default": {"kl": 0.01822085864841938, "entropy": 0.9869482517242432, "cur_lr": 0.0005000000237487257, "total_loss": 14.750919342041016, "policy_loss": -0.009318429976701736, "vf_explained_var": 0.9104554653167725, "vf_loss": 14.75764274597168, "cur_kl_coeff": 0.14238281548023224}, "num_steps_trained": 3742619, "load_time_ms": 13.098}, "custom_metrics": {"cost1_mean": 293.3006820544522, "outflow_rate_max": 1156.5425765010039, "system_level_velocity_mean": 11.736316297415236, "cost1_min": 27.711514136552324, "cost1_max": 424.13508949369594, "outflow_rate_min": 433.9289437323226, "cost2_mean": -124.34072893830344, "outflow_rate_mean": 927.8198170868338, "system_level_velocity_min": 9.07917355392809, "cost2_min": -151.1894225620333, "system_level_velocity_max": 19.274240295969033, "cost2_max": -24.54560137858707}, "node_ip": "10.138.0.2", "iterations_since_restore": 98, "done": false, "episodes_total": 1741, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cac8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 670.9110963907701, "episode_reward_min": 49.96023211274989, "timesteps_total": 3742619, "time_since_restore": 2197.3460953235626, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36884, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557191780, "time_this_iter_s": 21.030027627944946, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 98, "date": "2019-05-07_01-16-20", "episode_len_mean": 686.86}
{"timesteps_since_restore": 3779815, "policy_reward_mean": {}, "episode_reward_max": 825.6669230565383, "time_total_s": 2218.798861026764, "info": {"num_steps_sampled": 3779815, "sample_time_ms": 12950.07, "grad_time_ms": 8339.651, "update_time_ms": 6.755, "default": {"kl": 0.01775364950299263, "entropy": 1.0434837341308594, "cur_lr": 0.0005000000237487257, "total_loss": 13.315515518188477, "policy_loss": -0.008862723596394062, "vf_explained_var": 0.913047194480896, "vf_loss": 13.321849822998047, "cur_kl_coeff": 0.14238281548023224}, "num_steps_trained": 3779815, "load_time_ms": 13.511}, "custom_metrics": {"cost1_mean": 294.0663028020714, "outflow_rate_max": 1156.5425765010039, "system_level_velocity_mean": 11.59337718022365, "cost1_min": 30.162744880710743, "cost1_max": 424.13508949369594, "outflow_rate_min": 453.3362824983133, "cost2_mean": -125.09605316941739, "outflow_rate_mean": 929.5721647097321, "system_level_velocity_min": 9.07917355392809, "cost2_min": -151.1894225620333, "system_level_velocity_max": 19.274240295969033, "cost2_max": -24.54560137858707}, "node_ip": "10.138.0.2", "iterations_since_restore": 99, "done": false, "episodes_total": 1758, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062893c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540626a4a8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 671.4595017004971, "episode_reward_min": 49.96023211274989, "timesteps_total": 3779815, "time_since_restore": 2218.798861026764, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37196, "pid": 25319, "episodes_this_iter": 17, "timestamp": 1557191802, "time_this_iter_s": 21.452765703201294, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 99, "date": "2019-05-07_01-16-42", "episode_len_mean": 693.44}
{"timesteps_since_restore": 3816940, "policy_reward_mean": {}, "episode_reward_max": 883.7533721478067, "time_total_s": 2239.8959550857544, "info": {"num_steps_sampled": 3816940, "sample_time_ms": 12966.439, "grad_time_ms": 8303.626, "update_time_ms": 6.729, "default": {"kl": 0.020370936021208763, "entropy": 1.0352859497070312, "cur_lr": 0.0005000000237487257, "total_loss": 15.100293159484863, "policy_loss": -0.006068937946110964, "vf_explained_var": 0.9016993045806885, "vf_loss": 15.103462219238281, "cur_kl_coeff": 0.14238281548023224}, "num_steps_trained": 3816940, "load_time_ms": 13.003}, "custom_metrics": {"cost1_mean": 293.7515837873078, "outflow_rate_max": 1204.3372567223114, "system_level_velocity_mean": 11.586338056886195, "cost1_min": 30.162744880710743, "cost1_max": 405.57132008149176, "outflow_rate_min": 453.3362824983133, "cost2_mean": -124.74718140995078, "outflow_rate_mean": 928.8262052247915, "system_level_velocity_min": 9.07917355392809, "cost2_min": -151.1894225620333, "system_level_velocity_max": 19.274240295969033, "cost2_max": -24.54560137858707}, "node_ip": "10.138.0.2", "iterations_since_restore": 100, "done": false, "episodes_total": 1776, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84fd0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 673.4225496608856, "episode_reward_min": 49.96023211274989, "timesteps_total": 3816940, "time_since_restore": 2239.8959550857544, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37125, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557191823, "time_this_iter_s": 21.09709405899048, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 100, "date": "2019-05-07_01-17-03", "episode_len_mean": 693.44}
{"timesteps_since_restore": 3853712, "policy_reward_mean": {}, "episode_reward_max": 883.7533721478067, "time_total_s": 2260.9563694000244, "info": {"num_steps_sampled": 3853712, "sample_time_ms": 12955.604, "grad_time_ms": 8278.608, "update_time_ms": 6.693, "default": {"kl": 0.0154722910374403, "entropy": 1.0145633220672607, "cur_lr": 0.0005000000237487257, "total_loss": 14.86622142791748, "policy_loss": -0.008050506934523582, "vf_explained_var": 0.8956819772720337, "vf_loss": 14.870969772338867, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 3853712, "load_time_ms": 13.0}, "custom_metrics": {"cost1_mean": 293.9763870699965, "outflow_rate_max": 1204.3372567223114, "system_level_velocity_mean": 11.600713513026905, "cost1_min": 30.162744880710743, "cost1_max": 405.57132008149176, "outflow_rate_min": 453.3362824983133, "cost2_mean": -124.87192724016917, "outflow_rate_mean": 931.0373553871187, "system_level_velocity_min": 9.53217650456861, "cost2_min": -151.1894225620333, "system_level_velocity_max": 19.274240295969033, "cost2_max": -24.54560137858707}, "node_ip": "10.138.0.2", "iterations_since_restore": 101, "done": false, "episodes_total": 1796, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289438>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 677.7835595419273, "episode_reward_min": 49.96023211274989, "timesteps_total": 3853712, "time_since_restore": 2260.9563694000244, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36772, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557191844, "time_this_iter_s": 21.06041431427002, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 101, "date": "2019-05-07_01-17-24", "episode_len_mean": 693.44}
{"timesteps_since_restore": 3890372, "policy_reward_mean": {}, "episode_reward_max": 883.7533721478067, "time_total_s": 2281.9620962142944, "info": {"num_steps_sampled": 3890372, "sample_time_ms": 12853.605, "grad_time_ms": 8207.976, "update_time_ms": 6.611, "default": {"kl": 0.013384913094341755, "entropy": 1.0302696228027344, "cur_lr": 0.0005000000237487257, "total_loss": 11.658581733703613, "policy_loss": -0.006879365537315607, "vf_explained_var": 0.9179183840751648, "vf_loss": 11.662602424621582, "cur_kl_coeff": 0.21357417106628418}, "num_steps_trained": 3890372, "load_time_ms": 12.837}, "custom_metrics": {"cost1_mean": 294.569329342606, "outflow_rate_max": 1204.3372567223114, "system_level_velocity_mean": 11.454719912709528, "cost1_min": 231.94008266279894, "cost1_max": 405.57132008149176, "outflow_rate_min": 799.2603369166983, "cost2_mean": -125.50252405201697, "outflow_rate_mean": 933.6221656843339, "system_level_velocity_min": 9.234565636643357, "cost2_min": -151.1894225620333, "system_level_velocity_max": 15.386005226592395, "cost2_max": -97.0852146537337}, "node_ip": "10.138.0.2", "iterations_since_restore": 102, "done": false, "episodes_total": 1815, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80a20>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 682.9628586358832, "episode_reward_min": 554.4528960765193, "timesteps_total": 3890372, "time_since_restore": 2281.9620962142944, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36660, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557191865, "time_this_iter_s": 21.00572681427002, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 102, "date": "2019-05-07_01-17-45", "episode_len_mean": 700.0}
{"timesteps_since_restore": 3927322, "policy_reward_mean": {}, "episode_reward_max": 883.7533721478067, "time_total_s": 2304.016104698181, "info": {"num_steps_sampled": 3927322, "sample_time_ms": 12984.448, "grad_time_ms": 8191.145, "update_time_ms": 6.658, "default": {"kl": 0.014312414452433586, "entropy": 1.0117250680923462, "cur_lr": 0.0005000000237487257, "total_loss": 11.506032943725586, "policy_loss": -0.007668851874768734, "vf_explained_var": 0.915460467338562, "vf_loss": 11.510645866394043, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 3927322, "load_time_ms": 12.71}, "custom_metrics": {"cost1_mean": 291.19735549828624, "outflow_rate_max": 1204.3372567223114, "system_level_velocity_mean": 11.503399311065918, "cost1_min": 30.28788497798496, "cost1_max": 405.57132008149176, "outflow_rate_min": 443.6919444745619, "cost2_mean": -123.754934295727, "outflow_rate_mean": 928.8838698226448, "system_level_velocity_min": 9.234565636643357, "cost2_min": -146.6904273371624, "system_level_velocity_max": 18.93847145408468, "cost2_max": -23.30976115794038}, "node_ip": "10.138.0.2", "iterations_since_restore": 103, "done": false, "episodes_total": 1834, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289668>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 672.7287295123248, "episode_reward_min": 48.80837380857212, "timesteps_total": 3927322, "time_since_restore": 2304.016104698181, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36950, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557191887, "time_this_iter_s": 22.05400848388672, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 103, "date": "2019-05-07_01-18-07", "episode_len_mean": 693.45}
{"timesteps_since_restore": 3964091, "policy_reward_mean": {}, "episode_reward_max": 883.7533721478067, "time_total_s": 2325.2590112686157, "info": {"num_steps_sampled": 3964091, "sample_time_ms": 13011.93, "grad_time_ms": 8195.171, "update_time_ms": 6.783, "default": {"kl": 0.012446261942386627, "entropy": 0.9915549159049988, "cur_lr": 0.0005000000237487257, "total_loss": 11.072293281555176, "policy_loss": -0.006650187075138092, "vf_explained_var": 0.9325174689292908, "vf_loss": 11.076286315917969, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 3964091, "load_time_ms": 12.656}, "custom_metrics": {"cost1_mean": 286.7645918082211, "outflow_rate_max": 1204.3372567223114, "system_level_velocity_mean": 11.504755794472269, "cost1_min": 30.28788497798496, "cost1_max": 405.57132008149176, "outflow_rate_min": 443.6919444745619, "cost2_mean": -122.78709170549928, "outflow_rate_mean": 919.2166117412787, "system_level_velocity_min": 9.234565636643357, "cost2_min": -146.6904273371624, "system_level_velocity_max": 18.93847145408468, "cost2_max": -23.30976115794038}, "node_ip": "10.138.0.2", "iterations_since_restore": 104, "done": false, "episodes_total": 1850, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f804a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80a20>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 664.7201150778596, "episode_reward_min": 48.80837380857212, "timesteps_total": 3964091, "time_since_restore": 2325.2590112686157, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36769, "pid": 25319, "episodes_this_iter": 16, "timestamp": 1557191908, "time_this_iter_s": 21.24290657043457, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 104, "date": "2019-05-07_01-18-28", "episode_len_mean": 687.13}
{"timesteps_since_restore": 4000812, "policy_reward_mean": {}, "episode_reward_max": 883.7533721478067, "time_total_s": 2346.2009835243225, "info": {"num_steps_sampled": 4000812, "sample_time_ms": 12991.977, "grad_time_ms": 8145.34, "update_time_ms": 6.951, "default": {"kl": 0.015196897089481354, "entropy": 0.9794994592666626, "cur_lr": 0.0005000000237487257, "total_loss": 12.834693908691406, "policy_loss": -0.007951365783810616, "vf_explained_var": 0.919806182384491, "vf_loss": 12.839400291442871, "cur_kl_coeff": 0.21357417106628418}, "num_steps_trained": 4000812, "load_time_ms": 12.635}, "custom_metrics": {"cost1_mean": 287.02658557393136, "outflow_rate_max": 1204.3372567223114, "system_level_velocity_mean": 11.5301234527212, "cost1_min": 30.28788497798496, "cost1_max": 405.57132008149176, "outflow_rate_min": 443.6919444745619, "cost2_mean": -123.53293093108486, "outflow_rate_mean": 920.5172346125943, "system_level_velocity_min": 9.234565636643357, "cost2_min": -150.28797402775152, "system_level_velocity_max": 18.93847145408468, "cost2_max": -23.30976115794038}, "node_ip": "10.138.0.2", "iterations_since_restore": 105, "done": false, "episodes_total": 1870, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289390>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 667.1055912605858, "episode_reward_min": 48.80837380857212, "timesteps_total": 4000812, "time_since_restore": 2346.2009835243225, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36721, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557191929, "time_this_iter_s": 20.941972255706787, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 105, "date": "2019-05-07_01-18-49", "episode_len_mean": 687.13}
{"timesteps_since_restore": 4038016, "policy_reward_mean": {}, "episode_reward_max": 811.7305577499513, "time_total_s": 2368.1256635189056, "info": {"num_steps_sampled": 4038016, "sample_time_ms": 12961.352, "grad_time_ms": 8207.406, "update_time_ms": 6.883, "default": {"kl": 0.012443826533854008, "entropy": 0.9471709132194519, "cur_lr": 0.0005000000237487257, "total_loss": 13.619462013244629, "policy_loss": -0.006921133492141962, "vf_explained_var": 0.9231134057044983, "vf_loss": 13.623725891113281, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 4038016, "load_time_ms": 12.739}, "custom_metrics": {"cost1_mean": 288.5880598637191, "outflow_rate_max": 1074.1943484043563, "system_level_velocity_mean": 11.594177560953833, "cost1_min": 30.28788497798496, "cost1_max": 357.0528899737485, "outflow_rate_min": 443.6919444745619, "cost2_mean": -125.43387174255759, "outflow_rate_mean": 924.4313887068819, "system_level_velocity_min": 9.234565636643357, "cost2_min": -150.5445164408817, "system_level_velocity_max": 18.93847145408468, "cost2_max": -23.30976115794038}, "node_ip": "10.138.0.2", "iterations_since_restore": 106, "done": false, "episodes_total": 1890, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80198>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 672.1618816120609, "episode_reward_min": 48.80837380857212, "timesteps_total": 4038016, "time_since_restore": 2368.1256635189056, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37204, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557191951, "time_this_iter_s": 21.92467999458313, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 106, "date": "2019-05-07_01-19-11", "episode_len_mean": 687.13}
{"timesteps_since_restore": 4075157, "policy_reward_mean": {}, "episode_reward_max": 811.7305577499513, "time_total_s": 2389.5199720859528, "info": {"num_steps_sampled": 4075157, "sample_time_ms": 13003.11, "grad_time_ms": 8231.196, "update_time_ms": 6.848, "default": {"kl": 0.013872144743800163, "entropy": 0.941421389579773, "cur_lr": 0.0005000000237487257, "total_loss": 13.249350547790527, "policy_loss": -0.006216492038220167, "vf_explained_var": 0.9135758876800537, "vf_loss": 13.252604484558105, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 4075157, "load_time_ms": 12.295}, "custom_metrics": {"cost1_mean": 296.1681748763007, "outflow_rate_max": 1126.435731453133, "system_level_velocity_mean": 11.870857852675847, "cost1_min": 30.28788497798496, "cost1_max": 392.1311668394725, "outflow_rate_min": 443.6919444745619, "cost2_mean": -127.11382750038358, "outflow_rate_mean": 939.7008419748656, "system_level_velocity_min": 9.328738032829474, "cost2_min": -151.11945991548401, "system_level_velocity_max": 18.93847145408468, "cost2_max": -23.30976115794038}, "node_ip": "10.138.0.2", "iterations_since_restore": 107, "done": false, "episodes_total": 1909, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062890f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289128>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 678.0571349799314, "episode_reward_min": 48.80837380857212, "timesteps_total": 4075157, "time_since_restore": 2389.5199720859528, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37141, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557191972, "time_this_iter_s": 21.39430856704712, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 107, "date": "2019-05-07_01-19-32", "episode_len_mean": 687.13}
{"timesteps_since_restore": 4111840, "policy_reward_mean": {}, "episode_reward_max": 811.7305577499513, "time_total_s": 2410.690848827362, "info": {"num_steps_sampled": 4111840, "sample_time_ms": 13050.207, "grad_time_ms": 8198.34, "update_time_ms": 6.896, "default": {"kl": 0.014262724667787552, "entropy": 0.9380158185958862, "cur_lr": 0.0005000000237487257, "total_loss": 13.464998245239258, "policy_loss": -0.0072070457972586155, "vf_explained_var": 0.9205157160758972, "vf_loss": 13.469158172607422, "cur_kl_coeff": 0.21357417106628418}, "num_steps_trained": 4111840, "load_time_ms": 12.495}, "custom_metrics": {"cost1_mean": 297.24857589673024, "outflow_rate_max": 1126.435731453133, "system_level_velocity_mean": 11.919114444956204, "cost1_min": 30.28788497798496, "cost1_max": 392.1311668394725, "outflow_rate_min": 443.6919444745619, "cost2_mean": -129.03356414049594, "outflow_rate_mean": 941.9616983898152, "system_level_velocity_min": 9.76388165619326, "cost2_min": -151.11945991548401, "system_level_velocity_max": 18.93847145408468, "cost2_max": -23.30976115794038}, "node_ip": "10.138.0.2", "iterations_since_restore": 108, "done": false, "episodes_total": 1927, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f805c0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 680.6230110664919, "episode_reward_min": 48.80837380857212, "timesteps_total": 4111840, "time_since_restore": 2410.690848827362, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36683, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557191994, "time_this_iter_s": 21.1708767414093, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 108, "date": "2019-05-07_01-19-54", "episode_len_mean": 687.13}
{"timesteps_since_restore": 4147854, "policy_reward_mean": {}, "episode_reward_max": 830.2446513026963, "time_total_s": 2431.976769208908, "info": {"num_steps_sampled": 4147854, "sample_time_ms": 13051.172, "grad_time_ms": 8180.617, "update_time_ms": 6.919, "default": {"kl": 0.01505340076982975, "entropy": 0.9540245532989502, "cur_lr": 0.0005000000237487257, "total_loss": 18.755115509033203, "policy_loss": -0.008003012277185917, "vf_explained_var": 0.8820335865020752, "vf_loss": 18.759904861450195, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 4147854, "load_time_ms": 12.437}, "custom_metrics": {"cost1_mean": 308.5790903335561, "outflow_rate_max": 1183.235568030525, "system_level_velocity_mean": 12.00636438856933, "cost1_min": 242.8170603536592, "cost1_max": 396.2448131677704, "outflow_rate_min": 827.2445667579444, "cost2_mean": -132.5149712802303, "outflow_rate_mean": 965.5699796787652, "system_level_velocity_min": 9.76388165619326, "cost2_min": -155.4329478193799, "system_level_velocity_max": 14.999689100517887, "cost2_max": -109.99890858139031}, "node_ip": "10.138.0.2", "iterations_since_restore": 109, "done": false, "episodes_total": 1948, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062890f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289320>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 700.4006269028314, "episode_reward_min": 575.1744189568363, "timesteps_total": 4147854, "time_since_restore": 2431.976769208908, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36014, "pid": 25319, "episodes_this_iter": 21, "timestamp": 1557192015, "time_this_iter_s": 21.28592038154602, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 109, "date": "2019-05-07_01-20-15", "episode_len_mean": 700.0}
{"timesteps_since_restore": 4183951, "policy_reward_mean": {}, "episode_reward_max": 830.2446513026963, "time_total_s": 2453.028960466385, "info": {"num_steps_sampled": 4183951, "sample_time_ms": 13059.602, "grad_time_ms": 8166.464, "update_time_ms": 7.032, "default": {"kl": 0.016291571781039238, "entropy": 0.9532498717308044, "cur_lr": 0.0005000000237487257, "total_loss": 13.179262161254883, "policy_loss": -0.007469288073480129, "vf_explained_var": 0.9151039123535156, "vf_loss": 13.18325138092041, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 4183951, "load_time_ms": 12.807}, "custom_metrics": {"cost1_mean": 310.7204652020184, "outflow_rate_max": 1183.235568030525, "system_level_velocity_mean": 12.08375772525879, "cost1_min": 233.854946640972, "cost1_max": 396.2448131677704, "outflow_rate_min": 837.4094557228187, "cost2_mean": -133.2889441474461, "outflow_rate_mean": 970.8892194351092, "system_level_velocity_min": 9.41826727288938, "cost2_min": -155.4329478193799, "system_level_velocity_max": 14.999689100517887, "cost2_max": -109.99890858139031}, "node_ip": "10.138.0.2", "iterations_since_restore": 110, "done": false, "episodes_total": 1966, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80198>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 699.9319603028737, "episode_reward_min": 575.1744189568363, "timesteps_total": 4183951, "time_since_restore": 2453.028960466385, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36097, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557192036, "time_this_iter_s": 21.052191257476807, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 110, "date": "2019-05-07_01-20-36", "episode_len_mean": 700.0}
{"timesteps_since_restore": 4219983, "policy_reward_mean": {}, "episode_reward_max": 830.2446513026963, "time_total_s": 2473.899503469467, "info": {"num_steps_sampled": 4219983, "sample_time_ms": 13054.726, "grad_time_ms": 8152.979, "update_time_ms": 7.007, "default": {"kl": 0.01642773486673832, "entropy": 0.968866765499115, "cur_lr": 0.0005000000237487257, "total_loss": 13.50903034210205, "policy_loss": -0.008164896629750729, "vf_explained_var": 0.9054371118545532, "vf_loss": 13.513687133789062, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 4219983, "load_time_ms": 12.82}, "custom_metrics": {"cost1_mean": 309.7184075114816, "outflow_rate_max": 1183.235568030525, "system_level_velocity_mean": 12.058599138023808, "cost1_min": 233.854946640972, "cost1_max": 396.2448131677704, "outflow_rate_min": 837.4094557228187, "cost2_mean": -132.28303787185877, "outflow_rate_mean": 968.6721007411496, "system_level_velocity_min": 9.41826727288938, "cost2_min": -155.4329478193799, "system_level_velocity_max": 14.999689100517887, "cost2_max": -109.99890858139031}, "node_ip": "10.138.0.2", "iterations_since_restore": 111, "done": false, "episodes_total": 1983, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062892b0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 694.6301348660004, "episode_reward_min": 575.1744189568363, "timesteps_total": 4219983, "time_since_restore": 2473.899503469467, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36032, "pid": 25319, "episodes_this_iter": 17, "timestamp": 1557192057, "time_this_iter_s": 20.870543003082275, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 111, "date": "2019-05-07_01-20-57", "episode_len_mean": 700.0}
{"timesteps_since_restore": 4256588, "policy_reward_mean": {}, "episode_reward_max": 830.2446513026963, "time_total_s": 2494.7367362976074, "info": {"num_steps_sampled": 4256588, "sample_time_ms": 13038.488, "grad_time_ms": 8151.683, "update_time_ms": 7.175, "default": {"kl": 0.015470876358449459, "entropy": 0.9614782333374023, "cur_lr": 0.0005000000237487257, "total_loss": 12.281691551208496, "policy_loss": -0.008648373186588287, "vf_explained_var": 0.9148244857788086, "vf_loss": 12.287036895751953, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 4256588, "load_time_ms": 12.771}, "custom_metrics": {"cost1_mean": 308.59390747529574, "outflow_rate_max": 1183.235568030525, "system_level_velocity_mean": 12.028999018675929, "cost1_min": 233.854946640972, "cost1_max": 396.2448131677704, "outflow_rate_min": 837.4094557228187, "cost2_mean": -131.9248167615938, "outflow_rate_mean": 965.5835498598971, "system_level_velocity_min": 9.41826727288938, "cost2_min": -155.4329478193799, "system_level_velocity_max": 14.999689100517887, "cost2_max": -109.99890858139031}, "node_ip": "10.138.0.2", "iterations_since_restore": 112, "done": false, "episodes_total": 2000, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f805c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80278>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 690.4822373379039, "episode_reward_min": 575.1744189568363, "timesteps_total": 4256588, "time_since_restore": 2494.7367362976074, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36605, "pid": 25319, "episodes_this_iter": 17, "timestamp": 1557192078, "time_this_iter_s": 20.83723282814026, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 112, "date": "2019-05-07_01-21-18", "episode_len_mean": 700.0}
{"timesteps_since_restore": 4293633, "policy_reward_mean": {}, "episode_reward_max": 830.2446513026963, "time_total_s": 2515.9756574630737, "info": {"num_steps_sampled": 4293633, "sample_time_ms": 12923.306, "grad_time_ms": 8185.721, "update_time_ms": 7.139, "default": {"kl": 0.014356976374983788, "entropy": 0.9577687382698059, "cur_lr": 0.0005000000237487257, "total_loss": 14.152971267700195, "policy_loss": -0.006513881031423807, "vf_explained_var": 0.9123613238334656, "vf_loss": 14.15641975402832, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 4293633, "load_time_ms": 12.669}, "custom_metrics": {"cost1_mean": 308.85552150475274, "outflow_rate_max": 1183.235568030525, "system_level_velocity_mean": 12.091809238717223, "cost1_min": 201.7961647654124, "cost1_max": 396.2448131677704, "outflow_rate_min": 807.6906227227629, "cost2_mean": -131.193629856975, "outflow_rate_mean": 966.7637780661242, "system_level_velocity_min": 9.41826727288938, "cost2_min": -155.4329478193799, "system_level_velocity_max": 14.999689100517887, "cost2_max": -110.57094900655837}, "node_ip": "10.138.0.2", "iterations_since_restore": 113, "done": false, "episodes_total": 2020, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289cc0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 692.2050637341183, "episode_reward_min": 422.6064265036437, "timesteps_total": 4293633, "time_since_restore": 2515.9756574630737, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37045, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557192099, "time_this_iter_s": 21.23892116546631, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 113, "date": "2019-05-07_01-21-39", "episode_len_mean": 697.15}
{"timesteps_since_restore": 4330413, "policy_reward_mean": {}, "episode_reward_max": 810.3912215059374, "time_total_s": 2537.174120903015, "info": {"num_steps_sampled": 4330413, "sample_time_ms": 12948.338, "grad_time_ms": 8156.516, "update_time_ms": 6.973, "default": {"kl": 0.013400290161371231, "entropy": 0.9634905457496643, "cur_lr": 0.0005000000237487257, "total_loss": 14.700264930725098, "policy_loss": -0.007603994105011225, "vf_explained_var": 0.9053706526756287, "vf_loss": 14.70500659942627, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 4330413, "load_time_ms": 12.595}, "custom_metrics": {"cost1_mean": 302.78523842582445, "outflow_rate_max": 1169.769709579716, "system_level_velocity_mean": 12.042466149189906, "cost1_min": 36.994337901195316, "cost1_max": 391.1135794904602, "outflow_rate_min": 460.3112657452716, "cost2_mean": -128.64314633336105, "outflow_rate_mean": 954.9000742751642, "system_level_velocity_min": 9.41826727288938, "cost2_min": -149.1997541750652, "system_level_velocity_max": 18.660458823200727, "cost2_max": -29.005726769309362}, "node_ip": "10.138.0.2", "iterations_since_restore": 114, "done": false, "episodes_total": 2041, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80ef0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 680.2921392255964, "episode_reward_min": 54.489564740255446, "timesteps_total": 4330413, "time_since_restore": 2537.174120903015, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36780, "pid": 25319, "episodes_this_iter": 21, "timestamp": 1557192120, "time_this_iter_s": 21.198463439941406, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 114, "date": "2019-05-07_01-22-00", "episode_len_mean": 690.7}
{"timesteps_since_restore": 4367065, "policy_reward_mean": {}, "episode_reward_max": 793.3680795395056, "time_total_s": 2558.51806974411, "info": {"num_steps_sampled": 4367065, "sample_time_ms": 12984.328, "grad_time_ms": 8160.16, "update_time_ms": 6.855, "default": {"kl": 0.0152431670576334, "entropy": 0.9547876715660095, "cur_lr": 0.0005000000237487257, "total_loss": 12.883598327636719, "policy_loss": -0.008677925914525986, "vf_explained_var": 0.9192312955856323, "vf_loss": 12.889021873474121, "cur_kl_coeff": 0.21357417106628418}, "num_steps_trained": 4367065, "load_time_ms": 12.32}, "custom_metrics": {"cost1_mean": 299.729419998243, "outflow_rate_max": 1169.769709579716, "system_level_velocity_mean": 11.93472337199979, "cost1_min": 36.994337901195316, "cost1_max": 391.1135794904602, "outflow_rate_min": 460.3112657452716, "cost2_mean": -128.24734164387928, "outflow_rate_mean": 946.842954455513, "system_level_velocity_min": 9.28097061587871, "cost2_min": -149.1997541750652, "system_level_velocity_max": 18.660458823200727, "cost2_max": -29.005726769309362}, "node_ip": "10.138.0.2", "iterations_since_restore": 115, "done": false, "episodes_total": 2060, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289320>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 680.1964291604011, "episode_reward_min": 54.489564740255446, "timesteps_total": 4367065, "time_since_restore": 2558.51806974411, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36652, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557192142, "time_this_iter_s": 21.34394884109497, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 115, "date": "2019-05-07_01-22-22", "episode_len_mean": 690.7}
{"timesteps_since_restore": 4403044, "policy_reward_mean": {}, "episode_reward_max": 793.3680795395056, "time_total_s": 2581.2011091709137, "info": {"num_steps_sampled": 4403044, "sample_time_ms": 13087.808, "grad_time_ms": 8133.537, "update_time_ms": 6.872, "default": {"kl": 0.014672033488750458, "entropy": 0.9565719366073608, "cur_lr": 0.0005000000237487257, "total_loss": 13.981671333312988, "policy_loss": -0.008257975801825523, "vf_explained_var": 0.9056214690208435, "vf_loss": 13.986795425415039, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 4403044, "load_time_ms": 12.12}, "custom_metrics": {"cost1_mean": 297.5114557047152, "outflow_rate_max": 1171.7630374384885, "system_level_velocity_mean": 12.011559768059731, "cost1_min": 35.908712497443055, "cost1_max": 391.1135794904602, "outflow_rate_min": 452.7381993624708, "cost2_mean": -126.43274886747318, "outflow_rate_mean": 943.2968883689142, "system_level_velocity_min": 9.28097061587871, "cost2_min": -150.25695408833818, "system_level_velocity_max": 18.660458823200727, "cost2_max": -24.696926160305065}, "node_ip": "10.138.0.2", "iterations_since_restore": 116, "done": false, "episodes_total": 2077, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f804a8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 676.4132718961426, "episode_reward_min": 54.489564740255446, "timesteps_total": 4403044, "time_since_restore": 2581.2011091709137, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35979, "pid": 25319, "episodes_this_iter": 17, "timestamp": 1557192164, "time_this_iter_s": 22.68303942680359, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 116, "date": "2019-05-07_01-22-44", "episode_len_mean": 684.23}
{"timesteps_since_restore": 4439534, "policy_reward_mean": {}, "episode_reward_max": 793.3680795395056, "time_total_s": 2602.5227012634277, "info": {"num_steps_sampled": 4439534, "sample_time_ms": 13064.226, "grad_time_ms": 8149.104, "update_time_ms": 6.805, "default": {"kl": 0.013972001150250435, "entropy": 0.9600114822387695, "cur_lr": 0.0005000000237487257, "total_loss": 15.075671195983887, "policy_loss": -0.008460409939289093, "vf_explained_var": 0.897946834564209, "vf_loss": 15.081149101257324, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 4439534, "load_time_ms": 12.274}, "custom_metrics": {"cost1_mean": 297.4145055558995, "outflow_rate_max": 1171.7630374384885, "system_level_velocity_mean": 11.987422229080536, "cost1_min": 35.908712497443055, "cost1_max": 391.1135794904602, "outflow_rate_min": 452.7381993624708, "cost2_mean": -126.23462420150275, "outflow_rate_mean": 943.8557746831659, "system_level_velocity_min": 9.28097061587871, "cost2_min": -150.25695408833818, "system_level_velocity_max": 18.660458823200727, "cost2_max": -24.696926160305065}, "node_ip": "10.138.0.2", "iterations_since_restore": 117, "done": false, "episodes_total": 2097, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289cc0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 678.4165286391836, "episode_reward_min": 54.489564740255446, "timesteps_total": 4439534, "time_since_restore": 2602.5227012634277, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36490, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557192186, "time_this_iter_s": 21.321592092514038, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 117, "date": "2019-05-07_01-23-06", "episode_len_mean": 684.23}
{"timesteps_since_restore": 4475916, "policy_reward_mean": {}, "episode_reward_max": 816.9221993758197, "time_total_s": 2623.322235107422, "info": {"num_steps_sampled": 4475916, "sample_time_ms": 13013.609, "grad_time_ms": 8162.634, "update_time_ms": 6.73, "default": {"kl": 0.015229265205562115, "entropy": 0.9860296249389648, "cur_lr": 0.0005000000237487257, "total_loss": 14.122820854187012, "policy_loss": -0.008894720114767551, "vf_explained_var": 0.9046957492828369, "vf_loss": 14.128462791442871, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 4475916, "load_time_ms": 11.79}, "custom_metrics": {"cost1_mean": 297.8066919258738, "outflow_rate_max": 1171.7630374384885, "system_level_velocity_mean": 11.943324998717888, "cost1_min": 35.908712497443055, "cost1_max": 386.0333659195146, "outflow_rate_min": 452.7381993624708, "cost2_mean": -125.77388410084541, "outflow_rate_mean": 944.2962412287904, "system_level_velocity_min": 9.28097061587871, "cost2_min": -150.25695408833818, "system_level_velocity_max": 18.660458823200727, "cost2_max": -24.696926160305065}, "node_ip": "10.138.0.2", "iterations_since_restore": 118, "done": false, "episodes_total": 2115, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80ef0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 680.8124621222944, "episode_reward_min": 54.489564740255446, "timesteps_total": 4475916, "time_since_restore": 2623.322235107422, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36382, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557192207, "time_this_iter_s": 20.79953384399414, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 118, "date": "2019-05-07_01-23-27", "episode_len_mean": 687.08}
{"timesteps_since_restore": 4512844, "policy_reward_mean": {}, "episode_reward_max": 816.9221993758197, "time_total_s": 2643.8106610774994, "info": {"num_steps_sampled": 4512844, "sample_time_ms": 12926.907, "grad_time_ms": 8170.317, "update_time_ms": 6.712, "default": {"kl": 0.015681609511375427, "entropy": 1.0115904808044434, "cur_lr": 0.0005000000237487257, "total_loss": 7.774446487426758, "policy_loss": -0.00791314709931612, "vf_explained_var": 0.9378712177276611, "vf_loss": 7.77901029586792, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 4512844, "load_time_ms": 11.436}, "custom_metrics": {"cost1_mean": 296.65790490530765, "outflow_rate_max": 1171.7630374384885, "system_level_velocity_mean": 11.89586802480005, "cost1_min": 35.908712497443055, "cost1_max": 386.0333659195146, "outflow_rate_min": 452.7381993624708, "cost2_mean": -124.9562084743075, "outflow_rate_mean": 943.3770843414935, "system_level_velocity_min": 9.28097061587871, "cost2_min": -150.25695408833818, "system_level_velocity_max": 18.660458823200727, "cost2_max": -24.696926160305065}, "node_ip": "10.138.0.2", "iterations_since_restore": 119, "done": false, "episodes_total": 2127, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062898d0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 675.3710600611126, "episode_reward_min": 54.489564740255446, "timesteps_total": 4512844, "time_since_restore": 2643.8106610774994, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36928, "pid": 25319, "episodes_this_iter": 12, "timestamp": 1557192227, "time_this_iter_s": 20.488425970077515, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 119, "date": "2019-05-07_01-23-47", "episode_len_mean": 687.08}
{"timesteps_since_restore": 4550483, "policy_reward_mean": {}, "episode_reward_max": 816.9221993758197, "time_total_s": 2666.102399587631, "info": {"num_steps_sampled": 4550483, "sample_time_ms": 13008.329, "grad_time_ms": 8213.239, "update_time_ms": 6.59, "default": {"kl": 0.016069546341896057, "entropy": 0.9815196394920349, "cur_lr": 0.0005000000237487257, "total_loss": 14.863136291503906, "policy_loss": -0.009433862753212452, "vf_explained_var": 0.8945592641830444, "vf_loss": 14.86913776397705, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 4550483, "load_time_ms": 11.442}, "custom_metrics": {"cost1_mean": 296.0445637639689, "outflow_rate_max": 1171.7630374384885, "system_level_velocity_mean": 11.69823762502233, "cost1_min": 35.908712497443055, "cost1_max": 386.0333659195146, "outflow_rate_min": 452.7381993624708, "cost2_mean": -124.55212150690771, "outflow_rate_mean": 942.288607713781, "system_level_velocity_min": 9.28097061587871, "cost2_min": -150.25695408833818, "system_level_velocity_max": 18.1008284629754, "cost2_max": -24.696926160305065}, "node_ip": "10.138.0.2", "iterations_since_restore": 120, "done": false, "episodes_total": 2148, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80358>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 679.394019167111, "episode_reward_min": 61.21048813352131, "timesteps_total": 4550483, "time_since_restore": 2666.102399587631, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37639, "pid": 25319, "episodes_this_iter": 21, "timestamp": 1557192249, "time_this_iter_s": 22.291738510131836, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 120, "date": "2019-05-07_01-24-09", "episode_len_mean": 693.53}
{"timesteps_since_restore": 4587934, "policy_reward_mean": {}, "episode_reward_max": 816.9221993758197, "time_total_s": 2688.3515095710754, "info": {"num_steps_sampled": 4587934, "sample_time_ms": 13038.942, "grad_time_ms": 8320.214, "update_time_ms": 6.708, "default": {"kl": 0.014399056322872639, "entropy": 0.9903520345687866, "cur_lr": 0.0005000000237487257, "total_loss": 14.855244636535645, "policy_loss": -0.007409394718706608, "vf_explained_var": 0.8918279409408569, "vf_loss": 14.859577178955078, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 4587934, "load_time_ms": 11.446}, "custom_metrics": {"cost1_mean": 296.4843378364309, "outflow_rate_max": 1171.7630374384885, "system_level_velocity_mean": 11.534032463109105, "cost1_min": 227.86096012147567, "cost1_max": 386.0333659195146, "outflow_rate_min": 816.7519653816627, "cost2_mean": -125.97997216750856, "outflow_rate_mean": 944.87211428008, "system_level_velocity_min": 9.251429499436226, "cost2_min": -150.25695408833818, "system_level_velocity_max": 14.506666025677017, "cost2_max": -106.68071907228125}, "node_ip": "10.138.0.2", "iterations_since_restore": 121, "done": false, "episodes_total": 2168, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289320>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 684.4641946886309, "episode_reward_min": 579.89319809087, "timesteps_total": 4587934, "time_since_restore": 2688.3515095710754, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37451, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557192272, "time_this_iter_s": 22.249109983444214, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 121, "date": "2019-05-07_01-24-32", "episode_len_mean": 700.0}
{"timesteps_since_restore": 4624678, "policy_reward_mean": {}, "episode_reward_max": 816.9221993758197, "time_total_s": 2709.7940549850464, "info": {"num_steps_sampled": 4624678, "sample_time_ms": 13052.912, "grad_time_ms": 8367.224, "update_time_ms": 6.499, "default": {"kl": 0.016827493906021118, "entropy": 0.9611529111862183, "cur_lr": 0.0005000000237487257, "total_loss": 13.99796199798584, "policy_loss": -0.006252105347812176, "vf_explained_var": 0.8994571566581726, "vf_loss": 14.000619888305664, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 4624678, "load_time_ms": 11.154}, "custom_metrics": {"cost1_mean": 293.3080838330685, "outflow_rate_max": 1102.6669432232416, "system_level_velocity_mean": 11.447451288106457, "cost1_min": 227.86096012147567, "cost1_max": 365.5389690239254, "outflow_rate_min": 816.7519653816627, "cost2_mean": -125.15536196092839, "outflow_rate_mean": 937.9814394316471, "system_level_velocity_min": 9.251429499436226, "cost2_min": -143.74892084261776, "system_level_velocity_max": 13.849976111764336, "cost2_max": -106.68071907228125}, "node_ip": "10.138.0.2", "iterations_since_restore": 122, "done": false, "episodes_total": 2188, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80a20>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 684.7824317254774, "episode_reward_min": 496.56168262494106, "timesteps_total": 4624678, "time_since_restore": 2709.7940549850464, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36744, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557192293, "time_this_iter_s": 21.442545413970947, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 122, "date": "2019-05-07_01-24-53", "episode_len_mean": 698.14}
{"timesteps_since_restore": 4661221, "policy_reward_mean": {}, "episode_reward_max": 800.536904174548, "time_total_s": 2730.610842227936, "info": {"num_steps_sampled": 4661221, "sample_time_ms": 13032.707, "grad_time_ms": 8344.697, "update_time_ms": 6.511, "default": {"kl": 0.016142388805747032, "entropy": 0.9588055610656738, "cur_lr": 0.0005000000237487257, "total_loss": 14.463123321533203, "policy_loss": -0.008138841018080711, "vf_explained_var": 0.8935306072235107, "vf_loss": 14.467814445495605, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 4661221, "load_time_ms": 11.163}, "custom_metrics": {"cost1_mean": 291.4345152216314, "outflow_rate_max": 1102.6669432232416, "system_level_velocity_mean": 11.387263175809046, "cost1_min": 227.86096012147567, "cost1_max": 365.5389690239254, "outflow_rate_min": 811.3425757882172, "cost2_mean": -125.20067440802744, "outflow_rate_mean": 933.4723917159763, "system_level_velocity_min": 9.251429499436226, "cost2_min": -145.51374775034785, "system_level_velocity_max": 13.849976111764336, "cost2_max": -106.68071907228125}, "node_ip": "10.138.0.2", "iterations_since_restore": 123, "done": false, "episodes_total": 2206, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289a90>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 679.0840681413165, "episode_reward_min": 496.56168262494106, "timesteps_total": 4661221, "time_since_restore": 2730.610842227936, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36543, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557192314, "time_this_iter_s": 20.816787242889404, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 123, "date": "2019-05-07_01-25-14", "episode_len_mean": 698.14}
{"timesteps_since_restore": 4696822, "policy_reward_mean": {}, "episode_reward_max": 800.536904174548, "time_total_s": 2751.352771282196, "info": {"num_steps_sampled": 4696822, "sample_time_ms": 12989.711, "grad_time_ms": 8341.912, "update_time_ms": 6.578, "default": {"kl": 0.015443253330886364, "entropy": 0.9603123068809509, "cur_lr": 0.0005000000237487257, "total_loss": 11.115464210510254, "policy_loss": -0.0077670118771493435, "vf_explained_var": 0.9219509363174438, "vf_loss": 11.119933128356934, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 4696822, "load_time_ms": 11.028}, "custom_metrics": {"cost1_mean": 287.07503401104583, "outflow_rate_max": 1077.6744346266437, "system_level_velocity_mean": 11.237863914942622, "cost1_min": 227.86096012147567, "cost1_max": 352.77009983913683, "outflow_rate_min": 797.9373671119215, "cost2_mean": -125.62207183360756, "outflow_rate_mean": 922.4955475406967, "system_level_velocity_min": 9.251429499436226, "cost2_min": -147.02163488556937, "system_level_velocity_max": 13.331784510782878, "cost2_max": -106.68071907228125}, "node_ip": "10.138.0.2", "iterations_since_restore": 124, "done": false, "episodes_total": 2223, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f808d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80c50>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 677.2718065871691, "episode_reward_min": 496.56168262494106, "timesteps_total": 4696822, "time_since_restore": 2751.352771282196, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35601, "pid": 25319, "episodes_this_iter": 17, "timestamp": 1557192335, "time_this_iter_s": 20.741929054260254, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 124, "date": "2019-05-07_01-25-35", "episode_len_mean": 698.14}
{"timesteps_since_restore": 4732962, "policy_reward_mean": {}, "episode_reward_max": 800.536904174548, "time_total_s": 2773.5425691604614, "info": {"num_steps_sampled": 4732962, "sample_time_ms": 13084.624, "grad_time_ms": 8332.313, "update_time_ms": 6.62, "default": {"kl": 0.017257900908589363, "entropy": 0.964252769947052, "cur_lr": 0.0005000000237487257, "total_loss": 18.504169464111328, "policy_loss": -0.00914471223950386, "vf_explained_var": 0.8745378255844116, "vf_loss": 18.509628295898438, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 4732962, "load_time_ms": 11.065}, "custom_metrics": {"cost1_mean": 287.22020079824995, "outflow_rate_max": 1128.7726977112031, "system_level_velocity_mean": 11.381046245703631, "cost1_min": 85.94026891635004, "cost1_max": 378.47888037143446, "outflow_rate_min": 601.2531338042064, "cost2_mean": -125.66953594551966, "outflow_rate_mean": 922.4308387328102, "system_level_velocity_min": 9.251429499436226, "cost2_min": -147.02163488556937, "system_level_velocity_max": 17.950843676527814, "cost2_max": -60.99077210355245}, "node_ip": "10.138.0.2", "iterations_since_restore": 125, "done": false, "episodes_total": 2244, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062892b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289048>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 666.2235594617403, "episode_reward_min": 151.54281629755488, "timesteps_total": 4732962, "time_since_restore": 2773.5425691604614, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36140, "pid": 25319, "episodes_this_iter": 21, "timestamp": 1557192357, "time_this_iter_s": 22.18979787826538, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 125, "date": "2019-05-07_01-25-57", "episode_len_mean": 692.41}
{"timesteps_since_restore": 4769183, "policy_reward_mean": {}, "episode_reward_max": 847.0463399288523, "time_total_s": 2794.23197722435, "info": {"num_steps_sampled": 4769183, "sample_time_ms": 12932.168, "grad_time_ms": 8285.998, "update_time_ms": 6.626, "default": {"kl": 0.015277473255991936, "entropy": 0.9546365737915039, "cur_lr": 0.0005000000237487257, "total_loss": 13.89263916015625, "policy_loss": -0.00369844026863575, "vf_explained_var": 0.9096062779426575, "vf_loss": 13.893074035644531, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 4769183, "load_time_ms": 10.629}, "custom_metrics": {"cost1_mean": 287.2073678609578, "outflow_rate_max": 1185.253872454618, "system_level_velocity_mean": 11.549607691525669, "cost1_min": 41.969302227330495, "cost1_max": 393.7443148679947, "outflow_rate_min": 473.2339493388826, "cost2_mean": -125.27064734303559, "outflow_rate_mean": 922.070954414402, "system_level_velocity_min": 9.251429499436226, "cost2_min": -163.87589564324392, "system_level_velocity_max": 18.562935754263258, "cost2_max": -32.170531948102834}, "node_ip": "10.138.0.2", "iterations_since_restore": 126, "done": false, "episodes_total": 2261, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a59e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5208>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 658.3205552675173, "episode_reward_min": 75.90442010171625, "timesteps_total": 4769183, "time_since_restore": 2794.23197722435, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36221, "pid": 25319, "episodes_this_iter": 17, "timestamp": 1557192378, "time_this_iter_s": 20.68940806388855, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 126, "date": "2019-05-07_01-26-18", "episode_len_mean": 686.03}
{"timesteps_since_restore": 4806537, "policy_reward_mean": {}, "episode_reward_max": 847.0463399288523, "time_total_s": 2815.383930683136, "info": {"num_steps_sampled": 4806537, "sample_time_ms": 12932.233, "grad_time_ms": 8269.566, "update_time_ms": 6.609, "default": {"kl": 0.0139562813565135, "entropy": 0.9314278364181519, "cur_lr": 0.0005000000237487257, "total_loss": 15.168911933898926, "policy_loss": -0.00764320557937026, "vf_explained_var": 0.9036630392074585, "vf_loss": 15.17357349395752, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 4806537, "load_time_ms": 10.497}, "custom_metrics": {"cost1_mean": 289.0145458364115, "outflow_rate_max": 1185.253872454618, "system_level_velocity_mean": 11.598512807133234, "cost1_min": 41.969302227330495, "cost1_max": 393.7443148679947, "outflow_rate_min": 473.2339493388826, "cost2_mean": -126.47848722536239, "outflow_rate_mean": 924.9934871514492, "system_level_velocity_min": 9.388838207645321, "cost2_min": -163.87589564324392, "system_level_velocity_max": 18.562935754263258, "cost2_max": -32.170531948102834}, "node_ip": "10.138.0.2", "iterations_since_restore": 127, "done": false, "episodes_total": 2281, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062899b0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 659.9755841761876, "episode_reward_min": 75.90442010171625, "timesteps_total": 4806537, "time_since_restore": 2815.383930683136, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37354, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557192399, "time_this_iter_s": 21.15195345878601, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 127, "date": "2019-05-07_01-26-39", "episode_len_mean": 687.89}
{"timesteps_since_restore": 4843767, "policy_reward_mean": {}, "episode_reward_max": 847.0463399288523, "time_total_s": 2837.445048093796, "info": {"num_steps_sampled": 4843767, "sample_time_ms": 13027.603, "grad_time_ms": 8300.104, "update_time_ms": 6.635, "default": {"kl": 0.015105454251170158, "entropy": 0.9325500726699829, "cur_lr": 0.0005000000237487257, "total_loss": 15.549155235290527, "policy_loss": -0.00955174770206213, "vf_explained_var": 0.8948448300361633, "vf_loss": 15.555479049682617, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 4843767, "load_time_ms": 10.416}, "custom_metrics": {"cost1_mean": 288.8219770315689, "outflow_rate_max": 1185.253872454618, "system_level_velocity_mean": 11.600935385066299, "cost1_min": 41.969302227330495, "cost1_max": 393.7443148679947, "outflow_rate_min": 473.2339493388826, "cost2_mean": -126.14659699057769, "outflow_rate_mean": 923.8607745124464, "system_level_velocity_min": 8.891361437300388, "cost2_min": -163.87589564324392, "system_level_velocity_max": 18.562935754263258, "cost2_max": -32.170531948102834}, "node_ip": "10.138.0.2", "iterations_since_restore": 128, "done": false, "episodes_total": 2301, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a59e8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 656.9752565320322, "episode_reward_min": 75.90442010171625, "timesteps_total": 4843767, "time_since_restore": 2837.445048093796, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37230, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557192421, "time_this_iter_s": 22.06111741065979, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 128, "date": "2019-05-07_01-27-01", "episode_len_mean": 687.89}
{"timesteps_since_restore": 4880589, "policy_reward_mean": {}, "episode_reward_max": 847.0463399288523, "time_total_s": 2858.9811882972717, "info": {"num_steps_sampled": 4880589, "sample_time_ms": 13114.869, "grad_time_ms": 8317.541, "update_time_ms": 6.65, "default": {"kl": 0.014374190010130405, "entropy": 0.9482869505882263, "cur_lr": 0.0005000000237487257, "total_loss": 15.601770401000977, "policy_loss": -0.007948355749249458, "vf_explained_var": 0.9019559621810913, "vf_loss": 15.606647491455078, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 4880589, "load_time_ms": 10.334}, "custom_metrics": {"cost1_mean": 291.2827848540096, "outflow_rate_max": 1185.253872454618, "system_level_velocity_mean": 11.688882505172394, "cost1_min": 41.969302227330495, "cost1_max": 393.7443148679947, "outflow_rate_min": 473.2339493388826, "cost2_mean": -126.9143535728108, "outflow_rate_mean": 929.4279136606638, "system_level_velocity_min": 8.891361437300388, "cost2_min": -163.87589564324392, "system_level_velocity_max": 18.562935754263258, "cost2_max": -32.170531948102834}, "node_ip": "10.138.0.2", "iterations_since_restore": 129, "done": false, "episodes_total": 2321, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289f28>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 656.4239714748259, "episode_reward_min": 75.90442010171625, "timesteps_total": 4880589, "time_since_restore": 2858.9811882972717, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36822, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557192443, "time_this_iter_s": 21.536140203475952, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 129, "date": "2019-05-07_01-27-23", "episode_len_mean": 687.89}
{"timesteps_since_restore": 4916819, "policy_reward_mean": {}, "episode_reward_max": 847.0463399288523, "time_total_s": 2879.695433139801, "info": {"num_steps_sampled": 4916819, "sample_time_ms": 12995.17, "grad_time_ms": 8279.468, "update_time_ms": 6.655, "default": {"kl": 0.015167145058512688, "entropy": 0.9490591287612915, "cur_lr": 0.0005000000237487257, "total_loss": 12.26049518585205, "policy_loss": -0.009160855785012245, "vf_explained_var": 0.9230521321296692, "vf_loss": 12.266416549682617, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 4916819, "load_time_ms": 10.304}, "custom_metrics": {"cost1_mean": 291.46141073753637, "outflow_rate_max": 1185.253872454618, "system_level_velocity_mean": 11.57488244223728, "cost1_min": 41.969302227330495, "cost1_max": 393.7443148679947, "outflow_rate_min": 473.2339493388826, "cost2_mean": -127.20131396957633, "outflow_rate_mean": 929.0673712428325, "system_level_velocity_min": 8.891361437300388, "cost2_min": -163.87589564324392, "system_level_velocity_max": 18.562935754263258, "cost2_max": -32.170531948102834}, "node_ip": "10.138.0.2", "iterations_since_restore": 130, "done": false, "episodes_total": 2339, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062666a0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 666.1826391876676, "episode_reward_min": 75.90442010171625, "timesteps_total": 4916819, "time_since_restore": 2879.695433139801, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36230, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557192463, "time_this_iter_s": 20.714244842529297, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 130, "date": "2019-05-07_01-27-43", "episode_len_mean": 693.62}
{"timesteps_since_restore": 4952352, "policy_reward_mean": {}, "episode_reward_max": 790.967159258278, "time_total_s": 2900.1935188770294, "info": {"num_steps_sampled": 4952352, "sample_time_ms": 12930.884, "grad_time_ms": 8168.285, "update_time_ms": 6.673, "default": {"kl": 0.014362205751240253, "entropy": 0.9478633999824524, "cur_lr": 0.0005000000237487257, "total_loss": 14.253615379333496, "policy_loss": -0.006287985946983099, "vf_explained_var": 0.9100601077079773, "vf_loss": 14.256836891174316, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 4952352, "load_time_ms": 10.06}, "custom_metrics": {"cost1_mean": 295.39405843920883, "outflow_rate_max": 1115.2973423855744, "system_level_velocity_mean": 11.572802667577717, "cost1_min": 222.27496707914733, "cost1_max": 375.206162165657, "outflow_rate_min": 812.2496462630778, "cost2_mean": -128.02942747338687, "outflow_rate_mean": 936.3522680539661, "system_level_velocity_min": 8.891361437300388, "cost2_min": -152.24962770049942, "system_level_velocity_max": 14.374644876073134, "cost2_max": -102.32014648327451}, "node_ip": "10.138.0.2", "iterations_since_restore": 131, "done": false, "episodes_total": 2354, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062899b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289f28>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 673.966109115562, "episode_reward_min": 510.9206021182422, "timesteps_total": 4952352, "time_since_restore": 2900.1935188770294, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35533, "pid": 25319, "episodes_this_iter": 15, "timestamp": 1557192484, "time_this_iter_s": 20.498085737228394, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 131, "date": "2019-05-07_01-28-04", "episode_len_mean": 699.17}
{"timesteps_since_restore": 4988813, "policy_reward_mean": {}, "episode_reward_max": 790.967159258278, "time_total_s": 2921.138432741165, "info": {"num_steps_sampled": 4988813, "sample_time_ms": 12908.795, "grad_time_ms": 8141.07, "update_time_ms": 6.791, "default": {"kl": 0.014056358486413956, "entropy": 0.9382321834564209, "cur_lr": 0.0005000000237487257, "total_loss": 13.68666934967041, "policy_loss": -0.00811251625418663, "vf_explained_var": 0.9131776094436646, "vf_loss": 13.691780090332031, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 4988813, "load_time_ms": 10.108}, "custom_metrics": {"cost1_mean": 293.7419856908376, "outflow_rate_max": 1115.2973423855744, "system_level_velocity_mean": 11.523797459718129, "cost1_min": 222.27496707914733, "cost1_max": 375.206162165657, "outflow_rate_min": 812.2496462630778, "cost2_mean": -127.97825820249174, "outflow_rate_mean": 932.2146702487189, "system_level_velocity_min": 8.891361437300388, "cost2_min": -152.24962770049942, "system_level_velocity_max": 14.374644876073134, "cost2_max": -102.32014648327451}, "node_ip": "10.138.0.2", "iterations_since_restore": 132, "done": false, "episodes_total": 2372, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540626ae80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cf98>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 670.7331639147699, "episode_reward_min": 510.9206021182422, "timesteps_total": 4988813, "time_since_restore": 2921.138432741165, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36461, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557192505, "time_this_iter_s": 20.944913864135742, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 132, "date": "2019-05-07_01-28-25", "episode_len_mean": 699.17}
{"timesteps_since_restore": 5026541, "policy_reward_mean": {}, "episode_reward_max": 790.967159258278, "time_total_s": 2942.8646919727325, "info": {"num_steps_sampled": 5026541, "sample_time_ms": 12949.826, "grad_time_ms": 8190.413, "update_time_ms": 6.925, "default": {"kl": 0.014033989049494267, "entropy": 0.9274111390113831, "cur_lr": 0.0005000000237487257, "total_loss": 14.933147430419922, "policy_loss": -0.005720798391848803, "vf_explained_var": 0.9073214530944824, "vf_loss": 14.935869216918945, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 5026541, "load_time_ms": 9.954}, "custom_metrics": {"cost1_mean": 295.33659481676824, "outflow_rate_max": 1115.2973423855744, "system_level_velocity_mean": 11.589804104896336, "cost1_min": 224.51402966540078, "cost1_max": 375.206162165657, "outflow_rate_min": 808.4283356160005, "cost2_mean": -129.0516183176288, "outflow_rate_mean": 935.3244054170963, "system_level_velocity_min": 9.34982770653368, "cost2_min": -152.24962770049942, "system_level_velocity_max": 14.374644876073134, "cost2_max": -102.32014648327451}, "node_ip": "10.138.0.2", "iterations_since_restore": 133, "done": false, "episodes_total": 2392, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062899b0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 675.4395551280816, "episode_reward_min": 510.9206021182422, "timesteps_total": 5026541, "time_since_restore": 2942.8646919727325, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37728, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557192526, "time_this_iter_s": 21.726259231567383, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 133, "date": "2019-05-07_01-28-46", "episode_len_mean": 699.17}
{"timesteps_since_restore": 5062574, "policy_reward_mean": {}, "episode_reward_max": 790.967159258278, "time_total_s": 2964.0939354896545, "info": {"num_steps_sampled": 5062574, "sample_time_ms": 12978.603, "grad_time_ms": 8209.846, "update_time_ms": 6.93, "default": {"kl": 0.01519782841205597, "entropy": 0.9331912398338318, "cur_lr": 0.0005000000237487257, "total_loss": 16.84246826171875, "policy_loss": -0.008788402192294598, "vf_explained_var": 0.8926839828491211, "vf_loss": 16.848011016845703, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 5062574, "load_time_ms": 9.931}, "custom_metrics": {"cost1_mean": 290.55599628720154, "outflow_rate_max": 1072.6957117435554, "system_level_velocity_mean": 11.596671290997428, "cost1_min": 38.0533574575886, "cost1_max": 357.15085825720814, "outflow_rate_min": 447.16476711609437, "cost2_mean": -127.82695424648823, "outflow_rate_mean": 926.1494316293096, "system_level_velocity_min": 9.34982770653368, "cost2_min": -153.22680719527463, "system_level_velocity_max": 18.613879115429345, "cost2_max": -33.71318388840096}, "node_ip": "10.138.0.2", "iterations_since_restore": 134, "done": false, "episodes_total": 2413, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cf98>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 667.3976571027329, "episode_reward_min": 68.40848902999562, "timesteps_total": 5062574, "time_since_restore": 2964.0939354896545, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36033, "pid": 25319, "episodes_this_iter": 21, "timestamp": 1557192548, "time_this_iter_s": 21.229243516921997, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 134, "date": "2019-05-07_01-29-08", "episode_len_mean": 692.73}
{"timesteps_since_restore": 5098755, "policy_reward_mean": {}, "episode_reward_max": 790.967159258278, "time_total_s": 2985.594652414322, "info": {"num_steps_sampled": 5098755, "sample_time_ms": 12885.596, "grad_time_ms": 8233.153, "update_time_ms": 6.93, "default": {"kl": 0.015574230812489986, "entropy": 0.9282421469688416, "cur_lr": 0.0005000000237487257, "total_loss": 16.33101463317871, "policy_loss": -0.00863176304847002, "vf_explained_var": 0.9056286811828613, "vf_loss": 16.336318969726562, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 5098755, "load_time_ms": 9.902}, "custom_metrics": {"cost1_mean": 299.14482372173245, "outflow_rate_max": 1134.1627575773, "system_level_velocity_mean": 11.912958361403003, "cost1_min": 38.0533574575886, "cost1_max": 380.273603736753, "outflow_rate_min": 447.16476711609437, "cost2_mean": -129.10515515683974, "outflow_rate_mean": 944.8097093783912, "system_level_velocity_min": 9.533673173471806, "cost2_min": -153.22680719527463, "system_level_velocity_max": 18.613879115429345, "cost2_max": -33.71318388840096}, "node_ip": "10.138.0.2", "iterations_since_restore": 135, "done": false, "episodes_total": 2433, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289668>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 672.7168284270116, "episode_reward_min": 68.40848902999562, "timesteps_total": 5098755, "time_since_restore": 2985.594652414322, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36181, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557192569, "time_this_iter_s": 21.50071692466736, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 135, "date": "2019-05-07_01-29-29", "episode_len_mean": 692.73}
{"timesteps_since_restore": 5134784, "policy_reward_mean": {}, "episode_reward_max": 898.1568483644907, "time_total_s": 3007.408891439438, "info": {"num_steps_sampled": 5134784, "sample_time_ms": 12981.55, "grad_time_ms": 8248.749, "update_time_ms": 7.052, "default": {"kl": 0.014489377848803997, "entropy": 0.9457052946090698, "cur_lr": 0.0005000000237487257, "total_loss": 15.835296630859375, "policy_loss": -0.009278982877731323, "vf_explained_var": 0.9048813581466675, "vf_loss": 15.841480255126953, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 5134784, "load_time_ms": 10.149}, "custom_metrics": {"cost1_mean": 300.46075717948725, "outflow_rate_max": 1246.4055150509218, "system_level_velocity_mean": 11.965955043651496, "cost1_min": 38.0533574575886, "cost1_max": 430.2480594124908, "outflow_rate_min": 447.16476711609437, "cost2_mean": -129.47427479610678, "outflow_rate_mean": 946.3633641475247, "system_level_velocity_min": 9.533673173471806, "cost2_min": -153.22680719527463, "system_level_velocity_max": 18.613879115429345, "cost2_max": -33.71318388840096}, "node_ip": "10.138.0.2", "iterations_since_restore": 136, "done": false, "episodes_total": 2453, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f845f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f844e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84d68>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 671.2748162135758, "episode_reward_min": 68.40848902999562, "timesteps_total": 5134784, "time_since_restore": 3007.408891439438, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36029, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557192591, "time_this_iter_s": 21.814239025115967, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 136, "date": "2019-05-07_01-29-51", "episode_len_mean": 693.56}
{"timesteps_since_restore": 5170450, "policy_reward_mean": {}, "episode_reward_max": 898.1568483644907, "time_total_s": 3028.773469209671, "info": {"num_steps_sampled": 5170450, "sample_time_ms": 13015.412, "grad_time_ms": 8236.446, "update_time_ms": 7.032, "default": {"kl": 0.013591243885457516, "entropy": 0.9575320482254028, "cur_lr": 0.0005000000237487257, "total_loss": 12.599096298217773, "policy_loss": -0.007900712080299854, "vf_explained_var": 0.9243502020835876, "vf_loss": 12.604095458984375, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 5170450, "load_time_ms": 10.462}, "custom_metrics": {"cost1_mean": 303.2834018009384, "outflow_rate_max": 1246.4055150509218, "system_level_velocity_mean": 12.077065062368991, "cost1_min": 38.0533574575886, "cost1_max": 430.2480594124908, "outflow_rate_min": 447.16476711609437, "cost2_mean": -128.6364028532111, "outflow_rate_mean": 950.837931490127, "system_level_velocity_min": 9.533673173471806, "cost2_min": -153.22680719527463, "system_level_velocity_max": 18.613879115429345, "cost2_max": -33.71318388840096}, "node_ip": "10.138.0.2", "iterations_since_restore": 137, "done": false, "episodes_total": 2471, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289f28>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 670.1108513360571, "episode_reward_min": 68.40848902999562, "timesteps_total": 5170450, "time_since_restore": 3028.773469209671, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35666, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557192613, "time_this_iter_s": 21.364577770233154, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 137, "date": "2019-05-07_01-30-13", "episode_len_mean": 693.56}
{"timesteps_since_restore": 5206233, "policy_reward_mean": {}, "episode_reward_max": 898.1568483644907, "time_total_s": 3049.6083047389984, "info": {"num_steps_sampled": 5206233, "sample_time_ms": 12888.669, "grad_time_ms": 8240.64, "update_time_ms": 6.959, "default": {"kl": 0.014163203537464142, "entropy": 0.9617249369621277, "cur_lr": 0.0005000000237487257, "total_loss": 12.522687911987305, "policy_loss": -0.0073738181963562965, "vf_explained_var": 0.9167397022247314, "vf_loss": 12.527036666870117, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 5206233, "load_time_ms": 10.566}, "custom_metrics": {"cost1_mean": 301.88150615171156, "outflow_rate_max": 1246.4055150509218, "system_level_velocity_mean": 12.189918125250683, "cost1_min": 18.793013377565742, "cost1_max": 430.2480594124908, "outflow_rate_min": 436.5771272776546, "cost2_mean": -127.15098530829205, "outflow_rate_mean": 948.1142554134806, "system_level_velocity_min": 9.533673173471806, "cost2_min": -153.22680719527463, "system_level_velocity_max": 18.613879115429345, "cost2_max": -16.717120763449582}, "node_ip": "10.138.0.2", "iterations_since_restore": 138, "done": false, "episodes_total": 2485, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c1d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cf98>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 664.7376019024146, "episode_reward_min": 32.33579323851248, "timesteps_total": 5206233, "time_since_restore": 3049.6083047389984, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35783, "pid": 25319, "episodes_this_iter": 14, "timestamp": 1557192633, "time_this_iter_s": 20.834835529327393, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 138, "date": "2019-05-07_01-30-33", "episode_len_mean": 686.84}
{"timesteps_since_restore": 5242781, "policy_reward_mean": {}, "episode_reward_max": 898.1568483644907, "time_total_s": 3070.9697527885437, "info": {"num_steps_sampled": 5242781, "sample_time_ms": 12884.98, "grad_time_ms": 8225.285, "update_time_ms": 6.918, "default": {"kl": 0.015649328008294106, "entropy": 0.9430701732635498, "cur_lr": 0.0005000000237487257, "total_loss": 11.947884559631348, "policy_loss": -0.009415342472493649, "vf_explained_var": 0.926737368106842, "vf_loss": 11.953956604003906, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 5242781, "load_time_ms": 11.13}, "custom_metrics": {"cost1_mean": 307.15214120872713, "outflow_rate_max": 1246.4055150509218, "system_level_velocity_mean": 12.27169218026394, "cost1_min": 18.793013377565742, "cost1_max": 430.2480594124908, "outflow_rate_min": 436.5771272776546, "cost2_mean": -127.05053252885244, "outflow_rate_mean": 958.6242654989569, "system_level_velocity_min": 9.12684672012317, "cost2_min": -152.20259412461863, "system_level_velocity_max": 17.898720865534624, "cost2_max": -16.717120763449582}, "node_ip": "10.138.0.2", "iterations_since_restore": 139, "done": false, "episodes_total": 2506, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062898d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289438>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 667.9140521904523, "episode_reward_min": 32.33579323851248, "timesteps_total": 5242781, "time_since_restore": 3070.9697527885437, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36548, "pid": 25319, "episodes_this_iter": 21, "timestamp": 1557192655, "time_this_iter_s": 21.361448049545288, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 139, "date": "2019-05-07_01-30-55", "episode_len_mean": 689.91}
{"timesteps_since_restore": 5280184, "policy_reward_mean": {}, "episode_reward_max": 898.1568483644907, "time_total_s": 3092.064037322998, "info": {"num_steps_sampled": 5280184, "sample_time_ms": 12950.161, "grad_time_ms": 8197.254, "update_time_ms": 6.935, "default": {"kl": 0.017988085746765137, "entropy": 0.9670511484146118, "cur_lr": 0.0005000000237487257, "total_loss": 15.207708358764648, "policy_loss": -0.010301683098077774, "vf_explained_var": 0.8890408873558044, "vf_loss": 15.214168548583984, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 5280184, "load_time_ms": 11.923}, "custom_metrics": {"cost1_mean": 303.2465361970313, "outflow_rate_max": 1246.4055150509218, "system_level_velocity_mean": 12.11964666586894, "cost1_min": 18.793013377565742, "cost1_max": 430.2480594124908, "outflow_rate_min": 436.5771272776546, "cost2_mean": -125.62035485481329, "outflow_rate_mean": 950.7440485848019, "system_level_velocity_min": 9.12684672012317, "cost2_min": -152.20259412461863, "system_level_velocity_max": 17.898720865534624, "cost2_max": -16.717120763449582}, "node_ip": "10.138.0.2", "iterations_since_restore": 140, "done": false, "episodes_total": 2526, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c1d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c0b8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 663.6938762851834, "episode_reward_min": 32.33579323851248, "timesteps_total": 5280184, "time_since_restore": 3092.064037322998, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37403, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557192676, "time_this_iter_s": 21.094284534454346, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 140, "date": "2019-05-07_01-31-16", "episode_len_mean": 689.91}
{"timesteps_since_restore": 5317026, "policy_reward_mean": {}, "episode_reward_max": 786.8465120335484, "time_total_s": 3113.363960981369, "info": {"num_steps_sampled": 5317026, "sample_time_ms": 12979.864, "grad_time_ms": 8246.875, "update_time_ms": 6.819, "default": {"kl": 0.015737779438495636, "entropy": 0.952221691608429, "cur_lr": 0.0005000000237487257, "total_loss": 10.850566864013672, "policy_loss": -0.009293714538216591, "vf_explained_var": 0.9321740865707397, "vf_loss": 10.856500625610352, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 5317026, "load_time_ms": 12.591}, "custom_metrics": {"cost1_mean": 300.0514678585412, "outflow_rate_max": 1096.1158740851254, "system_level_velocity_mean": 11.992643537165568, "cost1_min": 18.793013377565742, "cost1_max": 376.7349847516772, "outflow_rate_min": 436.5771272776546, "cost2_mean": -125.02400196032713, "outflow_rate_mean": 945.5828844533568, "system_level_velocity_min": 9.12684672012317, "cost2_min": -143.10494428004137, "system_level_velocity_max": 17.898720865534624, "cost2_max": -16.717120763449582}, "node_ip": "10.138.0.2", "iterations_since_restore": 141, "done": false, "episodes_total": 2546, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84208>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 663.1985931216727, "episode_reward_min": 32.33579323851248, "timesteps_total": 5317026, "time_since_restore": 3113.363960981369, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36842, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557192697, "time_this_iter_s": 21.29992365837097, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 141, "date": "2019-05-07_01-31-37", "episode_len_mean": 689.91}
{"timesteps_since_restore": 5354045, "policy_reward_mean": {}, "episode_reward_max": 942.4993240177942, "time_total_s": 3134.973079919815, "info": {"num_steps_sampled": 5354045, "sample_time_ms": 13054.594, "grad_time_ms": 8238.451, "update_time_ms": 6.844, "default": {"kl": 0.018119098618626595, "entropy": 0.9672585725784302, "cur_lr": 0.0005000000237487257, "total_loss": 16.975746154785156, "policy_loss": -0.00910696480423212, "vf_explained_var": 0.8840271830558777, "vf_loss": 16.980981826782227, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 5354045, "load_time_ms": 12.741}, "custom_metrics": {"cost1_mean": 299.84082891757487, "outflow_rate_max": 1227.0127307963992, "system_level_velocity_mean": 12.132201642110514, "cost1_min": 18.793013377565742, "cost1_max": 422.39548102974067, "outflow_rate_min": 436.5771272776546, "cost2_mean": -123.74751612363274, "outflow_rate_mean": 946.3271793609243, "system_level_velocity_min": 9.12684672012317, "cost2_min": -153.4609534506228, "system_level_velocity_max": 18.693831427326007, "cost2_max": -16.717120763449582}, "node_ip": "10.138.0.2", "iterations_since_restore": 142, "done": false, "episodes_total": 2567, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f805c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80198>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 663.6196332968404, "episode_reward_min": 32.33579323851248, "timesteps_total": 5354045, "time_since_restore": 3134.973079919815, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37019, "pid": 25319, "episodes_this_iter": 21, "timestamp": 1557192719, "time_this_iter_s": 21.609118938446045, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 142, "date": "2019-05-07_01-31-59", "episode_len_mean": 683.33}
{"timesteps_since_restore": 5390369, "policy_reward_mean": {}, "episode_reward_max": 942.4993240177942, "time_total_s": 3156.129315853119, "info": {"num_steps_sampled": 5390369, "sample_time_ms": 13042.463, "grad_time_ms": 8193.267, "update_time_ms": 6.757, "default": {"kl": 0.015621050260961056, "entropy": 0.9619991183280945, "cur_lr": 0.0005000000237487257, "total_loss": 14.37517261505127, "policy_loss": -0.008016679435968399, "vf_explained_var": 0.9054660201072693, "vf_loss": 14.379852294921875, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 5390369, "load_time_ms": 12.995}, "custom_metrics": {"cost1_mean": 305.39770663634147, "outflow_rate_max": 1227.0127307963992, "system_level_velocity_mean": 12.08912374249601, "cost1_min": 27.924728630587225, "cost1_max": 422.39548102974067, "outflow_rate_min": 437.40194710690065, "cost2_mean": -123.928084879572, "outflow_rate_mean": 956.6143590862356, "system_level_velocity_min": 9.12684672012317, "cost2_min": -153.4609534506228, "system_level_velocity_max": 18.693831427326007, "cost2_max": -25.276794218286184}, "node_ip": "10.138.0.2", "iterations_since_restore": 143, "done": false, "episodes_total": 2587, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540626ae80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f807b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289c50>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 673.1229158839742, "episode_reward_min": 49.54801784820824, "timesteps_total": 5390369, "time_since_restore": 3156.129315853119, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36324, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557192740, "time_this_iter_s": 21.156235933303833, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 143, "date": "2019-05-07_01-32-20", "episode_len_mean": 693.42}
{"timesteps_since_restore": 5425779, "policy_reward_mean": {}, "episode_reward_max": 942.4993240177942, "time_total_s": 3177.405100107193, "info": {"num_steps_sampled": 5425779, "sample_time_ms": 13061.987, "grad_time_ms": 8179.312, "update_time_ms": 6.743, "default": {"kl": 0.015962285920977592, "entropy": 0.9623249173164368, "cur_lr": 0.0005000000237487257, "total_loss": 12.326659202575684, "policy_loss": -0.007798417937010527, "vf_explained_var": 0.9093311429023743, "vf_loss": 12.331048965454102, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 5425779, "load_time_ms": 13.04}, "custom_metrics": {"cost1_mean": 300.0928395982004, "outflow_rate_max": 1227.0127307963992, "system_level_velocity_mean": 11.894905870359894, "cost1_min": 27.924728630587225, "cost1_max": 422.39548102974067, "outflow_rate_min": 437.40194710690065, "cost2_mean": -122.88715200799585, "outflow_rate_mean": 946.4484853066876, "system_level_velocity_min": 9.947128806356805, "cost2_min": -153.4609534506228, "system_level_velocity_max": 18.693831427326007, "cost2_max": -25.276794218286184}, "node_ip": "10.138.0.2", "iterations_since_restore": 144, "done": false, "episodes_total": 2607, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f808d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84fd0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 668.9876672844871, "episode_reward_min": 49.54801784820824, "timesteps_total": 5425779, "time_since_restore": 3177.405100107193, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35410, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557192761, "time_this_iter_s": 21.275784254074097, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 144, "date": "2019-05-07_01-32-41", "episode_len_mean": 693.42}
{"timesteps_since_restore": 5461102, "policy_reward_mean": {}, "episode_reward_max": 942.4993240177942, "time_total_s": 3198.082401037216, "info": {"num_steps_sampled": 5461102, "sample_time_ms": 13006.715, "grad_time_ms": 8152.177, "update_time_ms": 6.712, "default": {"kl": 0.014348354190587997, "entropy": 0.9780009388923645, "cur_lr": 0.0005000000237487257, "total_loss": 9.140551567077637, "policy_loss": -0.008998044766485691, "vf_explained_var": 0.9256412982940674, "vf_loss": 9.146484375, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 5461102, "load_time_ms": 13.205}, "custom_metrics": {"cost1_mean": 300.73932338555073, "outflow_rate_max": 1227.0127307963992, "system_level_velocity_mean": 11.906328729681897, "cost1_min": 27.924728630587225, "cost1_max": 422.39548102974067, "outflow_rate_min": 437.40194710690065, "cost2_mean": -122.26278432748772, "outflow_rate_mean": 947.3796084005241, "system_level_velocity_min": 9.662522344613148, "cost2_min": -153.4609534506228, "system_level_velocity_max": 18.693831427326007, "cost2_max": -25.276794218286184}, "node_ip": "10.138.0.2", "iterations_since_restore": 145, "done": false, "episodes_total": 2621, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f807b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80048>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 667.975544846096, "episode_reward_min": 49.54801784820824, "timesteps_total": 5461102, "time_since_restore": 3198.082401037216, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35323, "pid": 25319, "episodes_this_iter": 14, "timestamp": 1557192782, "time_this_iter_s": 20.677300930023193, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 145, "date": "2019-05-07_01-33-02", "episode_len_mean": 693.42}
{"timesteps_since_restore": 5497362, "policy_reward_mean": {}, "episode_reward_max": 942.4993240177942, "time_total_s": 3218.5528168678284, "info": {"num_steps_sampled": 5497362, "sample_time_ms": 12907.765, "grad_time_ms": 8116.626, "update_time_ms": 6.648, "default": {"kl": 0.014317262917757034, "entropy": 0.9876327514648438, "cur_lr": 0.0005000000237487257, "total_loss": 11.459081649780273, "policy_loss": -0.009513246826827526, "vf_explained_var": 0.9086097478866577, "vf_loss": 11.465538024902344, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 5497362, "load_time_ms": 13.677}, "custom_metrics": {"cost1_mean": 295.2162377909405, "outflow_rate_max": 1227.0127307963992, "system_level_velocity_mean": 11.861138352124545, "cost1_min": 27.924728630587225, "cost1_max": 422.39548102974067, "outflow_rate_min": 437.40194710690065, "cost2_mean": -120.47991836876093, "outflow_rate_mean": 936.835124197718, "system_level_velocity_min": 9.568917776102246, "cost2_min": -153.4609534506228, "system_level_velocity_max": 18.693831427326007, "cost2_max": -25.276794218286184}, "node_ip": "10.138.0.2", "iterations_since_restore": 146, "done": false, "episodes_total": 2639, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80160>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 658.5682433063439, "episode_reward_min": 49.54801784820824, "timesteps_total": 5497362, "time_since_restore": 3218.5528168678284, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36260, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557192803, "time_this_iter_s": 20.470415830612183, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 146, "date": "2019-05-07_01-33-23", "episode_len_mean": 686.96}
{"timesteps_since_restore": 5534669, "policy_reward_mean": {}, "episode_reward_max": 921.3666491036134, "time_total_s": 3240.098746776581, "info": {"num_steps_sampled": 5534669, "sample_time_ms": 12890.356, "grad_time_ms": 8151.309, "update_time_ms": 6.693, "default": {"kl": 0.01760765351355076, "entropy": 0.9744683504104614, "cur_lr": 0.0005000000237487257, "total_loss": 11.024145126342773, "policy_loss": -0.009106469340622425, "vf_explained_var": 0.9206146597862244, "vf_loss": 11.029492378234863, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 5534669, "load_time_ms": 13.852}, "custom_metrics": {"cost1_mean": 293.12604484114394, "outflow_rate_max": 1204.2418593545738, "system_level_velocity_mean": 11.613990230140548, "cost1_min": 36.092447889055876, "cost1_max": 413.9152983085381, "outflow_rate_min": 458.3356077923883, "cost2_mean": -119.20559240053353, "outflow_rate_mean": 929.9707553826919, "system_level_velocity_min": 9.568917776102246, "cost2_min": -164.93807550733985, "system_level_velocity_max": 18.567087477124133, "cost2_max": -27.32740354743099}, "node_ip": "10.138.0.2", "iterations_since_restore": 147, "done": false, "episodes_total": 2658, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c0b8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 654.8276249084084, "episode_reward_min": 57.507897899133845, "timesteps_total": 5534669, "time_since_restore": 3240.098746776581, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37307, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557192824, "time_this_iter_s": 21.54592990875244, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 147, "date": "2019-05-07_01-33-44", "episode_len_mean": 693.54}
{"timesteps_since_restore": 5571744, "policy_reward_mean": {}, "episode_reward_max": 921.3666491036134, "time_total_s": 3261.6792182922363, "info": {"num_steps_sampled": 5571744, "sample_time_ms": 12963.299, "grad_time_ms": 8152.161, "update_time_ms": 6.768, "default": {"kl": 0.01605372317135334, "entropy": 1.0049411058425903, "cur_lr": 0.0005000000237487257, "total_loss": 11.969233512878418, "policy_loss": -0.006782034412026405, "vf_explained_var": 0.9103275537490845, "vf_loss": 11.972587585449219, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 5571744, "load_time_ms": 14.195}, "custom_metrics": {"cost1_mean": 286.6177780969, "outflow_rate_max": 1204.2418593545738, "system_level_velocity_mean": 11.373800130876818, "cost1_min": 36.092447889055876, "cost1_max": 407.5889170663248, "outflow_rate_min": 458.3356077923883, "cost2_mean": -117.34315191353275, "outflow_rate_mean": 917.367493832179, "system_level_velocity_min": 9.568917776102246, "cost2_min": -164.93807550733985, "system_level_velocity_max": 18.567087477124133, "cost2_max": -27.32740354743099}, "node_ip": "10.138.0.2", "iterations_since_restore": 148, "done": false, "episodes_total": 2678, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f805c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80fd0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 643.558758020473, "episode_reward_min": 57.507897899133845, "timesteps_total": 5571744, "time_since_restore": 3261.6792182922363, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37075, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557192846, "time_this_iter_s": 21.580471515655518, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 148, "date": "2019-05-07_01-34-06", "episode_len_mean": 693.54}
{"timesteps_since_restore": 5608546, "policy_reward_mean": {}, "episode_reward_max": 921.3666491036134, "time_total_s": 3283.2227272987366, "info": {"num_steps_sampled": 5608546, "sample_time_ms": 12966.964, "grad_time_ms": 8167.734, "update_time_ms": 6.856, "default": {"kl": 0.015018543228507042, "entropy": 0.9652969241142273, "cur_lr": 0.0005000000237487257, "total_loss": 9.960877418518066, "policy_loss": -0.007237741723656654, "vf_explained_var": 0.929015040397644, "vf_loss": 9.9649076461792, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 5608546, "load_time_ms": 13.884}, "custom_metrics": {"cost1_mean": 282.0132653318695, "outflow_rate_max": 1204.2418593545738, "system_level_velocity_mean": 11.208490333674563, "cost1_min": 36.092447889055876, "cost1_max": 407.5889170663248, "outflow_rate_min": 458.3356077923883, "cost2_mean": -116.27013823810648, "outflow_rate_mean": 906.5426850926234, "system_level_velocity_min": 8.866992204220388, "cost2_min": -164.93807550733985, "system_level_velocity_max": 18.567087477124133, "cost2_max": -27.32740354743099}, "node_ip": "10.138.0.2", "iterations_since_restore": 149, "done": false, "episodes_total": 2698, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f806a0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 633.3285602394227, "episode_reward_min": 57.507897899133845, "timesteps_total": 5608546, "time_since_restore": 3283.2227272987366, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36802, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557192867, "time_this_iter_s": 21.543509006500244, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 149, "date": "2019-05-07_01-34-27", "episode_len_mean": 693.54}
{"timesteps_since_restore": 5644826, "policy_reward_mean": {}, "episode_reward_max": 921.3666491036134, "time_total_s": 3305.5436038970947, "info": {"num_steps_sampled": 5644826, "sample_time_ms": 12951.796, "grad_time_ms": 8306.444, "update_time_ms": 7.063, "default": {"kl": 0.015606162138283253, "entropy": 0.9876118302345276, "cur_lr": 0.0005000000237487257, "total_loss": 12.353422164916992, "policy_loss": -0.009919031523168087, "vf_explained_var": 0.9053786993026733, "vf_loss": 12.360008239746094, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 5644826, "load_time_ms": 13.057}, "custom_metrics": {"cost1_mean": 281.1567620419041, "outflow_rate_max": 1204.2418593545738, "system_level_velocity_mean": 11.182885022641205, "cost1_min": 36.092447889055876, "cost1_max": 407.5889170663248, "outflow_rate_min": 458.3356077923883, "cost2_mean": -115.03838965363452, "outflow_rate_mean": 904.7197697965926, "system_level_velocity_min": 8.866992204220388, "cost2_min": -164.93807550733985, "system_level_velocity_max": 18.567087477124133, "cost2_max": -27.32740354743099}, "node_ip": "10.138.0.2", "iterations_since_restore": 150, "done": false, "episodes_total": 2718, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80da0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 631.5975570159671, "episode_reward_min": 57.507897899133845, "timesteps_total": 5644826, "time_since_restore": 3305.5436038970947, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36280, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557192890, "time_this_iter_s": 22.320876598358154, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 150, "date": "2019-05-07_01-34-50", "episode_len_mean": 693.54}
{"timesteps_since_restore": 5680275, "policy_reward_mean": {}, "episode_reward_max": 921.3666491036134, "time_total_s": 3326.75634264946, "info": {"num_steps_sampled": 5680275, "sample_time_ms": 12974.621, "grad_time_ms": 8276.635, "update_time_ms": 7.089, "default": {"kl": 0.01711224392056465, "entropy": 0.9976085424423218, "cur_lr": 0.0005000000237487257, "total_loss": 10.3191556930542, "policy_loss": -0.010699603706598282, "vf_explained_var": 0.9196226000785828, "vf_loss": 10.326200485229492, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 5680275, "load_time_ms": 12.588}, "custom_metrics": {"cost1_mean": 281.0630581089706, "outflow_rate_max": 1204.2418593545738, "system_level_velocity_mean": 11.181802757341375, "cost1_min": 36.092447889055876, "cost1_max": 407.5889170663248, "outflow_rate_min": 458.3356077923883, "cost2_mean": -114.63117775570853, "outflow_rate_mean": 904.0843234489942, "system_level_velocity_min": 8.866992204220388, "cost2_min": -164.93807550733985, "system_level_velocity_max": 18.567087477124133, "cost2_max": -27.32740354743099}, "node_ip": "10.138.0.2", "iterations_since_restore": 151, "done": false, "episodes_total": 2734, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f806a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80ef0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 631.2297531336352, "episode_reward_min": 57.507897899133845, "timesteps_total": 5680275, "time_since_restore": 3326.75634264946, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35449, "pid": 25319, "episodes_this_iter": 16, "timestamp": 1557192911, "time_this_iter_s": 21.212738752365112, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 151, "date": "2019-05-07_01-35-11", "episode_len_mean": 693.54}
{"timesteps_since_restore": 5715937, "policy_reward_mean": {}, "episode_reward_max": 921.3666491036134, "time_total_s": 3347.347809314728, "info": {"num_steps_sampled": 5715937, "sample_time_ms": 12898.684, "grad_time_ms": 8250.773, "update_time_ms": 7.044, "default": {"kl": 0.016814839094877243, "entropy": 1.0090218782424927, "cur_lr": 0.0005000000237487257, "total_loss": 10.202582359313965, "policy_loss": -0.011491437442600727, "vf_explained_var": 0.9203890562057495, "vf_loss": 10.210482597351074, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 5715937, "load_time_ms": 12.757}, "custom_metrics": {"cost1_mean": 282.995894045014, "outflow_rate_max": 1204.2418593545738, "system_level_velocity_mean": 11.10828455114201, "cost1_min": 221.38472235016232, "cost1_max": 407.5889170663248, "outflow_rate_min": 756.0063792094443, "cost2_mean": -114.93637837509876, "outflow_rate_mean": 908.2991725184396, "system_level_velocity_min": 8.866992204220388, "cost2_min": -164.93807550733985, "system_level_velocity_max": 15.136283917430571, "cost2_max": -98.12719731499666}, "node_ip": "10.138.0.2", "iterations_since_restore": 152, "done": false, "episodes_total": 2752, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289320>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 634.3134190268764, "episode_reward_min": 547.7379524884616, "timesteps_total": 5715937, "time_since_restore": 3347.347809314728, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35662, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557192931, "time_this_iter_s": 20.591466665267944, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 152, "date": "2019-05-07_01-35-31", "episode_len_mean": 700.0}
{"timesteps_since_restore": 5752305, "policy_reward_mean": {}, "episode_reward_max": 803.163674139106, "time_total_s": 3368.242166519165, "info": {"num_steps_sampled": 5752305, "sample_time_ms": 12884.456, "grad_time_ms": 8240.1, "update_time_ms": 6.978, "default": {"kl": 0.014853360131382942, "entropy": 0.9639418721199036, "cur_lr": 0.0005000000237487257, "total_loss": 11.052891731262207, "policy_loss": -0.00810521375387907, "vf_explained_var": 0.9166167378425598, "vf_loss": 11.05782413482666, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 5752305, "load_time_ms": 12.755}, "custom_metrics": {"cost1_mean": 284.3664635758294, "outflow_rate_max": 1075.377242862214, "system_level_velocity_mean": 11.1716644772364, "cost1_min": 221.38472235016232, "cost1_max": 372.1715557249876, "outflow_rate_min": 756.0063792094443, "cost2_mean": -116.295579445223, "outflow_rate_mean": 911.1502421665526, "system_level_velocity_min": 8.866992204220388, "cost2_min": -144.63454937111325, "system_level_velocity_max": 14.34407379046665, "cost2_max": -98.12719731499666}, "node_ip": "10.138.0.2", "iterations_since_restore": 153, "done": false, "episodes_total": 2772, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f806d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80400>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 641.4401431701768, "episode_reward_min": 539.7464686045872, "timesteps_total": 5752305, "time_since_restore": 3368.242166519165, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36368, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557192952, "time_this_iter_s": 20.894357204437256, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 153, "date": "2019-05-07_01-35-52", "episode_len_mean": 700.0}
{"timesteps_since_restore": 5789435, "policy_reward_mean": {}, "episode_reward_max": 803.163674139106, "time_total_s": 3390.0635554790497, "info": {"num_steps_sampled": 5789435, "sample_time_ms": 12899.933, "grad_time_ms": 8278.021, "update_time_ms": 7.074, "default": {"kl": 0.014558150433003902, "entropy": 0.9779338836669922, "cur_lr": 0.0005000000237487257, "total_loss": 9.268603324890137, "policy_loss": -0.008097399026155472, "vf_explained_var": 0.9292577505111694, "vf_loss": 9.273591995239258, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 5789435, "load_time_ms": 12.998}, "custom_metrics": {"cost1_mean": 285.5914066766392, "outflow_rate_max": 1075.377242862214, "system_level_velocity_mean": 11.384440333691497, "cost1_min": 33.525735574964806, "cost1_max": 372.1715557249876, "outflow_rate_min": 462.93230547844075, "cost2_mean": -115.83315115028655, "outflow_rate_mean": 913.6417019373304, "system_level_velocity_min": 8.866992204220388, "cost2_min": -144.63454937111325, "system_level_velocity_max": 18.78748415509216, "cost2_max": -26.971059848095315}, "node_ip": "10.138.0.2", "iterations_since_restore": 154, "done": false, "episodes_total": 2791, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289320>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 636.3282176666505, "episode_reward_min": 51.33909471341841, "timesteps_total": 5789435, "time_since_restore": 3390.0635554790497, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37130, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557192974, "time_this_iter_s": 21.821388959884644, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 154, "date": "2019-05-07_01-36-14", "episode_len_mean": 693.49}
{"timesteps_since_restore": 5825594, "policy_reward_mean": {}, "episode_reward_max": 803.163674139106, "time_total_s": 3411.537790775299, "info": {"num_steps_sampled": 5825594, "sample_time_ms": 12952.272, "grad_time_ms": 8306.463, "update_time_ms": 7.165, "default": {"kl": 0.015388065949082375, "entropy": 0.9623687863349915, "cur_lr": 0.0005000000237487257, "total_loss": 10.65058422088623, "policy_loss": -0.009673412889242172, "vf_explained_var": 0.9199541211128235, "vf_loss": 10.656970024108887, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 5825594, "load_time_ms": 12.949}, "custom_metrics": {"cost1_mean": 286.7155565459697, "outflow_rate_max": 1161.9566964162752, "system_level_velocity_mean": 11.421818706879884, "cost1_min": 33.525735574964806, "cost1_max": 389.73035641737613, "outflow_rate_min": 462.93230547844075, "cost2_mean": -116.78720790840441, "outflow_rate_mean": 918.0418062728879, "system_level_velocity_min": 8.900631492476267, "cost2_min": -144.63454937111325, "system_level_velocity_max": 18.78748415509216, "cost2_max": -26.971059848095315}, "node_ip": "10.138.0.2", "iterations_since_restore": 155, "done": false, "episodes_total": 2811, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f803c8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 643.7792186110923, "episode_reward_min": 51.33909471341841, "timesteps_total": 5825594, "time_since_restore": 3411.537790775299, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36159, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557192996, "time_this_iter_s": 21.47423529624939, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 155, "date": "2019-05-07_01-36-36", "episode_len_mean": 693.49}
{"timesteps_since_restore": 5861193, "policy_reward_mean": {}, "episode_reward_max": 803.163674139106, "time_total_s": 3432.362348794937, "info": {"num_steps_sampled": 5861193, "sample_time_ms": 12977.455, "grad_time_ms": 8316.56, "update_time_ms": 7.223, "default": {"kl": 0.015860598534345627, "entropy": 0.9675428867340088, "cur_lr": 0.0005000000237487257, "total_loss": 15.031074523925781, "policy_loss": -0.008619996719062328, "vf_explained_var": 0.8888123631477356, "vf_loss": 15.036304473876953, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 5861193, "load_time_ms": 12.792}, "custom_metrics": {"cost1_mean": 286.05249397237907, "outflow_rate_max": 1161.9566964162752, "system_level_velocity_mean": 11.733398734509974, "cost1_min": 17.501115605938075, "cost1_max": 389.73035641737613, "outflow_rate_min": 432.15272909469354, "cost2_mean": -116.24627761025427, "outflow_rate_mean": 917.9164484193493, "system_level_velocity_min": 8.98939412793189, "cost2_min": -159.10737855829086, "system_level_velocity_max": 19.72575122184573, "cost2_max": -15.51144889578972}, "node_ip": "10.138.0.2", "iterations_since_restore": 156, "done": false, "episodes_total": 2830, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289208>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 639.9892742950061, "episode_reward_min": 30.531385144305304, "timesteps_total": 5861193, "time_since_restore": 3432.362348794937, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35599, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557193017, "time_this_iter_s": 20.82455801963806, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 156, "date": "2019-05-07_01-36-57", "episode_len_mean": 680.26}
{"timesteps_since_restore": 5896464, "policy_reward_mean": {}, "episode_reward_max": 803.163674139106, "time_total_s": 3452.5791890621185, "info": {"num_steps_sampled": 5896464, "sample_time_ms": 12923.69, "grad_time_ms": 8237.352, "update_time_ms": 7.266, "default": {"kl": 0.018206506967544556, "entropy": 0.9730105996131897, "cur_lr": 0.0005000000237487257, "total_loss": 11.31831169128418, "policy_loss": -0.008764508180320263, "vf_explained_var": 0.9042469263076782, "vf_loss": 11.323186874389648, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 5896464, "load_time_ms": 12.432}, "custom_metrics": {"cost1_mean": 285.44456431141913, "outflow_rate_max": 1161.9566964162752, "system_level_velocity_mean": 11.859709316403416, "cost1_min": 17.501115605938075, "cost1_max": 389.73035641737613, "outflow_rate_min": 424.5969205877253, "cost2_mean": -116.29854762897543, "outflow_rate_mean": 916.9569759874634, "system_level_velocity_min": 8.98939412793189, "cost2_min": -159.10737855829086, "system_level_velocity_max": 19.72575122184573, "cost2_max": -15.51144889578972}, "node_ip": "10.138.0.2", "iterations_since_restore": 157, "done": false, "episodes_total": 2849, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f803c8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 639.4419171239298, "episode_reward_min": 30.531385144305304, "timesteps_total": 5896464, "time_since_restore": 3452.5791890621185, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35271, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557193037, "time_this_iter_s": 20.216840267181396, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 157, "date": "2019-05-07_01-37-17", "episode_len_mean": 673.71}
{"timesteps_since_restore": 5932988, "policy_reward_mean": {}, "episode_reward_max": 772.1387569065122, "time_total_s": 3474.0904598236084, "info": {"num_steps_sampled": 5932988, "sample_time_ms": 12930.908, "grad_time_ms": 8224.018, "update_time_ms": 7.312, "default": {"kl": 0.01671534776687622, "entropy": 0.9724795818328857, "cur_lr": 0.0005000000237487257, "total_loss": 11.710301399230957, "policy_loss": -0.009418097324669361, "vf_explained_var": 0.9053211808204651, "vf_loss": 11.71614933013916, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 5932988, "load_time_ms": 12.374}, "custom_metrics": {"cost1_mean": 285.2528267604746, "outflow_rate_max": 1161.9566964162752, "system_level_velocity_mean": 11.879313116837979, "cost1_min": 17.501115605938075, "cost1_max": 389.73035641737613, "outflow_rate_min": 424.5969205877253, "cost2_mean": -116.41126103045926, "outflow_rate_mean": 917.4067306556051, "system_level_velocity_min": 8.98939412793189, "cost2_min": -159.10737855829086, "system_level_velocity_max": 19.72575122184573, "cost2_max": -15.51144889578972}, "node_ip": "10.138.0.2", "iterations_since_restore": 158, "done": false, "episodes_total": 2869, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062892e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289e48>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 636.6230948100779, "episode_reward_min": 30.531385144305304, "timesteps_total": 5932988, "time_since_restore": 3474.0904598236084, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36524, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557193058, "time_this_iter_s": 21.511270761489868, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 158, "date": "2019-05-07_01-37-38", "episode_len_mean": 671.37}
{"timesteps_since_restore": 5969385, "policy_reward_mean": {}, "episode_reward_max": 808.7878587401214, "time_total_s": 3495.385980606079, "info": {"num_steps_sampled": 5969385, "sample_time_ms": 12918.771, "grad_time_ms": 8211.275, "update_time_ms": 7.288, "default": {"kl": 0.016067998483777046, "entropy": 0.9762555956840515, "cur_lr": 0.0005000000237487257, "total_loss": 13.140620231628418, "policy_loss": -0.00824244786053896, "vf_explained_var": 0.8857880234718323, "vf_loss": 13.145430564880371, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 5969385, "load_time_ms": 12.304}, "custom_metrics": {"cost1_mean": 286.6768827072356, "outflow_rate_max": 1161.9566964162752, "system_level_velocity_mean": 11.752170121396722, "cost1_min": 17.501115605938075, "cost1_max": 389.73035641737613, "outflow_rate_min": 424.5969205877253, "cost2_mean": -118.02181708965942, "outflow_rate_mean": 920.2622537849129, "system_level_velocity_min": 8.98939412793189, "cost2_min": -159.10737855829086, "system_level_velocity_max": 19.72575122184573, "cost2_max": -15.51144889578972}, "node_ip": "10.138.0.2", "iterations_since_restore": 159, "done": false, "episodes_total": 2887, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289e10>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 647.6032193606299, "episode_reward_min": 30.531385144305304, "timesteps_total": 5969385, "time_since_restore": 3495.385980606079, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36397, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557193080, "time_this_iter_s": 21.295520782470703, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 159, "date": "2019-05-07_01-38-00", "episode_len_mean": 677.88}
{"timesteps_since_restore": 6005061, "policy_reward_mean": {}, "episode_reward_max": 832.8500833876743, "time_total_s": 3516.616374015808, "info": {"num_steps_sampled": 6005061, "sample_time_ms": 12930.236, "grad_time_ms": 8090.931, "update_time_ms": 7.123, "default": {"kl": 0.016348307952284813, "entropy": 0.955534815788269, "cur_lr": 0.0005000000237487257, "total_loss": 14.404290199279785, "policy_loss": -0.007559546269476414, "vf_explained_var": 0.8970141410827637, "vf_loss": 14.408357620239258, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 6005061, "load_time_ms": 12.478}, "custom_metrics": {"cost1_mean": 287.2458292398057, "outflow_rate_max": 1161.9566964162752, "system_level_velocity_mean": 11.929099509871897, "cost1_min": 17.501115605938075, "cost1_max": 389.73035641737613, "outflow_rate_min": 424.5969205877253, "cost2_mean": -117.36226666505308, "outflow_rate_mean": 919.9112510045555, "system_level_velocity_min": 9.461741887773703, "cost2_min": -159.10737855829086, "system_level_velocity_max": 19.72575122184573, "cost2_max": -15.51144889578972}, "node_ip": "10.138.0.2", "iterations_since_restore": 160, "done": false, "episodes_total": 2907, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062892b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289358>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 643.0711489018403, "episode_reward_min": 30.531385144305304, "timesteps_total": 6005061, "time_since_restore": 3516.616374015808, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35676, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557193101, "time_this_iter_s": 21.230393409729004, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 160, "date": "2019-05-07_01-38-21", "episode_len_mean": 671.4}
{"timesteps_since_restore": 6041600, "policy_reward_mean": {}, "episode_reward_max": 832.8500833876743, "time_total_s": 3537.585079908371, "info": {"num_steps_sampled": 6041600, "sample_time_ms": 12915.32, "grad_time_ms": 8080.503, "update_time_ms": 7.128, "default": {"kl": 0.01467348076403141, "entropy": 0.974673330783844, "cur_lr": 0.0005000000237487257, "total_loss": 13.083438873291016, "policy_loss": -0.009079569950699806, "vf_explained_var": 0.8833140134811401, "vf_loss": 13.089384078979492, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 6041600, "load_time_ms": 12.594}, "custom_metrics": {"cost1_mean": 288.2685199121841, "outflow_rate_max": 1136.503435455885, "system_level_velocity_mean": 11.805689954703528, "cost1_min": 17.501115605938075, "cost1_max": 391.7827536557997, "outflow_rate_min": 424.5969205877253, "cost2_mean": -117.96367156464954, "outflow_rate_mean": 919.7322272706854, "system_level_velocity_min": 9.461741887773703, "cost2_min": -139.55770300605798, "system_level_velocity_max": 19.72575122184573, "cost2_max": -15.51144889578972}, "node_ip": "10.138.0.2", "iterations_since_restore": 161, "done": false, "episodes_total": 2925, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80a58>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 648.0694667452987, "episode_reward_min": 30.531385144305304, "timesteps_total": 6041600, "time_since_restore": 3537.585079908371, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36539, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557193122, "time_this_iter_s": 20.968705892562866, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 161, "date": "2019-05-07_01-38-42", "episode_len_mean": 677.89}
{"timesteps_since_restore": 6077940, "policy_reward_mean": {}, "episode_reward_max": 832.8500833876743, "time_total_s": 3558.965514421463, "info": {"num_steps_sampled": 6077940, "sample_time_ms": 12948.653, "grad_time_ms": 8125.484, "update_time_ms": 7.068, "default": {"kl": 0.015770409256219864, "entropy": 0.9769099354743958, "cur_lr": 0.0005000000237487257, "total_loss": 11.387584686279297, "policy_loss": -0.008636530488729477, "vf_explained_var": 0.9120317101478577, "vf_loss": 11.392853736877441, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 6077940, "load_time_ms": 12.587}, "custom_metrics": {"cost1_mean": 292.9656706560471, "outflow_rate_max": 1136.503435455885, "system_level_velocity_mean": 11.626782287532603, "cost1_min": 35.19876759971542, "cost1_max": 391.7827536557997, "outflow_rate_min": 459.7855400574733, "cost2_mean": -120.6754619522187, "outflow_rate_mean": 927.9626572584463, "system_level_velocity_min": 9.562339092903496, "cost2_min": -139.55770300605798, "system_level_velocity_max": 18.80234038471652, "cost2_max": -28.1916408858559}, "node_ip": "10.138.0.2", "iterations_since_restore": 162, "done": false, "episodes_total": 2942, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062892b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062893c8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 660.6202498689722, "episode_reward_min": 61.809689161017594, "timesteps_total": 6077940, "time_since_restore": 3558.965514421463, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36340, "pid": 25319, "episodes_this_iter": 17, "timestamp": 1557193143, "time_this_iter_s": 21.38043451309204, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 162, "date": "2019-05-07_01-39-03", "episode_len_mean": 691.18}
{"timesteps_since_restore": 6115135, "policy_reward_mean": {}, "episode_reward_max": 884.1615882909385, "time_total_s": 3580.086050271988, "info": {"num_steps_sampled": 6115135, "sample_time_ms": 12957.197, "grad_time_ms": 8138.659, "update_time_ms": 7.12, "default": {"kl": 0.016794933006167412, "entropy": 0.9493797421455383, "cur_lr": 0.0005000000237487257, "total_loss": 12.474090576171875, "policy_loss": -0.009699271060526371, "vf_explained_var": 0.9096309542655945, "vf_loss": 12.480202674865723, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 6115135, "load_time_ms": 12.839}, "custom_metrics": {"cost1_mean": 297.0030931659922, "outflow_rate_max": 1156.4484062397903, "system_level_velocity_mean": 11.742149851910296, "cost1_min": 35.19876759971542, "cost1_max": 443.6062403176173, "outflow_rate_min": 459.7855400574733, "cost2_mean": -121.56797832324912, "outflow_rate_mean": 935.6293417275313, "system_level_velocity_min": 9.562339092903496, "cost2_min": -144.9612617797319, "system_level_velocity_max": 18.80234038471652, "cost2_max": -28.1916408858559}, "node_ip": "10.138.0.2", "iterations_since_restore": 163, "done": false, "episodes_total": 2962, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80b70>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 667.2367959104216, "episode_reward_min": 61.809689161017594, "timesteps_total": 6115135, "time_since_restore": 3580.086050271988, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37195, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557193164, "time_this_iter_s": 21.120535850524902, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 163, "date": "2019-05-07_01-39-24", "episode_len_mean": 693.52}
{"timesteps_since_restore": 6151689, "policy_reward_mean": {}, "episode_reward_max": 884.1615882909385, "time_total_s": 3601.3649439811707, "info": {"num_steps_sampled": 6151689, "sample_time_ms": 12952.778, "grad_time_ms": 8089.731, "update_time_ms": 6.943, "default": {"kl": 0.01580851711332798, "entropy": 0.9632958173751831, "cur_lr": 0.0005000000237487257, "total_loss": 15.025371551513672, "policy_loss": -0.008470751345157623, "vf_explained_var": 0.8893996477127075, "vf_loss": 15.030465126037598, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 6151689, "load_time_ms": 12.628}, "custom_metrics": {"cost1_mean": 297.34198975068847, "outflow_rate_max": 1156.4484062397903, "system_level_velocity_mean": 11.904384926847154, "cost1_min": 35.19876759971542, "cost1_max": 443.6062403176173, "outflow_rate_min": 440.7320626841436, "cost2_mean": -120.92187208776963, "outflow_rate_mean": 935.5072407265051, "system_level_velocity_min": 9.415072706349685, "cost2_min": -144.9612617797319, "system_level_velocity_max": 18.80234038471652, "cost2_max": -28.1916408858559}, "node_ip": "10.138.0.2", "iterations_since_restore": 164, "done": false, "episodes_total": 2982, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062893c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062897b8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 662.7337588857066, "episode_reward_min": 61.809689161017594, "timesteps_total": 6151689, "time_since_restore": 3601.3649439811707, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36554, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557193186, "time_this_iter_s": 21.27889370918274, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 164, "date": "2019-05-07_01-39-46", "episode_len_mean": 687.05}
{"timesteps_since_restore": 6188626, "policy_reward_mean": {}, "episode_reward_max": 884.1615882909385, "time_total_s": 3622.6635825634003, "info": {"num_steps_sampled": 6188626, "sample_time_ms": 12990.974, "grad_time_ms": 8033.666, "update_time_ms": 6.801, "default": {"kl": 0.0156325064599514, "entropy": 0.9548993706703186, "cur_lr": 0.0005000000237487257, "total_loss": 15.885579109191895, "policy_loss": -0.008009430952370167, "vf_explained_var": 0.8742110133171082, "vf_loss": 15.890250205993652, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 6188626, "load_time_ms": 12.803}, "custom_metrics": {"cost1_mean": 295.28629574680997, "outflow_rate_max": 1156.4484062397903, "system_level_velocity_mean": 11.86906650695437, "cost1_min": 20.78534527901493, "cost1_max": 443.6062403176173, "outflow_rate_min": 440.7320626841436, "cost2_mean": -120.30688027202906, "outflow_rate_mean": 930.8779905810959, "system_level_velocity_min": 9.415072706349685, "cost2_min": -144.9612617797319, "system_level_velocity_max": 19.323556380369077, "cost2_max": -19.946847649532575}, "node_ip": "10.138.0.2", "iterations_since_restore": 165, "done": false, "episodes_total": 3003, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80588>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 660.2631370071845, "episode_reward_min": 35.963775052209726, "timesteps_total": 6188626, "time_since_restore": 3622.6635825634003, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36937, "pid": 25319, "episodes_this_iter": 21, "timestamp": 1557193207, "time_this_iter_s": 21.298638582229614, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 165, "date": "2019-05-07_01-40-07", "episode_len_mean": 685.19}
{"timesteps_since_restore": 6225875, "policy_reward_mean": {}, "episode_reward_max": 884.1615882909385, "time_total_s": 3643.667563199997, "info": {"num_steps_sampled": 6225875, "sample_time_ms": 12977.541, "grad_time_ms": 8065.313, "update_time_ms": 6.635, "default": {"kl": 0.017063196748495102, "entropy": 0.9314092993736267, "cur_lr": 0.0005000000237487257, "total_loss": 13.893749237060547, "policy_loss": -0.008179647848010063, "vf_explained_var": 0.8881329298019409, "vf_loss": 13.898283958435059, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 6225875, "load_time_ms": 12.674}, "custom_metrics": {"cost1_mean": 298.3532864881282, "outflow_rate_max": 1156.4484062397903, "system_level_velocity_mean": 11.9726235096153, "cost1_min": 20.78534527901493, "cost1_max": 443.6062403176173, "outflow_rate_min": 440.7320626841436, "cost2_mean": -121.37276441799126, "outflow_rate_mean": 939.103693519388, "system_level_velocity_min": 9.415072706349685, "cost2_min": -144.9612617797319, "system_level_velocity_max": 19.323556380369077, "cost2_max": -19.946847649532575}, "node_ip": "10.138.0.2", "iterations_since_restore": 166, "done": false, "episodes_total": 3023, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062899b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062893c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062890f0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 664.3459703441702, "episode_reward_min": 35.963775052209726, "timesteps_total": 6225875, "time_since_restore": 3643.667563199997, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37249, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557193228, "time_this_iter_s": 21.00398063659668, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 166, "date": "2019-05-07_01-40-28", "episode_len_mean": 685.19}
{"timesteps_since_restore": 6262783, "policy_reward_mean": {}, "episode_reward_max": 884.1615882909385, "time_total_s": 3665.444964170456, "info": {"num_steps_sampled": 6262783, "sample_time_ms": 13068.64, "grad_time_ms": 8130.289, "update_time_ms": 6.607, "default": {"kl": 0.01820361614227295, "entropy": 0.962473452091217, "cur_lr": 0.0005000000237487257, "total_loss": 13.636272430419922, "policy_loss": -0.009382453747093678, "vf_explained_var": 0.8847091794013977, "vf_loss": 13.641766548156738, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 6262783, "load_time_ms": 12.719}, "custom_metrics": {"cost1_mean": 301.29669490346214, "outflow_rate_max": 1156.4484062397903, "system_level_velocity_mean": 12.075736783229852, "cost1_min": 20.78534527901493, "cost1_max": 443.6062403176173, "outflow_rate_min": 440.7320626841436, "cost2_mean": -121.87201018938615, "outflow_rate_mean": 945.7454610100851, "system_level_velocity_min": 9.415072706349685, "cost2_min": -144.9612617797319, "system_level_velocity_max": 19.323556380369077, "cost2_max": -19.946847649532575}, "node_ip": "10.138.0.2", "iterations_since_restore": 167, "done": false, "episodes_total": 3043, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f806d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f807f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540626ae80>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 671.4731343617507, "episode_reward_min": 35.963775052209726, "timesteps_total": 6262783, "time_since_restore": 3665.444964170456, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36908, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557193250, "time_this_iter_s": 21.777400970458984, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 167, "date": "2019-05-07_01-40-50", "episode_len_mean": 685.19}
{"timesteps_since_restore": 6299155, "policy_reward_mean": {}, "episode_reward_max": 786.4222150339335, "time_total_s": 3686.6989603042603, "info": {"num_steps_sampled": 6299155, "sample_time_ms": 13058.999, "grad_time_ms": 8113.879, "update_time_ms": 6.61, "default": {"kl": 0.016629090532660484, "entropy": 0.9677494764328003, "cur_lr": 0.0005000000237487257, "total_loss": 14.242854118347168, "policy_loss": -0.008214322850108147, "vf_explained_var": 0.891906201839447, "vf_loss": 14.247517585754395, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 6299155, "load_time_ms": 12.739}, "custom_metrics": {"cost1_mean": 294.99209163663375, "outflow_rate_max": 1126.491538738874, "system_level_velocity_mean": 12.041583295084006, "cost1_min": 20.78534527901493, "cost1_max": 385.5215920512835, "outflow_rate_min": 436.0779255786675, "cost2_mean": -120.27864781680324, "outflow_rate_mean": 934.867092685316, "system_level_velocity_min": 9.547794837038463, "cost2_min": -140.3363648861451, "system_level_velocity_max": 19.323556380369077, "cost2_max": -19.946847649532575}, "node_ip": "10.138.0.2", "iterations_since_restore": 168, "done": false, "episodes_total": 3064, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062899b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289e48>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 658.3862541188116, "episode_reward_min": 35.963775052209726, "timesteps_total": 6299155, "time_since_restore": 3686.6989603042603, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36372, "pid": 25319, "episodes_this_iter": 21, "timestamp": 1557193271, "time_this_iter_s": 21.25399613380432, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 168, "date": "2019-05-07_01-41-11", "episode_len_mean": 677.22}
{"timesteps_since_restore": 6334697, "policy_reward_mean": {}, "episode_reward_max": 783.7340410428466, "time_total_s": 3707.4456691741943, "info": {"num_steps_sampled": 6334697, "sample_time_ms": 13041.024, "grad_time_ms": 8076.9, "update_time_ms": 6.672, "default": {"kl": 0.018639281392097473, "entropy": 0.9652810096740723, "cur_lr": 0.0005000000237487257, "total_loss": 16.672204971313477, "policy_loss": -0.01173789706081152, "vf_explained_var": 0.8623906373977661, "vf_loss": 16.679962158203125, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 6334697, "load_time_ms": 12.864}, "custom_metrics": {"cost1_mean": 296.08180678276466, "outflow_rate_max": 1122.3323908380387, "system_level_velocity_mean": 11.939983121101491, "cost1_min": 20.78534527901493, "cost1_max": 375.71317811762003, "outflow_rate_min": 436.0779255786675, "cost2_mean": -120.95507591890282, "outflow_rate_mean": 937.7754484496318, "system_level_velocity_min": 9.700008761473676, "cost2_min": -142.40560956272438, "system_level_velocity_max": 19.323556380369077, "cost2_max": -19.946847649532575}, "node_ip": "10.138.0.2", "iterations_since_restore": 169, "done": false, "episodes_total": 3084, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289fd0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 662.6865404937438, "episode_reward_min": 35.963775052209726, "timesteps_total": 6334697, "time_since_restore": 3707.4456691741943, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35542, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557193292, "time_this_iter_s": 20.746708869934082, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 169, "date": "2019-05-07_01-41-32", "episode_len_mean": 683.69}
{"timesteps_since_restore": 6369814, "policy_reward_mean": {}, "episode_reward_max": 783.7340410428466, "time_total_s": 3727.236524105072, "info": {"num_steps_sampled": 6369814, "sample_time_ms": 12924.096, "grad_time_ms": 8050.399, "update_time_ms": 6.616, "default": {"kl": 0.01394651923328638, "entropy": 0.9994205832481384, "cur_lr": 0.0005000000237487257, "total_loss": 10.41114330291748, "policy_loss": -0.009152396582067013, "vf_explained_var": 0.9029827117919922, "vf_loss": 10.417316436767578, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 6369814, "load_time_ms": 12.709}, "custom_metrics": {"cost1_mean": 300.4834734730714, "outflow_rate_max": 1122.3323908380387, "system_level_velocity_mean": 11.897513213067327, "cost1_min": 29.333746516431063, "cost1_max": 375.71317811762003, "outflow_rate_min": 436.0779255786675, "cost2_mean": -121.9933981753783, "outflow_rate_mean": 945.7301117726151, "system_level_velocity_min": 9.700008761473676, "cost2_min": -142.40560956272438, "system_level_velocity_max": 18.26648068018163, "cost2_max": -25.30318508108836}, "node_ip": "10.138.0.2", "iterations_since_restore": 170, "done": false, "episodes_total": 3097, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289d68>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 668.2572698538054, "episode_reward_min": 54.99355800916067, "timesteps_total": 6369814, "time_since_restore": 3727.236524105072, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35117, "pid": 25319, "episodes_this_iter": 13, "timestamp": 1557193312, "time_this_iter_s": 19.790854930877686, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 170, "date": "2019-05-07_01-41-52", "episode_len_mean": 692.03}
{"timesteps_since_restore": 6405451, "policy_reward_mean": {}, "episode_reward_max": 772.8819630876794, "time_total_s": 3747.7903974056244, "info": {"num_steps_sampled": 6405451, "sample_time_ms": 12859.364, "grad_time_ms": 8074.175, "update_time_ms": 6.636, "default": {"kl": 0.0165468230843544, "entropy": 0.9778721332550049, "cur_lr": 0.0005000000237487257, "total_loss": 8.149148941040039, "policy_loss": -0.009288020431995392, "vf_explained_var": 0.9313237071037292, "vf_loss": 8.154902458190918, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 6405451, "load_time_ms": 12.759}, "custom_metrics": {"cost1_mean": 296.5785323878451, "outflow_rate_max": 1108.5308073534156, "system_level_velocity_mean": 11.76986726139947, "cost1_min": 29.333746516431063, "cost1_max": 372.3674598889015, "outflow_rate_min": 436.0779255786675, "cost2_mean": -121.0401199275386, "outflow_rate_mean": 936.8699632085975, "system_level_velocity_min": 9.700008761473676, "cost2_min": -142.40560956272438, "system_level_velocity_max": 18.26648068018163, "cost2_max": -25.30318508108836}, "node_ip": "10.138.0.2", "iterations_since_restore": 171, "done": false, "episodes_total": 3112, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289fd0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 663.6244893334831, "episode_reward_min": 54.99355800916067, "timesteps_total": 6405451, "time_since_restore": 3747.7903974056244, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35637, "pid": 25319, "episodes_this_iter": 15, "timestamp": 1557193332, "time_this_iter_s": 20.553873300552368, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 171, "date": "2019-05-07_01-42-12", "episode_len_mean": 692.03}
{"timesteps_since_restore": 6442469, "policy_reward_mean": {}, "episode_reward_max": 759.0424935758327, "time_total_s": 3769.4841661453247, "info": {"num_steps_sampled": 6442469, "sample_time_ms": 12906.189, "grad_time_ms": 8059.122, "update_time_ms": 6.752, "default": {"kl": 0.016979297623038292, "entropy": 0.9720197319984436, "cur_lr": 0.0005000000237487257, "total_loss": 13.17757511138916, "policy_loss": -0.008743342943489552, "vf_explained_var": 0.9024031758308411, "vf_loss": 13.182692527770996, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 6442469, "load_time_ms": 12.682}, "custom_metrics": {"cost1_mean": 291.9410007283586, "outflow_rate_max": 1108.5308073534156, "system_level_velocity_mean": 11.796539578719912, "cost1_min": 18.939663451879472, "cost1_max": 369.9210079912983, "outflow_rate_min": 428.6206280397692, "cost2_mean": -118.73569817770367, "outflow_rate_mean": 928.0424316749486, "system_level_velocity_min": 9.64640205002677, "cost2_min": -142.40560956272438, "system_level_velocity_max": 18.26648068018163, "cost2_max": -16.983424855528536}, "node_ip": "10.138.0.2", "iterations_since_restore": 172, "done": false, "episodes_total": 3135, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062891d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062894e0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 646.7672288457851, "episode_reward_min": 32.548758231080825, "timesteps_total": 6442469, "time_since_restore": 3769.4841661453247, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37018, "pid": 25319, "episodes_this_iter": 23, "timestamp": 1557193354, "time_this_iter_s": 21.693768739700317, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 172, "date": "2019-05-07_01-42-34", "episode_len_mean": 684.9}
{"timesteps_since_restore": 6479053, "policy_reward_mean": {}, "episode_reward_max": 861.7277405081402, "time_total_s": 3790.5126831531525, "info": {"num_steps_sampled": 6479053, "sample_time_ms": 12921.676, "grad_time_ms": 8035.188, "update_time_ms": 6.753, "default": {"kl": 0.018965423107147217, "entropy": 0.9511052966117859, "cur_lr": 0.0005000000237487257, "total_loss": 14.927867889404297, "policy_loss": -0.009773226454854012, "vf_explained_var": 0.8939457535743713, "vf_loss": 14.933591842651367, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 6479053, "load_time_ms": 12.396}, "custom_metrics": {"cost1_mean": 295.13321750665125, "outflow_rate_max": 1205.4944814563855, "system_level_velocity_mean": 11.761734956494102, "cost1_min": 18.939663451879472, "cost1_max": 419.6751172326442, "outflow_rate_min": 428.6206280397692, "cost2_mean": -120.50199014298721, "outflow_rate_mean": 935.0038855112871, "system_level_velocity_min": 9.64640205002677, "cost2_min": -157.28218968281976, "system_level_velocity_max": 18.07893316855652, "cost2_max": -16.983424855528536}, "node_ip": "10.138.0.2", "iterations_since_restore": 173, "done": false, "episodes_total": 3155, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289048>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 650.4140444145306, "episode_reward_min": 32.548758231080825, "timesteps_total": 6479053, "time_since_restore": 3790.5126831531525, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36584, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557193375, "time_this_iter_s": 21.02851700782776, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 173, "date": "2019-05-07_01-42-55", "episode_len_mean": 691.47}
{"timesteps_since_restore": 6515698, "policy_reward_mean": {}, "episode_reward_max": 861.7277405081402, "time_total_s": 3811.2990379333496, "info": {"num_steps_sampled": 6515698, "sample_time_ms": 12878.584, "grad_time_ms": 8028.715, "update_time_ms": 6.772, "default": {"kl": 0.018801076337695122, "entropy": 0.9856187701225281, "cur_lr": 0.0005000000237487257, "total_loss": 16.917490005493164, "policy_loss": -0.009122326038777828, "vf_explained_var": 0.8616226315498352, "vf_loss": 16.92259979248047, "cur_kl_coeff": 0.21357417106628418}, "num_steps_trained": 6515698, "load_time_ms": 12.617}, "custom_metrics": {"cost1_mean": 297.16478968121015, "outflow_rate_max": 1205.4944814563855, "system_level_velocity_mean": 11.825438943476435, "cost1_min": 18.939663451879472, "cost1_max": 419.6751172326442, "outflow_rate_min": 428.6206280397692, "cost2_mean": -121.09902067038183, "outflow_rate_mean": 938.9964863978597, "system_level_velocity_min": 9.64640205002677, "cost2_min": -157.28218968281976, "system_level_velocity_max": 18.07893316855652, "cost2_max": -16.983424855528536}, "node_ip": "10.138.0.2", "iterations_since_restore": 174, "done": false, "episodes_total": 3175, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062892e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289e48>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 649.8240878128404, "episode_reward_min": 32.548758231080825, "timesteps_total": 6515698, "time_since_restore": 3811.2990379333496, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36645, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557193396, "time_this_iter_s": 20.786354780197144, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 174, "date": "2019-05-07_01-43-16", "episode_len_mean": 692.39}
{"timesteps_since_restore": 6552678, "policy_reward_mean": {}, "episode_reward_max": 861.7277405081402, "time_total_s": 3832.522104740143, "info": {"num_steps_sampled": 6552678, "sample_time_ms": 12889.371, "grad_time_ms": 8010.513, "update_time_ms": 6.998, "default": {"kl": 0.015528778545558453, "entropy": 0.9612509608268738, "cur_lr": 0.0005000000237487257, "total_loss": 14.427135467529297, "policy_loss": -0.009624598547816277, "vf_explained_var": 0.8883928656578064, "vf_loss": 14.43344497680664, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 6552678, "load_time_ms": 12.371}, "custom_metrics": {"cost1_mean": 296.9651100354347, "outflow_rate_max": 1205.4944814563855, "system_level_velocity_mean": 11.997239037410779, "cost1_min": 18.939663451879472, "cost1_max": 419.6751172326442, "outflow_rate_min": 428.6206280397692, "cost2_mean": -120.20279377569602, "outflow_rate_mean": 938.9557373368392, "system_level_velocity_min": 9.64640205002677, "cost2_min": -162.89175411601892, "system_level_velocity_max": 19.2427387530155, "cost2_max": -16.983424855528536}, "node_ip": "10.138.0.2", "iterations_since_restore": 175, "done": false, "episodes_total": 3196, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289b38>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 646.0894670716193, "episode_reward_min": 32.548758231080825, "timesteps_total": 6552678, "time_since_restore": 3832.522104740143, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36980, "pid": 25319, "episodes_this_iter": 21, "timestamp": 1557193417, "time_this_iter_s": 21.223066806793213, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 175, "date": "2019-05-07_01-43-37", "episode_len_mean": 685.69}
{"timesteps_since_restore": 6590190, "policy_reward_mean": {}, "episode_reward_max": 861.7277405081402, "time_total_s": 3853.567331314087, "info": {"num_steps_sampled": 6590190, "sample_time_ms": 12902.347, "grad_time_ms": 8001.599, "update_time_ms": 6.985, "default": {"kl": 0.015889817848801613, "entropy": 0.991077184677124, "cur_lr": 0.0005000000237487257, "total_loss": 14.018777847290039, "policy_loss": -0.00816210638731718, "vf_explained_var": 0.8915117979049683, "vf_loss": 14.023547172546387, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 6590190, "load_time_ms": 12.432}, "custom_metrics": {"cost1_mean": 299.08340314593994, "outflow_rate_max": 1205.4944814563855, "system_level_velocity_mean": 12.08848231784407, "cost1_min": 18.939663451879472, "cost1_max": 419.6751172326442, "outflow_rate_min": 428.6206280397692, "cost2_mean": -121.2574070071562, "outflow_rate_mean": 945.2072021207065, "system_level_velocity_min": 9.64640205002677, "cost2_min": -162.89175411601892, "system_level_velocity_max": 19.2427387530155, "cost2_max": -16.983424855528536}, "node_ip": "10.138.0.2", "iterations_since_restore": 176, "done": false, "episodes_total": 3216, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f802e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80400>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 648.8796710038621, "episode_reward_min": 32.548758231080825, "timesteps_total": 6590190, "time_since_restore": 3853.567331314087, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37512, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557193438, "time_this_iter_s": 21.045226573944092, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 176, "date": "2019-05-07_01-43-58", "episode_len_mean": 685.69}
{"timesteps_since_restore": 6626794, "policy_reward_mean": {}, "episode_reward_max": 861.7277405081402, "time_total_s": 3874.434218645096, "info": {"num_steps_sampled": 6626794, "sample_time_ms": 12846.157, "grad_time_ms": 7967.138, "update_time_ms": 6.952, "default": {"kl": 0.016999872401356697, "entropy": 0.9750749468803406, "cur_lr": 0.0005000000237487257, "total_loss": 13.845280647277832, "policy_loss": -0.010032951831817627, "vf_explained_var": 0.8982804417610168, "vf_loss": 13.851682662963867, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 6626794, "load_time_ms": 12.42}, "custom_metrics": {"cost1_mean": 303.4658158408383, "outflow_rate_max": 1205.4944814563855, "system_level_velocity_mean": 12.0760614014751, "cost1_min": 20.096582291341946, "cost1_max": 419.6751172326442, "outflow_rate_min": 439.84056314513816, "cost2_mean": -123.37330651454812, "outflow_rate_mean": 953.5961469802611, "system_level_velocity_min": 9.738937465286204, "cost2_min": -162.89175411601892, "system_level_velocity_max": 19.2427387530155, "cost2_max": -20.605980872441783}, "node_ip": "10.138.0.2", "iterations_since_restore": 177, "done": false, "episodes_total": 3235, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540628deb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540628dd30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540628dc18>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 659.6962772793378, "episode_reward_min": 37.51645484455119, "timesteps_total": 6626794, "time_since_restore": 3874.434218645096, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36604, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557193459, "time_this_iter_s": 20.86688733100891, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 177, "date": "2019-05-07_01-44-19", "episode_len_mean": 692.82}
{"timesteps_since_restore": 6662752, "policy_reward_mean": {}, "episode_reward_max": 832.8510827034147, "time_total_s": 3894.6122686862946, "info": {"num_steps_sampled": 6662752, "sample_time_ms": 12771.205, "grad_time_ms": 7935.444, "update_time_ms": 6.938, "default": {"kl": 0.01652110554277897, "entropy": 0.991180956363678, "cur_lr": 0.0005000000237487257, "total_loss": 15.092756271362305, "policy_loss": -0.00930413044989109, "vf_explained_var": 0.8873568177223206, "vf_loss": 15.098531723022461, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 6662752, "load_time_ms": 12.202}, "custom_metrics": {"cost1_mean": 303.44153037477844, "outflow_rate_max": 1169.30009333449, "system_level_velocity_mean": 12.081235571963212, "cost1_min": 20.096582291341946, "cost1_max": 394.22500808207917, "outflow_rate_min": 439.84056314513816, "cost2_mean": -122.75576856241015, "outflow_rate_mean": 954.5810192137252, "system_level_velocity_min": 9.696207776745718, "cost2_min": -162.89175411601892, "system_level_velocity_max": 19.2427387530155, "cost2_max": -20.605980872441783}, "node_ip": "10.138.0.2", "iterations_since_restore": 178, "done": false, "episodes_total": 3255, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f809b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80160>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 660.007239073242, "episode_reward_min": 37.51645484455119, "timesteps_total": 6662752, "time_since_restore": 3894.6122686862946, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35958, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557193479, "time_this_iter_s": 20.17805004119873, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 178, "date": "2019-05-07_01-44-39", "episode_len_mean": 692.82}
{"timesteps_since_restore": 6698689, "policy_reward_mean": {}, "episode_reward_max": 832.8510827034147, "time_total_s": 3915.124612092972, "info": {"num_steps_sampled": 6698689, "sample_time_ms": 12734.333, "grad_time_ms": 7949.371, "update_time_ms": 6.847, "default": {"kl": 0.019722679629921913, "entropy": 0.979629397392273, "cur_lr": 0.0005000000237487257, "total_loss": 12.504443168640137, "policy_loss": -0.005366475787013769, "vf_explained_var": 0.9048007130622864, "vf_loss": 12.505598068237305, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 6698689, "load_time_ms": 11.698}, "custom_metrics": {"cost1_mean": 302.4691060040348, "outflow_rate_max": 1169.30009333449, "system_level_velocity_mean": 12.042195816158127, "cost1_min": 20.096582291341946, "cost1_max": 394.22500808207917, "outflow_rate_min": 439.84056314513816, "cost2_mean": -122.70424066184997, "outflow_rate_mean": 952.6021052091214, "system_level_velocity_min": 9.696207776745718, "cost2_min": -162.89175411601892, "system_level_velocity_max": 19.2427387530155, "cost2_max": -20.605980872441783}, "node_ip": "10.138.0.2", "iterations_since_restore": 179, "done": false, "episodes_total": 3273, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540628df28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540628dc18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540628dcc0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 659.5850849913779, "episode_reward_min": 37.51645484455119, "timesteps_total": 6698689, "time_since_restore": 3915.124612092972, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35937, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557193500, "time_this_iter_s": 20.512343406677246, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 179, "date": "2019-05-07_01-45-00", "episode_len_mean": 693.3}
{"timesteps_since_restore": 6735327, "policy_reward_mean": {}, "episode_reward_max": 870.30398672805, "time_total_s": 3936.5360033512115, "info": {"num_steps_sampled": 6735327, "sample_time_ms": 12874.89, "grad_time_ms": 7970.612, "update_time_ms": 6.899, "default": {"kl": 0.015836570411920547, "entropy": 0.9826576709747314, "cur_lr": 0.0005000000237487257, "total_loss": 18.22364044189453, "policy_loss": -0.007398905232548714, "vf_explained_var": 0.8699519038200378, "vf_loss": 18.227657318115234, "cur_kl_coeff": 0.21357417106628418}, "num_steps_trained": 6735327, "load_time_ms": 11.795}, "custom_metrics": {"cost1_mean": 302.775420767715, "outflow_rate_max": 1221.325875338096, "system_level_velocity_mean": 12.052589535439152, "cost1_min": 30.354349267831434, "cost1_max": 419.23199525451605, "outflow_rate_min": 452.3301084121646, "cost2_mean": -123.47783958918507, "outflow_rate_mean": 954.7672863105024, "system_level_velocity_min": 9.635974934524178, "cost2_min": -162.89175411601892, "system_level_velocity_max": 18.981815390496994, "cost2_max": -25.6557115917372}, "node_ip": "10.138.0.2", "iterations_since_restore": 180, "done": false, "episodes_total": 3294, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f808d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80630>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 661.9428242903248, "episode_reward_min": 50.16439672390356, "timesteps_total": 6735327, "time_since_restore": 3936.5360033512115, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36638, "pid": 25319, "episodes_this_iter": 21, "timestamp": 1557193521, "time_this_iter_s": 21.411391258239746, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 180, "date": "2019-05-07_01-45-21", "episode_len_mean": 693.44}
{"timesteps_since_restore": 6771610, "policy_reward_mean": {}, "episode_reward_max": 870.30398672805, "time_total_s": 3956.9949769973755, "info": {"num_steps_sampled": 6771610, "sample_time_ms": 12892.561, "grad_time_ms": 7943.566, "update_time_ms": 6.807, "default": {"kl": 0.01847708970308304, "entropy": 1.0031189918518066, "cur_lr": 0.0005000000237487257, "total_loss": 12.392708778381348, "policy_loss": -0.008715559728443623, "vf_explained_var": 0.9065874218940735, "vf_loss": 12.397479057312012, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 6771610, "load_time_ms": 11.654}, "custom_metrics": {"cost1_mean": 304.53043341738095, "outflow_rate_max": 1221.325875338096, "system_level_velocity_mean": 12.107607997396801, "cost1_min": 30.354349267831434, "cost1_max": 419.23199525451605, "outflow_rate_min": 452.3301084121646, "cost2_mean": -122.79424738653874, "outflow_rate_mean": 956.9001030583338, "system_level_velocity_min": 9.635974934524178, "cost2_min": -152.12085429155198, "system_level_velocity_max": 18.981815390496994, "cost2_max": -25.6557115917372}, "node_ip": "10.138.0.2", "iterations_since_restore": 181, "done": false, "episodes_total": 3312, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540628dd68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540628dcc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540628d630>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 658.1650869171084, "episode_reward_min": 50.16439672390356, "timesteps_total": 6771610, "time_since_restore": 3956.9949769973755, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36283, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557193542, "time_this_iter_s": 20.45897364616394, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 181, "date": "2019-05-07_01-45-42", "episode_len_mean": 693.44}
{"timesteps_since_restore": 6808230, "policy_reward_mean": {}, "episode_reward_max": 870.30398672805, "time_total_s": 3977.84654545784, "info": {"num_steps_sampled": 6808230, "sample_time_ms": 12816.077, "grad_time_ms": 7936.259, "update_time_ms": 6.727, "default": {"kl": 0.016285045072436333, "entropy": 1.0232068300247192, "cur_lr": 0.0005000000237487257, "total_loss": 13.932652473449707, "policy_loss": -0.010339062660932541, "vf_explained_var": 0.8939716219902039, "vf_loss": 13.93951416015625, "cur_kl_coeff": 0.21357417106628418}, "num_steps_trained": 6808230, "load_time_ms": 11.611}, "custom_metrics": {"cost1_mean": 304.3824347860318, "outflow_rate_max": 1221.325875338096, "system_level_velocity_mean": 12.10343304300793, "cost1_min": 30.354349267831434, "cost1_max": 419.23199525451605, "outflow_rate_min": 452.3301084121646, "cost2_mean": -122.17018843348848, "outflow_rate_mean": 956.6005118229498, "system_level_velocity_min": 9.635974934524178, "cost2_min": -152.12085429155198, "system_level_velocity_max": 18.981815390496994, "cost2_max": -25.6557115917372}, "node_ip": "10.138.0.2", "iterations_since_restore": 182, "done": false, "episodes_total": 3332, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f802e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80860>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 657.8899100387938, "episode_reward_min": 50.16439672390356, "timesteps_total": 6808230, "time_since_restore": 3977.84654545784, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36620, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557193563, "time_this_iter_s": 20.851568460464478, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 182, "date": "2019-05-07_01-46-03", "episode_len_mean": 693.44}
{"timesteps_since_restore": 6844172, "policy_reward_mean": {}, "episode_reward_max": 870.30398672805, "time_total_s": 3999.660704612732, "info": {"num_steps_sampled": 6844172, "sample_time_ms": 12906.793, "grad_time_ms": 7923.959, "update_time_ms": 6.771, "default": {"kl": 0.0193504448980093, "entropy": 0.9897409677505493, "cur_lr": 0.0005000000237487257, "total_loss": 21.30628776550293, "policy_loss": -0.0111284414306283, "vf_explained_var": 0.8494318127632141, "vf_loss": 21.313283920288086, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 6844172, "load_time_ms": 11.63}, "custom_metrics": {"cost1_mean": 297.9654076123352, "outflow_rate_max": 1221.325875338096, "system_level_velocity_mean": 12.371763902850876, "cost1_min": 25.993407140313554, "cost1_max": 419.23199525451605, "outflow_rate_min": 434.71393809930083, "cost2_mean": -119.26084629179691, "outflow_rate_mean": 945.0871442564386, "system_level_velocity_min": 9.635974934524178, "cost2_min": -152.12085429155198, "system_level_velocity_max": 18.981815390496994, "cost2_max": -22.081739347428805}, "node_ip": "10.138.0.2", "iterations_since_restore": 183, "done": false, "episodes_total": 3355, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540628d828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540628db00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540628dcc0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 637.1922301492343, "episode_reward_min": 49.28903326107312, "timesteps_total": 6844172, "time_since_restore": 3999.660704612732, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35942, "pid": 25319, "episodes_this_iter": 23, "timestamp": 1557193585, "time_this_iter_s": 21.814159154891968, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 183, "date": "2019-05-07_01-46-25", "episode_len_mean": 673.91}
{"timesteps_since_restore": 6879392, "policy_reward_mean": {}, "episode_reward_max": 870.30398672805, "time_total_s": 4019.7649607658386, "info": {"num_steps_sampled": 6879392, "sample_time_ms": 12876.876, "grad_time_ms": 7886.248, "update_time_ms": 6.785, "default": {"kl": 0.016573432832956314, "entropy": 1.0042186975479126, "cur_lr": 0.0005000000237487257, "total_loss": 13.194085121154785, "policy_loss": -0.009099223650991917, "vf_explained_var": 0.886043906211853, "vf_loss": 13.19964599609375, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 6879392, "load_time_ms": 11.286}, "custom_metrics": {"cost1_mean": 294.9397915403384, "outflow_rate_max": 1221.325875338096, "system_level_velocity_mean": 12.261463175303806, "cost1_min": 25.993407140313554, "cost1_max": 419.23199525451605, "outflow_rate_min": 434.71393809930083, "cost2_mean": -119.21324633183659, "outflow_rate_mean": 939.9026278685501, "system_level_velocity_min": 9.635974934524178, "cost2_min": -152.12085429155198, "system_level_velocity_max": 18.981815390496994, "cost2_max": -22.081739347428805}, "node_ip": "10.138.0.2", "iterations_since_restore": 184, "done": false, "episodes_total": 3374, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f805c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80e10>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 637.3437642483237, "episode_reward_min": 49.28903326107312, "timesteps_total": 6879392, "time_since_restore": 4019.7649607658386, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35220, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557193605, "time_this_iter_s": 20.10425615310669, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 184, "date": "2019-05-07_01-46-45", "episode_len_mean": 673.91}
{"timesteps_since_restore": 6914313, "policy_reward_mean": {}, "episode_reward_max": 774.7769455841351, "time_total_s": 4039.364496231079, "info": {"num_steps_sampled": 6914313, "sample_time_ms": 12713.81, "grad_time_ms": 7887.409, "update_time_ms": 6.579, "default": {"kl": 0.016396597027778625, "entropy": 1.0113458633422852, "cur_lr": 0.0005000000237487257, "total_loss": 13.617216110229492, "policy_loss": -0.00866987556219101, "vf_explained_var": 0.8858984112739563, "vf_loss": 13.622384071350098, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 6914313, "load_time_ms": 11.345}, "custom_metrics": {"cost1_mean": 290.10066315106155, "outflow_rate_max": 1146.5753197612348, "system_level_velocity_mean": 12.255188927368051, "cost1_min": 25.993407140313554, "cost1_max": 384.21497116080775, "outflow_rate_min": 434.71393809930083, "cost2_mean": -117.7316605974407, "outflow_rate_mean": 929.1165699295723, "system_level_velocity_min": 9.811954792000034, "cost2_min": -137.8241155502985, "system_level_velocity_max": 18.981815390496994, "cost2_max": -22.081739347428805}, "node_ip": "10.138.0.2", "iterations_since_restore": 185, "done": false, "episodes_total": 3390, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540628d828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540628db00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540628d710>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 627.0727021707202, "episode_reward_min": 49.28903326107312, "timesteps_total": 6914313, "time_since_restore": 4039.364496231079, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 34921, "pid": 25319, "episodes_this_iter": 16, "timestamp": 1557193624, "time_this_iter_s": 19.59953546524048, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 185, "date": "2019-05-07_01-47-04", "episode_len_mean": 667.36}
{"timesteps_since_restore": 6949905, "policy_reward_mean": {}, "episode_reward_max": 774.7769455841351, "time_total_s": 4059.6211099624634, "info": {"num_steps_sampled": 6949905, "sample_time_ms": 12685.921, "grad_time_ms": 7836.856, "update_time_ms": 6.673, "default": {"kl": 0.015902789309620857, "entropy": 1.0162988901138306, "cur_lr": 0.0005000000237487257, "total_loss": 14.905961990356445, "policy_loss": -0.008168283849954605, "vf_explained_var": 0.8815499544143677, "vf_loss": 14.910734176635742, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 6949905, "load_time_ms": 11.435}, "custom_metrics": {"cost1_mean": 293.2020581092187, "outflow_rate_max": 1146.5753197612348, "system_level_velocity_mean": 12.219925469671983, "cost1_min": 25.993407140313554, "cost1_max": 388.07496673190656, "outflow_rate_min": 434.71393809930083, "cost2_mean": -119.64366455829399, "outflow_rate_mean": 934.3664847496922, "system_level_velocity_min": 10.061908363194824, "cost2_min": -142.45868981522997, "system_level_velocity_max": 18.924178911295403, "cost2_max": -22.081739347428805}, "node_ip": "10.138.0.2", "iterations_since_restore": 186, "done": false, "episodes_total": 3411, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f808d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f804e0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 635.3784730156506, "episode_reward_min": 49.28903326107312, "timesteps_total": 6949905, "time_since_restore": 4059.6211099624634, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35592, "pid": 25319, "episodes_this_iter": 21, "timestamp": 1557193645, "time_this_iter_s": 20.256613731384277, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 186, "date": "2019-05-07_01-47-25", "episode_len_mean": 672.62}
{"timesteps_since_restore": 6985534, "policy_reward_mean": {}, "episode_reward_max": 774.7769455841351, "time_total_s": 4079.497705936432, "info": {"num_steps_sampled": 6985534, "sample_time_ms": 12624.524, "grad_time_ms": 7800.109, "update_time_ms": 6.674, "default": {"kl": 0.01744500920176506, "entropy": 0.9848734736442566, "cur_lr": 0.0005000000237487257, "total_loss": 13.912081718444824, "policy_loss": -0.011831134557723999, "vf_explained_var": 0.8938170671463013, "vf_loss": 13.920185089111328, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 6985534, "load_time_ms": 11.131}, "custom_metrics": {"cost1_mean": 294.21055426481627, "outflow_rate_max": 1106.0082290353384, "system_level_velocity_mean": 12.252731989076004, "cost1_min": 25.993407140313554, "cost1_max": 388.07496673190656, "outflow_rate_min": 434.71393809930083, "cost2_mean": -120.44874337130081, "outflow_rate_mean": 933.3175626568784, "system_level_velocity_min": 10.20615745344555, "cost2_min": -142.45868981522997, "system_level_velocity_max": 18.924178911295403, "cost2_max": -22.081739347428805}, "node_ip": "10.138.0.2", "iterations_since_restore": 187, "done": false, "episodes_total": 3430, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540628d438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540628d828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540628df60>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 635.648988549582, "episode_reward_min": 49.28903326107312, "timesteps_total": 6985534, "time_since_restore": 4079.497705936432, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35629, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557193664, "time_this_iter_s": 19.876595973968506, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 187, "date": "2019-05-07_01-47-44", "episode_len_mean": 672.62}
{"timesteps_since_restore": 7021337, "policy_reward_mean": {}, "episode_reward_max": 810.2337677205352, "time_total_s": 4100.698745727539, "info": {"num_steps_sampled": 7021337, "sample_time_ms": 12707.654, "grad_time_ms": 7818.925, "update_time_ms": 6.691, "default": {"kl": 0.01757577247917652, "entropy": 1.0154387950897217, "cur_lr": 0.0005000000237487257, "total_loss": 18.753246307373047, "policy_loss": -0.011680866591632366, "vf_explained_var": 0.8524073958396912, "vf_loss": 18.761173248291016, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 7021337, "load_time_ms": 11.136}, "custom_metrics": {"cost1_mean": 299.3889228282702, "outflow_rate_max": 1169.214669404643, "system_level_velocity_mean": 12.25394618758992, "cost1_min": 30.275799840431773, "cost1_max": 421.9581439108049, "outflow_rate_min": 444.57232367343914, "cost2_mean": -122.31921222057001, "outflow_rate_mean": 942.9564552398118, "system_level_velocity_min": 10.20615745344555, "cost2_min": -155.60400797463265, "system_level_velocity_max": 18.89458364722238, "cost2_max": -22.500280717000663}, "node_ip": "10.138.0.2", "iterations_since_restore": 188, "done": false, "episodes_total": 3450, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289b70>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 648.1979968477453, "episode_reward_min": 52.204495798087535, "timesteps_total": 7021337, "time_since_restore": 4100.698745727539, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35803, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557193686, "time_this_iter_s": 21.201039791107178, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 188, "date": "2019-05-07_01-48-06", "episode_len_mean": 679.15}
{"timesteps_since_restore": 7056311, "policy_reward_mean": {}, "episode_reward_max": 863.0046971483464, "time_total_s": 4120.955089092255, "info": {"num_steps_sampled": 7056311, "sample_time_ms": 12715.267, "grad_time_ms": 7785.818, "update_time_ms": 6.735, "default": {"kl": 0.018591629341244698, "entropy": 0.9912101626396179, "cur_lr": 0.0005000000237487257, "total_loss": 17.139301300048828, "policy_loss": -0.009622885845601559, "vf_explained_var": 0.8686420321464539, "vf_loss": 17.14495277404785, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 7056311, "load_time_ms": 11.529}, "custom_metrics": {"cost1_mean": 304.67704235880103, "outflow_rate_max": 1215.0555470876075, "system_level_velocity_mean": 12.307856737586095, "cost1_min": 30.275799840431773, "cost1_max": 421.9581439108049, "outflow_rate_min": 444.57232367343914, "cost2_mean": -123.88592984193544, "outflow_rate_mean": 951.9625515275808, "system_level_velocity_min": 9.676509327016989, "cost2_min": -155.60400797463265, "system_level_velocity_max": 18.695133625563333, "cost2_max": -22.500280717000663}, "node_ip": "10.138.0.2", "iterations_since_restore": 189, "done": false, "episodes_total": 3470, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540628dcc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540628dc18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540628deb8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 654.6648013253554, "episode_reward_min": 52.204495798087535, "timesteps_total": 7056311, "time_since_restore": 4120.955089092255, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 34974, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557193706, "time_this_iter_s": 20.256343364715576, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 189, "date": "2019-05-07_01-48-26", "episode_len_mean": 684.12}
{"timesteps_since_restore": 7091437, "policy_reward_mean": {}, "episode_reward_max": 863.0046971483464, "time_total_s": 4141.142336606979, "info": {"num_steps_sampled": 7091437, "sample_time_ms": 12623.881, "grad_time_ms": 7754.703, "update_time_ms": 6.733, "default": {"kl": 0.018999753519892693, "entropy": 0.992786705493927, "cur_lr": 0.0005000000237487257, "total_loss": 17.394149780273438, "policy_loss": -0.007952910847961903, "vf_explained_var": 0.8711577653884888, "vf_loss": 17.39804458618164, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 7091437, "load_time_ms": 11.405}, "custom_metrics": {"cost1_mean": 306.5011790496911, "outflow_rate_max": 1215.0555470876075, "system_level_velocity_mean": 12.372026647997787, "cost1_min": 32.231767893927355, "cost1_max": 421.9581439108049, "outflow_rate_min": 444.57232367343914, "cost2_mean": -124.78042802204051, "outflow_rate_mean": 955.9362742514667, "system_level_velocity_min": 9.676509327016989, "cost2_min": -155.60400797463265, "system_level_velocity_max": 18.63600934741749, "cost2_max": -26.26235393056103}, "node_ip": "10.138.0.2", "iterations_since_restore": 190, "done": false, "episodes_total": 3490, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289ac8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 654.6128883957218, "episode_reward_min": 53.862014324042086, "timesteps_total": 7091437, "time_since_restore": 4141.142336606979, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35126, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557193726, "time_this_iter_s": 20.18724751472473, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 190, "date": "2019-05-07_01-48-46", "episode_len_mean": 684.3}
{"timesteps_since_restore": 7127017, "policy_reward_mean": {}, "episode_reward_max": 863.0046971483464, "time_total_s": 4160.740270376205, "info": {"num_steps_sampled": 7127017, "sample_time_ms": 12570.277, "grad_time_ms": 7722.048, "update_time_ms": 6.798, "default": {"kl": 0.018153734505176544, "entropy": 1.0133122205734253, "cur_lr": 0.0005000000237487257, "total_loss": 15.036802291870117, "policy_loss": -0.008942189626395702, "vf_explained_var": 0.8711028099060059, "vf_loss": 15.041869163513184, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 7127017, "load_time_ms": 11.367}, "custom_metrics": {"cost1_mean": 307.359069539438, "outflow_rate_max": 1215.0555470876075, "system_level_velocity_mean": 12.409531311457664, "cost1_min": 32.231767893927355, "cost1_max": 421.9581439108049, "outflow_rate_min": 444.57232367343914, "cost2_mean": -124.79435795454135, "outflow_rate_mean": 957.6626228217383, "system_level_velocity_min": 9.676509327016989, "cost2_min": -155.60400797463265, "system_level_velocity_max": 18.63600934741749, "cost2_max": -26.26235393056103}, "node_ip": "10.138.0.2", "iterations_since_restore": 191, "done": false, "episodes_total": 3505, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540628d860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540628dcc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540628d0f0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 657.3266828259792, "episode_reward_min": 53.862014324042086, "timesteps_total": 7127017, "time_since_restore": 4160.740270376205, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35580, "pid": 25319, "episodes_this_iter": 15, "timestamp": 1557193746, "time_this_iter_s": 19.597933769226074, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 191, "date": "2019-05-07_01-49-06", "episode_len_mean": 684.3}
{"timesteps_since_restore": 7162762, "policy_reward_mean": {}, "episode_reward_max": 863.0046971483464, "time_total_s": 4182.488032341003, "info": {"num_steps_sampled": 7162762, "sample_time_ms": 12693.207, "grad_time_ms": 7688.484, "update_time_ms": 6.823, "default": {"kl": 0.015704838559031487, "entropy": 0.9846106171607971, "cur_lr": 0.0005000000237487257, "total_loss": 16.76085662841797, "policy_loss": -0.009402080439031124, "vf_explained_var": 0.8613373637199402, "vf_loss": 16.766902923583984, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 7162762, "load_time_ms": 11.374}, "custom_metrics": {"cost1_mean": 302.8900376252088, "outflow_rate_max": 1215.0555470876075, "system_level_velocity_mean": 12.404497334220377, "cost1_min": 32.231767893927355, "cost1_max": 421.9581439108049, "outflow_rate_min": 444.57232367343914, "cost2_mean": -123.69974620009434, "outflow_rate_mean": 951.3775076117057, "system_level_velocity_min": 9.359364334966378, "cost2_min": -155.60400797463265, "system_level_velocity_max": 19.19251393763373, "cost2_max": -26.26235393056103}, "node_ip": "10.138.0.2", "iterations_since_restore": 192, "done": false, "episodes_total": 3526, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062893c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062898d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289438>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 647.7504549541868, "episode_reward_min": 53.862014324042086, "timesteps_total": 7162762, "time_since_restore": 4182.488032341003, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35745, "pid": 25319, "episodes_this_iter": 21, "timestamp": 1557193768, "time_this_iter_s": 21.747761964797974, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 192, "date": "2019-05-07_01-49-28", "episode_len_mean": 679.08}
{"timesteps_since_restore": 7199034, "policy_reward_mean": {}, "episode_reward_max": 863.0046971483464, "time_total_s": 4204.161838054657, "info": {"num_steps_sampled": 7199034, "sample_time_ms": 12661.445, "grad_time_ms": 7706.309, "update_time_ms": 6.752, "default": {"kl": 0.015584737062454224, "entropy": 0.9836292862892151, "cur_lr": 0.0005000000237487257, "total_loss": 16.244487762451172, "policy_loss": -0.00711936317384243, "vf_explained_var": 0.866245687007904, "vf_loss": 16.24827766418457, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 7199034, "load_time_ms": 11.394}, "custom_metrics": {"cost1_mean": 301.5871522924528, "outflow_rate_max": 1215.0555470876075, "system_level_velocity_mean": 12.376438335158257, "cost1_min": 32.72854709711438, "cost1_max": 421.9581439108049, "outflow_rate_min": 459.37602933476336, "cost2_mean": -124.71535539747852, "outflow_rate_mean": 949.7280511952217, "system_level_velocity_min": 9.359364334966378, "cost2_min": -147.20883957074415, "system_level_velocity_max": 19.19251393763373, "cost2_max": -26.781765121455816}, "node_ip": "10.138.0.2", "iterations_since_restore": 193, "done": false, "episodes_total": 3547, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f806d8>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 643.4614973661131, "episode_reward_min": 54.84234160037862, "timesteps_total": 7199034, "time_since_restore": 4204.161838054657, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36272, "pid": 25319, "episodes_this_iter": 21, "timestamp": 1557193789, "time_this_iter_s": 21.673805713653564, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 193, "date": "2019-05-07_01-49-49", "episode_len_mean": 679.12}
{"timesteps_since_restore": 7235010, "policy_reward_mean": {}, "episode_reward_max": 775.0916802684616, "time_total_s": 4224.51778960228, "info": {"num_steps_sampled": 7235010, "sample_time_ms": 12647.903, "grad_time_ms": 7744.442, "update_time_ms": 6.692, "default": {"kl": 0.015781620517373085, "entropy": 0.9775607585906982, "cur_lr": 0.0005000000237487257, "total_loss": 14.108677864074707, "policy_loss": -0.0076585798524320126, "vf_explained_var": 0.8901944160461426, "vf_loss": 14.112966537475586, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 7235010, "load_time_ms": 11.588}, "custom_metrics": {"cost1_mean": 300.65010916791107, "outflow_rate_max": 1113.4925011517084, "system_level_velocity_mean": 12.326920985984545, "cost1_min": 32.72854709711438, "cost1_max": 392.1060547789333, "outflow_rate_min": 459.37602933476336, "cost2_mean": -124.7538518741361, "outflow_rate_mean": 947.4247422058469, "system_level_velocity_min": 9.359364334966378, "cost2_min": -146.09096671536906, "system_level_velocity_max": 19.19251393763373, "cost2_max": -26.781765121455816}, "node_ip": "10.138.0.2", "iterations_since_restore": 194, "done": false, "episodes_total": 3566, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062898d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625fb70>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 642.0376679126284, "episode_reward_min": 54.84234160037862, "timesteps_total": 7235010, "time_since_restore": 4224.51778960228, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35976, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557193810, "time_this_iter_s": 20.35595154762268, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 194, "date": "2019-05-07_01-50-10", "episode_len_mean": 680.62}
{"timesteps_since_restore": 7270734, "policy_reward_mean": {}, "episode_reward_max": 808.0417896200578, "time_total_s": 4245.51509976387, "info": {"num_steps_sampled": 7270734, "sample_time_ms": 12764.822, "grad_time_ms": 7766.632, "update_time_ms": 6.694, "default": {"kl": 0.017142990604043007, "entropy": 1.0001301765441895, "cur_lr": 0.0005000000237487257, "total_loss": 16.9310359954834, "policy_loss": -0.007139258086681366, "vf_explained_var": 0.8720619082450867, "vf_loss": 16.934511184692383, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 7270734, "load_time_ms": 11.437}, "custom_metrics": {"cost1_mean": 300.7995854335177, "outflow_rate_max": 1113.4925011517084, "system_level_velocity_mean": 12.324597498237924, "cost1_min": 32.72854709711438, "cost1_max": 392.1060547789333, "outflow_rate_min": 459.37602933476336, "cost2_mean": -125.21873799211016, "outflow_rate_mean": 947.4857893265284, "system_level_velocity_min": 9.359364334966378, "cost2_min": -146.09096671536906, "system_level_velocity_max": 19.19251393763373, "cost2_max": -26.781765121455816}, "node_ip": "10.138.0.2", "iterations_since_restore": 195, "done": false, "episodes_total": 3584, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f805c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c1d0>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 650.3565980151307, "episode_reward_min": 54.84234160037862, "timesteps_total": 7270734, "time_since_restore": 4245.51509976387, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35724, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557193831, "time_this_iter_s": 20.997310161590576, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 195, "date": "2019-05-07_01-50-31", "episode_len_mean": 680.62}
{"timesteps_since_restore": 7306464, "policy_reward_mean": {}, "episode_reward_max": 808.0417896200578, "time_total_s": 4266.76592874527, "info": {"num_steps_sampled": 7306464, "sample_time_ms": 12875.038, "grad_time_ms": 7755.96, "update_time_ms": 6.633, "default": {"kl": 0.016651971265673637, "entropy": 1.0025780200958252, "cur_lr": 0.0005000000237487257, "total_loss": 14.60432243347168, "policy_loss": -0.00678718276321888, "vf_explained_var": 0.8891025185585022, "vf_loss": 14.60755443572998, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 7306464, "load_time_ms": 10.878}, "custom_metrics": {"cost1_mean": 298.38880346093623, "outflow_rate_max": 1179.0788699741822, "system_level_velocity_mean": 12.242741039176071, "cost1_min": 32.72854709711438, "cost1_max": 419.1025699745096, "outflow_rate_min": 459.37602933476336, "cost2_mean": -124.90234988323135, "outflow_rate_mean": 943.1819616545918, "system_level_velocity_min": 9.359364334966378, "cost2_min": -146.09096671536906, "system_level_velocity_max": 19.19251393763373, "cost2_max": -26.781765121455816}, "node_ip": "10.138.0.2", "iterations_since_restore": 196, "done": false, "episodes_total": 3603, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062898d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289908>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 647.7625323771706, "episode_reward_min": 54.84234160037862, "timesteps_total": 7306464, "time_since_restore": 4266.76592874527, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35730, "pid": 25319, "episodes_this_iter": 19, "timestamp": 1557193852, "time_this_iter_s": 21.250828981399536, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 196, "date": "2019-05-07_01-50-52", "episode_len_mean": 680.52}
{"timesteps_since_restore": 7342646, "policy_reward_mean": {}, "episode_reward_max": 808.0417896200578, "time_total_s": 4287.026911973953, "info": {"num_steps_sampled": 7342646, "sample_time_ms": 12885.055, "grad_time_ms": 7783.559, "update_time_ms": 6.722, "default": {"kl": 0.016794653609395027, "entropy": 1.0144189596176147, "cur_lr": 0.0005000000237487257, "total_loss": 18.577594757080078, "policy_loss": -0.010525784455239773, "vf_explained_var": 0.8605296015739441, "vf_loss": 18.584535598754883, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 7342646, "load_time_ms": 11.268}, "custom_metrics": {"cost1_mean": 299.8232325858342, "outflow_rate_max": 1179.0788699741822, "system_level_velocity_mean": 12.303532522810006, "cost1_min": 28.947734376111235, "cost1_max": 419.1025699745096, "outflow_rate_min": 453.767226909696, "cost2_mean": -124.47917288148517, "outflow_rate_mean": 947.2199717614503, "system_level_velocity_min": 9.765183546267604, "cost2_min": -146.09096671536906, "system_level_velocity_max": 19.172709559188018, "cost2_max": -22.573304022732643}, "node_ip": "10.138.0.2", "iterations_since_restore": 197, "done": false, "episodes_total": 3624, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80780>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 651.2284866970177, "episode_reward_min": 47.42232594628585, "timesteps_total": 7342646, "time_since_restore": 4287.026911973953, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36182, "pid": 25319, "episodes_this_iter": 21, "timestamp": 1557193872, "time_this_iter_s": 20.26098322868347, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 197, "date": "2019-05-07_01-51-12", "episode_len_mean": 680.47}
{"timesteps_since_restore": 7379842, "policy_reward_mean": {}, "episode_reward_max": 808.0417896200578, "time_total_s": 4308.237688541412, "info": {"num_steps_sampled": 7379842, "sample_time_ms": 12875.417, "grad_time_ms": 7794.048, "update_time_ms": 6.669, "default": {"kl": 0.01953454501926899, "entropy": 1.0244967937469482, "cur_lr": 0.0005000000237487257, "total_loss": 15.373625755310059, "policy_loss": -0.010217230767011642, "vf_explained_var": 0.8861892223358154, "vf_loss": 15.379671096801758, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 7379842, "load_time_ms": 11.288}, "custom_metrics": {"cost1_mean": 303.45254406127196, "outflow_rate_max": 1179.0788699741822, "system_level_velocity_mean": 12.266990006838311, "cost1_min": 28.947734376111235, "cost1_max": 419.1025699745096, "outflow_rate_min": 453.767226909696, "cost2_mean": -124.11761210794513, "outflow_rate_mean": 951.2533770345049, "system_level_velocity_min": 9.765183546267604, "cost2_min": -145.8025692252719, "system_level_velocity_max": 19.172709559188018, "cost2_max": -22.573304022732643}, "node_ip": "10.138.0.2", "iterations_since_restore": 198, "done": false, "episodes_total": 3644, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062895c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289e48>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 653.371007824532, "episode_reward_min": 47.42232594628585, "timesteps_total": 7379842, "time_since_restore": 4308.237688541412, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 37196, "pid": 25319, "episodes_this_iter": 20, "timestamp": 1557193893, "time_this_iter_s": 21.210776567459106, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 198, "date": "2019-05-07_01-51-33", "episode_len_mean": 686.96}
{"timesteps_since_restore": 7416107, "policy_reward_mean": {}, "episode_reward_max": 808.0417896200578, "time_total_s": 4328.560368061066, "info": {"num_steps_sampled": 7416107, "sample_time_ms": 12861.191, "grad_time_ms": 7814.689, "update_time_ms": 6.59, "default": {"kl": 0.017000265419483185, "entropy": 1.045984148979187, "cur_lr": 0.0005000000237487257, "total_loss": 19.809574127197266, "policy_loss": -0.009004207327961922, "vf_explained_var": 0.843785285949707, "vf_loss": 19.81494903564453, "cur_kl_coeff": 0.21357420086860657}, "num_steps_trained": 7416107, "load_time_ms": 11.238}, "custom_metrics": {"cost1_mean": 300.1636256206948, "outflow_rate_max": 1179.0788699741822, "system_level_velocity_mean": 12.323580097711964, "cost1_min": 18.30591479330134, "cost1_max": 419.1025699745096, "outflow_rate_min": 423.5377983815456, "cost2_mean": -123.1018740527737, "outflow_rate_mean": 943.3943148355543, "system_level_velocity_min": 9.765183546267604, "cost2_min": -145.8025692252719, "system_level_velocity_max": 19.706628681371633, "cost2_max": -17.19358431052971}, "node_ip": "10.138.0.2", "iterations_since_restore": 199, "done": false, "episodes_total": 3665, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540628d240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062664e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540628d208>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 651.7914475026755, "episode_reward_min": 34.348227630896425, "timesteps_total": 7416107, "time_since_restore": 4328.560368061066, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 36265, "pid": 25319, "episodes_this_iter": 21, "timestamp": 1557193914, "time_this_iter_s": 20.32267951965332, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 199, "date": "2019-05-07_01-51-54", "episode_len_mean": 680.23}
{"timesteps_since_restore": 7452003, "policy_reward_mean": {}, "episode_reward_max": 804.2766355627662, "time_total_s": 4349.240902900696, "info": {"num_steps_sampled": 7452003, "sample_time_ms": 12892.773, "grad_time_ms": 7832.066, "update_time_ms": 6.508, "default": {"kl": 0.016466161236166954, "entropy": 1.0466041564941406, "cur_lr": 0.0005000000237487257, "total_loss": 14.207254409790039, "policy_loss": -0.01058936771005392, "vf_explained_var": 0.8932188153266907, "vf_loss": 14.214326858520508, "cur_kl_coeff": 0.21357418596744537}, "num_steps_trained": 7452003, "load_time_ms": 11.523}, "custom_metrics": {"cost1_mean": 297.43916032166794, "outflow_rate_max": 1179.0788699741822, "system_level_velocity_mean": 12.237030902038716, "cost1_min": 18.30591479330134, "cost1_max": 419.1025699745096, "outflow_rate_min": 423.5377983815456, "cost2_mean": -123.14706296112118, "outflow_rate_mean": 937.1547895671392, "system_level_velocity_min": 9.622388819726185, "cost2_min": -145.8025692252719, "system_level_velocity_max": 19.706628681371633, "cost2_max": -17.19358431052971}, "node_ip": "10.138.0.2", "iterations_since_restore": 200, "done": true, "episodes_total": 3683, "config": {"lr": 0.0005, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "optimizer": {}, "num_gpus": 0, "lambda": 0.97, "sample_async": false, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "num_cpus_for_driver": 1, "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289908>", "on_train_result": null, "on_sample_end": null}, "log_level": "INFO", "num_gpus_per_worker": 0, "clip_actions": false, "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "use_lstm": false, "grayscale": false, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "conv_filters": null, "max_seq_len": 20, "framestack": true, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "free_log_std": false, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "synchronize_filters": true, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "batch_mode": "truncate_episodes", "num_cpus_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "log_device_placement": false}}, "episode_reward_mean": 644.7721438358541, "episode_reward_min": 34.348227630896425, "timesteps_total": 7452003, "time_since_restore": 4349.240902900696, "hostname": "flow-main", "num_metric_batches_dropped": 0, "timesteps_this_iter": 35896, "pid": 25319, "episodes_this_iter": 18, "timestamp": 1557193935, "time_this_iter_s": 20.680534839630127, "experiment_id": "ea419ef9679d4a6d84587f07087c3ddf", "training_iteration": 200, "date": "2019-05-07_01-52-15", "episode_len_mean": 680.23}

{"timesteps_since_restore": 46935, "policy_reward_mean": {}, "episode_reward_max": NaN, "time_total_s": 49.24121570587158, "info": {"num_steps_sampled": 46935, "sample_time_ms": 37602.211, "grad_time_ms": 10050.731, "update_time_ms": 1346.663, "default": {"kl": 0.0002695932053029537, "entropy": 1.420686960220337, "cur_lr": 0.0005000000237487257, "total_loss": 1.3862916231155396, "policy_loss": -2.5766794351511635e-06, "vf_explained_var": 0.9155588746070862, "vf_loss": 1.3862401247024536, "cur_kl_coeff": 0.20000003278255463}, "num_steps_trained": 46935, "load_time_ms": 69.281}, "custom_metrics": {}, "node_ip": "10.138.0.2", "iterations_since_restore": 1, "done": false, "episodes_total": 0, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5390>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5400>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a53c8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": NaN, "timesteps_this_iter": 46935, "timesteps_total": 46935, "time_since_restore": 49.24121570587158, "hostname": "flow-main", "episode_reward_min": NaN, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 0, "timestamp": 1557184540, "time_this_iter_s": 49.24121570587158, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 1, "date": "2019-05-06_23-15-40", "episode_len_mean": NaN}
{"timesteps_since_restore": 92427, "policy_reward_mean": {}, "episode_reward_max": 556.720368839301, "time_total_s": 76.76523756980896, "info": {"num_steps_sampled": 92427, "sample_time_ms": 27929.526, "grad_time_ms": 9607.321, "update_time_ms": 676.858, "default": {"kl": 0.0035235299728810787, "entropy": 1.4196795225143433, "cur_lr": 0.0005000000237487257, "total_loss": 1.0550857782363892, "policy_loss": -0.0015950693050399423, "vf_explained_var": 0.9726424813270569, "vf_loss": 1.056328535079956, "cur_kl_coeff": 0.10000002384185791}, "num_steps_trained": 92427, "load_time_ms": 41.599}, "custom_metrics": {"cost1_mean": 225.0654872975037, "outflow_rate_max": 929.1576255166939, "system_level_velocity_mean": 9.410490640412949, "cost1_min": 21.993668492832846, "cost1_max": 303.3282621866127, "outflow_rate_min": 198.07256592000738, "cost2_mean": -0.031770444280237155, "outflow_rate_mean": 684.8497234415, "system_level_velocity_min": 3.3768096568795722, "cost2_min": -0.625, "system_level_velocity_max": 18.103056212616654, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 2, "done": false, "episodes_total": 21, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540622e8d0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540622e940>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540622e908>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 418.8940241191266, "timesteps_this_iter": 45492, "timesteps_total": 92427, "time_since_restore": 76.76523756980896, "hostname": "flow-main", "episode_reward_min": 43.98733698566568, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557184567, "time_this_iter_s": 27.524021863937378, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 2, "date": "2019-05-06_23-16-07", "episode_len_mean": 668.2380952380952}
{"timesteps_since_restore": 134313, "policy_reward_mean": {}, "episode_reward_max": 556.720368839301, "time_total_s": 106.17374682426453, "info": {"num_steps_sampled": 134313, "sample_time_ms": 25089.783, "grad_time_ms": 9702.262, "update_time_ms": 453.939, "default": {"kl": 0.0061877416446805, "entropy": 1.4147295951843262, "cur_lr": 0.0005000000237487257, "total_loss": 0.9261372685432434, "policy_loss": -0.0021250243298709393, "vf_explained_var": 0.9839744567871094, "vf_loss": 0.9279528260231018, "cur_kl_coeff": 0.05000000819563866}, "num_steps_trained": 134313, "load_time_ms": 32.178}, "custom_metrics": {"cost1_mean": 222.10600815441202, "outflow_rate_max": 929.1576255166939, "system_level_velocity_mean": 9.37006097428474, "cost1_min": 21.993668492832846, "cost1_max": 303.3282621866127, "outflow_rate_min": 198.07256592000738, "cost2_mean": -0.022235038802680056, "outflow_rate_mean": 670.4559934589031, "system_level_velocity_min": 3.3768096568795722, "cost2_min": -0.625, "system_level_velocity_max": 18.168644497519768, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 3, "done": false, "episodes_total": 40, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235be0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235a90>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235b00>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 405.5127828648859, "timesteps_this_iter": 41886, "timesteps_total": 134313, "time_since_restore": 106.17374682426453, "hostname": "flow-main", "episode_reward_min": 43.98733698566568, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557184597, "time_this_iter_s": 29.408509254455566, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 3, "date": "2019-05-06_23-16-37", "episode_len_mean": 666.725}
{"timesteps_since_restore": 177911, "policy_reward_mean": {}, "episode_reward_max": 556.720368839301, "time_total_s": 133.62362909317017, "info": {"num_steps_sampled": 177911, "sample_time_ms": 23241.023, "grad_time_ms": 9682.982, "update_time_ms": 342.696, "default": {"kl": 0.009162853471934795, "entropy": 1.4305154085159302, "cur_lr": 0.0005000000237487257, "total_loss": 0.45639142394065857, "policy_loss": -0.0026572514325380325, "vf_explained_var": 0.9896144866943359, "vf_loss": 0.4585905075073242, "cur_kl_coeff": 0.050000011920928955}, "num_steps_trained": 177911, "load_time_ms": 27.398}, "custom_metrics": {"cost1_mean": 224.80495542703204, "outflow_rate_max": 929.1576255166939, "system_level_velocity_mean": 9.267416724883011, "cost1_min": 21.993668492832846, "cost1_max": 303.50698162720744, "outflow_rate_min": 198.07256592000738, "cost2_mean": -0.016781161360513254, "outflow_rate_mean": 672.8111298103746, "system_level_velocity_min": 3.3768096568795722, "cost2_min": -0.625, "system_level_velocity_max": 18.168644497519768, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 4, "done": false, "episodes_total": 53, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540623e240>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540623ea90>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540623e278>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 413.45439762565024, "timesteps_this_iter": 43598, "timesteps_total": 177911, "time_since_restore": 133.62362909317017, "hostname": "flow-main", "episode_reward_min": 43.98733698566568, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 13, "timestamp": 1557184624, "time_this_iter_s": 27.44988226890564, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 4, "date": "2019-05-06_23-17-04", "episode_len_mean": 674.8867924528302}
{"timesteps_since_restore": 222585, "policy_reward_mean": {}, "episode_reward_max": 609.2086949713776, "time_total_s": 162.12621927261353, "info": {"num_steps_sampled": 222585, "sample_time_ms": 22221.061, "grad_time_ms": 9793.081, "update_time_ms": 276.458, "default": {"kl": 0.009915199130773544, "entropy": 1.4083727598190308, "cur_lr": 0.0005000000237487257, "total_loss": 1.1499357223510742, "policy_loss": -0.004126735031604767, "vf_explained_var": 0.9778526425361633, "vf_loss": 1.1535667181015015, "cur_kl_coeff": 0.050000011920928955}, "num_steps_trained": 222585, "load_time_ms": 24.592}, "custom_metrics": {"cost1_mean": 223.48784326191864, "outflow_rate_max": 929.1576255166939, "system_level_velocity_mean": 9.067261815916272, "cost1_min": 21.993668492832846, "cost1_max": 303.50698162720744, "outflow_rate_min": 198.07256592000738, "cost2_mean": -0.019848593601531465, "outflow_rate_mean": 671.3697337725388, "system_level_velocity_min": 3.3768096568795722, "cost2_min": -0.625, "system_level_velocity_max": 18.168644497519768, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 5, "done": false, "episodes_total": 70, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062355f8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540622ef60>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235208>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 423.8427542191544, "timesteps_this_iter": 44674, "timesteps_total": 222585, "time_since_restore": 162.12621927261353, "hostname": "flow-main", "episode_reward_min": 43.98733698566568, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 17, "timestamp": 1557184653, "time_this_iter_s": 28.50259017944336, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 5, "date": "2019-05-06_23-17-33", "episode_len_mean": 680.9857142857143}
{"timesteps_since_restore": 263320, "policy_reward_mean": {}, "episode_reward_max": 647.9872266253403, "time_total_s": 187.82212686538696, "info": {"num_steps_sampled": 263320, "sample_time_ms": 21254.645, "grad_time_ms": 9690.19, "update_time_ms": 231.771, "default": {"kl": 0.011108389124274254, "entropy": 1.3846511840820312, "cur_lr": 0.0005000000237487257, "total_loss": 1.9544929265975952, "policy_loss": -0.004217033740133047, "vf_explained_var": 0.9725704789161682, "vf_loss": 1.9581546783447266, "cur_kl_coeff": 0.050000011920928955}, "num_steps_trained": 263320, "load_time_ms": 22.666}, "custom_metrics": {"cost1_mean": 224.71068994374147, "outflow_rate_max": 929.1576255166939, "system_level_velocity_mean": 9.042795088861158, "cost1_min": 21.993668492832846, "cost1_max": 303.50698162720744, "outflow_rate_min": 198.07256592000738, "cost2_mean": -0.026498835409070595, "outflow_rate_mean": 676.4105566145679, "system_level_velocity_min": 3.3768096568795722, "cost2_min": -0.7189452697569441, "system_level_velocity_max": 18.168644497519768, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 6, "done": false, "episodes_total": 82, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235c18>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235d68>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235c50>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 440.84491803635916, "timesteps_this_iter": 40735, "timesteps_total": 263320, "time_since_restore": 187.82212686538696, "hostname": "flow-main", "episode_reward_min": 43.98733698566568, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 12, "timestamp": 1557184678, "time_this_iter_s": 25.695907592773438, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 6, "date": "2019-05-06_23-17-58", "episode_len_mean": 683.7682926829268}
{"timesteps_since_restore": 305015, "policy_reward_mean": {}, "episode_reward_max": 701.7916466586348, "time_total_s": 214.64566612243652, "info": {"num_steps_sampled": 305015, "sample_time_ms": 20630.471, "grad_time_ms": 9711.117, "update_time_ms": 200.166, "default": {"kl": 0.006619452033191919, "entropy": 1.3871936798095703, "cur_lr": 0.0005000000237487257, "total_loss": 2.333677053451538, "policy_loss": -0.0028053708374500275, "vf_explained_var": 0.9666088223457336, "vf_loss": 2.336151599884033, "cur_kl_coeff": 0.050000011920928955}, "num_steps_trained": 305015, "load_time_ms": 21.322}, "custom_metrics": {"cost1_mean": 230.6904536634389, "outflow_rate_max": 938.9925542016255, "system_level_velocity_mean": 9.193322027485147, "cost1_min": 21.993668492832846, "cost1_max": 305.96778249934994, "outflow_rate_min": 198.07256592000738, "cost2_mean": -0.030587393888179073, "outflow_rate_mean": 701.1801915459409, "system_level_velocity_min": 3.3768096568795722, "cost2_min": -0.7189452697569441, "system_level_velocity_max": 18.168644497519768, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 7, "done": false, "episodes_total": 99, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540623ea90>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540623e438>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540623e7b8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 468.7024086421724, "timesteps_this_iter": 41695, "timesteps_total": 305015, "time_since_restore": 214.64566612243652, "hostname": "flow-main", "episode_reward_min": 43.98733698566568, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 17, "timestamp": 1557184705, "time_this_iter_s": 26.82353925704956, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 7, "date": "2019-05-06_23-18-25", "episode_len_mean": 686.5555555555555}
{"timesteps_since_restore": 347993, "policy_reward_mean": {}, "episode_reward_max": 733.2748689579652, "time_total_s": 240.9808313846588, "info": {"num_steps_sampled": 347993, "sample_time_ms": 20076.809, "grad_time_ms": 9750.916, "update_time_ms": 176.133, "default": {"kl": 0.007144523784518242, "entropy": 1.391646385192871, "cur_lr": 0.0005000000237487257, "total_loss": 2.742170810699463, "policy_loss": -0.0022224937565624714, "vf_explained_var": 0.9508734345436096, "vf_loss": 2.7440359592437744, "cur_kl_coeff": 0.050000011920928955}, "num_steps_trained": 347993, "load_time_ms": 20.338}, "custom_metrics": {"cost1_mean": 234.66649353751274, "outflow_rate_max": 938.9925542016255, "system_level_velocity_mean": 9.180722541785807, "cost1_min": 24.425639010655892, "cost1_max": 305.96778249934994, "outflow_rate_min": 241.33626464901775, "cost2_mean": -0.035463386174328024, "outflow_rate_mean": 719.0830119398489, "system_level_velocity_min": 3.506216674295456, "cost2_min": -0.7189452697569441, "system_level_velocity_max": 18.168644497519768, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 8, "done": false, "episodes_total": 115, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540623e198>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062359e8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540623ef28>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 500.6300496367343, "timesteps_this_iter": 42978, "timesteps_total": 347993, "time_since_restore": 240.9808313846588, "hostname": "flow-main", "episode_reward_min": 48.85127802131181, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 16, "timestamp": 1557184731, "time_this_iter_s": 26.33516526222229, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 8, "date": "2019-05-06_23-18-51", "episode_len_mean": 693.36}
{"timesteps_since_restore": 388936, "policy_reward_mean": {}, "episode_reward_max": 761.1119049612797, "time_total_s": 265.8843014240265, "info": {"num_steps_sampled": 388936, "sample_time_ms": 19556.032, "grad_time_ms": 9713.833, "update_time_ms": 157.616, "default": {"kl": 0.006528093479573727, "entropy": 1.376724123954773, "cur_lr": 0.0005000000237487257, "total_loss": 2.879413604736328, "policy_loss": -0.001885735895484686, "vf_explained_var": 0.9554795622825623, "vf_loss": 2.8809731006622314, "cur_kl_coeff": 0.05000000819563866}, "num_steps_trained": 388936, "load_time_ms": 19.349}, "custom_metrics": {"cost1_mean": 234.27353321506905, "outflow_rate_max": 938.9925542016255, "system_level_velocity_mean": 9.179259106012639, "cost1_min": 24.425639010655892, "cost1_max": 305.96778249934994, "outflow_rate_min": 241.33626464901775, "cost2_mean": -0.029391056321333223, "outflow_rate_mean": 729.1709659977129, "system_level_velocity_min": 3.506216674295456, "cost2_min": -0.7189452697569441, "system_level_velocity_max": 18.168644497519768, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 9, "done": false, "episodes_total": 129, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247eb8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062471d0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247208>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 527.47397225222, "timesteps_this_iter": 40943, "timesteps_total": 388936, "time_since_restore": 265.8843014240265, "hostname": "flow-main", "episode_reward_min": 48.85127802131181, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 14, "timestamp": 1557184756, "time_this_iter_s": 24.903470039367676, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 9, "date": "2019-05-06_23-19-16", "episode_len_mean": 693.36}
{"timesteps_since_restore": 430835, "policy_reward_mean": {}, "episode_reward_max": 761.1119049612797, "time_total_s": 292.68145179748535, "info": {"num_steps_sampled": 430835, "sample_time_ms": 19297.838, "grad_time_ms": 9714.138, "update_time_ms": 142.901, "default": {"kl": 0.007121108006685972, "entropy": 1.370849847793579, "cur_lr": 0.0005000000237487257, "total_loss": 4.271204948425293, "policy_loss": -0.0017119215335696936, "vf_explained_var": 0.9190869927406311, "vf_loss": 4.272561073303223, "cur_kl_coeff": 0.05000000819563866}, "num_steps_trained": 430835, "load_time_ms": 18.716}, "custom_metrics": {"cost1_mean": 234.86325046636014, "outflow_rate_max": 938.9925542016255, "system_level_velocity_mean": 9.051990616670027, "cost1_min": 86.1035128295576, "cost1_max": 305.96778249934994, "outflow_rate_min": 241.33626464901775, "cost2_mean": -0.038057986940814074, "outflow_rate_mean": 747.9564894753972, "system_level_velocity_min": 3.506216674295456, "cost2_min": -0.7189452697569441, "system_level_velocity_max": 11.722149708194909, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 10, "done": false, "episodes_total": 148, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235c18>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235b00>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235a20>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 566.5412860799055, "timesteps_this_iter": 41899, "timesteps_total": 430835, "time_since_restore": 292.68145179748535, "hostname": "flow-main", "episode_reward_min": 299.50999079314386, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557184783, "time_this_iter_s": 26.797150373458862, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 10, "date": "2019-05-06_23-19-43", "episode_len_mean": 700.0}
{"timesteps_since_restore": 473568, "policy_reward_mean": {}, "episode_reward_max": 761.1119049612797, "time_total_s": 320.4645047187805, "info": {"num_steps_sampled": 473568, "sample_time_ms": 17135.437, "grad_time_ms": 9879.39, "update_time_ms": 9.198, "default": {"kl": 0.0081826476380229, "entropy": 1.356130599975586, "cur_lr": 0.0005000000237487257, "total_loss": 3.7285611629486084, "policy_loss": -0.0022325071040540934, "vf_explained_var": 0.934052586555481, "vf_loss": 3.730384349822998, "cur_kl_coeff": 0.05000000447034836}, "num_steps_trained": 473568, "load_time_ms": 12.989}, "custom_metrics": {"cost1_mean": 234.45383904816362, "outflow_rate_max": 938.9925542016255, "system_level_velocity_mean": 9.20857506911128, "cost1_min": 41.79036143404944, "cost1_max": 305.96778249934994, "outflow_rate_min": 444.7734289452424, "cost2_mean": -0.03558206547118343, "outflow_rate_mean": 761.1871465068388, "system_level_velocity_min": 6.450999945312486, "cost2_min": -0.7189452697569441, "system_level_velocity_max": 17.41983888806171, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 11, "done": false, "episodes_total": 162, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540623e438>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540623e668>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540623e240>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 582.630541471161, "timesteps_this_iter": 42733, "timesteps_total": 473568, "time_since_restore": 320.4645047187805, "hostname": "flow-main", "episode_reward_min": 81.24624399536087, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 14, "timestamp": 1557184811, "time_this_iter_s": 27.783052921295166, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 11, "date": "2019-05-06_23-20-11", "episode_len_mean": 693.65}
{"timesteps_since_restore": 514368, "policy_reward_mean": {}, "episode_reward_max": 761.1119049612797, "time_total_s": 345.229829788208, "info": {"num_steps_sampled": 514368, "sample_time_ms": 16787.259, "grad_time_ms": 9951.894, "update_time_ms": 9.199, "default": {"kl": 0.007660532835870981, "entropy": 1.3252142667770386, "cur_lr": 0.0005000000237487257, "total_loss": 4.966915130615234, "policy_loss": -0.002497066045179963, "vf_explained_var": 0.9259649515151978, "vf_loss": 4.969029426574707, "cur_kl_coeff": 0.050000011920928955}, "num_steps_trained": 514368, "load_time_ms": 12.817}, "custom_metrics": {"cost1_mean": 236.3973898200311, "outflow_rate_max": 938.9925542016255, "system_level_velocity_mean": 9.275328860283219, "cost1_min": 41.79036143404944, "cost1_max": 305.96778249934994, "outflow_rate_min": 470.72592455763873, "cost2_mean": -0.03652874719400549, "outflow_rate_mean": 780.9369657216598, "system_level_velocity_min": 6.450999945312486, "cost2_min": -0.7189452697569441, "system_level_velocity_max": 17.41983888806171, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 12, "done": false, "episodes_total": 177, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247c50>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247710>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247e48>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 608.4090332116637, "timesteps_this_iter": 40800, "timesteps_total": 514368, "time_since_restore": 345.229829788208, "hostname": "flow-main", "episode_reward_min": 81.24624399536087, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 15, "timestamp": 1557184836, "time_this_iter_s": 24.76532506942749, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 12, "date": "2019-05-06_23-20-36", "episode_len_mean": 693.65}
{"timesteps_since_restore": 555353, "policy_reward_mean": {}, "episode_reward_max": 833.3646023854889, "time_total_s": 370.4667730331421, "info": {"num_steps_sampled": 555353, "sample_time_ms": 16376.18, "grad_time_ms": 9945.438, "update_time_ms": 9.24, "default": {"kl": 0.007831918075680733, "entropy": 1.334930658340454, "cur_lr": 0.0005000000237487257, "total_loss": 5.136409759521484, "policy_loss": -0.002388333436101675, "vf_explained_var": 0.9214170575141907, "vf_loss": 5.138406276702881, "cur_kl_coeff": 0.05000000447034836}, "num_steps_trained": 555353, "load_time_ms": 12.763}, "custom_metrics": {"cost1_mean": 238.18516825418547, "outflow_rate_max": 930.4995530449806, "system_level_velocity_mean": 9.340655542473991, "cost1_min": 41.79036143404944, "cost1_max": 297.6073080059917, "outflow_rate_min": 470.72592455763873, "cost2_mean": -0.03246949705983907, "outflow_rate_mean": 795.4883550898916, "system_level_velocity_min": 6.450999945312486, "cost2_min": -0.6000000000000001, "system_level_velocity_max": 17.41983888806171, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 13, "done": false, "episodes_total": 195, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247470>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247048>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247f60>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 629.1233389138125, "timesteps_this_iter": 40985, "timesteps_total": 555353, "time_since_restore": 370.4667730331421, "hostname": "flow-main", "episode_reward_min": 81.24624399536087, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557184861, "time_this_iter_s": 25.236943244934082, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 13, "date": "2019-05-06_23-21-01", "episode_len_mean": 693.65}
{"timesteps_since_restore": 595214, "policy_reward_mean": {}, "episode_reward_max": 833.3646023854889, "time_total_s": 395.15548062324524, "info": {"num_steps_sampled": 595214, "sample_time_ms": 16107.075, "grad_time_ms": 9941.156, "update_time_ms": 9.225, "default": {"kl": 0.008516648784279823, "entropy": 1.3193223476409912, "cur_lr": 0.0005000000237487257, "total_loss": 6.5292181968688965, "policy_loss": -0.0019701262935996056, "vf_explained_var": 0.9187086224555969, "vf_loss": 6.530762672424316, "cur_kl_coeff": 0.05000000819563866}, "num_steps_trained": 595214, "load_time_ms": 12.556}, "custom_metrics": {"cost1_mean": 235.46498656700206, "outflow_rate_max": 924.8453265888782, "system_level_velocity_mean": 9.425257823498693, "cost1_min": 27.679902400179856, "cost1_max": 284.40268927422665, "outflow_rate_min": 437.2498088386631, "cost2_mean": -0.022822360534292305, "outflow_rate_mean": 796.9882570394802, "system_level_velocity_min": 6.450999945312486, "cost2_min": -0.5, "system_level_velocity_max": 18.132689328408283, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 14, "done": false, "episodes_total": 213, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235b00>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062355f8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235cf8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 633.9107420687195, "timesteps_this_iter": 39861, "timesteps_total": 595214, "time_since_restore": 395.15548062324524, "hostname": "flow-main", "episode_reward_min": 51.98538124117028, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557184886, "time_this_iter_s": 24.68870759010315, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 14, "date": "2019-05-06_23-21-26", "episode_len_mean": 687.06}
{"timesteps_since_restore": 635538, "policy_reward_mean": {}, "episode_reward_max": 833.3646023854889, "time_total_s": 420.617826461792, "info": {"num_steps_sampled": 635538, "sample_time_ms": 15854.753, "grad_time_ms": 9891.667, "update_time_ms": 8.757, "default": {"kl": 0.009342627599835396, "entropy": 1.3138737678527832, "cur_lr": 0.0005000000237487257, "total_loss": 5.308369159698486, "policy_loss": -0.0028108940459787846, "vf_explained_var": 0.9317082762718201, "vf_loss": 5.3107123374938965, "cur_kl_coeff": 0.05000000447034836}, "num_steps_trained": 635538, "load_time_ms": 12.531}, "custom_metrics": {"cost1_mean": 242.280904401042, "outflow_rate_max": 1061.712526466403, "system_level_velocity_mean": 9.67151200922449, "cost1_min": 27.679902400179856, "cost1_max": 347.25624732567195, "outflow_rate_min": 437.2498088386631, "cost2_mean": -0.025827399981487153, "outflow_rate_mean": 819.0856835525468, "system_level_velocity_min": 6.450999945312486, "cost2_min": -0.5, "system_level_velocity_max": 18.132689328408283, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 15, "done": false, "episodes_total": 230, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247320>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247ac8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247208>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 646.6220214420035, "timesteps_this_iter": 40324, "timesteps_total": 635538, "time_since_restore": 420.617826461792, "hostname": "flow-main", "episode_reward_min": 51.98538124117028, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 17, "timestamp": 1557184911, "time_this_iter_s": 25.462345838546753, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 15, "date": "2019-05-06_23-21-51", "episode_len_mean": 687.06}
{"timesteps_since_restore": 675620, "policy_reward_mean": {}, "episode_reward_max": 833.3646023854889, "time_total_s": 446.56420493125916, "info": {"num_steps_sampled": 675620, "sample_time_ms": 15787.049, "grad_time_ms": 9981.145, "update_time_ms": 8.857, "default": {"kl": 0.00784612912684679, "entropy": 1.325645923614502, "cur_lr": 0.0005000000237487257, "total_loss": 6.242938995361328, "policy_loss": -0.0012645864626392722, "vf_explained_var": 0.9193930625915527, "vf_loss": 6.24381160736084, "cur_kl_coeff": 0.05000000447034836}, "num_steps_trained": 675620, "load_time_ms": 12.57}, "custom_metrics": {"cost1_mean": 250.14496040568108, "outflow_rate_max": 1061.712526466403, "system_level_velocity_mean": 9.950086197163515, "cost1_min": 27.679902400179856, "cost1_max": 347.25624732567195, "outflow_rate_min": 437.2498088386631, "cost2_mean": -0.020058519749996964, "outflow_rate_mean": 841.2913817436295, "system_level_velocity_min": 8.12052347590204, "cost2_min": -0.3196157141763878, "system_level_velocity_max": 18.132689328408283, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 16, "done": false, "episodes_total": 247, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540622e9e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062359e8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235160>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 660.7843276608337, "timesteps_this_iter": 40082, "timesteps_total": 675620, "time_since_restore": 446.56420493125916, "hostname": "flow-main", "episode_reward_min": 51.98538124117028, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 17, "timestamp": 1557184937, "time_this_iter_s": 25.946378469467163, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 16, "date": "2019-05-06_23-22-17", "episode_len_mean": 687.06}
{"timesteps_since_restore": 715049, "policy_reward_mean": {}, "episode_reward_max": 833.3646023854889, "time_total_s": 471.5763533115387, "info": {"num_steps_sampled": 715049, "sample_time_ms": 15608.589, "grad_time_ms": 9976.527, "update_time_ms": 8.725, "default": {"kl": 0.009407682344317436, "entropy": 1.3062489032745361, "cur_lr": 0.0005000000237487257, "total_loss": 6.96530818939209, "policy_loss": -0.002723806072026491, "vf_explained_var": 0.9172168970108032, "vf_loss": 6.967560768127441, "cur_kl_coeff": 0.05000000819563866}, "num_steps_trained": 715049, "load_time_ms": 12.585}, "custom_metrics": {"cost1_mean": 259.32855663687076, "outflow_rate_max": 1061.712526466403, "system_level_velocity_mean": 10.141617159923822, "cost1_min": 27.679902400179856, "cost1_max": 347.25624732567195, "outflow_rate_min": 437.2498088386631, "cost2_mean": -0.021763805300206603, "outflow_rate_mean": 865.9287399714343, "system_level_velocity_min": 8.15878131492689, "cost2_min": -0.34396327065619026, "system_level_velocity_max": 18.132689328408283, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 17, "done": false, "episodes_total": 264, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247668>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247c88>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247438>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 683.9105149063944, "timesteps_this_iter": 39429, "timesteps_total": 715049, "time_since_restore": 471.5763533115387, "hostname": "flow-main", "episode_reward_min": 51.98538124117028, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 17, "timestamp": 1557184962, "time_this_iter_s": 25.01214838027954, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 17, "date": "2019-05-06_23-22-42", "episode_len_mean": 693.41}
{"timesteps_since_restore": 754469, "policy_reward_mean": {}, "episode_reward_max": 858.5027962048777, "time_total_s": 496.1398446559906, "info": {"num_steps_sampled": 754469, "sample_time_ms": 15502.151, "grad_time_ms": 9906.586, "update_time_ms": 8.917, "default": {"kl": 0.011023903265595436, "entropy": 1.2972322702407837, "cur_lr": 0.0005000000237487257, "total_loss": 6.936273097991943, "policy_loss": -0.0043463921174407005, "vf_explained_var": 0.9207847118377686, "vf_loss": 6.94006872177124, "cur_kl_coeff": 0.05000000819563866}, "num_steps_trained": 754469, "load_time_ms": 12.498}, "custom_metrics": {"cost1_mean": 265.2792915862486, "outflow_rate_max": 1061.712526466403, "system_level_velocity_mean": 10.384048639604574, "cost1_min": 27.679902400179856, "cost1_max": 348.37656011559164, "outflow_rate_min": 437.2498088386631, "cost2_mean": -0.025107704858769744, "outflow_rate_mean": 881.3616591639574, "system_level_velocity_min": 7.812828588703328, "cost2_min": -0.34396327065619026, "system_level_velocity_max": 18.132689328408283, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 18, "done": false, "episodes_total": 279, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247f60>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540622e860>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540622e4e0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 689.9610356741374, "timesteps_this_iter": 39420, "timesteps_total": 754469, "time_since_restore": 496.1398446559906, "hostname": "flow-main", "episode_reward_min": 51.98538124117028, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 15, "timestamp": 1557184987, "time_this_iter_s": 24.563491344451904, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 18, "date": "2019-05-06_23-23-07", "episode_len_mean": 693.41}
{"timesteps_since_restore": 793394, "policy_reward_mean": {}, "episode_reward_max": 858.5027962048777, "time_total_s": 522.231823682785, "info": {"num_steps_sampled": 793394, "sample_time_ms": 15628.802, "grad_time_ms": 9898.767, "update_time_ms": 8.94, "default": {"kl": 0.008356410078704357, "entropy": 1.2589757442474365, "cur_lr": 0.0005000000237487257, "total_loss": 8.858467102050781, "policy_loss": -0.0021628006361424923, "vf_explained_var": 0.9087157249450684, "vf_loss": 8.860211372375488, "cur_kl_coeff": 0.05000000447034836}, "num_steps_trained": 793394, "load_time_ms": 12.558}, "custom_metrics": {"cost1_mean": 269.88164466582157, "outflow_rate_max": 1061.712526466403, "system_level_velocity_mean": 10.590207842019817, "cost1_min": 27.679902400179856, "cost1_max": 348.37656011559164, "outflow_rate_min": 437.2498088386631, "cost2_mean": -0.030848953373766794, "outflow_rate_mean": 895.7833103137849, "system_level_velocity_min": 7.812828588703328, "cost2_min": -0.34396327065619026, "system_level_velocity_max": 18.132689328408283, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 19, "done": false, "episodes_total": 298, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540622e6a0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540622e240>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540622ea90>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 689.3748950528798, "timesteps_this_iter": 38925, "timesteps_total": 793394, "time_since_restore": 522.231823682785, "hostname": "flow-main", "episode_reward_min": 51.98538124117028, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557185013, "time_this_iter_s": 26.091979026794434, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 19, "date": "2019-05-06_23-23-33", "episode_len_mean": 693.41}
{"timesteps_since_restore": 831994, "policy_reward_mean": {}, "episode_reward_max": 864.8279161029933, "time_total_s": 547.0351173877716, "info": {"num_steps_sampled": 831994, "sample_time_ms": 15509.817, "grad_time_ms": 9819.166, "update_time_ms": 8.805, "default": {"kl": 0.007138383109122515, "entropy": 1.2607407569885254, "cur_lr": 0.0005000000237487257, "total_loss": 9.396581649780273, "policy_loss": -0.001454371609725058, "vf_explained_var": 0.8963370323181152, "vf_loss": 9.397680282592773, "cur_kl_coeff": 0.050000011920928955}, "num_steps_trained": 831994, "load_time_ms": 12.567}, "custom_metrics": {"cost1_mean": 279.0893768371594, "outflow_rate_max": 1061.712526466403, "system_level_velocity_mean": 10.77378847024916, "cost1_min": 193.48678290438994, "cost1_max": 348.37656011559164, "outflow_rate_min": 765.3002432496357, "cost2_mean": -0.02913607087847941, "outflow_rate_mean": 918.8504780668623, "system_level_velocity_min": 7.812828588703328, "cost2_min": -0.34396327065619026, "system_level_velocity_max": 13.292537831805662, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 20, "done": false, "episodes_total": 318, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235cf8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235c88>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062351d0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 704.4348744709, "timesteps_this_iter": 38600, "timesteps_total": 831994, "time_since_restore": 547.0351173877716, "hostname": "flow-main", "episode_reward_min": 581.1457821490001, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557185038, "time_this_iter_s": 24.803293704986572, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 20, "date": "2019-05-06_23-23-58", "episode_len_mean": 700.0}
{"timesteps_since_restore": 870142, "policy_reward_mean": {}, "episode_reward_max": 864.8279161029933, "time_total_s": 572.229722738266, "info": {"num_steps_sampled": 870142, "sample_time_ms": 15484.609, "grad_time_ms": 9586.015, "update_time_ms": 8.632, "default": {"kl": 0.007093186490237713, "entropy": 1.253737449645996, "cur_lr": 0.0005000000237487257, "total_loss": 8.78619384765625, "policy_loss": -0.0020692136604338884, "vf_explained_var": 0.9151768088340759, "vf_loss": 8.787908554077148, "cur_kl_coeff": 0.05000000447034836}, "num_steps_trained": 870142, "load_time_ms": 12.586}, "custom_metrics": {"cost1_mean": 280.552944444523, "outflow_rate_max": 1095.2804986315318, "system_level_velocity_mean": 11.02354788160753, "cost1_min": 41.40525231845903, "cost1_max": 360.93546301284465, "outflow_rate_min": 469.5269403240251, "cost2_mean": -0.030863247616318784, "outflow_rate_mean": 925.2392006845378, "system_level_velocity_min": 7.812828588703328, "cost2_min": -0.34396327065619026, "system_level_velocity_max": 18.662581829589804, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 21, "done": false, "episodes_total": 335, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247898>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247be0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062474e0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 701.8701674059023, "timesteps_this_iter": 38148, "timesteps_total": 870142, "time_since_restore": 572.229722738266, "hostname": "flow-main", "episode_reward_min": 63.39040500206653, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 17, "timestamp": 1557185063, "time_this_iter_s": 25.194605350494385, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 21, "date": "2019-05-06_23-24-23", "episode_len_mean": 693.61}
{"timesteps_since_restore": 909263, "policy_reward_mean": {}, "episode_reward_max": 864.8279161029933, "time_total_s": 596.1512162685394, "info": {"num_steps_sampled": 909263, "sample_time_ms": 15418.757, "grad_time_ms": 9565.892, "update_time_ms": 8.722, "default": {"kl": 0.008301302790641785, "entropy": 1.259048342704773, "cur_lr": 0.0005000000237487257, "total_loss": 8.087170600891113, "policy_loss": -0.0025896718725562096, "vf_explained_var": 0.906024694442749, "vf_loss": 8.089344024658203, "cur_kl_coeff": 0.05000000447034836}, "num_steps_trained": 909263, "load_time_ms": 12.647}, "custom_metrics": {"cost1_mean": 286.07974297758267, "outflow_rate_max": 1101.5510254367548, "system_level_velocity_mean": 11.236222034748804, "cost1_min": 41.40525231845903, "cost1_max": 360.93546301284465, "outflow_rate_min": 469.5269403240251, "cost2_mean": -0.03544052954855867, "outflow_rate_mean": 938.6322921755336, "system_level_velocity_min": 7.812828588703328, "cost2_min": -0.4902379867211596, "system_level_velocity_max": 18.662581829589804, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 22, "done": false, "episodes_total": 351, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247f60>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247358>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247ef0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 708.3064712130376, "timesteps_this_iter": 39121, "timesteps_total": 909263, "time_since_restore": 596.1512162685394, "hostname": "flow-main", "episode_reward_min": 63.39040500206653, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 16, "timestamp": 1557185087, "time_this_iter_s": 23.921493530273438, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 22, "date": "2019-05-06_23-24-47", "episode_len_mean": 693.61}
{"timesteps_since_restore": 948279, "policy_reward_mean": {}, "episode_reward_max": 864.8279161029933, "time_total_s": 623.1539912223816, "info": {"num_steps_sampled": 948279, "sample_time_ms": 15571.566, "grad_time_ms": 9590.21, "update_time_ms": 9.023, "default": {"kl": 0.008823591284453869, "entropy": 1.2481603622436523, "cur_lr": 0.0005000000237487257, "total_loss": 7.387153148651123, "policy_loss": -0.0024729480501264334, "vf_explained_var": 0.9270318746566772, "vf_loss": 7.389185905456543, "cur_kl_coeff": 0.05000000447034836}, "num_steps_trained": 948279, "load_time_ms": 12.732}, "custom_metrics": {"cost1_mean": 288.4357105427256, "outflow_rate_max": 1101.5510254367548, "system_level_velocity_mean": 11.335985846354417, "cost1_min": 41.40525231845903, "cost1_max": 360.93546301284465, "outflow_rate_min": 469.5269403240251, "cost2_mean": -0.04968910862538369, "outflow_rate_mean": 945.1098413612453, "system_level_velocity_min": 7.812828588703328, "cost2_min": -0.4902379867211596, "system_level_velocity_max": 18.662581829589804, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 23, "done": false, "episodes_total": 367, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062472b0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247b00>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247748>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 709.5553363470352, "timesteps_this_iter": 39016, "timesteps_total": 948279, "time_since_restore": 623.1539912223816, "hostname": "flow-main", "episode_reward_min": 63.39040500206653, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 16, "timestamp": 1557185114, "time_this_iter_s": 27.002774953842163, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 23, "date": "2019-05-06_23-25-14", "episode_len_mean": 693.61}
{"timesteps_since_restore": 987765, "policy_reward_mean": {}, "episode_reward_max": 864.8279161029933, "time_total_s": 650.0916640758514, "info": {"num_steps_sampled": 987765, "sample_time_ms": 15750.725, "grad_time_ms": 9634.108, "update_time_ms": 8.987, "default": {"kl": 0.009347749873995781, "entropy": 1.2288365364074707, "cur_lr": 0.0005000000237487257, "total_loss": 9.659003257751465, "policy_loss": -0.0030737698543816805, "vf_explained_var": 0.9104114770889282, "vf_loss": 9.661608695983887, "cur_kl_coeff": 0.05000000819563866}, "num_steps_trained": 987765, "load_time_ms": 13.04}, "custom_metrics": {"cost1_mean": 292.6687680574164, "outflow_rate_max": 1101.5510254367548, "system_level_velocity_mean": 11.502384657398668, "cost1_min": 41.40525231845903, "cost1_max": 360.93546301284465, "outflow_rate_min": 469.5269403240251, "cost2_mean": -0.057830001056971725, "outflow_rate_mean": 952.9620637293411, "system_level_velocity_min": 9.076393023005496, "cost2_min": -0.910413407676519, "system_level_velocity_max": 18.662581829589804, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 24, "done": false, "episodes_total": 387, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235d68>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235710>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235c88>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 713.3741681548128, "timesteps_this_iter": 39486, "timesteps_total": 987765, "time_since_restore": 650.0916640758514, "hostname": "flow-main", "episode_reward_min": 63.39040500206653, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557185141, "time_this_iter_s": 26.93767285346985, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 24, "date": "2019-05-06_23-25-41", "episode_len_mean": 693.61}
{"timesteps_since_restore": 1026700, "policy_reward_mean": {}, "episode_reward_max": 864.8279161029933, "time_total_s": 676.297926902771, "info": {"num_steps_sampled": 1026700, "sample_time_ms": 15833.188, "grad_time_ms": 9625.6, "update_time_ms": 9.027, "default": {"kl": 0.010847830213606358, "entropy": 1.1998827457427979, "cur_lr": 0.0005000000237487257, "total_loss": 8.731773376464844, "policy_loss": -0.003013459499925375, "vf_explained_var": 0.9150921702384949, "vf_loss": 8.734243392944336, "cur_kl_coeff": 0.05000000447034836}, "num_steps_trained": 1026700, "load_time_ms": 13.061}, "custom_metrics": {"cost1_mean": 296.1041682474337, "outflow_rate_max": 1101.5510254367548, "system_level_velocity_mean": 11.62980130505449, "cost1_min": 41.40525231845903, "cost1_max": 360.93546301284465, "outflow_rate_min": 469.5269403240251, "cost2_mean": -0.0681798845412953, "outflow_rate_mean": 959.7308972108523, "system_level_velocity_min": 9.355578849503615, "cost2_min": -0.910413407676519, "system_level_velocity_max": 18.662581829589804, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 25, "done": false, "episodes_total": 404, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235390>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540623ef98>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235160>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 713.3090598639078, "timesteps_this_iter": 38935, "timesteps_total": 1026700, "time_since_restore": 676.297926902771, "hostname": "flow-main", "episode_reward_min": 63.39040500206653, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 17, "timestamp": 1557185167, "time_this_iter_s": 26.206262826919556, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 25, "date": "2019-05-06_23-26-07", "episode_len_mean": 693.61}
{"timesteps_since_restore": 1065151, "policy_reward_mean": {}, "episode_reward_max": 853.2521276299628, "time_total_s": 700.6925404071808, "info": {"num_steps_sampled": 1065151, "sample_time_ms": 15706.334, "grad_time_ms": 9599.342, "update_time_ms": 8.845, "default": {"kl": 0.009127294644713402, "entropy": 1.208746075630188, "cur_lr": 0.0005000000237487257, "total_loss": 8.639098167419434, "policy_loss": -0.0032309771049767733, "vf_explained_var": 0.9166123270988464, "vf_loss": 8.641873359680176, "cur_kl_coeff": 0.05000000819563866}, "num_steps_trained": 1065151, "load_time_ms": 13.651}, "custom_metrics": {"cost1_mean": 299.29189064164336, "outflow_rate_max": 1106.4126764383009, "system_level_velocity_mean": 11.751161567221134, "cost1_min": 41.40525231845903, "cost1_max": 370.3162297134672, "outflow_rate_min": 469.5269403240251, "cost2_mean": -0.06843449703051346, "outflow_rate_mean": 965.1417724994806, "system_level_velocity_min": 9.405838725292831, "cost2_min": -0.910413407676519, "system_level_velocity_max": 18.662581829589804, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 26, "done": false, "episodes_total": 421, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248160>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062481d0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248198>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 721.2425666687176, "timesteps_this_iter": 38451, "timesteps_total": 1065151, "time_since_restore": 700.6925404071808, "hostname": "flow-main", "episode_reward_min": 63.39040500206653, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 17, "timestamp": 1557185192, "time_this_iter_s": 24.39461350440979, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 26, "date": "2019-05-06_23-26-32", "episode_len_mean": 693.61}
{"timesteps_since_restore": 1103785, "policy_reward_mean": {}, "episode_reward_max": 857.6923637862112, "time_total_s": 727.0042612552643, "info": {"num_steps_sampled": 1103785, "sample_time_ms": 15864.444, "grad_time_ms": 9570.99, "update_time_ms": 8.684, "default": {"kl": 0.009862379170954227, "entropy": 1.21310293674469, "cur_lr": 0.0005000000237487257, "total_loss": 10.363295555114746, "policy_loss": -0.0028779448475688696, "vf_explained_var": 0.9159768223762512, "vf_loss": 10.365681648254395, "cur_kl_coeff": 0.050000011920928955}, "num_steps_trained": 1103785, "load_time_ms": 13.762}, "custom_metrics": {"cost1_mean": 299.9330090412034, "outflow_rate_max": 1223.0847741613106, "system_level_velocity_mean": 11.780705116565963, "cost1_min": 41.56733870327305, "cost1_max": 424.88595614524047, "outflow_rate_min": 489.80603701467646, "cost2_mean": -0.07370944919484317, "outflow_rate_mean": 967.4703594612475, "system_level_velocity_min": 9.326618317406547, "cost2_min": -0.910413407676519, "system_level_velocity_max": 19.068167310847056, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 27, "done": false, "episodes_total": 441, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540622eba8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540622ecc0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540622e240>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 722.7997526087762, "timesteps_this_iter": 38634, "timesteps_total": 1103785, "time_since_restore": 727.0042612552643, "hostname": "flow-main", "episode_reward_min": 66.03913705391042, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557185218, "time_this_iter_s": 26.311720848083496, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 27, "date": "2019-05-06_23-26-58", "episode_len_mean": 693.61}
{"timesteps_since_restore": 1141866, "policy_reward_mean": {}, "episode_reward_max": 857.6923637862112, "time_total_s": 753.5693051815033, "info": {"num_steps_sampled": 1141866, "sample_time_ms": 15976.96, "grad_time_ms": 9658.547, "update_time_ms": 8.351, "default": {"kl": 0.008722594939172268, "entropy": 1.2102974653244019, "cur_lr": 0.0005000000237487257, "total_loss": 8.299942970275879, "policy_loss": -0.0023464197292923927, "vf_explained_var": 0.9391319155693054, "vf_loss": 8.30185317993164, "cur_kl_coeff": 0.05000000819563866}, "num_steps_trained": 1141866, "load_time_ms": 13.78}, "custom_metrics": {"cost1_mean": 302.540502283167, "outflow_rate_max": 1223.0847741613106, "system_level_velocity_mean": 11.885830886131119, "cost1_min": 41.56733870327305, "cost1_max": 424.88595614524047, "outflow_rate_min": 489.80603701467646, "cost2_mean": -0.059923659709707894, "outflow_rate_mean": 971.6728346438136, "system_level_velocity_min": 9.326618317406547, "cost2_min": -0.910413407676519, "system_level_velocity_max": 19.068167310847056, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 28, "done": false, "episodes_total": 459, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406251a58>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406251668>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062515f8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 718.9533912868179, "timesteps_this_iter": 38081, "timesteps_total": 1141866, "time_since_restore": 753.5693051815033, "hostname": "flow-main", "episode_reward_min": 66.03913705391042, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557185245, "time_this_iter_s": 26.565043926239014, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 28, "date": "2019-05-06_23-27-25", "episode_len_mean": 693.61}
{"timesteps_since_restore": 1180160, "policy_reward_mean": {}, "episode_reward_max": 868.9102012065914, "time_total_s": 779.5561721324921, "info": {"num_steps_sampled": 1180160, "sample_time_ms": 15954.632, "grad_time_ms": 9669.422, "update_time_ms": 8.123, "default": {"kl": 0.011693180538713932, "entropy": 1.2092384099960327, "cur_lr": 0.0005000000237487257, "total_loss": 8.129765510559082, "policy_loss": -0.004597942810505629, "vf_explained_var": 0.9269086718559265, "vf_loss": 8.133779525756836, "cur_kl_coeff": 0.05000000819563866}, "num_steps_trained": 1180160, "load_time_ms": 14.027}, "custom_metrics": {"cost1_mean": 309.18599682137665, "outflow_rate_max": 1223.0847741613106, "system_level_velocity_mean": 12.125200877667297, "cost1_min": 41.56733870327305, "cost1_max": 424.88595614524047, "outflow_rate_min": 489.80603701467646, "cost2_mean": -0.061720460806090234, "outflow_rate_mean": 984.051135498492, "system_level_velocity_min": 9.326618317406547, "cost2_min": -0.910413407676519, "system_level_velocity_max": 19.068167310847056, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 29, "done": false, "episodes_total": 475, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248b00>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248b38>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248ef0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 723.2004755140754, "timesteps_this_iter": 38294, "timesteps_total": 1180160, "time_since_restore": 779.5561721324921, "hostname": "flow-main", "episode_reward_min": 66.03913705391042, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 16, "timestamp": 1557185271, "time_this_iter_s": 25.98686695098877, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 29, "date": "2019-05-06_23-27-51", "episode_len_mean": 693.61}
{"timesteps_since_restore": 1217772, "policy_reward_mean": {}, "episode_reward_max": 868.9102012065914, "time_total_s": 805.1449947357178, "info": {"num_steps_sampled": 1217772, "sample_time_ms": 15977.333, "grad_time_ms": 9725.025, "update_time_ms": 8.006, "default": {"kl": 0.010836930014193058, "entropy": 1.1825063228607178, "cur_lr": 0.0005000000237487257, "total_loss": 10.164480209350586, "policy_loss": -0.0029877505730837584, "vf_explained_var": 0.9394566416740417, "vf_loss": 10.166925430297852, "cur_kl_coeff": 0.05000000447034836}, "num_steps_trained": 1217772, "load_time_ms": 14.177}, "custom_metrics": {"cost1_mean": 310.4637659806425, "outflow_rate_max": 1239.3937360276802, "system_level_velocity_mean": 12.3325175217935, "cost1_min": 41.56733870327305, "cost1_max": 428.3235760637772, "outflow_rate_min": 489.80603701467646, "cost2_mean": -0.0505349285913067, "outflow_rate_mean": 987.7682813519268, "system_level_velocity_min": 9.326618317406547, "cost2_min": -0.6000000000000001, "system_level_velocity_max": 19.068167310847056, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 30, "done": false, "episodes_total": 492, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540623ec88>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540623ed68>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540623eda0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 721.735459301338, "timesteps_this_iter": 37612, "timesteps_total": 1217772, "time_since_restore": 805.1449947357178, "hostname": "flow-main", "episode_reward_min": 66.03913705391042, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 17, "timestamp": 1557185296, "time_this_iter_s": 25.588822603225708, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 30, "date": "2019-05-06_23-28-16", "episode_len_mean": 687.3}
{"timesteps_since_restore": 1256437, "policy_reward_mean": {}, "episode_reward_max": 947.3551636248471, "time_total_s": 832.7136285305023, "info": {"num_steps_sampled": 1256437, "sample_time_ms": 16173.804, "grad_time_ms": 9765.036, "update_time_ms": 8.059, "default": {"kl": 0.01011874619871378, "entropy": 1.1959853172302246, "cur_lr": 0.0005000000237487257, "total_loss": 10.356061935424805, "policy_loss": -0.002985227620229125, "vf_explained_var": 0.9163392186164856, "vf_loss": 10.358541488647461, "cur_kl_coeff": 0.05000000819563866}, "num_steps_trained": 1256437, "load_time_ms": 14.275}, "custom_metrics": {"cost1_mean": 318.11510889426705, "outflow_rate_max": 1269.4817007084202, "system_level_velocity_mean": 12.614880160044793, "cost1_min": 41.56733870327305, "cost1_max": 445.9241616261803, "outflow_rate_min": 489.80603701467646, "cost2_mean": -0.05618616435476199, "outflow_rate_mean": 1003.1004463047342, "system_level_velocity_min": 9.326618317406547, "cost2_min": -0.6000000000000001, "system_level_velocity_max": 19.068167310847056, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 31, "done": false, "episodes_total": 512, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248438>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248cc0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062487f0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 731.7410716929176, "timesteps_this_iter": 38665, "timesteps_total": 1256437, "time_since_restore": 832.7136285305023, "hostname": "flow-main", "episode_reward_min": 66.03913705391042, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557185324, "time_this_iter_s": 27.568633794784546, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 31, "date": "2019-05-06_23-28-44", "episode_len_mean": 687.3}
{"timesteps_since_restore": 1296246, "policy_reward_mean": {}, "episode_reward_max": 947.3551636248471, "time_total_s": 859.9510033130646, "info": {"num_steps_sampled": 1296246, "sample_time_ms": 16477.108, "grad_time_ms": 9792.721, "update_time_ms": 8.022, "default": {"kl": 0.008990569040179253, "entropy": 1.2162234783172607, "cur_lr": 0.0005000000237487257, "total_loss": 8.29629135131836, "policy_loss": -0.003943230025470257, "vf_explained_var": 0.9236088991165161, "vf_loss": 8.299785614013672, "cur_kl_coeff": 0.05000000819563866}, "num_steps_trained": 1296246, "load_time_ms": 14.423}, "custom_metrics": {"cost1_mean": 319.0018275948398, "outflow_rate_max": 1269.4817007084202, "system_level_velocity_mean": 12.66020486264719, "cost1_min": 28.540963325308656, "cost1_max": 445.9241616261803, "outflow_rate_min": 454.14688713509594, "cost2_mean": -0.05400160464058562, "outflow_rate_mean": 1004.999591562263, "system_level_velocity_min": 9.647530801356126, "cost2_min": -0.5461268803900674, "system_level_velocity_max": 19.24807877963326, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 32, "done": false, "episodes_total": 529, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540622e630>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540622e9b0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540622ecc0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 731.5930507831469, "timesteps_this_iter": 39809, "timesteps_total": 1296246, "time_since_restore": 859.9510033130646, "hostname": "flow-main", "episode_reward_min": 49.10411259656557, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 17, "timestamp": 1557185351, "time_this_iter_s": 27.237374782562256, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 32, "date": "2019-05-06_23-29-11", "episode_len_mean": 687.11}
{"timesteps_since_restore": 1334742, "policy_reward_mean": {}, "episode_reward_max": 947.3551636248471, "time_total_s": 885.1250755786896, "info": {"num_steps_sampled": 1334742, "sample_time_ms": 16365.305, "grad_time_ms": 9721.424, "update_time_ms": 7.574, "default": {"kl": 0.009453453123569489, "entropy": 1.1921546459197998, "cur_lr": 0.0005000000237487257, "total_loss": 8.86548137664795, "policy_loss": -0.002582135610282421, "vf_explained_var": 0.92218017578125, "vf_loss": 8.86759090423584, "cur_kl_coeff": 0.05000000819563866}, "num_steps_trained": 1334742, "load_time_ms": 14.433}, "custom_metrics": {"cost1_mean": 318.306465778479, "outflow_rate_max": 1269.4817007084202, "system_level_velocity_mean": 12.642656521911363, "cost1_min": 28.540963325308656, "cost1_max": 445.9241616261803, "outflow_rate_min": 454.14688713509594, "cost2_mean": -0.047879882204369034, "outflow_rate_mean": 1004.5186058486004, "system_level_velocity_min": 9.647530801356126, "cost2_min": -0.5461268803900674, "system_level_velocity_max": 19.24807877963326, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 33, "done": false, "episodes_total": 545, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406251b00>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062516a0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406251e10>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 735.1852458622733, "timesteps_this_iter": 38496, "timesteps_total": 1334742, "time_since_restore": 885.1250755786896, "hostname": "flow-main", "episode_reward_min": 49.10411259656557, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 16, "timestamp": 1557185376, "time_this_iter_s": 25.174072265625, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 33, "date": "2019-05-06_23-29-36", "episode_len_mean": 687.11}
{"timesteps_since_restore": 1373172, "policy_reward_mean": {}, "episode_reward_max": 947.3551636248471, "time_total_s": 911.9714844226837, "info": {"num_steps_sampled": 1373172, "sample_time_ms": 16414.067, "grad_time_ms": 9666.447, "update_time_ms": 7.509, "default": {"kl": 0.008098247461020947, "entropy": 1.189458966255188, "cur_lr": 0.0005000000237487257, "total_loss": 10.015421867370605, "policy_loss": -0.0018013251246884465, "vf_explained_var": 0.9059309959411621, "vf_loss": 10.016818046569824, "cur_kl_coeff": 0.05000000819563866}, "num_steps_trained": 1373172, "load_time_ms": 13.943}, "custom_metrics": {"cost1_mean": 318.04039925846666, "outflow_rate_max": 1269.4817007084202, "system_level_velocity_mean": 12.635862291261695, "cost1_min": 28.540963325308656, "cost1_max": 445.9241616261803, "outflow_rate_min": 454.14688713509594, "cost2_mean": -0.053919631030602426, "outflow_rate_mean": 1004.5853822820068, "system_level_velocity_min": 10.008422906687361, "cost2_min": -0.5461268803900674, "system_level_velocity_max": 19.24807877963326, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 34, "done": false, "episodes_total": 564, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248c18>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248198>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248320>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 735.0905114883851, "timesteps_this_iter": 38430, "timesteps_total": 1373172, "time_since_restore": 911.9714844226837, "hostname": "flow-main", "episode_reward_min": 49.10411259656557, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557185403, "time_this_iter_s": 26.84640884399414, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 34, "date": "2019-05-06_23-30-03", "episode_len_mean": 687.11}
{"timesteps_since_restore": 1411045, "policy_reward_mean": {}, "episode_reward_max": 947.3551636248471, "time_total_s": 939.030766248703, "info": {"num_steps_sampled": 1411045, "sample_time_ms": 16394.901, "grad_time_ms": 9771.558, "update_time_ms": 7.641, "default": {"kl": 0.00806520413607359, "entropy": 1.182848334312439, "cur_lr": 0.0005000000237487257, "total_loss": 9.201042175292969, "policy_loss": -0.0017207509372383356, "vf_explained_var": 0.9228122234344482, "vf_loss": 9.202360153198242, "cur_kl_coeff": 0.05000000447034836}, "num_steps_trained": 1411045, "load_time_ms": 14.032}, "custom_metrics": {"cost1_mean": 314.03218435457563, "outflow_rate_max": 1269.4817007084202, "system_level_velocity_mean": 12.506926630004603, "cost1_min": 28.540963325308656, "cost1_max": 445.9241616261803, "outflow_rate_min": 454.14688713509594, "cost2_mean": -0.04848211868364474, "outflow_rate_mean": 998.6313639434696, "system_level_velocity_min": 10.008422906687361, "cost2_min": -0.5, "system_level_velocity_max": 19.24807877963326, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 35, "done": false, "episodes_total": 582, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248390>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062489b0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248978>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 732.0353683924492, "timesteps_this_iter": 37873, "timesteps_total": 1411045, "time_since_restore": 939.030766248703, "hostname": "flow-main", "episode_reward_min": 49.10411259656557, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557185430, "time_this_iter_s": 27.059281826019287, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 35, "date": "2019-05-06_23-30-30", "episode_len_mean": 687.11}
{"timesteps_since_restore": 1448914, "policy_reward_mean": {}, "episode_reward_max": 950.3466610278402, "time_total_s": 964.7175273895264, "info": {"num_steps_sampled": 1448914, "sample_time_ms": 16598.801, "grad_time_ms": 9695.257, "update_time_ms": 8.112, "default": {"kl": 0.010842662304639816, "entropy": 1.1645584106445312, "cur_lr": 0.0005000000237487257, "total_loss": 8.577815055847168, "policy_loss": -0.0038246680051088333, "vf_explained_var": 0.933745801448822, "vf_loss": 8.581097602844238, "cur_kl_coeff": 0.05000000447034836}, "num_steps_trained": 1448914, "load_time_ms": 12.99}, "custom_metrics": {"cost1_mean": 317.0787193456808, "outflow_rate_max": 1269.4817007084202, "system_level_velocity_mean": 12.457480531918383, "cost1_min": 28.540963325308656, "cost1_max": 445.9241616261803, "outflow_rate_min": 454.14688713509594, "cost2_mean": -0.04871593127763339, "outflow_rate_mean": 1002.4585247484575, "system_level_velocity_min": 10.008422906687361, "cost2_min": -0.5, "system_level_velocity_max": 19.24807877963326, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 36, "done": false, "episodes_total": 598, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540622e630>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540622e6d8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540622ecc0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 738.0998169840939, "timesteps_this_iter": 37869, "timesteps_total": 1448914, "time_since_restore": 964.7175273895264, "hostname": "flow-main", "episode_reward_min": 49.10411259656557, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 16, "timestamp": 1557185456, "time_this_iter_s": 25.686761140823364, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 36, "date": "2019-05-06_23-30-56", "episode_len_mean": 693.42}
{"timesteps_since_restore": 1487115, "policy_reward_mean": {}, "episode_reward_max": 950.3466610278402, "time_total_s": 991.3160619735718, "info": {"num_steps_sampled": 1487115, "sample_time_ms": 16633.737, "grad_time_ms": 9690.493, "update_time_ms": 8.159, "default": {"kl": 0.010044686496257782, "entropy": 1.171784520149231, "cur_lr": 0.0005000000237487257, "total_loss": 8.92544937133789, "policy_loss": -0.002956861164420843, "vf_explained_var": 0.9327408075332642, "vf_loss": 8.927905082702637, "cur_kl_coeff": 0.05000000447034836}, "num_steps_trained": 1487115, "load_time_ms": 13.193}, "custom_metrics": {"cost1_mean": 312.05534623060464, "outflow_rate_max": 1180.9367150571488, "system_level_velocity_mean": 12.278575030186323, "cost1_min": 28.540963325308656, "cost1_max": 435.07684893569916, "outflow_rate_min": 454.14688713509594, "cost2_mean": -0.030099477908419107, "outflow_rate_mean": 991.8934011865884, "system_level_velocity_min": 9.478937967770687, "cost2_min": -0.4346606108043873, "system_level_velocity_max": 19.24807877963326, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 37, "done": false, "episodes_total": 617, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406251f98>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406251278>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406251710>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 729.4640944101818, "timesteps_this_iter": 38201, "timesteps_total": 1487115, "time_since_restore": 991.3160619735718, "hostname": "flow-main", "episode_reward_min": 49.10411259656557, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557185483, "time_this_iter_s": 26.59853458404541, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 37, "date": "2019-05-06_23-31-23", "episode_len_mean": 693.42}
{"timesteps_since_restore": 1525992, "policy_reward_mean": {}, "episode_reward_max": 950.3466610278402, "time_total_s": 1017.749050617218, "info": {"num_steps_sampled": 1525992, "sample_time_ms": 16690.836, "grad_time_ms": 9620.071, "update_time_ms": 8.339, "default": {"kl": 0.009788797236979008, "entropy": 1.1910237073898315, "cur_lr": 0.0005000000237487257, "total_loss": 10.026962280273438, "policy_loss": -0.0033227161038666964, "vf_explained_var": 0.9100069999694824, "vf_loss": 10.02979564666748, "cur_kl_coeff": 0.050000011920928955}, "num_steps_trained": 1525992, "load_time_ms": 13.239}, "custom_metrics": {"cost1_mean": 313.41730890827307, "outflow_rate_max": 1180.9367150571488, "system_level_velocity_mean": 12.329089357199837, "cost1_min": 30.12034762855056, "cost1_max": 435.07684893569916, "outflow_rate_min": 455.8357567680177, "cost2_mean": -0.034868851377535835, "outflow_rate_mean": 993.3930505271935, "system_level_velocity_min": 9.478937967770687, "cost2_min": -0.4346606108043873, "system_level_velocity_max": 18.75915618707152, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 38, "done": false, "episodes_total": 638, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540623ec88>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540623ed68>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540623eb38>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 728.5532018227548, "timesteps_this_iter": 38877, "timesteps_total": 1525992, "time_since_restore": 1017.749050617218, "hostname": "flow-main", "episode_reward_min": 47.862098485838104, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557185509, "time_this_iter_s": 26.43298864364624, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 38, "date": "2019-05-06_23-31-49", "episode_len_mean": 693.44}
{"timesteps_since_restore": 1564845, "policy_reward_mean": {}, "episode_reward_max": 950.3466610278402, "time_total_s": 1043.8290112018585, "info": {"num_steps_sampled": 1564845, "sample_time_ms": 16693.581, "grad_time_ms": 9626.879, "update_time_ms": 8.417, "default": {"kl": 0.008295107632875443, "entropy": 1.1892502307891846, "cur_lr": 0.0005000000237487257, "total_loss": 7.21563720703125, "policy_loss": -0.002926306566223502, "vf_explained_var": 0.9376302361488342, "vf_loss": 7.218148708343506, "cur_kl_coeff": 0.050000011920928955}, "num_steps_trained": 1564845, "load_time_ms": 12.779}, "custom_metrics": {"cost1_mean": 314.55969300865473, "outflow_rate_max": 1180.9367150571488, "system_level_velocity_mean": 12.380818545682926, "cost1_min": 30.12034762855056, "cost1_max": 435.07684893569916, "outflow_rate_min": 455.8357567680177, "cost2_mean": -0.03105160791770264, "outflow_rate_mean": 993.9988476168438, "system_level_velocity_min": 9.478937967770687, "cost2_min": -0.4208944527672558, "system_level_velocity_max": 18.75915618707152, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 39, "done": false, "episodes_total": 653, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248ba8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248048>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248940>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 722.1849815548217, "timesteps_this_iter": 38853, "timesteps_total": 1564845, "time_since_restore": 1043.8290112018585, "hostname": "flow-main", "episode_reward_min": 47.862098485838104, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 15, "timestamp": 1557185535, "time_this_iter_s": 26.079960584640503, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 39, "date": "2019-05-06_23-32-15", "episode_len_mean": 693.44}
{"timesteps_since_restore": 1603601, "policy_reward_mean": {}, "episode_reward_max": 950.3466610278402, "time_total_s": 1069.1846919059753, "info": {"num_steps_sampled": 1603601, "sample_time_ms": 16690.192, "grad_time_ms": 9606.42, "update_time_ms": 8.374, "default": {"kl": 0.010970097966492176, "entropy": 1.1837233304977417, "cur_lr": 0.0005000000237487257, "total_loss": 8.865926742553711, "policy_loss": -0.0038111312314867973, "vf_explained_var": 0.9406193494796753, "vf_loss": 8.869189262390137, "cur_kl_coeff": 0.05000000819563866}, "num_steps_trained": 1603601, "load_time_ms": 12.884}, "custom_metrics": {"cost1_mean": 315.3159068156521, "outflow_rate_max": 1180.9367150571488, "system_level_velocity_mean": 12.416524868946698, "cost1_min": 30.12034762855056, "cost1_max": 435.07684893569916, "outflow_rate_min": 455.8357567680177, "cost2_mean": -0.03546155326341169, "outflow_rate_mean": 993.5484301095295, "system_level_velocity_min": 9.478937967770687, "cost2_min": -0.5, "system_level_velocity_max": 18.75915618707152, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 40, "done": false, "episodes_total": 669, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247b00>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247c88>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062470b8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 727.0802573021379, "timesteps_this_iter": 38756, "timesteps_total": 1603601, "time_since_restore": 1069.1846919059753, "hostname": "flow-main", "episode_reward_min": 47.862098485838104, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 16, "timestamp": 1557185561, "time_this_iter_s": 25.35568070411682, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 40, "date": "2019-05-06_23-32-41", "episode_len_mean": 693.44}
{"timesteps_since_restore": 1641731, "policy_reward_mean": {}, "episode_reward_max": 950.3466610278402, "time_total_s": 1094.3845636844635, "info": {"num_steps_sampled": 1641731, "sample_time_ms": 16587.456, "grad_time_ms": 9473.942, "update_time_ms": 8.209, "default": {"kl": 0.012210887856781483, "entropy": 1.1504729986190796, "cur_lr": 0.0005000000237487257, "total_loss": 13.852811813354492, "policy_loss": -0.003900992451235652, "vf_explained_var": 0.9172949194908142, "vf_loss": 13.856101989746094, "cur_kl_coeff": 0.05000000819563866}, "num_steps_trained": 1641731, "load_time_ms": 12.743}, "custom_metrics": {"cost1_mean": 313.01950773015756, "outflow_rate_max": 1180.9367150571488, "system_level_velocity_mean": 12.665385817574224, "cost1_min": 25.559098494630273, "cost1_max": 419.4540485685973, "outflow_rate_min": 428.5538781257697, "cost2_mean": -0.03287223012813983, "outflow_rate_mean": 989.6168289757593, "system_level_velocity_min": 9.478937967770687, "cost2_min": -0.5, "system_level_velocity_max": 18.866938252600846, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 41, "done": false, "episodes_total": 690, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062516d8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406251198>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406251d68>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 714.2746635216379, "timesteps_this_iter": 38130, "timesteps_total": 1641731, "time_since_restore": 1094.3845636844635, "hostname": "flow-main", "episode_reward_min": 47.862098485838104, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557185586, "time_this_iter_s": 25.19987177848816, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 41, "date": "2019-05-06_23-33-06", "episode_len_mean": 680.92}
{"timesteps_since_restore": 1680928, "policy_reward_mean": {}, "episode_reward_max": 905.2228044296085, "time_total_s": 1120.7005660533905, "info": {"num_steps_sampled": 1680928, "sample_time_ms": 16617.127, "grad_time_ms": 9354.753, "update_time_ms": 8.091, "default": {"kl": 0.011367876082658768, "entropy": 1.188145637512207, "cur_lr": 0.0005000000237487257, "total_loss": 9.723441123962402, "policy_loss": -0.0047949207946658134, "vf_explained_var": 0.9329103827476501, "vf_loss": 9.727666854858398, "cur_kl_coeff": 0.05000000819563866}, "num_steps_trained": 1680928, "load_time_ms": 12.752}, "custom_metrics": {"cost1_mean": 316.45741977079024, "outflow_rate_max": 1214.3113174841199, "system_level_velocity_mean": 12.803808686175868, "cost1_min": 25.559098494630273, "cost1_max": 444.42452553635997, "outflow_rate_min": 428.5538781257697, "cost2_mean": -0.03347986826722504, "outflow_rate_mean": 996.3938464810208, "system_level_velocity_min": 9.521210793538947, "cost2_min": -0.5, "system_level_velocity_max": 18.866938252600846, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 42, "done": false, "episodes_total": 710, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406251cf8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406251748>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062511d0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 713.8382460422429, "timesteps_this_iter": 39197, "timesteps_total": 1680928, "time_since_restore": 1120.7005660533905, "hostname": "flow-main", "episode_reward_min": 47.862098485838104, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557185612, "time_this_iter_s": 26.316002368927002, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 42, "date": "2019-05-06_23-33-32", "episode_len_mean": 680.92}
{"timesteps_since_restore": 1718887, "policy_reward_mean": {}, "episode_reward_max": 905.2228044296085, "time_total_s": 1145.6315138339996, "info": {"num_steps_sampled": 1718887, "sample_time_ms": 16669.88, "grad_time_ms": 9278.973, "update_time_ms": 8.019, "default": {"kl": 0.011152638122439384, "entropy": 1.1445720195770264, "cur_lr": 0.0005000000237487257, "total_loss": 10.845998764038086, "policy_loss": -0.004170382395386696, "vf_explained_var": 0.9428090453147888, "vf_loss": 10.849611282348633, "cur_kl_coeff": 0.05000000447034836}, "num_steps_trained": 1718887, "load_time_ms": 12.534}, "custom_metrics": {"cost1_mean": 317.8874424521154, "outflow_rate_max": 1231.015818108909, "system_level_velocity_mean": 13.034998643172877, "cost1_min": 22.74612430707074, "cost1_max": 444.42452553635997, "outflow_rate_min": 428.5538781257697, "cost2_mean": -0.03750333577202267, "outflow_rate_mean": 1000.4808923672098, "system_level_velocity_min": 9.521210793538947, "cost2_min": -0.5, "system_level_velocity_max": 19.8311398456322, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 43, "done": false, "episodes_total": 729, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062514e0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247b00>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406251be0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 705.1352051716415, "timesteps_this_iter": 37959, "timesteps_total": 1718887, "time_since_restore": 1145.6315138339996, "hostname": "flow-main", "episode_reward_min": 44.765344800842044, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557185637, "time_this_iter_s": 24.93094778060913, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 43, "date": "2019-05-06_23-33-57", "episode_len_mean": 675.24}
{"timesteps_since_restore": 1755836, "policy_reward_mean": {}, "episode_reward_max": 905.2228044296085, "time_total_s": 1170.6670622825623, "info": {"num_steps_sampled": 1755836, "sample_time_ms": 16636.121, "grad_time_ms": 9132.007, "update_time_ms": 7.956, "default": {"kl": 0.01284833438694477, "entropy": 1.1354607343673706, "cur_lr": 0.0005000000237487257, "total_loss": 12.535385131835938, "policy_loss": -0.0044619981199502945, "vf_explained_var": 0.9153902530670166, "vf_loss": 12.539204597473145, "cur_kl_coeff": 0.05000000447034836}, "num_steps_trained": 1755836, "load_time_ms": 12.798}, "custom_metrics": {"cost1_mean": 318.39506388641536, "outflow_rate_max": 1231.015818108909, "system_level_velocity_mean": 13.2406992633336, "cost1_min": 22.74612430707074, "cost1_max": 444.42452553635997, "outflow_rate_min": 428.5538781257697, "cost2_mean": -0.04720804492920276, "outflow_rate_mean": 1001.8933969113377, "system_level_velocity_min": 9.313685964782623, "cost2_min": -0.8403151487940312, "system_level_velocity_max": 19.8311398456322, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 44, "done": false, "episodes_total": 748, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406251a20>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248240>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406251828>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 697.7366207869424, "timesteps_this_iter": 36949, "timesteps_total": 1755836, "time_since_restore": 1170.6670622825623, "hostname": "flow-main", "episode_reward_min": 44.765344800842044, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557185662, "time_this_iter_s": 25.035548448562622, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 44, "date": "2019-05-06_23-34-22", "episode_len_mean": 668.75}
{"timesteps_since_restore": 1793056, "policy_reward_mean": {}, "episode_reward_max": 902.7420027965334, "time_total_s": 1195.0267374515533, "info": {"num_steps_sampled": 1793056, "sample_time_ms": 16590.339, "grad_time_ms": 8909.342, "update_time_ms": 7.707, "default": {"kl": 0.013854928314685822, "entropy": 1.1428567171096802, "cur_lr": 0.0005000000237487257, "total_loss": 11.523065567016602, "policy_loss": -0.005652114748954773, "vf_explained_var": 0.9329260587692261, "vf_loss": 11.528024673461914, "cur_kl_coeff": 0.05000000819563866}, "num_steps_trained": 1793056, "load_time_ms": 12.702}, "custom_metrics": {"cost1_mean": 319.31357083179546, "outflow_rate_max": 1231.015818108909, "system_level_velocity_mean": 13.461153275875153, "cost1_min": 20.76273898420685, "cost1_max": 455.8375868051346, "outflow_rate_min": 422.26791936284985, "cost2_mean": -0.05237760824847519, "outflow_rate_mean": 1002.4790104961106, "system_level_velocity_min": 9.313685964782623, "cost2_min": -0.8403151487940312, "system_level_velocity_max": 19.8311398456322, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 45, "done": false, "episodes_total": 766, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625ab00>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a1d0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a198>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 690.9373093586137, "timesteps_this_iter": 37220, "timesteps_total": 1793056, "time_since_restore": 1195.0267374515533, "hostname": "flow-main", "episode_reward_min": 35.39690715687429, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557185687, "time_this_iter_s": 24.35967516899109, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 45, "date": "2019-05-06_23-34-47", "episode_len_mean": 662.06}
{"timesteps_since_restore": 1830607, "policy_reward_mean": {}, "episode_reward_max": 902.7420027965334, "time_total_s": 1220.7326357364655, "info": {"num_steps_sampled": 1830607, "sample_time_ms": 16608.421, "grad_time_ms": 8896.852, "update_time_ms": 7.069, "default": {"kl": 0.013764270581305027, "entropy": 1.131003499031067, "cur_lr": 0.0005000000237487257, "total_loss": 11.525955200195312, "policy_loss": -0.005138715263456106, "vf_explained_var": 0.9365705251693726, "vf_loss": 11.530406951904297, "cur_kl_coeff": 0.05000000447034836}, "num_steps_trained": 1830607, "load_time_ms": 13.134}, "custom_metrics": {"cost1_mean": 323.665560781215, "outflow_rate_max": 1274.5473827699866, "system_level_velocity_mean": 13.481844224290555, "cost1_min": 20.76273898420685, "cost1_max": 464.06075806838857, "outflow_rate_min": 422.26791936284985, "cost2_mean": -0.08121503326088195, "outflow_rate_mean": 1011.8325555420463, "system_level_velocity_min": 9.313685964782623, "cost2_min": -1.791723775525571, "system_level_velocity_max": 19.8311398456322, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 46, "done": false, "episodes_total": 787, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625ae10>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a320>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a4a8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 698.0837412223733, "timesteps_this_iter": 37551, "timesteps_total": 1830607, "time_since_restore": 1220.7326357364655, "hostname": "flow-main", "episode_reward_min": 35.39690715687429, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557185712, "time_this_iter_s": 25.70589828491211, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 46, "date": "2019-05-06_23-35-12", "episode_len_mean": 668.19}
{"timesteps_since_restore": 1868035, "policy_reward_mean": {}, "episode_reward_max": 902.7420027965334, "time_total_s": 1246.4933788776398, "info": {"num_steps_sampled": 1868035, "sample_time_ms": 16455.368, "grad_time_ms": 8967.301, "update_time_ms": 6.883, "default": {"kl": 0.014164617285132408, "entropy": 1.1358004808425903, "cur_lr": 0.0005000000237487257, "total_loss": 9.525041580200195, "policy_loss": -0.00538265286013484, "vf_explained_var": 0.9532507061958313, "vf_loss": 9.529717445373535, "cur_kl_coeff": 0.05000000447034836}, "num_steps_trained": 1868035, "load_time_ms": 12.579}, "custom_metrics": {"cost1_mean": 327.33245974859017, "outflow_rate_max": 1274.5473827699866, "system_level_velocity_mean": 13.637048359924586, "cost1_min": 20.76273898420685, "cost1_max": 464.06075806838857, "outflow_rate_min": 422.26791936284985, "cost2_mean": -0.08605850333395469, "outflow_rate_mean": 1017.2807754914023, "system_level_velocity_min": 9.313685964782623, "cost2_min": -1.791723775525571, "system_level_velocity_max": 19.8311398456322, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 47, "done": false, "episodes_total": 804, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540623e3c8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540622e5c0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540623e278>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 700.7311349569961, "timesteps_this_iter": 37428, "timesteps_total": 1868035, "time_since_restore": 1246.4933788776398, "hostname": "flow-main", "episode_reward_min": 35.39690715687429, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 17, "timestamp": 1557185738, "time_this_iter_s": 25.760743141174316, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 47, "date": "2019-05-06_23-35-38", "episode_len_mean": 668.19}
{"timesteps_since_restore": 1906366, "policy_reward_mean": {}, "episode_reward_max": 902.7420027965334, "time_total_s": 1272.5794792175293, "info": {"num_steps_sampled": 1906366, "sample_time_ms": 16429.747, "grad_time_ms": 8957.668, "update_time_ms": 6.74, "default": {"kl": 0.015519218519330025, "entropy": 1.136395812034607, "cur_lr": 0.0005000000237487257, "total_loss": 10.657256126403809, "policy_loss": -0.005133628845214844, "vf_explained_var": 0.9459479451179504, "vf_loss": 10.661612510681152, "cur_kl_coeff": 0.05000000819563866}, "num_steps_trained": 1906366, "load_time_ms": 12.541}, "custom_metrics": {"cost1_mean": 332.35501211620135, "outflow_rate_max": 1274.5473827699866, "system_level_velocity_mean": 13.776984177432201, "cost1_min": 20.76273898420685, "cost1_max": 464.26546764445175, "outflow_rate_min": 422.26791936284985, "cost2_mean": -0.08403902888677217, "outflow_rate_mean": 1026.5680373619434, "system_level_velocity_min": 9.313685964782623, "cost2_min": -1.791723775525571, "system_level_velocity_max": 19.43998709376457, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 48, "done": false, "episodes_total": 821, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625af98>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a7f0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625af28>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 709.3440934910698, "timesteps_this_iter": 38331, "timesteps_total": 1906366, "time_since_restore": 1272.5794792175293, "hostname": "flow-main", "episode_reward_min": 35.39690715687429, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 17, "timestamp": 1557185764, "time_this_iter_s": 26.086100339889526, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 48, "date": "2019-05-06_23-36-04", "episode_len_mean": 670.06}
{"timesteps_since_restore": 1944683, "policy_reward_mean": {}, "episode_reward_max": 889.3359176829886, "time_total_s": 1297.7162580490112, "info": {"num_steps_sampled": 1944683, "sample_time_ms": 16370.404, "grad_time_ms": 8923.073, "update_time_ms": 6.608, "default": {"kl": 0.01243734359741211, "entropy": 1.1418358087539673, "cur_lr": 0.0005000000237487257, "total_loss": 9.172205924987793, "policy_loss": -0.005388640332967043, "vf_explained_var": 0.9479886293411255, "vf_loss": 9.176973342895508, "cur_kl_coeff": 0.05000000819563866}, "num_steps_trained": 1944683, "load_time_ms": 12.382}, "custom_metrics": {"cost1_mean": 332.12974534702204, "outflow_rate_max": 1274.5473827699866, "system_level_velocity_mean": 13.63278307524328, "cost1_min": 20.76273898420685, "cost1_max": 464.26546764445175, "outflow_rate_min": 422.26791936284985, "cost2_mean": -0.0717564132456185, "outflow_rate_mean": 1023.8366109048543, "system_level_velocity_min": 9.313685964782623, "cost2_min": -1.791723775525571, "system_level_velocity_max": 19.23879030494863, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 49, "done": false, "episodes_total": 839, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a0b8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a278>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a198>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 712.8319669180064, "timesteps_this_iter": 38317, "timesteps_total": 1944683, "time_since_restore": 1297.7162580490112, "hostname": "flow-main", "episode_reward_min": 35.39690715687429, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557185789, "time_this_iter_s": 25.136778831481934, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 49, "date": "2019-05-06_23-36-29", "episode_len_mean": 675.63}
{"timesteps_since_restore": 1983240, "policy_reward_mean": {}, "episode_reward_max": 897.2928054653028, "time_total_s": 1323.3512525558472, "info": {"num_steps_sampled": 1983240, "sample_time_ms": 16434.756, "grad_time_ms": 8887.911, "update_time_ms": 6.644, "default": {"kl": 0.01554440800100565, "entropy": 1.136031985282898, "cur_lr": 0.0005000000237487257, "total_loss": 10.396296501159668, "policy_loss": -0.005344935692846775, "vf_explained_var": 0.9440990686416626, "vf_loss": 10.400864601135254, "cur_kl_coeff": 0.050000011920928955}, "num_steps_trained": 1983240, "load_time_ms": 12.147}, "custom_metrics": {"cost1_mean": 337.7830177307238, "outflow_rate_max": 1274.5473827699866, "system_level_velocity_mean": 13.674849554715383, "cost1_min": 20.76273898420685, "cost1_max": 464.26546764445175, "outflow_rate_min": 422.26791936284985, "cost2_mean": -0.07244443606628535, "outflow_rate_mean": 1034.7574029488942, "system_level_velocity_min": 10.765923443427784, "cost2_min": -1.791723775525571, "system_level_velocity_max": 19.23879030494863, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 50, "done": false, "episodes_total": 859, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235780>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235630>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235dd8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 721.4933467329143, "timesteps_this_iter": 38557, "timesteps_total": 1983240, "time_since_restore": 1323.3512525558472, "hostname": "flow-main", "episode_reward_min": 35.39690715687429, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557185815, "time_this_iter_s": 25.634994506835938, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 50, "date": "2019-05-06_23-36-55", "episode_len_mean": 682.12}
{"timesteps_since_restore": 2021942, "policy_reward_mean": {}, "episode_reward_max": 897.2928054653028, "time_total_s": 1348.3587946891785, "info": {"num_steps_sampled": 2021942, "sample_time_ms": 16376.347, "grad_time_ms": 8926.205, "update_time_ms": 6.554, "default": {"kl": 0.014803561381995678, "entropy": 1.1490263938903809, "cur_lr": 0.0005000000237487257, "total_loss": 8.933553695678711, "policy_loss": -0.005611926317214966, "vf_explained_var": 0.9441002011299133, "vf_loss": 8.938425064086914, "cur_kl_coeff": 0.05000000819563866}, "num_steps_trained": 2021942, "load_time_ms": 12.331}, "custom_metrics": {"cost1_mean": 336.9864004153341, "outflow_rate_max": 1273.3094648218157, "system_level_velocity_mean": 13.477030911450655, "cost1_min": 41.97377368616969, "cost1_max": 464.26546764445175, "outflow_rate_min": 480.89944650811077, "cost2_mean": -0.06518758269842272, "outflow_rate_mean": 1034.5632121079316, "system_level_velocity_min": 10.653499918805837, "cost2_min": -1.791723775525571, "system_level_velocity_max": 19.23879030494863, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 51, "done": false, "episodes_total": 874, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248f28>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062487f0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248908>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 725.9065563506597, "timesteps_this_iter": 38702, "timesteps_total": 2021942, "time_since_restore": 1348.3587946891785, "hostname": "flow-main", "episode_reward_min": 66.75811887637452, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 15, "timestamp": 1557185840, "time_this_iter_s": 25.0075421333313, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 51, "date": "2019-05-06_23-37-20", "episode_len_mean": 688.81}
{"timesteps_since_restore": 2059473, "policy_reward_mean": {}, "episode_reward_max": 897.2928054653028, "time_total_s": 1372.9372358322144, "info": {"num_steps_sampled": 2059473, "sample_time_ms": 16196.711, "grad_time_ms": 8931.895, "update_time_ms": 6.651, "default": {"kl": 0.012620327062904835, "entropy": 1.1188058853149414, "cur_lr": 0.0005000000237487257, "total_loss": 10.314400672912598, "policy_loss": -0.004906308371573687, "vf_explained_var": 0.9458054900169373, "vf_loss": 10.318675994873047, "cur_kl_coeff": 0.05000000447034836}, "num_steps_trained": 2059473, "load_time_ms": 12.435}, "custom_metrics": {"cost1_mean": 339.114924929916, "outflow_rate_max": 1273.3094648218157, "system_level_velocity_mean": 13.39265714002498, "cost1_min": 154.5643738303524, "cost1_max": 464.26546764445175, "outflow_rate_min": 799.2548333461639, "cost2_mean": -0.04851396843500358, "outflow_rate_mean": 1037.2812284943254, "system_level_velocity_min": 10.46970599283765, "cost2_min": -1.5747395661526848, "system_level_velocity_max": 19.118962174438618, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 52, "done": false, "episodes_total": 892, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625ae80>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a2e8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a9e8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 729.4099949608296, "timesteps_this_iter": 37531, "timesteps_total": 2059473, "time_since_restore": 1372.9372358322144, "hostname": "flow-main", "episode_reward_min": 310.1992003983512, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557185865, "time_this_iter_s": 24.57844114303589, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 52, "date": "2019-05-06_23-37-45", "episode_len_mean": 695.2}
{"timesteps_since_restore": 2096986, "policy_reward_mean": {}, "episode_reward_max": 897.2928054653028, "time_total_s": 1397.8154702186584, "info": {"num_steps_sampled": 2096986, "sample_time_ms": 16152.498, "grad_time_ms": 8970.66, "update_time_ms": 6.605, "default": {"kl": 0.013293327763676643, "entropy": 1.1290810108184814, "cur_lr": 0.0005000000237487257, "total_loss": 10.639863014221191, "policy_loss": -0.004665630403906107, "vf_explained_var": 0.9465000629425049, "vf_loss": 10.643864631652832, "cur_kl_coeff": 0.05000000447034836}, "num_steps_trained": 2096986, "load_time_ms": 12.105}, "custom_metrics": {"cost1_mean": 336.09466294594284, "outflow_rate_max": 1273.3094648218157, "system_level_velocity_mean": 13.152181552377034, "cost1_min": 267.6559650730829, "cost1_max": 465.6497223860607, "outflow_rate_min": 873.8943836738158, "cost2_mean": -0.04932537995190794, "outflow_rate_mean": 1029.8754578778933, "system_level_velocity_min": 10.46970599283765, "cost2_min": -1.5747395661526848, "system_level_velocity_max": 18.032498928234464, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 53, "done": false, "episodes_total": 912, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062482b0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248828>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248160>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 724.7111863374984, "timesteps_this_iter": 37513, "timesteps_total": 2096986, "time_since_restore": 1397.8154702186584, "hostname": "flow-main", "episode_reward_min": 587.1680174787828, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557185890, "time_this_iter_s": 24.878234386444092, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 53, "date": "2019-05-06_23-38-10", "episode_len_mean": 700.0}
{"timesteps_since_restore": 2134511, "policy_reward_mean": {}, "episode_reward_max": 911.3621061034204, "time_total_s": 1422.7528069019318, "info": {"num_steps_sampled": 2134511, "sample_time_ms": 16060.037, "grad_time_ms": 9053.245, "update_time_ms": 6.579, "default": {"kl": 0.012649856507778168, "entropy": 1.1393510103225708, "cur_lr": 0.0005000000237487257, "total_loss": 10.62078857421875, "policy_loss": -0.004674504045397043, "vf_explained_var": 0.9504313468933105, "vf_loss": 10.62483024597168, "cur_kl_coeff": 0.05000000447034836}, "num_steps_trained": 2134511, "load_time_ms": 11.727}, "custom_metrics": {"cost1_mean": 338.1185037017161, "outflow_rate_max": 1298.0723239375873, "system_level_velocity_mean": 13.23347617058069, "cost1_min": 267.6559650730829, "cost1_max": 487.858973826083, "outflow_rate_min": 873.8943836738158, "cost2_mean": -0.040946243366979315, "outflow_rate_mean": 1033.8259441853868, "system_level_velocity_min": 10.46970599283765, "cost2_min": -1.5747395661526848, "system_level_velocity_max": 18.64595039158846, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 54, "done": false, "episodes_total": 931, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a0b8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a898>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625aa90>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 721.4743701237442, "timesteps_this_iter": 37525, "timesteps_total": 2134511, "time_since_restore": 1422.7528069019318, "hostname": "flow-main", "episode_reward_min": 587.1680174787828, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557185915, "time_this_iter_s": 24.937336683273315, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 54, "date": "2019-05-06_23-38-35", "episode_len_mean": 700.0}
{"timesteps_since_restore": 2172051, "policy_reward_mean": {}, "episode_reward_max": 911.3621061034204, "time_total_s": 1446.5301303863525, "info": {"num_steps_sampled": 2172051, "sample_time_ms": 15911.715, "grad_time_ms": 9141.208, "update_time_ms": 6.612, "default": {"kl": 0.013467124663293362, "entropy": 1.1673550605773926, "cur_lr": 0.0005000000237487257, "total_loss": 8.826057434082031, "policy_loss": -0.005501024890691042, "vf_explained_var": 0.9433706998825073, "vf_loss": 8.830883979797363, "cur_kl_coeff": 0.05000000447034836}, "num_steps_trained": 2172051, "load_time_ms": 11.369}, "custom_metrics": {"cost1_mean": 338.6122286839957, "outflow_rate_max": 1298.0723239375873, "system_level_velocity_mean": 13.260092059116916, "cost1_min": 267.6559650730829, "cost1_max": 487.858973826083, "outflow_rate_min": 873.8943836738158, "cost2_mean": -0.023325315621663813, "outflow_rate_mean": 1035.9411707998393, "system_level_velocity_min": 10.46970599283765, "cost2_min": -0.28610021567773103, "system_level_velocity_max": 18.64595039158846, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 55, "done": false, "episodes_total": 947, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406251828>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062514a8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406251080>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 718.0296235065077, "timesteps_this_iter": 37540, "timesteps_total": 2172051, "time_since_restore": 1446.5301303863525, "hostname": "flow-main", "episode_reward_min": 587.1680174787828, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 16, "timestamp": 1557185938, "time_this_iter_s": 23.777323484420776, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 55, "date": "2019-05-06_23-38-58", "episode_len_mean": 700.0}
{"timesteps_since_restore": 2208448, "policy_reward_mean": {}, "episode_reward_max": 911.3621061034204, "time_total_s": 1470.1412863731384, "info": {"num_steps_sampled": 2208448, "sample_time_ms": 15674.781, "grad_time_ms": 9168.307, "update_time_ms": 6.674, "default": {"kl": 0.014896940439939499, "entropy": 1.1229376792907715, "cur_lr": 0.0005000000237487257, "total_loss": 13.116961479187012, "policy_loss": -0.003668940393254161, "vf_explained_var": 0.9497436881065369, "vf_loss": 13.119885444641113, "cur_kl_coeff": 0.05000000447034836}, "num_steps_trained": 2208448, "load_time_ms": 11.284}, "custom_metrics": {"cost1_mean": 342.17223889530584, "outflow_rate_max": 1298.0723239375873, "system_level_velocity_mean": 13.406479636865281, "cost1_min": 267.6559650730829, "cost1_max": 521.0061241608813, "outflow_rate_min": 873.8943836738158, "cost2_mean": -0.026494835867451202, "outflow_rate_mean": 1040.2245771396247, "system_level_velocity_min": 10.46970599283765, "cost2_min": -0.3173389254254086, "system_level_velocity_max": 20.138599089901383, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 56, "done": false, "episodes_total": 966, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625add8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625aa58>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625aac8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 721.9940548875404, "timesteps_this_iter": 36397, "timesteps_total": 2208448, "time_since_restore": 1470.1412863731384, "hostname": "flow-main", "episode_reward_min": 587.1680174787828, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557185962, "time_this_iter_s": 23.61115598678589, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 56, "date": "2019-05-06_23-39-22", "episode_len_mean": 700.0}
{"timesteps_since_restore": 2246640, "policy_reward_mean": {}, "episode_reward_max": 911.3621061034204, "time_total_s": 1495.8684256076813, "info": {"num_steps_sampled": 2246640, "sample_time_ms": 15736.267, "grad_time_ms": 9101.915, "update_time_ms": 6.771, "default": {"kl": 0.01785292476415634, "entropy": 1.1126885414123535, "cur_lr": 0.0005000000237487257, "total_loss": 14.104395866394043, "policy_loss": -0.007132573984563351, "vf_explained_var": 0.9367712736129761, "vf_loss": 14.110636711120605, "cur_kl_coeff": 0.05000000447034836}, "num_steps_trained": 2246640, "load_time_ms": 11.454}, "custom_metrics": {"cost1_mean": 346.01026716391397, "outflow_rate_max": 1298.0723239375873, "system_level_velocity_mean": 13.749054885015163, "cost1_min": 19.594604764104844, "cost1_max": 521.0061241608813, "outflow_rate_min": 430.7465502984274, "cost2_mean": -0.024335631774513578, "outflow_rate_mean": 1049.6904230045939, "system_level_velocity_min": 10.68192120221214, "cost2_min": -0.3784254313592495, "system_level_velocity_max": 20.138599089901383, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 57, "done": false, "episodes_total": 987, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247198>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247e48>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247550>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 719.7258121221457, "timesteps_this_iter": 38192, "timesteps_total": 2246640, "time_since_restore": 1495.8684256076813, "hostname": "flow-main", "episode_reward_min": 35.780929857665505, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557185988, "time_this_iter_s": 25.727139234542847, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 57, "date": "2019-05-06_23-39-48", "episode_len_mean": 693.29}
{"timesteps_since_restore": 2283509, "policy_reward_mean": {}, "episode_reward_max": 917.735399129006, "time_total_s": 1522.9653210639954, "info": {"num_steps_sampled": 2283509, "sample_time_ms": 15788.239, "grad_time_ms": 9149.75, "update_time_ms": 6.985, "default": {"kl": 0.016057152301073074, "entropy": 1.0514962673187256, "cur_lr": 0.0005000000237487257, "total_loss": 13.73498249053955, "policy_loss": -0.0036859114188700914, "vf_explained_var": 0.9534632563591003, "vf_loss": 13.737865447998047, "cur_kl_coeff": 0.05000000447034836}, "num_steps_trained": 2283509, "load_time_ms": 12.082}, "custom_metrics": {"cost1_mean": 345.44315098727486, "outflow_rate_max": 1311.520661729691, "system_level_velocity_mean": 14.096679539822746, "cost1_min": 19.594604764104844, "cost1_max": 521.0061241608813, "outflow_rate_min": 430.7465502984274, "cost2_mean": -0.030661283702586112, "outflow_rate_mean": 1051.0113020389215, "system_level_velocity_min": 10.831474290862303, "cost2_min": -1.0726616072019466, "system_level_velocity_max": 20.138599089901383, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 58, "done": false, "episodes_total": 1008, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625ac18>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a908>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a6d8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 711.9685429296462, "timesteps_this_iter": 36869, "timesteps_total": 2283509, "time_since_restore": 1522.9653210639954, "hostname": "flow-main", "episode_reward_min": 35.780929857665505, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557186015, "time_this_iter_s": 27.096895456314087, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 58, "date": "2019-05-06_23-40-15", "episode_len_mean": 680.11}
{"timesteps_since_restore": 2321973, "policy_reward_mean": {}, "episode_reward_max": 917.735399129006, "time_total_s": 1550.42249917984, "info": {"num_steps_sampled": 2321973, "sample_time_ms": 15992.4, "grad_time_ms": 9177.147, "update_time_ms": 7.039, "default": {"kl": 0.01596537046134472, "entropy": 1.1149847507476807, "cur_lr": 0.0005000000237487257, "total_loss": 12.130791664123535, "policy_loss": -0.006001697387546301, "vf_explained_var": 0.9371097683906555, "vf_loss": 12.135995864868164, "cur_kl_coeff": 0.05000000819563866}, "num_steps_trained": 2321973, "load_time_ms": 12.612}, "custom_metrics": {"cost1_mean": 339.85880551749693, "outflow_rate_max": 1311.520661729691, "system_level_velocity_mean": 14.271671070526729, "cost1_min": 18.88643609418024, "cost1_max": 521.0061241608813, "outflow_rate_min": 430.7465502984274, "cost2_mean": -0.04240057431461617, "outflow_rate_mean": 1040.430519843669, "system_level_velocity_min": 10.831474290862303, "cost2_min": -1.0726616072019466, "system_level_velocity_max": 20.138599089901383, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 59, "done": false, "episodes_total": 1026, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540622e8d0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062514a8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406251828>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 699.981804771919, "timesteps_this_iter": 38464, "timesteps_total": 2321973, "time_since_restore": 1550.42249917984, "hostname": "flow-main", "episode_reward_min": 34.36793649351502, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557186042, "time_this_iter_s": 27.457178115844727, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 59, "date": "2019-05-06_23-40-42", "episode_len_mean": 666.76}
{"timesteps_since_restore": 2359564, "policy_reward_mean": {}, "episode_reward_max": 917.735399129006, "time_total_s": 1576.7124843597412, "info": {"num_steps_sampled": 2359564, "sample_time_ms": 16007.839, "grad_time_ms": 9224.487, "update_time_ms": 7.156, "default": {"kl": 0.020100368186831474, "entropy": 1.0825337171554565, "cur_lr": 0.0005000000237487257, "total_loss": 13.167811393737793, "policy_loss": -0.006318992003798485, "vf_explained_var": 0.9484862089157104, "vf_loss": 13.173125267028809, "cur_kl_coeff": 0.05000000447034836}, "num_steps_trained": 2359564, "load_time_ms": 12.642}, "custom_metrics": {"cost1_mean": 338.2561973895625, "outflow_rate_max": 1311.520661729691, "system_level_velocity_mean": 14.540473068998383, "cost1_min": 18.88643609418024, "cost1_max": 521.0061241608813, "outflow_rate_min": 430.7465502984274, "cost2_mean": -0.052816058151213756, "outflow_rate_mean": 1037.9620554002538, "system_level_velocity_min": 10.955834534252972, "cost2_min": -1.0726616072019466, "system_level_velocity_max": 20.138599089901383, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 60, "done": false, "episodes_total": 1045, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247550>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247518>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062474e0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 693.4979545910471, "timesteps_this_iter": 37591, "timesteps_total": 2359564, "time_since_restore": 1576.7124843597412, "hostname": "flow-main", "episode_reward_min": 34.36793649351502, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557186069, "time_this_iter_s": 26.289985179901123, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 60, "date": "2019-05-06_23-41-09", "episode_len_mean": 654.58}
{"timesteps_since_restore": 2397404, "policy_reward_mean": {}, "episode_reward_max": 926.4373019822671, "time_total_s": 1602.5076909065247, "info": {"num_steps_sampled": 2397404, "sample_time_ms": 16074.567, "grad_time_ms": 9236.813, "update_time_ms": 7.468, "default": {"kl": 0.01516181044280529, "entropy": 1.094627022743225, "cur_lr": 0.0005000000237487257, "total_loss": 14.217649459838867, "policy_loss": -0.005709415301680565, "vf_explained_var": 0.9383300542831421, "vf_loss": 14.222221374511719, "cur_kl_coeff": 0.07499998807907104}, "num_steps_trained": 2397404, "load_time_ms": 12.728}, "custom_metrics": {"cost1_mean": 336.9428189339237, "outflow_rate_max": 1311.520661729691, "system_level_velocity_mean": 14.643537506944334, "cost1_min": 18.88643609418024, "cost1_max": 503.6468842837728, "outflow_rate_min": 430.7465502984274, "cost2_mean": -0.058954259675021374, "outflow_rate_mean": 1038.9955930021797, "system_level_velocity_min": 10.92433536310663, "cost2_min": -1.0726616072019466, "system_level_velocity_max": 20.10336637459851, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 61, "done": false, "episodes_total": 1066, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248828>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062487f0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248a20>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 688.5174573580538, "timesteps_this_iter": 37840, "timesteps_total": 2397404, "time_since_restore": 1602.5076909065247, "hostname": "flow-main", "episode_reward_min": 34.36793649351502, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557186095, "time_this_iter_s": 25.795206546783447, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 61, "date": "2019-05-06_23-41-35", "episode_len_mean": 648.94}
{"timesteps_since_restore": 2435262, "policy_reward_mean": {}, "episode_reward_max": 926.4373019822671, "time_total_s": 1627.2385907173157, "info": {"num_steps_sampled": 2435262, "sample_time_ms": 16052.289, "grad_time_ms": 9274.372, "update_time_ms": 7.327, "default": {"kl": 0.015666719526052475, "entropy": 1.090360164642334, "cur_lr": 0.0005000000237487257, "total_loss": 13.138855934143066, "policy_loss": -0.006825279910117388, "vf_explained_var": 0.9342589378356934, "vf_loss": 13.14450454711914, "cur_kl_coeff": 0.07499998807907104}, "num_steps_trained": 2435262, "load_time_ms": 12.003}, "custom_metrics": {"cost1_mean": 334.44112615488564, "outflow_rate_max": 1311.520661729691, "system_level_velocity_mean": 14.694468824064694, "cost1_min": 18.88643609418024, "cost1_max": 503.6468842837728, "outflow_rate_min": 436.5771272776546, "cost2_mean": -0.10098502502861115, "outflow_rate_mean": 1032.52459189323, "system_level_velocity_min": 10.92433536310663, "cost2_min": -2.2841689954383364, "system_level_velocity_max": 20.10336637459851, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 62, "done": false, "episodes_total": 1087, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a860>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a898>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a5c0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 680.4683752882255, "timesteps_this_iter": 37858, "timesteps_total": 2435262, "time_since_restore": 1627.2385907173157, "hostname": "flow-main", "episode_reward_min": 34.36793649351502, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557186119, "time_this_iter_s": 24.730899810791016, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 62, "date": "2019-05-06_23-41-59", "episode_len_mean": 643.18}
{"timesteps_since_restore": 2472308, "policy_reward_mean": {}, "episode_reward_max": 926.4373019822671, "time_total_s": 1652.120599746704, "info": {"num_steps_sampled": 2472308, "sample_time_ms": 16046.471, "grad_time_ms": 9280.866, "update_time_ms": 7.344, "default": {"kl": 0.016085496172308922, "entropy": 1.0822631120681763, "cur_lr": 0.0005000000237487257, "total_loss": 13.996309280395508, "policy_loss": -0.006143891252577305, "vf_explained_var": 0.9338524341583252, "vf_loss": 14.001246452331543, "cur_kl_coeff": 0.07499999552965164}, "num_steps_trained": 2472308, "load_time_ms": 12.594}, "custom_metrics": {"cost1_mean": 330.5591138959272, "outflow_rate_max": 1309.0542263582536, "system_level_velocity_mean": 14.473334866541252, "cost1_min": 18.88643609418024, "cost1_max": 495.39401885543714, "outflow_rate_min": 436.5771272776546, "cost2_mean": -0.10472988214219629, "outflow_rate_mean": 1026.9458184873638, "system_level_velocity_min": 10.63879538192598, "cost2_min": -2.2841689954383364, "system_level_velocity_max": 20.10336637459851, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 63, "done": false, "episodes_total": 1108, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540623e3c8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540623ef60>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540623e438>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 683.4955976810546, "timesteps_this_iter": 37046, "timesteps_total": 2472308, "time_since_restore": 1652.120599746704, "hostname": "flow-main", "episode_reward_min": 34.36793649351502, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557186144, "time_this_iter_s": 24.882009029388428, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 63, "date": "2019-05-06_23-42-24", "episode_len_mean": 645.18}
{"timesteps_since_restore": 2509016, "policy_reward_mean": {}, "episode_reward_max": 926.4373019822671, "time_total_s": 1676.6845500469208, "info": {"num_steps_sampled": 2509016, "sample_time_ms": 15975.363, "grad_time_ms": 9313.479, "update_time_ms": 7.429, "default": {"kl": 0.014690644107758999, "entropy": 1.0846498012542725, "cur_lr": 0.0005000000237487257, "total_loss": 9.47414493560791, "policy_loss": -0.006954953074455261, "vf_explained_var": 0.9568585753440857, "vf_loss": 9.479997634887695, "cur_kl_coeff": 0.07499998807907104}, "num_steps_trained": 2509016, "load_time_ms": 13.2}, "custom_metrics": {"cost1_mean": 337.2217366936164, "outflow_rate_max": 1309.0542263582536, "system_level_velocity_mean": 14.345052388064063, "cost1_min": 22.060666957726653, "cost1_max": 495.39401885543714, "outflow_rate_min": 436.60683389916557, "cost2_mean": -0.10397319253538148, "outflow_rate_mean": 1041.7072387136332, "system_level_velocity_min": 10.63879538192598, "cost2_min": -2.2841689954383364, "system_level_velocity_max": 19.94405089303242, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 64, "done": false, "episodes_total": 1125, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a198>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625acc0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625add8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 696.74530474389, "timesteps_this_iter": 36708, "timesteps_total": 2509016, "time_since_restore": 1676.6845500469208, "hostname": "flow-main", "episode_reward_min": 40.78047516383117, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 17, "timestamp": 1557186169, "time_this_iter_s": 24.563950300216675, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 64, "date": "2019-05-06_23-42-49", "episode_len_mean": 658.53}
{"timesteps_since_restore": 2547223, "policy_reward_mean": {}, "episode_reward_max": 926.4373019822671, "time_total_s": 1701.4414448738098, "info": {"num_steps_sampled": 2547223, "sample_time_ms": 16045.398, "grad_time_ms": 9339.512, "update_time_ms": 7.714, "default": {"kl": 0.01702224463224411, "entropy": 1.0865318775177002, "cur_lr": 0.0005000000237487257, "total_loss": 13.336097717285156, "policy_loss": -0.008160736411809921, "vf_explained_var": 0.9383748769760132, "vf_loss": 13.34298038482666, "cur_kl_coeff": 0.07499999552965164}, "num_steps_trained": 2547223, "load_time_ms": 13.649}, "custom_metrics": {"cost1_mean": 338.93009632878216, "outflow_rate_max": 1309.0542263582536, "system_level_velocity_mean": 14.231456176587178, "cost1_min": 22.060666957726653, "cost1_max": 499.1070081832245, "outflow_rate_min": 436.60683389916557, "cost2_mean": -0.1007673614591399, "outflow_rate_mean": 1042.6194086289993, "system_level_velocity_min": 10.63879538192598, "cost2_min": -2.2841689954383364, "system_level_velocity_max": 19.94405089303242, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 65, "done": false, "episodes_total": 1146, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247898>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625aba8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247d68>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 703.8082860570097, "timesteps_this_iter": 38207, "timesteps_total": 2547223, "time_since_restore": 1701.4414448738098, "hostname": "flow-main", "episode_reward_min": 40.78047516383117, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557186194, "time_this_iter_s": 24.756894826889038, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 65, "date": "2019-05-06_23-43-14", "episode_len_mean": 664.97}
{"timesteps_since_restore": 2584542, "policy_reward_mean": {}, "episode_reward_max": 883.0406786100855, "time_total_s": 1725.7620701789856, "info": {"num_steps_sampled": 2584542, "sample_time_ms": 16083.357, "grad_time_ms": 9370.218, "update_time_ms": 7.818, "default": {"kl": 0.016029629856348038, "entropy": 1.078028678894043, "cur_lr": 0.0005000000237487257, "total_loss": 9.93333911895752, "policy_loss": -0.00595947727560997, "vf_explained_var": 0.9439957141876221, "vf_loss": 9.938096046447754, "cur_kl_coeff": 0.07499998807907104}, "num_steps_trained": 2584542, "load_time_ms": 13.983}, "custom_metrics": {"cost1_mean": 341.4027270837668, "outflow_rate_max": 1260.902220632042, "system_level_velocity_mean": 14.16208758800247, "cost1_min": 22.060666957726653, "cost1_max": 499.1070081832245, "outflow_rate_min": 436.60683389916557, "cost2_mean": -0.09894131892350719, "outflow_rate_mean": 1047.100106851139, "system_level_velocity_min": 10.63879538192598, "cost2_min": -2.2841689954383364, "system_level_velocity_max": 19.94405089303242, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 66, "done": false, "episodes_total": 1160, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248198>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248518>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248898>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 710.6273574913288, "timesteps_this_iter": 37319, "timesteps_total": 2584542, "time_since_restore": 1725.7620701789856, "hostname": "flow-main", "episode_reward_min": 40.78047516383117, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 14, "timestamp": 1557186218, "time_this_iter_s": 24.32062530517578, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 66, "date": "2019-05-06_23-43-38", "episode_len_mean": 670.61}
{"timesteps_since_restore": 2621818, "policy_reward_mean": {}, "episode_reward_max": 883.0406786100855, "time_total_s": 1750.5964658260345, "info": {"num_steps_sampled": 2621818, "sample_time_ms": 15998.23, "grad_time_ms": 9367.688, "update_time_ms": 7.797, "default": {"kl": 0.014879590831696987, "entropy": 1.0887900590896606, "cur_lr": 0.0005000000237487257, "total_loss": 12.620903968811035, "policy_loss": -0.006357118953019381, "vf_explained_var": 0.9373630285263062, "vf_loss": 12.626145362854004, "cur_kl_coeff": 0.07499998807907104}, "num_steps_trained": 2621818, "load_time_ms": 13.579}, "custom_metrics": {"cost1_mean": 337.32437576340766, "outflow_rate_max": 1260.902220632042, "system_level_velocity_mean": 14.013453201715645, "cost1_min": 22.060666957726653, "cost1_max": 499.1070081832245, "outflow_rate_min": 431.8273396153764, "cost2_mean": -0.05961643632198581, "outflow_rate_mean": 1039.6481113153168, "system_level_velocity_min": 10.63879538192598, "cost2_min": -0.6865620363346018, "system_level_velocity_max": 19.63300357606817, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 67, "done": false, "episodes_total": 1181, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406251470>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406251f98>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406251710>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 710.7421076779196, "timesteps_this_iter": 37276, "timesteps_total": 2621818, "time_since_restore": 1750.5964658260345, "hostname": "flow-main", "episode_reward_min": 40.78047516383117, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557186243, "time_this_iter_s": 24.83439564704895, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 67, "date": "2019-05-06_23-44-03", "episode_len_mean": 669.84}
{"timesteps_since_restore": 2659399, "policy_reward_mean": {}, "episode_reward_max": 883.0406786100855, "time_total_s": 1776.0849602222443, "info": {"num_steps_sampled": 2659399, "sample_time_ms": 15878.74, "grad_time_ms": 9325.629, "update_time_ms": 7.637, "default": {"kl": 0.01629946567118168, "entropy": 1.0490949153900146, "cur_lr": 0.0005000000237487257, "total_loss": 11.514331817626953, "policy_loss": -0.0065883793868124485, "vf_explained_var": 0.9477211833000183, "vf_loss": 11.519698143005371, "cur_kl_coeff": 0.07499999552965164}, "num_steps_trained": 2659399, "load_time_ms": 12.935}, "custom_metrics": {"cost1_mean": 343.84127282012116, "outflow_rate_max": 1260.902220632042, "system_level_velocity_mean": 13.926899460847192, "cost1_min": 29.18861993778009, "cost1_max": 499.1070081832245, "outflow_rate_min": 431.8273396153764, "cost2_mean": -0.05109465473132167, "outflow_rate_mean": 1052.5089159666998, "system_level_velocity_min": 10.855108266664882, "cost2_min": -0.6847442338955951, "system_level_velocity_max": 19.63300357606817, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 68, "done": false, "episodes_total": 1200, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625abe0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625ae10>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a7b8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 724.8077257864929, "timesteps_this_iter": 37581, "timesteps_total": 2659399, "time_since_restore": 1776.0849602222443, "hostname": "flow-main", "episode_reward_min": 50.31044277803018, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557186268, "time_this_iter_s": 25.488494396209717, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 68, "date": "2019-05-06_23-44-28", "episode_len_mean": 683.1}
{"timesteps_since_restore": 2696576, "policy_reward_mean": {}, "episode_reward_max": 883.0406786100855, "time_total_s": 1800.4519972801208, "info": {"num_steps_sampled": 2696576, "sample_time_ms": 15581.853, "grad_time_ms": 9313.908, "update_time_ms": 7.82, "default": {"kl": 0.01618625968694687, "entropy": 1.0712497234344482, "cur_lr": 0.0005000000237487257, "total_loss": 11.491087913513184, "policy_loss": -0.007050428539514542, "vf_explained_var": 0.9456658959388733, "vf_loss": 11.496923446655273, "cur_kl_coeff": 0.07499999552965164}, "num_steps_trained": 2696576, "load_time_ms": 12.959}, "custom_metrics": {"cost1_mean": 348.91255478778993, "outflow_rate_max": 1260.902220632042, "system_level_velocity_mean": 13.994085780531442, "cost1_min": 29.18861993778009, "cost1_max": 499.1070081832245, "outflow_rate_min": 431.8273396153764, "cost2_mean": -0.04422912796406235, "outflow_rate_mean": 1060.1419899684788, "system_level_velocity_min": 8.736960209746895, "cost2_min": -0.46370870233533024, "system_level_velocity_max": 19.483425950531306, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 69, "done": false, "episodes_total": 1218, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062336d8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233dd8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062331d0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 732.4031616745933, "timesteps_this_iter": 37177, "timesteps_total": 2696576, "time_since_restore": 1800.4519972801208, "hostname": "flow-main", "episode_reward_min": 50.31044277803018, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557186293, "time_this_iter_s": 24.367037057876587, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 69, "date": "2019-05-06_23-44-53", "episode_len_mean": 687.69}
{"timesteps_since_restore": 2734293, "policy_reward_mean": {}, "episode_reward_max": 883.0406786100855, "time_total_s": 1825.4798493385315, "info": {"num_steps_sampled": 2734293, "sample_time_ms": 15408.218, "grad_time_ms": 9363.173, "update_time_ms": 7.832, "default": {"kl": 0.017978142946958542, "entropy": 1.0717681646347046, "cur_lr": 0.0005000000237487257, "total_loss": 10.89373779296875, "policy_loss": -0.009014340117573738, "vf_explained_var": 0.9433824419975281, "vf_loss": 10.901402473449707, "cur_kl_coeff": 0.07499998807907104}, "num_steps_trained": 2734293, "load_time_ms": 13.033}, "custom_metrics": {"cost1_mean": 347.5827875330966, "outflow_rate_max": 1291.6632015141743, "system_level_velocity_mean": 13.796521278950673, "cost1_min": 29.18861993778009, "cost1_max": 467.18669365902076, "outflow_rate_min": 431.8273396153764, "cost2_mean": -0.05439885774145567, "outflow_rate_mean": 1058.888050921188, "system_level_velocity_min": 8.736960209746895, "cost2_min": -0.9762989396532222, "system_level_velocity_max": 19.04485033058046, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 70, "done": false, "episodes_total": 1235, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233518>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233be0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233160>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 732.3488453511053, "timesteps_this_iter": 37717, "timesteps_total": 2734293, "time_since_restore": 1825.4798493385315, "hostname": "flow-main", "episode_reward_min": 50.31044277803018, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 17, "timestamp": 1557186318, "time_this_iter_s": 25.027852058410645, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 70, "date": "2019-05-06_23-45-18", "episode_len_mean": 693.43}
{"timesteps_since_restore": 2770946, "policy_reward_mean": {}, "episode_reward_max": 885.5971189723239, "time_total_s": 1850.5069103240967, "info": {"num_steps_sampled": 2770946, "sample_time_ms": 15278.143, "grad_time_ms": 9413.239, "update_time_ms": 7.671, "default": {"kl": 0.015824340283870697, "entropy": 1.0598169565200806, "cur_lr": 0.0005000000237487257, "total_loss": 10.637266159057617, "policy_loss": -0.0064005618914961815, "vf_explained_var": 0.9561964869499207, "vf_loss": 10.642478942871094, "cur_kl_coeff": 0.07499998807907104}, "num_steps_trained": 2770946, "load_time_ms": 12.852}, "custom_metrics": {"cost1_mean": 348.6122468733814, "outflow_rate_max": 1297.4848609404773, "system_level_velocity_mean": 13.846466753139719, "cost1_min": 29.18861993778009, "cost1_max": 475.823635049452, "outflow_rate_min": 431.8273396153764, "cost2_mean": -0.056121677307796915, "outflow_rate_mean": 1062.476139752943, "system_level_velocity_min": 8.736960209746895, "cost2_min": -0.9762989396532222, "system_level_velocity_max": 19.04485033058046, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 71, "done": false, "episodes_total": 1253, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540623ef60>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540623eba8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540623e160>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 732.8950091246211, "timesteps_this_iter": 36653, "timesteps_total": 2770946, "time_since_restore": 1850.5069103240967, "hostname": "flow-main", "episode_reward_min": 50.31044277803018, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557186343, "time_this_iter_s": 25.027060985565186, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 71, "date": "2019-05-06_23-45-43", "episode_len_mean": 693.43}
{"timesteps_since_restore": 2809542, "policy_reward_mean": {}, "episode_reward_max": 885.5971189723239, "time_total_s": 1876.9277091026306, "info": {"num_steps_sampled": 2809542, "sample_time_ms": 15282.471, "grad_time_ms": 9577.582, "update_time_ms": 7.91, "default": {"kl": 0.01794377900660038, "entropy": 1.10201895236969, "cur_lr": 0.0005000000237487257, "total_loss": 10.897439002990723, "policy_loss": -0.007603793404996395, "vf_explained_var": 0.9389088749885559, "vf_loss": 10.90369701385498, "cur_kl_coeff": 0.07499998807907104}, "num_steps_trained": 2809542, "load_time_ms": 13.554}, "custom_metrics": {"cost1_mean": 350.4038499499023, "outflow_rate_max": 1297.4848609404773, "system_level_velocity_mean": 13.753201430790115, "cost1_min": 219.21774098242395, "cost1_max": 497.4212687273153, "outflow_rate_min": 805.7899996611238, "cost2_mean": -0.06304802583597917, "outflow_rate_mean": 1066.0224983488852, "system_level_velocity_min": 8.736960209746895, "cost2_min": -0.9762989396532222, "system_level_velocity_max": 19.334387109067237, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 72, "done": false, "episodes_total": 1272, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247860>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247e48>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247a58>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 737.1329470789457, "timesteps_this_iter": 38596, "timesteps_total": 2809542, "time_since_restore": 1876.9277091026306, "hostname": "flow-main", "episode_reward_min": 597.0078087004995, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557186369, "time_this_iter_s": 26.420798778533936, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 72, "date": "2019-05-06_23-46-09", "episode_len_mean": 700.0}
{"timesteps_since_restore": 2847825, "policy_reward_mean": {}, "episode_reward_max": 885.5971189723239, "time_total_s": 1902.8134005069733, "info": {"num_steps_sampled": 2847825, "sample_time_ms": 15315.875, "grad_time_ms": 9642.836, "update_time_ms": 8.043, "default": {"kl": 0.017199095338582993, "entropy": 1.0951249599456787, "cur_lr": 0.0005000000237487257, "total_loss": 10.731857299804688, "policy_loss": -0.006372871808707714, "vf_explained_var": 0.9468992352485657, "vf_loss": 10.736940383911133, "cur_kl_coeff": 0.07499998807907104}, "num_steps_trained": 2847825, "load_time_ms": 13.751}, "custom_metrics": {"cost1_mean": 348.36184693303915, "outflow_rate_max": 1297.4848609404773, "system_level_velocity_mean": 13.861151972520362, "cost1_min": 18.76435672931954, "cost1_max": 497.4212687273153, "outflow_rate_min": 436.5081934541252, "cost2_mean": -0.06692161836044838, "outflow_rate_mean": 1063.7873835937135, "system_level_velocity_min": 8.736960209746895, "cost2_min": -0.9762989396532222, "system_level_velocity_max": 19.712389919508983, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 73, "done": false, "episodes_total": 1290, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062330f0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233048>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062331d0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 732.4078466691863, "timesteps_this_iter": 38283, "timesteps_total": 2847825, "time_since_restore": 1902.8134005069733, "hostname": "flow-main", "episode_reward_min": 34.140593279271236, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557186395, "time_this_iter_s": 25.88569140434265, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 73, "date": "2019-05-06_23-46-35", "episode_len_mean": 693.28}
{"timesteps_since_restore": 2885654, "policy_reward_mean": {}, "episode_reward_max": 885.5971189723239, "time_total_s": 1928.4203474521637, "info": {"num_steps_sampled": 2885654, "sample_time_ms": 15373.164, "grad_time_ms": 9688.881, "update_time_ms": 8.083, "default": {"kl": 0.016701923683285713, "entropy": 1.0954254865646362, "cur_lr": 0.0005000000237487257, "total_loss": 11.711993217468262, "policy_loss": -0.007093597669154406, "vf_explained_var": 0.9454066157341003, "vf_loss": 11.717833518981934, "cur_kl_coeff": 0.07499998807907104}, "num_steps_trained": 2885654, "load_time_ms": 13.85}, "custom_metrics": {"cost1_mean": 345.2897051029519, "outflow_rate_max": 1297.4848609404773, "system_level_velocity_mean": 13.74982064804706, "cost1_min": 18.76435672931954, "cost1_max": 497.4212687273153, "outflow_rate_min": 436.5081934541252, "cost2_mean": -0.0743705397214491, "outflow_rate_mean": 1057.542536725482, "system_level_velocity_min": 8.736960209746895, "cost2_min": -0.9762989396532222, "system_level_velocity_max": 19.712389919508983, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 74, "done": false, "episodes_total": 1311, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233240>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233080>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233be0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 727.3917578901121, "timesteps_this_iter": 37829, "timesteps_total": 2885654, "time_since_restore": 1928.4203474521637, "hostname": "flow-main", "episode_reward_min": 34.140593279271236, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557186421, "time_this_iter_s": 25.60694694519043, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 74, "date": "2019-05-06_23-47-01", "episode_len_mean": 693.28}
{"timesteps_since_restore": 2922948, "policy_reward_mean": {}, "episode_reward_max": 885.5971189723239, "time_total_s": 1953.8407340049744, "info": {"num_steps_sampled": 2922948, "sample_time_ms": 15458.184, "grad_time_ms": 9672.69, "update_time_ms": 7.924, "default": {"kl": 0.017880834639072418, "entropy": 1.083336353302002, "cur_lr": 0.0005000000237487257, "total_loss": 10.435770034790039, "policy_loss": -0.004703356884419918, "vf_explained_var": 0.9502744078636169, "vf_loss": 10.439132690429688, "cur_kl_coeff": 0.07499998807907104}, "num_steps_trained": 2922948, "load_time_ms": 13.876}, "custom_metrics": {"cost1_mean": 342.82650249061936, "outflow_rate_max": 1297.4848609404773, "system_level_velocity_mean": 13.834479395552615, "cost1_min": 18.76435672931954, "cost1_max": 497.4212687273153, "outflow_rate_min": 436.5081934541252, "cost2_mean": -0.0582341243859651, "outflow_rate_mean": 1052.5068342123002, "system_level_velocity_min": 9.727954445328741, "cost2_min": -0.9251578087909085, "system_level_velocity_max": 19.712389919508983, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 75, "done": false, "episodes_total": 1328, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247048>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247d30>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247cf8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 721.2128044478992, "timesteps_this_iter": 37294, "timesteps_total": 2922948, "time_since_restore": 1953.8407340049744, "hostname": "flow-main", "episode_reward_min": 34.140593279271236, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 17, "timestamp": 1557186446, "time_this_iter_s": 25.42038655281067, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 75, "date": "2019-05-06_23-47-26", "episode_len_mean": 686.86}
{"timesteps_since_restore": 2961506, "policy_reward_mean": {}, "episode_reward_max": 864.958713140971, "time_total_s": 1980.1898574829102, "info": {"num_steps_sampled": 2961506, "sample_time_ms": 15676.378, "grad_time_ms": 9657.699, "update_time_ms": 7.949, "default": {"kl": 0.018127495422959328, "entropy": 1.096882939338684, "cur_lr": 0.0005000000237487257, "total_loss": 10.99532699584961, "policy_loss": -0.005865119397640228, "vf_explained_var": 0.9398909211158752, "vf_loss": 10.999831199645996, "cur_kl_coeff": 0.07499998807907104}, "num_steps_trained": 2961506, "load_time_ms": 13.782}, "custom_metrics": {"cost1_mean": 345.3216700003122, "outflow_rate_max": 1259.5239003133424, "system_level_velocity_mean": 13.94597055498985, "cost1_min": 18.76435672931954, "cost1_max": 497.4212687273153, "outflow_rate_min": 436.5081934541252, "cost2_mean": -0.05169574962860372, "outflow_rate_mean": 1055.9392174399243, "system_level_velocity_min": 9.727954445328741, "cost2_min": -0.9251578087909085, "system_level_velocity_max": 19.712389919508983, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 76, "done": false, "episodes_total": 1348, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233780>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233ac8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233cf8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 719.4231956669375, "timesteps_this_iter": 38558, "timesteps_total": 2961506, "time_since_restore": 1980.1898574829102, "hostname": "flow-main", "episode_reward_min": 34.140593279271236, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557186473, "time_this_iter_s": 26.34912347793579, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 76, "date": "2019-05-06_23-47-53", "episode_len_mean": 686.86}
{"timesteps_since_restore": 2998918, "policy_reward_mean": {}, "episode_reward_max": 864.958713140971, "time_total_s": 2003.9281845092773, "info": {"num_steps_sampled": 2998918, "sample_time_ms": 15593.846, "grad_time_ms": 9630.392, "update_time_ms": 7.912, "default": {"kl": 0.017015721648931503, "entropy": 1.1134315729141235, "cur_lr": 0.0005000000237487257, "total_loss": 11.454752922058105, "policy_loss": -0.0060706171207129955, "vf_explained_var": 0.9438984394073486, "vf_loss": 11.459546089172363, "cur_kl_coeff": 0.07499999552965164}, "num_steps_trained": 2998918, "load_time_ms": 14.066}, "custom_metrics": {"cost1_mean": 336.94100312858535, "outflow_rate_max": 1259.5239003133424, "system_level_velocity_mean": 13.963762533823495, "cost1_min": 18.76435672931954, "cost1_max": 468.11530387588726, "outflow_rate_min": 419.1285555471524, "cost2_mean": -0.04801572964913198, "outflow_rate_mean": 1039.9818172426071, "system_level_velocity_min": 9.727954445328741, "cost2_min": -0.9251578087909085, "system_level_velocity_max": 19.712389919508983, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 77, "done": false, "episodes_total": 1366, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a4a8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a390>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a860>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 713.6421778816707, "timesteps_this_iter": 37412, "timesteps_total": 2998918, "time_since_restore": 2003.9281845092773, "hostname": "flow-main", "episode_reward_min": 34.140593279271236, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557186496, "time_this_iter_s": 23.738327026367188, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 77, "date": "2019-05-06_23-48-16", "episode_len_mean": 673.75}
{"timesteps_since_restore": 3035579, "policy_reward_mean": {}, "episode_reward_max": 864.958713140971, "time_total_s": 2028.8049128055573, "info": {"num_steps_sampled": 3035579, "sample_time_ms": 15600.311, "grad_time_ms": 9564.507, "update_time_ms": 7.873, "default": {"kl": 0.018345825374126434, "entropy": 1.0852742195129395, "cur_lr": 0.0005000000237487257, "total_loss": 10.80299186706543, "policy_loss": -0.00686235073953867, "vf_explained_var": 0.955703854560852, "vf_loss": 10.808478355407715, "cur_kl_coeff": 0.07499998807907104}, "num_steps_trained": 3035579, "load_time_ms": 14.161}, "custom_metrics": {"cost1_mean": 344.3706589724263, "outflow_rate_max": 1259.5239003133424, "system_level_velocity_mean": 14.053520687423424, "cost1_min": 26.494769043994275, "cost1_max": 468.11530387588726, "outflow_rate_min": 419.1285555471524, "cost2_mean": -0.07466513689774688, "outflow_rate_mean": 1051.9900005824165, "system_level_velocity_min": 9.727954445328741, "cost2_min": -2.7448582428032067, "system_level_velocity_max": 19.073953950416538, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 78, "done": false, "episodes_total": 1386, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235128>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235cf8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235f60>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 717.7098465062575, "timesteps_this_iter": 36661, "timesteps_total": 3035579, "time_since_restore": 2028.8049128055573, "hostname": "flow-main", "episode_reward_min": 52.385372421236575, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557186521, "time_this_iter_s": 24.876728296279907, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 78, "date": "2019-05-06_23-48-41", "episode_len_mean": 680.47}
{"timesteps_since_restore": 3073267, "policy_reward_mean": {}, "episode_reward_max": 864.958713140971, "time_total_s": 2052.954260826111, "info": {"num_steps_sampled": 3073267, "sample_time_ms": 15587.537, "grad_time_ms": 9555.431, "update_time_ms": 7.739, "default": {"kl": 0.01963176764547825, "entropy": 1.1214745044708252, "cur_lr": 0.0005000000237487257, "total_loss": 10.936565399169922, "policy_loss": -0.007291174028068781, "vf_explained_var": 0.9336182475090027, "vf_loss": 10.942383766174316, "cur_kl_coeff": 0.07499998807907104}, "num_steps_trained": 3073267, "load_time_ms": 14.114}, "custom_metrics": {"cost1_mean": 339.5534799164583, "outflow_rate_max": 1259.5239003133424, "system_level_velocity_mean": 14.040603979128639, "cost1_min": 26.494769043994275, "cost1_max": 468.11530387588726, "outflow_rate_min": 419.1285555471524, "cost2_mean": -0.061405255760216014, "outflow_rate_mean": 1041.0019005374659, "system_level_velocity_min": 10.269592318742948, "cost2_min": -2.7448582428032067, "system_level_velocity_max": 19.073953950416538, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 79, "done": false, "episodes_total": 1405, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a588>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a080>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a518>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 710.2458064602106, "timesteps_this_iter": 37688, "timesteps_total": 3073267, "time_since_restore": 2052.954260826111, "hostname": "flow-main", "episode_reward_min": 52.385372421236575, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557186546, "time_this_iter_s": 24.14934802055359, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 79, "date": "2019-05-06_23-49-06", "episode_len_mean": 673.98}
{"timesteps_since_restore": 3111083, "policy_reward_mean": {}, "episode_reward_max": 856.2363921548597, "time_total_s": 2078.5438907146454, "info": {"num_steps_sampled": 3111083, "sample_time_ms": 15677.187, "grad_time_ms": 9521.111, "update_time_ms": 7.612, "default": {"kl": 0.01860974170267582, "entropy": 1.1156823635101318, "cur_lr": 0.0005000000237487257, "total_loss": 14.490767478942871, "policy_loss": -0.00593595253303647, "vf_explained_var": 0.932536780834198, "vf_loss": 14.495307922363281, "cur_kl_coeff": 0.07499998807907104}, "num_steps_trained": 3111083, "load_time_ms": 14.121}, "custom_metrics": {"cost1_mean": 333.03329552301204, "outflow_rate_max": 1259.5239003133424, "system_level_velocity_mean": 14.088029469026388, "cost1_min": 26.494769043994275, "cost1_max": 472.1670781132026, "outflow_rate_min": 419.1285555471524, "cost2_mean": -0.06996977724199371, "outflow_rate_mean": 1029.863649374254, "system_level_velocity_min": 10.269592318742948, "cost2_min": -2.7448582428032067, "system_level_velocity_max": 19.84041398040954, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 80, "done": false, "episodes_total": 1426, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233278>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233e48>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233240>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 699.6878595057934, "timesteps_this_iter": 37816, "timesteps_total": 3111083, "time_since_restore": 2078.5438907146454, "hostname": "flow-main", "episode_reward_min": 52.385372421236575, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557186571, "time_this_iter_s": 25.589629888534546, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 80, "date": "2019-05-06_23-49-31", "episode_len_mean": 663.53}
{"timesteps_since_restore": 3148046, "policy_reward_mean": {}, "episode_reward_max": 896.0576476252265, "time_total_s": 2103.730632543564, "info": {"num_steps_sampled": 3148046, "sample_time_ms": 15712.929, "grad_time_ms": 9503.488, "update_time_ms": 7.681, "default": {"kl": 0.022068696096539497, "entropy": 1.0887892246246338, "cur_lr": 0.0005000000237487257, "total_loss": 14.563594818115234, "policy_loss": -0.006708069238811731, "vf_explained_var": 0.9344717860221863, "vf_loss": 14.568647384643555, "cur_kl_coeff": 0.07499999552965164}, "num_steps_trained": 3148046, "load_time_ms": 14.191}, "custom_metrics": {"cost1_mean": 327.67197100759745, "outflow_rate_max": 1258.7258779536592, "system_level_velocity_mean": 14.170809381683753, "cost1_min": 26.494769043994275, "cost1_max": 485.59673613280347, "outflow_rate_min": 419.1285555471524, "cost2_mean": -0.0709915779687184, "outflow_rate_mean": 1021.2607460785474, "system_level_velocity_min": 10.269592318742948, "cost2_min": -2.7448582428032067, "system_level_velocity_max": 19.84041398040954, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 81, "done": false, "episodes_total": 1446, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540623e6d8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540623ea20>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540623ecc0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 693.5859097208198, "timesteps_this_iter": 36963, "timesteps_total": 3148046, "time_since_restore": 2103.730632543564, "hostname": "flow-main", "episode_reward_min": 52.385372421236575, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557186596, "time_this_iter_s": 25.186741828918457, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 81, "date": "2019-05-06_23-49-56", "episode_len_mean": 652.16}
{"timesteps_since_restore": 3186287, "policy_reward_mean": {}, "episode_reward_max": 896.0576476252265, "time_total_s": 2129.188556432724, "info": {"num_steps_sampled": 3186287, "sample_time_ms": 15760.324, "grad_time_ms": 9359.327, "update_time_ms": 7.764, "default": {"kl": 0.01654307171702385, "entropy": 1.1134332418441772, "cur_lr": 0.0005000000237487257, "total_loss": 10.000617027282715, "policy_loss": -0.005152920726686716, "vf_explained_var": 0.9459469318389893, "vf_loss": 10.00390911102295, "cur_kl_coeff": 0.11250000447034836}, "num_steps_trained": 3186287, "load_time_ms": 14.215}, "custom_metrics": {"cost1_mean": 329.9129169514321, "outflow_rate_max": 1258.7258779536592, "system_level_velocity_mean": 14.260248972539493, "cost1_min": 26.494769043994275, "cost1_max": 485.59673613280347, "outflow_rate_min": 419.1285555471524, "cost2_mean": -0.07536488835892963, "outflow_rate_mean": 1028.390009457695, "system_level_velocity_min": 10.269592318742948, "cost2_min": -2.7448582428032067, "system_level_velocity_max": 19.84041398040954, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 82, "done": false, "episodes_total": 1463, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062333c8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062332b0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233898>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 692.7901675525453, "timesteps_this_iter": 38241, "timesteps_total": 3186287, "time_since_restore": 2129.188556432724, "hostname": "flow-main", "episode_reward_min": 52.385372421236575, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 17, "timestamp": 1557186622, "time_this_iter_s": 25.457923889160156, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 82, "date": "2019-05-06_23-50-22", "episode_len_mean": 652.19}
{"timesteps_since_restore": 3224456, "policy_reward_mean": {}, "episode_reward_max": 896.0576476252265, "time_total_s": 2154.97460770607, "info": {"num_steps_sampled": 3224456, "sample_time_ms": 15810.308, "grad_time_ms": 9301.06, "update_time_ms": 7.84, "default": {"kl": 0.016858967021107674, "entropy": 1.0804065465927124, "cur_lr": 0.0005000000237487257, "total_loss": 11.503780364990234, "policy_loss": -0.007329846266657114, "vf_explained_var": 0.9462518095970154, "vf_loss": 11.509215354919434, "cur_kl_coeff": 0.11250000447034836}, "num_steps_trained": 3224456, "load_time_ms": 13.378}, "custom_metrics": {"cost1_mean": 327.4492328518611, "outflow_rate_max": 1264.9381378169167, "system_level_velocity_mean": 13.984405553776885, "cost1_min": 35.363254982447195, "cost1_max": 485.59673613280347, "outflow_rate_min": 453.9610506066798, "cost2_mean": -0.04062481018771381, "outflow_rate_mean": 1024.7534968662612, "system_level_velocity_min": 10.095614635000498, "cost2_min": -0.5909090909090909, "system_level_velocity_max": 19.84041398040954, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 83, "done": false, "episodes_total": 1482, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233390>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062336a0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233710>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 699.2989687555013, "timesteps_this_iter": 38169, "timesteps_total": 3224456, "time_since_restore": 2154.97460770607, "hostname": "flow-main", "episode_reward_min": 56.30371686679315, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557186648, "time_this_iter_s": 25.786051273345947, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 83, "date": "2019-05-06_23-50-48", "episode_len_mean": 658.8}
{"timesteps_since_restore": 3261956, "policy_reward_mean": {}, "episode_reward_max": 896.0576476252265, "time_total_s": 2182.7081303596497, "info": {"num_steps_sampled": 3261956, "sample_time_ms": 15972.28, "grad_time_ms": 9351.803, "update_time_ms": 8.005, "default": {"kl": 0.014768283814191818, "entropy": 1.0581132173538208, "cur_lr": 0.0005000000237487257, "total_loss": 12.511214256286621, "policy_loss": -0.007597369607537985, "vf_explained_var": 0.9548833966255188, "vf_loss": 12.517149925231934, "cur_kl_coeff": 0.11250000447034836}, "num_steps_trained": 3261956, "load_time_ms": 13.388}, "custom_metrics": {"cost1_mean": 334.25336707652343, "outflow_rate_max": 1264.9381378169167, "system_level_velocity_mean": 14.072697395800132, "cost1_min": 36.63557367683813, "cost1_max": 485.59673613280347, "outflow_rate_min": 476.73416764685544, "cost2_mean": -0.07028131717418491, "outflow_rate_mean": 1038.626522233323, "system_level_velocity_min": 10.095614635000498, "cost2_min": -1.1540538858613894, "system_level_velocity_max": 19.84041398040954, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 84, "done": false, "episodes_total": 1503, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062475c0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247860>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062474e0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 710.0367613674227, "timesteps_this_iter": 37500, "timesteps_total": 3261956, "time_since_restore": 2182.7081303596497, "hostname": "flow-main", "episode_reward_min": 56.30371686679315, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557186675, "time_this_iter_s": 27.733522653579712, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 84, "date": "2019-05-06_23-51-15", "episode_len_mean": 665.29}
{"timesteps_since_restore": 3300368, "policy_reward_mean": {}, "episode_reward_max": 896.0576476252265, "time_total_s": 2207.651683807373, "info": {"num_steps_sampled": 3300368, "sample_time_ms": 16010.727, "grad_time_ms": 9266.381, "update_time_ms": 8.163, "default": {"kl": 0.017437690868973732, "entropy": 1.095757007598877, "cur_lr": 0.0005000000237487257, "total_loss": 11.925765991210938, "policy_loss": -0.006931188050657511, "vf_explained_var": 0.9429921507835388, "vf_loss": 11.93073558807373, "cur_kl_coeff": 0.11249999701976776}, "num_steps_trained": 3300368, "load_time_ms": 13.18}, "custom_metrics": {"cost1_mean": 340.43661548112095, "outflow_rate_max": 1264.9381378169167, "system_level_velocity_mean": 14.015089724082577, "cost1_min": 20.365229114169924, "cost1_max": 485.59673613280347, "outflow_rate_min": 434.8788354250726, "cost2_mean": -0.0652655150406868, "outflow_rate_mean": 1048.6739749755004, "system_level_velocity_min": 10.095614635000498, "cost2_min": -1.1540538858613894, "system_level_velocity_max": 19.75079207132921, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 85, "done": false, "episodes_total": 1521, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233978>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247eb8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247b70>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 719.7491295216345, "timesteps_this_iter": 38412, "timesteps_total": 3300368, "time_since_restore": 2207.651683807373, "hostname": "flow-main", "episode_reward_min": 40.73045822833986, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557186700, "time_this_iter_s": 24.94355344772339, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 85, "date": "2019-05-06_23-51-40", "episode_len_mean": 675.46}
{"timesteps_since_restore": 3338236, "policy_reward_mean": {}, "episode_reward_max": 893.48500283691, "time_total_s": 2232.449489593506, "info": {"num_steps_sampled": 3338236, "sample_time_ms": 15933.405, "grad_time_ms": 9190.718, "update_time_ms": 8.043, "default": {"kl": 0.014311443082988262, "entropy": 1.0661627054214478, "cur_lr": 0.0005000000237487257, "total_loss": 11.483150482177734, "policy_loss": -0.005682637915015221, "vf_explained_var": 0.9573804140090942, "vf_loss": 11.487222671508789, "cur_kl_coeff": 0.11250001192092896}, "num_steps_trained": 3338236, "load_time_ms": 12.913}, "custom_metrics": {"cost1_mean": 345.29832566197837, "outflow_rate_max": 1286.245907500285, "system_level_velocity_mean": 14.07611033966109, "cost1_min": 20.365229114169924, "cost1_max": 504.29258016386564, "outflow_rate_min": 434.8788354250726, "cost2_mean": -0.07370096235882036, "outflow_rate_mean": 1055.9431572049125, "system_level_velocity_min": 10.095614635000498, "cost2_min": -1.1540538858613894, "system_level_velocity_max": 19.75079207132921, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 86, "done": false, "episodes_total": 1539, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062357b8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235c50>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062359b0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 728.4669452125669, "timesteps_this_iter": 37868, "timesteps_total": 3338236, "time_since_restore": 2232.449489593506, "hostname": "flow-main", "episode_reward_min": 40.73045822833986, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557186725, "time_this_iter_s": 24.797805786132812, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 86, "date": "2019-05-06_23-52-05", "episode_len_mean": 680.26}
{"timesteps_since_restore": 3376421, "policy_reward_mean": {}, "episode_reward_max": 893.48500283691, "time_total_s": 2257.5919709205627, "info": {"num_steps_sampled": 3376421, "sample_time_ms": 16134.329, "grad_time_ms": 9130.489, "update_time_ms": 7.997, "default": {"kl": 0.015382363460958004, "entropy": 1.0637149810791016, "cur_lr": 0.0005000000237487257, "total_loss": 12.266627311706543, "policy_loss": -0.006015635561197996, "vf_explained_var": 0.9476338624954224, "vf_loss": 12.270912170410156, "cur_kl_coeff": 0.11250000447034836}, "num_steps_trained": 3376421, "load_time_ms": 13.123}, "custom_metrics": {"cost1_mean": 347.80718213444516, "outflow_rate_max": 1286.245907500285, "system_level_velocity_mean": 13.996923432171325, "cost1_min": 20.365229114169924, "cost1_max": 504.29258016386564, "outflow_rate_min": 434.8788354250726, "cost2_mean": -0.06467742069715418, "outflow_rate_mean": 1059.4014860142247, "system_level_velocity_min": 10.095614635000498, "cost2_min": -1.1540538858613894, "system_level_velocity_max": 19.75079207132921, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 87, "done": false, "episodes_total": 1559, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625ae80>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625acc0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a6d8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 727.8860491463593, "timesteps_this_iter": 38185, "timesteps_total": 3376421, "time_since_restore": 2257.5919709205627, "hostname": "flow-main", "episode_reward_min": 40.73045822833986, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557186750, "time_this_iter_s": 25.142481327056885, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 87, "date": "2019-05-06_23-52-30", "episode_len_mean": 686.73}
{"timesteps_since_restore": 3414412, "policy_reward_mean": {}, "episode_reward_max": 880.8638701000258, "time_total_s": 2282.4909524917603, "info": {"num_steps_sampled": 3414412, "sample_time_ms": 16182.749, "grad_time_ms": 9086.387, "update_time_ms": 7.967, "default": {"kl": 0.017629820853471756, "entropy": 1.0813488960266113, "cur_lr": 0.0005000000237487257, "total_loss": 10.529568672180176, "policy_loss": -0.007917904295027256, "vf_explained_var": 0.9548189043998718, "vf_loss": 10.535502433776855, "cur_kl_coeff": 0.11250001192092896}, "num_steps_trained": 3414412, "load_time_ms": 12.832}, "custom_metrics": {"cost1_mean": 351.7891594623416, "outflow_rate_max": 1286.245907500285, "system_level_velocity_mean": 14.151948086026966, "cost1_min": 20.365229114169924, "cost1_max": 504.29258016386564, "outflow_rate_min": 434.8788354250726, "cost2_mean": -0.0730380409935908, "outflow_rate_mean": 1067.808009309896, "system_level_velocity_min": 9.904247563517497, "cost2_min": -1.1540538858613894, "system_level_velocity_max": 19.75079207132921, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 88, "done": false, "episodes_total": 1578, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233e48>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233780>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233a20>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 733.9250592210436, "timesteps_this_iter": 37991, "timesteps_total": 3414412, "time_since_restore": 2282.4909524917603, "hostname": "flow-main", "episode_reward_min": 40.73045822833986, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557186775, "time_this_iter_s": 24.89898157119751, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 88, "date": "2019-05-06_23-52-55", "episode_len_mean": 686.73}
{"timesteps_since_restore": 3451580, "policy_reward_mean": {}, "episode_reward_max": 880.8638701000258, "time_total_s": 2307.430207967758, "info": {"num_steps_sampled": 3451580, "sample_time_ms": 16316.569, "grad_time_ms": 9030.46, "update_time_ms": 7.86, "default": {"kl": 0.01751755364239216, "entropy": 1.0849119424819946, "cur_lr": 0.0005000000237487257, "total_loss": 11.622213363647461, "policy_loss": -0.008236621506512165, "vf_explained_var": 0.9443668723106384, "vf_loss": 11.628479957580566, "cur_kl_coeff": 0.11249999701976776}, "num_steps_trained": 3451580, "load_time_ms": 12.961}, "custom_metrics": {"cost1_mean": 344.88230958271663, "outflow_rate_max": 1286.245907500285, "system_level_velocity_mean": 14.014160795632057, "cost1_min": 20.365229114169924, "cost1_max": 504.29258016386564, "outflow_rate_min": 434.8788354250726, "cost2_mean": -0.061277264903320354, "outflow_rate_mean": 1055.8853983707224, "system_level_velocity_min": 9.904247563517497, "cost2_min": -1.1540538858613894, "system_level_velocity_max": 19.75079207132921, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 89, "done": false, "episodes_total": 1596, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540623e240>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540623e9b0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540623ea20>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 725.0848671540517, "timesteps_this_iter": 37168, "timesteps_total": 3451580, "time_since_restore": 2307.430207967758, "hostname": "flow-main", "episode_reward_min": 40.73045822833986, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557186800, "time_this_iter_s": 24.939255475997925, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 89, "date": "2019-05-06_23-53-20", "episode_len_mean": 682.41}
{"timesteps_since_restore": 3489415, "policy_reward_mean": {}, "episode_reward_max": 926.2848095446969, "time_total_s": 2332.8616960048676, "info": {"num_steps_sampled": 3489415, "sample_time_ms": 16351.029, "grad_time_ms": 8981.437, "update_time_ms": 7.91, "default": {"kl": 0.016302676871418953, "entropy": 1.1026623249053955, "cur_lr": 0.0005000000237487257, "total_loss": 12.492756843566895, "policy_loss": -0.006029848475009203, "vf_explained_var": 0.9324963688850403, "vf_loss": 12.496953010559082, "cur_kl_coeff": 0.11250001192092896}, "num_steps_trained": 3489415, "load_time_ms": 12.761}, "custom_metrics": {"cost1_mean": 341.908147180253, "outflow_rate_max": 1286.245907500285, "system_level_velocity_mean": 14.064298869584022, "cost1_min": 29.09211740236172, "cost1_max": 504.29258016386564, "outflow_rate_min": 459.99583714543724, "cost2_mean": -0.04968738629790468, "outflow_rate_mean": 1051.969703961325, "system_level_velocity_min": 9.904247563517497, "cost2_min": -0.836245295594261, "system_level_velocity_max": 19.930561249558057, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 90, "done": false, "episodes_total": 1615, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062511d0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248e10>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540622e4e0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 721.2013583443369, "timesteps_this_iter": 37835, "timesteps_total": 3489415, "time_since_restore": 2332.8616960048676, "hostname": "flow-main", "episode_reward_min": 44.98965899343677, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557186826, "time_this_iter_s": 25.431488037109375, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 90, "date": "2019-05-06_23-53-46", "episode_len_mean": 676.78}
{"timesteps_since_restore": 3527107, "policy_reward_mean": {}, "episode_reward_max": 926.2848095446969, "time_total_s": 2357.764859676361, "info": {"num_steps_sampled": 3527107, "sample_time_ms": 16388.325, "grad_time_ms": 8916.019, "update_time_ms": 7.961, "default": {"kl": 0.01716224104166031, "entropy": 1.0794180631637573, "cur_lr": 0.0005000000237487257, "total_loss": 12.494619369506836, "policy_loss": -0.006673079449683428, "vf_explained_var": 0.9447445273399353, "vf_loss": 12.499361991882324, "cur_kl_coeff": 0.11250001192092896}, "num_steps_trained": 3527107, "load_time_ms": 12.848}, "custom_metrics": {"cost1_mean": 336.7924860932063, "outflow_rate_max": 1279.0351043416026, "system_level_velocity_mean": 13.873622915218357, "cost1_min": 22.137012354197037, "cost1_max": 460.5080435015597, "outflow_rate_min": 443.416194152592, "cost2_mean": -0.03981983774495839, "outflow_rate_mean": 1042.2891580229555, "system_level_velocity_min": 9.904247563517497, "cost2_min": -0.836245295594261, "system_level_velocity_max": 20.113765635074603, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 91, "done": false, "episodes_total": 1636, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625fe80>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f048>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625fd30>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 711.2510642640998, "timesteps_this_iter": 37692, "timesteps_total": 3527107, "time_since_restore": 2357.764859676361, "hostname": "flow-main", "episode_reward_min": 43.54712706669399, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557186851, "time_this_iter_s": 24.90316367149353, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 91, "date": "2019-05-06_23-54-11", "episode_len_mean": 676.67}
{"timesteps_since_restore": 3565084, "policy_reward_mean": {}, "episode_reward_max": 926.2848095446969, "time_total_s": 2383.025388240814, "info": {"num_steps_sampled": 3565084, "sample_time_ms": 16432.793, "grad_time_ms": 8850.892, "update_time_ms": 7.823, "default": {"kl": 0.023868799209594727, "entropy": 1.0412172079086304, "cur_lr": 0.0005000000237487257, "total_loss": 11.960103034973145, "policy_loss": -0.005803708452731371, "vf_explained_var": 0.9526717662811279, "vf_loss": 11.963220596313477, "cur_kl_coeff": 0.11250001192092896}, "num_steps_trained": 3565084, "load_time_ms": 12.657}, "custom_metrics": {"cost1_mean": 336.93600363270184, "outflow_rate_max": 1279.0351043416026, "system_level_velocity_mean": 13.881958708274546, "cost1_min": 22.137012354197037, "cost1_max": 488.797890232902, "outflow_rate_min": 443.416194152592, "cost2_mean": -0.04635071986494998, "outflow_rate_mean": 1040.5217665685607, "system_level_velocity_min": 9.904247563517497, "cost2_min": -0.836245295594261, "system_level_velocity_max": 20.113765635074603, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 92, "done": false, "episodes_total": 1654, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233e48>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233390>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233908>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 716.5026517560499, "timesteps_this_iter": 37977, "timesteps_total": 3565084, "time_since_restore": 2383.025388240814, "hostname": "flow-main", "episode_reward_min": 43.54712706669399, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557186876, "time_this_iter_s": 25.260528564453125, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 92, "date": "2019-05-06_23-54-36", "episode_len_mean": 676.67}
{"timesteps_since_restore": 3602595, "policy_reward_mean": {}, "episode_reward_max": 926.2848095446969, "time_total_s": 2408.0436577796936, "info": {"num_steps_sampled": 3602595, "sample_time_ms": 16399.091, "grad_time_ms": 8807.246, "update_time_ms": 7.892, "default": {"kl": 0.013246343471109867, "entropy": 1.0423767566680908, "cur_lr": 0.0005000000237487257, "total_loss": 10.664250373840332, "policy_loss": -0.006088810041546822, "vf_explained_var": 0.9612263441085815, "vf_loss": 10.66810417175293, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 3602595, "load_time_ms": 12.995}, "custom_metrics": {"cost1_mean": 334.34266498313923, "outflow_rate_max": 1323.5281800817363, "system_level_velocity_mean": 13.950729422774094, "cost1_min": 22.137012354197037, "cost1_max": 496.3187164563176, "outflow_rate_min": 424.4693436354783, "cost2_mean": -0.0639850113560934, "outflow_rate_mean": 1034.8516831082704, "system_level_velocity_min": 9.904247563517497, "cost2_min": -1.3557354491521865, "system_level_velocity_max": 20.113765635074603, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 93, "done": false, "episodes_total": 1672, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540623ebe0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540623ea20>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540623e518>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 715.2361950606669, "timesteps_this_iter": 37511, "timesteps_total": 3602595, "time_since_restore": 2408.0436577796936, "hostname": "flow-main", "episode_reward_min": 43.54712706669399, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557186901, "time_this_iter_s": 25.018269538879395, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 93, "date": "2019-05-06_23-55-01", "episode_len_mean": 670.11}
{"timesteps_since_restore": 3640567, "policy_reward_mean": {}, "episode_reward_max": 926.2848095446969, "time_total_s": 2434.883768081665, "info": {"num_steps_sampled": 3640567, "sample_time_ms": 16314.326, "grad_time_ms": 8797.752, "update_time_ms": 7.691, "default": {"kl": 0.014435246586799622, "entropy": 1.040322184562683, "cur_lr": 0.0005000000237487257, "total_loss": 17.846294403076172, "policy_loss": -0.00828526634722948, "vf_explained_var": 0.9317775368690491, "vf_loss": 17.852142333984375, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 3640567, "load_time_ms": 12.606}, "custom_metrics": {"cost1_mean": 333.39471946421645, "outflow_rate_max": 1323.5281800817363, "system_level_velocity_mean": 14.290978947693572, "cost1_min": 20.269629073341438, "cost1_max": 511.678278995284, "outflow_rate_min": 424.4693436354783, "cost2_mean": -0.08284661458859902, "outflow_rate_mean": 1033.3452191667855, "system_level_velocity_min": 10.126441682506169, "cost2_min": -1.8504322844915104, "system_level_velocity_max": 20.113765635074603, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 94, "done": false, "episodes_total": 1695, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062333c8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625fba8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625aa58>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 701.27832776748, "timesteps_this_iter": 37972, "timesteps_total": 3640567, "time_since_restore": 2434.883768081665, "hostname": "flow-main", "episode_reward_min": 34.386223646670956, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 23, "timestamp": 1557186928, "time_this_iter_s": 26.840110301971436, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 94, "date": "2019-05-06_23-55-28", "episode_len_mean": 656.36}
{"timesteps_since_restore": 3678563, "policy_reward_mean": {}, "episode_reward_max": 899.2684541482442, "time_total_s": 2460.377452135086, "info": {"num_steps_sampled": 3678563, "sample_time_ms": 16346.286, "grad_time_ms": 8820.555, "update_time_ms": 7.826, "default": {"kl": 0.01616375893354416, "entropy": 1.0668036937713623, "cur_lr": 0.0005000000237487257, "total_loss": 12.963260650634766, "policy_loss": -0.006988233886659145, "vf_explained_var": 0.9368828535079956, "vf_loss": 12.967520713806152, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 3678563, "load_time_ms": 12.246}, "custom_metrics": {"cost1_mean": 335.3341106267154, "outflow_rate_max": 1323.5281800817363, "system_level_velocity_mean": 14.175601276264926, "cost1_min": 20.269629073341438, "cost1_max": 511.678278995284, "outflow_rate_min": 424.4693436354783, "cost2_mean": -0.08388165068892965, "outflow_rate_mean": 1035.274419099452, "system_level_velocity_min": 10.126441682506169, "cost2_min": -1.8504322844915104, "system_level_velocity_max": 20.113765635074603, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 95, "done": false, "episodes_total": 1713, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f0b8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f978>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f390>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 706.725721122053, "timesteps_this_iter": 37996, "timesteps_total": 3678563, "time_since_restore": 2460.377452135086, "hostname": "flow-main", "episode_reward_min": 34.386223646670956, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557186953, "time_this_iter_s": 25.49368405342102, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 95, "date": "2019-05-06_23-55-53", "episode_len_mean": 663.29}
{"timesteps_since_restore": 3716380, "policy_reward_mean": {}, "episode_reward_max": 899.2684541482442, "time_total_s": 2485.987157344818, "info": {"num_steps_sampled": 3716380, "sample_time_ms": 16318.949, "grad_time_ms": 8927.949, "update_time_ms": 7.963, "default": {"kl": 0.01454659178853035, "entropy": 1.0781809091567993, "cur_lr": 0.0005000000237487257, "total_loss": 13.450780868530273, "policy_loss": -0.007740040775388479, "vf_explained_var": 0.9380121827125549, "vf_loss": 13.456066131591797, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 3716380, "load_time_ms": 12.159}, "custom_metrics": {"cost1_mean": 333.8235510160046, "outflow_rate_max": 1323.5281800817363, "system_level_velocity_mean": 14.26844986711022, "cost1_min": 20.269629073341438, "cost1_max": 511.678278995284, "outflow_rate_min": 424.4693436354783, "cost2_mean": -0.08362604764218204, "outflow_rate_mean": 1034.6226336725354, "system_level_velocity_min": 10.317370535147814, "cost2_min": -1.8504322844915104, "system_level_velocity_max": 19.884408239003694, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 96, "done": false, "episodes_total": 1733, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f2e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f4a8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f6d8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 706.2553578426189, "timesteps_this_iter": 37817, "timesteps_total": 3716380, "time_since_restore": 2485.987157344818, "hostname": "flow-main", "episode_reward_min": 34.386223646670956, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557186979, "time_this_iter_s": 25.609705209732056, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 96, "date": "2019-05-06_23-56-19", "episode_len_mean": 657.74}
{"timesteps_since_restore": 3753536, "policy_reward_mean": {}, "episode_reward_max": 899.2684541482442, "time_total_s": 2511.5869550704956, "info": {"num_steps_sampled": 3753536, "sample_time_ms": 16355.998, "grad_time_ms": 8935.375, "update_time_ms": 8.221, "default": {"kl": 0.014497256837785244, "entropy": 1.066170573234558, "cur_lr": 0.0005000000237487257, "total_loss": 11.473923683166504, "policy_loss": -0.008215002715587616, "vf_explained_var": 0.9497116804122925, "vf_loss": 11.479692459106445, "cur_kl_coeff": 0.16875003278255463}, "num_steps_trained": 3753536, "load_time_ms": 12.069}, "custom_metrics": {"cost1_mean": 330.65534997012503, "outflow_rate_max": 1323.5281800817363, "system_level_velocity_mean": 14.148662471312031, "cost1_min": 20.269629073341438, "cost1_max": 511.678278995284, "outflow_rate_min": 424.4693436354783, "cost2_mean": -0.08405337860699211, "outflow_rate_mean": 1029.2423364522283, "system_level_velocity_min": 10.005009615647065, "cost2_min": -1.8504322844915104, "system_level_velocity_max": 19.884408239003694, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 97, "done": false, "episodes_total": 1750, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247b00>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247358>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247198>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 701.9773965332054, "timesteps_this_iter": 37156, "timesteps_total": 3753536, "time_since_restore": 2511.5869550704956, "hostname": "flow-main", "episode_reward_min": 34.386223646670956, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 17, "timestamp": 1557187005, "time_this_iter_s": 25.59979772567749, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 97, "date": "2019-05-06_23-56-45", "episode_len_mean": 657.74}
{"timesteps_since_restore": 3790630, "policy_reward_mean": {}, "episode_reward_max": 887.9926856507001, "time_total_s": 2536.6010358333588, "info": {"num_steps_sampled": 3790630, "sample_time_ms": 16340.971, "grad_time_ms": 8960.815, "update_time_ms": 8.323, "default": {"kl": 0.014507225714623928, "entropy": 1.0537793636322021, "cur_lr": 0.0005000000237487257, "total_loss": 16.92072105407715, "policy_loss": -0.006920232903212309, "vf_explained_var": 0.9408732056617737, "vf_loss": 16.925193786621094, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 3790630, "load_time_ms": 12.211}, "custom_metrics": {"cost1_mean": 324.43542234857995, "outflow_rate_max": 1304.1679929036775, "system_level_velocity_mean": 14.380082522645223, "cost1_min": 18.232593676021445, "cost1_max": 511.678278995284, "outflow_rate_min": 409.9924104711606, "cost2_mean": -0.05465015785639269, "outflow_rate_mean": 1018.4951106830642, "system_level_velocity_min": 10.005009615647065, "cost2_min": -0.7589093118887884, "system_level_velocity_max": 19.884408239003694, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 98, "done": false, "episodes_total": 1774, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f278>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f4e0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f080>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 682.8161168632946, "timesteps_this_iter": 37094, "timesteps_total": 3790630, "time_since_restore": 2536.6010358333588, "hostname": "flow-main", "episode_reward_min": 34.386223646670956, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 24, "timestamp": 1557187030, "time_this_iter_s": 25.01408076286316, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 98, "date": "2019-05-06_23-57-10", "episode_len_mean": 640.79}
{"timesteps_since_restore": 3829023, "policy_reward_mean": {}, "episode_reward_max": 866.7721262963496, "time_total_s": 2561.611395597458, "info": {"num_steps_sampled": 3829023, "sample_time_ms": 16309.266, "grad_time_ms": 9000.131, "update_time_ms": 8.575, "default": {"kl": 0.014009606093168259, "entropy": 1.0919981002807617, "cur_lr": 0.0005000000237487257, "total_loss": 10.650296211242676, "policy_loss": -0.005981625057756901, "vf_explained_var": 0.9409475922584534, "vf_loss": 10.653913497924805, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 3829023, "load_time_ms": 12.013}, "custom_metrics": {"cost1_mean": 323.32873767271155, "outflow_rate_max": 1284.5975349791945, "system_level_velocity_mean": 14.177474676731642, "cost1_min": 18.232593676021445, "cost1_max": 501.4620676901509, "outflow_rate_min": 409.9924104711606, "cost2_mean": -0.0502247710467215, "outflow_rate_mean": 1014.3697722187806, "system_level_velocity_min": 10.005009615647065, "cost2_min": -0.7589093118887884, "system_level_velocity_max": 19.884408239003694, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 99, "done": false, "episodes_total": 1791, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a0b8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a518>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a9e8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 687.1613550523108, "timesteps_this_iter": 38393, "timesteps_total": 3829023, "time_since_restore": 2561.611395597458, "hostname": "flow-main", "episode_reward_min": 36.46518735204288, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 17, "timestamp": 1557187055, "time_this_iter_s": 25.01035976409912, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 99, "date": "2019-05-06_23-57-35", "episode_len_mean": 646.66}
{"timesteps_since_restore": 3865392, "policy_reward_mean": {}, "episode_reward_max": 895.1571701170695, "time_total_s": 2587.386170864105, "info": {"num_steps_sampled": 3865392, "sample_time_ms": 16396.365, "grad_time_ms": 8945.966, "update_time_ms": 8.532, "default": {"kl": 0.015507543459534645, "entropy": 1.0473241806030273, "cur_lr": 0.0005000000237487257, "total_loss": 16.398847579956055, "policy_loss": -0.006211487576365471, "vf_explained_var": 0.9450947642326355, "vf_loss": 16.40243911743164, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 3865392, "load_time_ms": 12.108}, "custom_metrics": {"cost1_mean": 326.2845466360217, "outflow_rate_max": 1284.662627590972, "system_level_velocity_mean": 14.337823485650057, "cost1_min": 18.232593676021445, "cost1_max": 513.8654164955351, "outflow_rate_min": 409.9924104711606, "cost2_mean": -0.043028361390547526, "outflow_rate_mean": 1017.4599488031429, "system_level_velocity_min": 10.005009615647065, "cost2_min": -0.7589093118887884, "system_level_velocity_max": 19.884408239003694, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 100, "done": false, "episodes_total": 1813, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233358>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233a90>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062335f8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 686.3044002926952, "timesteps_this_iter": 36369, "timesteps_total": 3865392, "time_since_restore": 2587.386170864105, "hostname": "flow-main", "episode_reward_min": 36.46518735204288, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 22, "timestamp": 1557187081, "time_this_iter_s": 25.77477526664734, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 100, "date": "2019-05-06_23-58-01", "episode_len_mean": 644.4}
{"timesteps_since_restore": 3903263, "policy_reward_mean": {}, "episode_reward_max": 904.0145675108615, "time_total_s": 2612.9323117733, "info": {"num_steps_sampled": 3903263, "sample_time_ms": 16395.327, "grad_time_ms": 9011.053, "update_time_ms": 8.584, "default": {"kl": 0.014992784708738327, "entropy": 1.1048952341079712, "cur_lr": 0.0005000000237487257, "total_loss": 10.01646900177002, "policy_loss": -0.006922257132828236, "vf_explained_var": 0.9507834315299988, "vf_loss": 10.02086067199707, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 3903263, "load_time_ms": 12.045}, "custom_metrics": {"cost1_mean": 331.33661713420486, "outflow_rate_max": 1284.662627590972, "system_level_velocity_mean": 14.188588746294107, "cost1_min": 18.232593676021445, "cost1_max": 513.8654164955351, "outflow_rate_min": 409.9924104711606, "cost2_mean": -0.043277351912563364, "outflow_rate_mean": 1024.4042624839194, "system_level_velocity_min": 10.005009615647065, "cost2_min": -0.7589093118887884, "system_level_velocity_max": 19.839545118001926, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 101, "done": false, "episodes_total": 1830, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247048>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247d30>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062470f0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 694.1367194082578, "timesteps_this_iter": 37871, "timesteps_total": 3903263, "time_since_restore": 2612.9323117733, "hostname": "flow-main", "episode_reward_min": 36.46518735204288, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 17, "timestamp": 1557187106, "time_this_iter_s": 25.546140909194946, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 101, "date": "2019-05-06_23-58-26", "episode_len_mean": 656.63}
{"timesteps_since_restore": 3941699, "policy_reward_mean": {}, "episode_reward_max": 904.0145675108615, "time_total_s": 2638.909623146057, "info": {"num_steps_sampled": 3941699, "sample_time_ms": 16396.206, "grad_time_ms": 9081.696, "update_time_ms": 8.571, "default": {"kl": 0.015352923423051834, "entropy": 1.0977256298065186, "cur_lr": 0.0005000000237487257, "total_loss": 11.571890830993652, "policy_loss": -0.007057743147015572, "vf_explained_var": 0.9447782635688782, "vf_loss": 11.5763578414917, "cur_kl_coeff": 0.16875003278255463}, "num_steps_trained": 3941699, "load_time_ms": 12.024}, "custom_metrics": {"cost1_mean": 328.95554678356694, "outflow_rate_max": 1284.662627590972, "system_level_velocity_mean": 14.284977919223184, "cost1_min": 18.232593676021445, "cost1_max": 513.8654164955351, "outflow_rate_min": 409.9924104711606, "cost2_mean": -0.060077156310397874, "outflow_rate_mean": 1019.9382397074188, "system_level_velocity_min": 10.295377251528295, "cost2_min": -1.2406984764852378, "system_level_velocity_max": 20.24490777427076, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 102, "done": false, "episodes_total": 1849, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a588>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a320>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a860>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 684.2839743713956, "timesteps_this_iter": 38436, "timesteps_total": 3941699, "time_since_restore": 2638.909623146057, "hostname": "flow-main", "episode_reward_min": 36.46518735204288, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557187132, "time_this_iter_s": 25.977311372756958, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 102, "date": "2019-05-06_23-58-52", "episode_len_mean": 650.04}
{"timesteps_since_restore": 3978624, "policy_reward_mean": {}, "episode_reward_max": 904.0145675108615, "time_total_s": 2664.4405920505524, "info": {"num_steps_sampled": 3978624, "sample_time_ms": 16415.259, "grad_time_ms": 9113.507, "update_time_ms": 8.379, "default": {"kl": 0.01421294640749693, "entropy": 1.1029561758041382, "cur_lr": 0.0005000000237487257, "total_loss": 11.433083534240723, "policy_loss": -0.006871458608657122, "vf_explained_var": 0.9540020823478699, "vf_loss": 11.437556266784668, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 3978624, "load_time_ms": 12.322}, "custom_metrics": {"cost1_mean": 334.6321342662131, "outflow_rate_max": 1284.662627590972, "system_level_velocity_mean": 14.034718131382663, "cost1_min": 18.867685241929006, "cost1_max": 513.8654164955351, "outflow_rate_min": 436.5771272776546, "cost2_mean": -0.05373088199290264, "outflow_rate_mean": 1030.0114551006484, "system_level_velocity_min": 10.295377251528295, "cost2_min": -1.2406984764852378, "system_level_velocity_max": 20.24490777427076, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 103, "done": false, "episodes_total": 1868, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233908>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540623ef98>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540623eeb8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 701.8884520883059, "timesteps_this_iter": 36925, "timesteps_total": 3978624, "time_since_restore": 2664.4405920505524, "hostname": "flow-main", "episode_reward_min": 37.73537048385801, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557187158, "time_this_iter_s": 25.53096890449524, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 103, "date": "2019-05-06_23-59-18", "episode_len_mean": 667.1}
{"timesteps_since_restore": 4015792, "policy_reward_mean": {}, "episode_reward_max": 904.0145675108615, "time_total_s": 2689.569157600403, "info": {"num_steps_sampled": 4015792, "sample_time_ms": 16411.641, "grad_time_ms": 8952.515, "update_time_ms": 8.333, "default": {"kl": 0.01451027300208807, "entropy": 1.0842725038528442, "cur_lr": 0.0005000000237487257, "total_loss": 13.338957786560059, "policy_loss": -0.008251205086708069, "vf_explained_var": 0.9462600350379944, "vf_loss": 13.344759941101074, "cur_kl_coeff": 0.16875003278255463}, "num_steps_trained": 4015792, "load_time_ms": 12.394}, "custom_metrics": {"cost1_mean": 336.5767607944131, "outflow_rate_max": 1284.662627590972, "system_level_velocity_mean": 14.08599154441648, "cost1_min": 18.867685241929006, "cost1_max": 513.8654164955351, "outflow_rate_min": 436.5771272776546, "cost2_mean": -0.0540182977973325, "outflow_rate_mean": 1036.3497005100373, "system_level_velocity_min": 10.295377251528295, "cost2_min": -1.2406984764852378, "system_level_velocity_max": 20.24490777427076, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 104, "done": false, "episodes_total": 1888, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f630>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f128>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625fb38>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 697.9850015924525, "timesteps_this_iter": 37168, "timesteps_total": 4015792, "time_since_restore": 2689.569157600403, "hostname": "flow-main", "episode_reward_min": 37.73537048385801, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557187183, "time_this_iter_s": 25.128565549850464, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 104, "date": "2019-05-06_23-59-43", "episode_len_mean": 667.95}
{"timesteps_since_restore": 4053537, "policy_reward_mean": {}, "episode_reward_max": 904.0145675108615, "time_total_s": 2713.10938167572, "info": {"num_steps_sampled": 4053537, "sample_time_ms": 16179.451, "grad_time_ms": 8989.747, "update_time_ms": 7.954, "default": {"kl": 0.01308770664036274, "entropy": 1.1536439657211304, "cur_lr": 0.0005000000237487257, "total_loss": 11.918627738952637, "policy_loss": -0.006674614269286394, "vf_explained_var": 0.9433404803276062, "vf_loss": 11.923093795776367, "cur_kl_coeff": 0.16875000298023224}, "num_steps_trained": 4053537, "load_time_ms": 12.876}, "custom_metrics": {"cost1_mean": 335.30128501222674, "outflow_rate_max": 1281.877549713329, "system_level_velocity_mean": 13.860347113994933, "cost1_min": 18.867685241929006, "cost1_max": 496.3625583422655, "outflow_rate_min": 430.0201970840813, "cost2_mean": -0.06432301253820226, "outflow_rate_mean": 1035.1021909566298, "system_level_velocity_min": 10.096228874531946, "cost2_min": -1.2406984764852378, "system_level_velocity_max": 20.24490777427076, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 105, "done": false, "episodes_total": 1907, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247b00>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247400>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247048>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 697.8612074467511, "timesteps_this_iter": 37745, "timesteps_total": 4053537, "time_since_restore": 2713.10938167572, "hostname": "flow-main", "episode_reward_min": 37.051327922206525, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557187206, "time_this_iter_s": 23.540224075317383, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 105, "date": "2019-05-07_00-00-06", "episode_len_mean": 674.39}
{"timesteps_since_restore": 4091573, "policy_reward_mean": {}, "episode_reward_max": 873.7880709491408, "time_total_s": 2737.917732000351, "info": {"num_steps_sampled": 4091573, "sample_time_ms": 16162.452, "grad_time_ms": 8926.221, "update_time_ms": 7.835, "default": {"kl": 0.013000553473830223, "entropy": 1.116323471069336, "cur_lr": 0.0005000000237487257, "total_loss": 11.788787841796875, "policy_loss": -0.0065543693490326405, "vf_explained_var": 0.9514514803886414, "vf_loss": 11.793148040771484, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 4091573, "load_time_ms": 12.904}, "custom_metrics": {"cost1_mean": 338.08391630683707, "outflow_rate_max": 1282.7736381305908, "system_level_velocity_mean": 13.914516668499871, "cost1_min": 20.22359142083669, "cost1_max": 474.44727906828405, "outflow_rate_min": 430.0201970840813, "cost2_mean": -0.06590977385317459, "outflow_rate_mean": 1041.6268506861707, "system_level_velocity_min": 10.096228874531946, "cost2_min": -1.2406984764852378, "system_level_velocity_max": 20.24490777427076, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 106, "done": false, "episodes_total": 1926, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a160>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a1d0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625ab38>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 700.7005599157897, "timesteps_this_iter": 38036, "timesteps_total": 4091573, "time_since_restore": 2737.917732000351, "hostname": "flow-main", "episode_reward_min": 37.051327922206525, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557187231, "time_this_iter_s": 24.808350324630737, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 106, "date": "2019-05-07_00-00-31", "episode_len_mean": 675.67}
{"timesteps_since_restore": 4128781, "policy_reward_mean": {}, "episode_reward_max": 873.7880709491408, "time_total_s": 2762.5625972747803, "info": {"num_steps_sampled": 4128781, "sample_time_ms": 16007.283, "grad_time_ms": 8986.73, "update_time_ms": 7.759, "default": {"kl": 0.015890706330537796, "entropy": 1.0969116687774658, "cur_lr": 0.0005000000237487257, "total_loss": 11.18991470336914, "policy_loss": -0.008193319663405418, "vf_explained_var": 0.9590117335319519, "vf_loss": 11.195425987243652, "cur_kl_coeff": 0.16875003278255463}, "num_steps_trained": 4128781, "load_time_ms": 12.857}, "custom_metrics": {"cost1_mean": 345.2775248795739, "outflow_rate_max": 1282.7736381305908, "system_level_velocity_mean": 13.994694666373269, "cost1_min": 20.22359142083669, "cost1_max": 502.4011742232087, "outflow_rate_min": 430.0201970840813, "cost2_mean": -0.08738903741279777, "outflow_rate_mean": 1054.3069681703914, "system_level_velocity_min": 10.096228874531946, "cost2_min": -2.3212903279248724, "system_level_velocity_max": 19.74027179504807, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 107, "done": false, "episodes_total": 1946, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406251d30>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406251518>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406251160>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 712.1740471397163, "timesteps_this_iter": 37208, "timesteps_total": 4128781, "time_since_restore": 2762.5625972747803, "hostname": "flow-main", "episode_reward_min": 37.051327922206525, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557187256, "time_this_iter_s": 24.64486527442932, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 107, "date": "2019-05-07_00-00-56", "episode_len_mean": 682.26}
{"timesteps_since_restore": 4166099, "policy_reward_mean": {}, "episode_reward_max": 926.8974077500849, "time_total_s": 2787.6423745155334, "info": {"num_steps_sampled": 4166099, "sample_time_ms": 15881.758, "grad_time_ms": 9119.373, "update_time_ms": 7.668, "default": {"kl": 0.015037208795547485, "entropy": 1.076338291168213, "cur_lr": 0.0005000000237487257, "total_loss": 17.070697784423828, "policy_loss": -0.006273563951253891, "vf_explained_var": 0.940287709236145, "vf_loss": 17.074434280395508, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 4166099, "load_time_ms": 12.817}, "custom_metrics": {"cost1_mean": 339.12379460687583, "outflow_rate_max": 1294.9236865311327, "system_level_velocity_mean": 14.281110724876607, "cost1_min": 20.22359142083669, "cost1_max": 509.23794434762453, "outflow_rate_min": 430.0201970840813, "cost2_mean": -0.08887591967425719, "outflow_rate_mean": 1042.3580680149407, "system_level_velocity_min": 10.096228874531946, "cost2_min": -2.3212903279248724, "system_level_velocity_max": 19.956184017464853, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 108, "done": false, "episodes_total": 1967, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f160>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f8d0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625ff28>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 698.9328652369068, "timesteps_this_iter": 37318, "timesteps_total": 4166099, "time_since_restore": 2787.6423745155334, "hostname": "flow-main", "episode_reward_min": 37.051327922206525, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557187281, "time_this_iter_s": 25.079777240753174, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 108, "date": "2019-05-07_00-01-21", "episode_len_mean": 663.28}
{"timesteps_since_restore": 4204225, "policy_reward_mean": {}, "episode_reward_max": 926.8974077500849, "time_total_s": 2813.3844850063324, "info": {"num_steps_sampled": 4204225, "sample_time_ms": 15928.194, "grad_time_ms": 9147.256, "update_time_ms": 7.444, "default": {"kl": 0.015397400595247746, "entropy": 1.149484634399414, "cur_lr": 0.0005000000237487257, "total_loss": 12.108718872070312, "policy_loss": -0.007653365842998028, "vf_explained_var": 0.9307833313941956, "vf_loss": 12.11377239227295, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 4204225, "load_time_ms": 13.091}, "custom_metrics": {"cost1_mean": 337.211627300581, "outflow_rate_max": 1294.9236865311327, "system_level_velocity_mean": 14.4169792774941, "cost1_min": 18.229207255605544, "cost1_max": 509.23794434762453, "outflow_rate_min": 430.0201970840813, "cost2_mean": -0.08818293907673454, "outflow_rate_mean": 1037.5969064871158, "system_level_velocity_min": 10.096228874531946, "cost2_min": -2.3212903279248724, "system_level_velocity_max": 20.077544427022247, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 109, "done": false, "episodes_total": 1985, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247828>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233d30>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062338d0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 695.3111481189259, "timesteps_this_iter": 38126, "timesteps_total": 4204225, "time_since_restore": 2813.3844850063324, "hostname": "flow-main", "episode_reward_min": 36.45841451121106, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557187307, "time_this_iter_s": 25.74211049079895, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 109, "date": "2019-05-07_00-01-47", "episode_len_mean": 655.52}
{"timesteps_since_restore": 4241425, "policy_reward_mean": {}, "episode_reward_max": 926.8974077500849, "time_total_s": 2838.201112508774, "info": {"num_steps_sampled": 4241425, "sample_time_ms": 15772.438, "grad_time_ms": 9207.761, "update_time_ms": 7.297, "default": {"kl": 0.015951702371239662, "entropy": 1.098500370979309, "cur_lr": 0.0005000000237487257, "total_loss": 11.304242134094238, "policy_loss": -0.00811560358852148, "vf_explained_var": 0.9564966559410095, "vf_loss": 11.309666633605957, "cur_kl_coeff": 0.16875003278255463}, "num_steps_trained": 4241425, "load_time_ms": 12.916}, "custom_metrics": {"cost1_mean": 333.54982897024246, "outflow_rate_max": 1294.9236865311327, "system_level_velocity_mean": 14.235648928835879, "cost1_min": 18.229207255605544, "cost1_max": 509.23794434762453, "outflow_rate_min": 434.44599691538906, "cost2_mean": -0.07918587916476319, "outflow_rate_mean": 1030.3405018262574, "system_level_velocity_min": 10.096228874531946, "cost2_min": -2.3212903279248724, "system_level_velocity_max": 20.077544427022247, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 110, "done": false, "episodes_total": 2003, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a320>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625af28>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a208>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 694.8914974128212, "timesteps_this_iter": 37200, "timesteps_total": 4241425, "time_since_restore": 2838.201112508774, "hostname": "flow-main", "episode_reward_min": 36.45841451121106, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557187332, "time_this_iter_s": 24.816627502441406, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 110, "date": "2019-05-07_00-02-12", "episode_len_mean": 657.86}
{"timesteps_since_restore": 4279404, "policy_reward_mean": {}, "episode_reward_max": 979.0400353019056, "time_total_s": 2863.586082458496, "info": {"num_steps_sampled": 4279404, "sample_time_ms": 15768.579, "grad_time_ms": 9196.915, "update_time_ms": 7.072, "default": {"kl": 0.013854075223207474, "entropy": 1.1424777507781982, "cur_lr": 0.0005000000237487257, "total_loss": 11.865246772766113, "policy_loss": -0.007669511716812849, "vf_explained_var": 0.9382219910621643, "vf_loss": 11.870577812194824, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 4279404, "load_time_ms": 12.726}, "custom_metrics": {"cost1_mean": 344.5090985702125, "outflow_rate_max": 1311.6481489429364, "system_level_velocity_mean": 14.503236492837635, "cost1_min": 18.229207255605544, "cost1_max": 509.23794434762453, "outflow_rate_min": 434.44599691538906, "cost2_mean": -0.07949627162973354, "outflow_rate_mean": 1049.3064326170474, "system_level_velocity_min": 10.968713560945115, "cost2_min": -2.3212903279248724, "system_level_velocity_max": 20.077544427022247, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 111, "done": false, "episodes_total": 2023, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540623ef98>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540623ef60>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540623e5f8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 710.3648292353562, "timesteps_this_iter": 37979, "timesteps_total": 4279404, "time_since_restore": 2863.586082458496, "hostname": "flow-main", "episode_reward_min": 36.45841451121106, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557187357, "time_this_iter_s": 25.38496994972229, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 111, "date": "2019-05-07_00-02-37", "episode_len_mean": 663.3}
{"timesteps_since_restore": 4317421, "policy_reward_mean": {}, "episode_reward_max": 979.0400353019056, "time_total_s": 2888.9739515781403, "info": {"num_steps_sampled": 4317421, "sample_time_ms": 15739.088, "grad_time_ms": 9169.394, "update_time_ms": 7.047, "default": {"kl": 0.017001420259475708, "entropy": 1.1422264575958252, "cur_lr": 0.0005000000237487257, "total_loss": 12.689029693603516, "policy_loss": -0.006369350012391806, "vf_explained_var": 0.9403799772262573, "vf_loss": 12.692530632019043, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 4317421, "load_time_ms": 12.807}, "custom_metrics": {"cost1_mean": 335.2110253808425, "outflow_rate_max": 1311.6481489429364, "system_level_velocity_mean": 14.309165135336773, "cost1_min": 18.229207255605544, "cost1_max": 509.23794434762453, "outflow_rate_min": 434.44599691538906, "cost2_mean": -0.07700434133508832, "outflow_rate_mean": 1032.2131237178985, "system_level_velocity_min": 10.954656088194398, "cost2_min": -2.3212903279248724, "system_level_velocity_max": 20.077544427022247, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 112, "done": false, "episodes_total": 2041, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247358>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406251a90>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062472e8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 697.331854328122, "timesteps_this_iter": 38017, "timesteps_total": 4317421, "time_since_restore": 2888.9739515781403, "hostname": "flow-main", "episode_reward_min": 36.45841451121106, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557187382, "time_this_iter_s": 25.387869119644165, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 112, "date": "2019-05-07_00-03-02", "episode_len_mean": 657.67}
{"timesteps_since_restore": 4355008, "policy_reward_mean": {}, "episode_reward_max": 979.0400353019056, "time_total_s": 2913.6768007278442, "info": {"num_steps_sampled": 4355008, "sample_time_ms": 15659.342, "grad_time_ms": 9167.471, "update_time_ms": 7.032, "default": {"kl": 0.015047460794448853, "entropy": 1.119862675666809, "cur_lr": 0.0005000000237487257, "total_loss": 10.894461631774902, "policy_loss": -0.006424315273761749, "vf_explained_var": 0.9553664326667786, "vf_loss": 10.898347854614258, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 4355008, "load_time_ms": 12.606}, "custom_metrics": {"cost1_mean": 345.49758889155294, "outflow_rate_max": 1311.6481489429364, "system_level_velocity_mean": 14.174868536444752, "cost1_min": 18.229207255605544, "cost1_max": 509.23794434762453, "outflow_rate_min": 434.44599691538906, "cost2_mean": -0.04080188226161023, "outflow_rate_mean": 1051.485787521199, "system_level_velocity_min": 10.954656088194398, "cost2_min": -0.8318820301376462, "system_level_velocity_max": 20.077544427022247, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 113, "done": false, "episodes_total": 2059, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540622ea90>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540622e9e8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540622e9b0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 714.6064790469331, "timesteps_this_iter": 37587, "timesteps_total": 4355008, "time_since_restore": 2913.6768007278442, "hostname": "flow-main", "episode_reward_min": 36.45841451121106, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557187407, "time_this_iter_s": 24.70284914970398, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 113, "date": "2019-05-07_00-03-27", "episode_len_mean": 676.65}
{"timesteps_since_restore": 4392334, "policy_reward_mean": {}, "episode_reward_max": 979.0400353019056, "time_total_s": 2939.4844946861267, "info": {"num_steps_sampled": 4392334, "sample_time_ms": 15666.538, "grad_time_ms": 9227.739, "update_time_ms": 7.007, "default": {"kl": 0.015048549510538578, "entropy": 1.1381133794784546, "cur_lr": 0.0005000000237487257, "total_loss": 16.511825561523438, "policy_loss": -0.0070058079436421394, "vf_explained_var": 0.9354106187820435, "vf_loss": 16.516292572021484, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 4392334, "load_time_ms": 12.816}, "custom_metrics": {"cost1_mean": 333.2728072376059, "outflow_rate_max": 1311.6481489429364, "system_level_velocity_mean": 14.052722985723511, "cost1_min": 28.40310835837584, "cost1_max": 493.76945872722894, "outflow_rate_min": 419.68722186845395, "cost2_mean": -0.046624686741335325, "outflow_rate_mean": 1028.258978829582, "system_level_velocity_min": 10.255663964433662, "cost2_min": -1.0959033002679501, "system_level_velocity_max": 20.190029744302095, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 114, "done": false, "episodes_total": 2084, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a3c8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a7f0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625abe0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 697.2703853956577, "timesteps_this_iter": 37326, "timesteps_total": 4392334, "time_since_restore": 2939.4844946861267, "hostname": "flow-main", "episode_reward_min": 45.56391721093094, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 25, "timestamp": 1557187433, "time_this_iter_s": 25.80769395828247, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 114, "date": "2019-05-07_00-03-53", "episode_len_mean": 663.96}
{"timesteps_since_restore": 4429972, "policy_reward_mean": {}, "episode_reward_max": 979.0400353019056, "time_total_s": 2964.3980474472046, "info": {"num_steps_sampled": 4429972, "sample_time_ms": 15786.411, "grad_time_ms": 9245.477, "update_time_ms": 7.066, "default": {"kl": 0.014475634321570396, "entropy": 1.1565090417861938, "cur_lr": 0.0005000000237487257, "total_loss": 15.708818435668945, "policy_loss": -0.007817176170647144, "vf_explained_var": 0.9266747832298279, "vf_loss": 15.714192390441895, "cur_kl_coeff": 0.16875000298023224}, "num_steps_trained": 4429972, "load_time_ms": 12.726}, "custom_metrics": {"cost1_mean": 332.4380727639223, "outflow_rate_max": 1311.6481489429364, "system_level_velocity_mean": 14.32691648092441, "cost1_min": 18.944422666179456, "cost1_max": 493.76945872722894, "outflow_rate_min": 419.68722186845395, "cost2_mean": -0.04492050048679079, "outflow_rate_mean": 1028.6166629308887, "system_level_velocity_min": 10.255663964433662, "cost2_min": -1.0959033002679501, "system_level_velocity_max": 20.190029744302095, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 115, "done": false, "episodes_total": 2106, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625ac50>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266b70>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a240>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 691.1614511421856, "timesteps_this_iter": 37638, "timesteps_total": 4429972, "time_since_restore": 2964.3980474472046, "hostname": "flow-main", "episode_reward_min": 37.88884533235892, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 22, "timestamp": 1557187458, "time_this_iter_s": 24.91355276107788, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 115, "date": "2019-05-07_00-04-18", "episode_len_mean": 652.65}
{"timesteps_since_restore": 4466723, "policy_reward_mean": {}, "episode_reward_max": 909.9070890757597, "time_total_s": 2989.0238139629364, "info": {"num_steps_sampled": 4466723, "sample_time_ms": 15729.592, "grad_time_ms": 9282.314, "update_time_ms": 7.044, "default": {"kl": 0.01483799610286951, "entropy": 1.158678412437439, "cur_lr": 0.0005000000237487257, "total_loss": 10.655070304870605, "policy_loss": -0.007774339523166418, "vf_explained_var": 0.9514972567558289, "vf_loss": 10.660340309143066, "cur_kl_coeff": 0.16875000298023224}, "num_steps_trained": 4466723, "load_time_ms": 12.936}, "custom_metrics": {"cost1_mean": 327.6474527154551, "outflow_rate_max": 1305.4619789988176, "system_level_velocity_mean": 14.144014872917298, "cost1_min": 18.944422666179456, "cost1_max": 493.76945872722894, "outflow_rate_min": 419.68722186845395, "cost2_mean": -0.04904953728609992, "outflow_rate_mean": 1019.4604363673274, "system_level_velocity_min": 10.255663964433662, "cost2_min": -1.1416811479678528, "system_level_velocity_max": 20.190029744302095, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 116, "done": false, "episodes_total": 2123, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062664a8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266898>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062664e0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 683.5548596781741, "timesteps_this_iter": 36751, "timesteps_total": 4466723, "time_since_restore": 2989.0238139629364, "hostname": "flow-main", "episode_reward_min": 37.88884533235892, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 17, "timestamp": 1557187483, "time_this_iter_s": 24.62576651573181, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 116, "date": "2019-05-07_00-04-43", "episode_len_mean": 652.65}
{"timesteps_since_restore": 4504501, "policy_reward_mean": {}, "episode_reward_max": 909.9070890757597, "time_total_s": 3014.0398960113525, "info": {"num_steps_sampled": 4504501, "sample_time_ms": 15731.521, "grad_time_ms": 9316.409, "update_time_ms": 7.144, "default": {"kl": 0.014629027806222439, "entropy": 1.1900060176849365, "cur_lr": 0.0005000000237487257, "total_loss": 11.51892375946045, "policy_loss": -0.007978975772857666, "vf_explained_var": 0.9355432391166687, "vf_loss": 11.524435043334961, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 4504501, "load_time_ms": 12.994}, "custom_metrics": {"cost1_mean": 331.18767223958014, "outflow_rate_max": 1305.4619789988176, "system_level_velocity_mean": 14.3001875105348, "cost1_min": 18.944422666179456, "cost1_max": 493.76945872722894, "outflow_rate_min": 419.68722186845395, "cost2_mean": -0.05530156543687677, "outflow_rate_mean": 1027.2980858665956, "system_level_velocity_min": 10.255663964433662, "cost2_min": -1.1416811479678528, "system_level_velocity_max": 20.190029744302095, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 117, "done": false, "episodes_total": 2141, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540622eba8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062510b8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540622e7b8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 686.4118249734186, "timesteps_this_iter": 37778, "timesteps_total": 4504501, "time_since_restore": 3014.0398960113525, "hostname": "flow-main", "episode_reward_min": 37.88884533235892, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557187508, "time_this_iter_s": 25.016082048416138, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 117, "date": "2019-05-07_00-05-08", "episode_len_mean": 651.76}
{"timesteps_since_restore": 4542116, "policy_reward_mean": {}, "episode_reward_max": 939.4407637131288, "time_total_s": 3039.5583250522614, "info": {"num_steps_sampled": 4542116, "sample_time_ms": 15842.408, "grad_time_ms": 9248.402, "update_time_ms": 7.226, "default": {"kl": 0.016635699197649956, "entropy": 1.11593759059906, "cur_lr": 0.0005000000237487257, "total_loss": 14.247368812561035, "policy_loss": -0.007036534603685141, "vf_explained_var": 0.9461437463760376, "vf_loss": 14.25160026550293, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 4542116, "load_time_ms": 13.11}, "custom_metrics": {"cost1_mean": 327.66801723808726, "outflow_rate_max": 1310.0318531945757, "system_level_velocity_mean": 14.377688638808237, "cost1_min": 18.944422666179456, "cost1_max": 492.7889872816501, "outflow_rate_min": 436.5771272776546, "cost2_mean": -0.0667210469607194, "outflow_rate_mean": 1020.1941950500051, "system_level_velocity_min": 10.185552819315555, "cost2_min": -1.1416811479678528, "system_level_velocity_max": 20.190029744302095, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 118, "done": false, "episodes_total": 2162, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a978>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a0b8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625ad30>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 675.3172977418293, "timesteps_this_iter": 37615, "timesteps_total": 4542116, "time_since_restore": 3039.5583250522614, "hostname": "flow-main", "episode_reward_min": 37.88884533235892, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557187533, "time_this_iter_s": 25.518429040908813, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 118, "date": "2019-05-07_00-05-33", "episode_len_mean": 644.87}
{"timesteps_since_restore": 4579446, "policy_reward_mean": {}, "episode_reward_max": 939.4407637131288, "time_total_s": 3064.67377948761, "info": {"num_steps_sampled": 4579446, "sample_time_ms": 15809.456, "grad_time_ms": 9218.407, "update_time_ms": 7.425, "default": {"kl": 0.017946293577551842, "entropy": 1.1693817377090454, "cur_lr": 0.0005000000237487257, "total_loss": 11.952068328857422, "policy_loss": -0.00832830648869276, "vf_explained_var": 0.9472119212150574, "vf_loss": 11.957368850708008, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 4579446, "load_time_ms": 12.875}, "custom_metrics": {"cost1_mean": 332.073737347286, "outflow_rate_max": 1310.0318531945757, "system_level_velocity_mean": 14.19644490066316, "cost1_min": 18.944422666179456, "cost1_max": 492.7889872816501, "outflow_rate_min": 436.5771272776546, "cost2_mean": -0.055837038524601104, "outflow_rate_mean": 1028.034559623113, "system_level_velocity_min": 9.85551568429145, "cost2_min": -1.1416811479678528, "system_level_velocity_max": 20.02945103937107, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 119, "done": false, "episodes_total": 2180, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062665f8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266908>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062660f0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 686.515513715463, "timesteps_this_iter": 37330, "timesteps_total": 4579446, "time_since_restore": 3064.67377948761, "hostname": "flow-main", "episode_reward_min": 37.88884533235892, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557187558, "time_this_iter_s": 25.11545443534851, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 119, "date": "2019-05-07_00-05-58", "episode_len_mean": 657.99}
{"timesteps_since_restore": 4616473, "policy_reward_mean": {}, "episode_reward_max": 939.4407637131288, "time_total_s": 3090.1001648902893, "info": {"num_steps_sampled": 4616473, "sample_time_ms": 15844.046, "grad_time_ms": 9244.68, "update_time_ms": 7.621, "default": {"kl": 0.01604665443301201, "entropy": 1.154364824295044, "cur_lr": 0.0005000000237487257, "total_loss": 11.051058769226074, "policy_loss": -0.00924678798764944, "vf_explained_var": 0.948103666305542, "vf_loss": 11.057598114013672, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 4616473, "load_time_ms": 13.003}, "custom_metrics": {"cost1_mean": 341.724373216141, "outflow_rate_max": 1310.0318531945757, "system_level_velocity_mean": 14.016763554069117, "cost1_min": 22.136965388745633, "cost1_max": 492.7889872816501, "outflow_rate_min": 443.416194152592, "cost2_mean": -0.05858665244318716, "outflow_rate_mean": 1046.0600997180904, "system_level_velocity_min": 9.85551568429145, "cost2_min": -1.1416811479678528, "system_level_velocity_max": 19.99363363739475, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 120, "done": false, "episodes_total": 2197, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266c88>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062665c0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266668>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 705.0727778701653, "timesteps_this_iter": 37027, "timesteps_total": 4616473, "time_since_restore": 3090.1001648902893, "hostname": "flow-main", "episode_reward_min": 43.54790652925855, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 17, "timestamp": 1557187584, "time_this_iter_s": 25.426385402679443, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 120, "date": "2019-05-07_00-06-24", "episode_len_mean": 677.72}
{"timesteps_since_restore": 4655011, "policy_reward_mean": {}, "episode_reward_max": 939.4407637131288, "time_total_s": 3116.709187746048, "info": {"num_steps_sampled": 4655011, "sample_time_ms": 15879.819, "grad_time_ms": 9329.661, "update_time_ms": 7.923, "default": {"kl": 0.016404952853918076, "entropy": 1.2087055444717407, "cur_lr": 0.0005000000237487257, "total_loss": 10.589954376220703, "policy_loss": -0.008533918298780918, "vf_explained_var": 0.9345663785934448, "vf_loss": 10.595720291137695, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 4655011, "load_time_ms": 13.066}, "custom_metrics": {"cost1_mean": 340.6581031338368, "outflow_rate_max": 1310.0318531945757, "system_level_velocity_mean": 13.911664205941104, "cost1_min": 22.136965388745633, "cost1_max": 492.7889872816501, "outflow_rate_min": 443.416194152592, "cost2_mean": -0.047785933570259544, "outflow_rate_mean": 1044.9426629156455, "system_level_velocity_min": 9.85551568429145, "cost2_min": -1.044375103086531, "system_level_velocity_max": 19.99363363739475, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 121, "done": false, "episodes_total": 2215, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540623ed68>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a7f0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540623ecc0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 704.5397294692391, "timesteps_this_iter": 38538, "timesteps_total": 4655011, "time_since_restore": 3116.709187746048, "hostname": "flow-main", "episode_reward_min": 43.54790652925855, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557187610, "time_this_iter_s": 26.609022855758667, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 121, "date": "2019-05-07_00-06-50", "episode_len_mean": 680.22}
{"timesteps_since_restore": 4692140, "policy_reward_mean": {}, "episode_reward_max": 939.4407637131288, "time_total_s": 3141.4834394454956, "info": {"num_steps_sampled": 4692140, "sample_time_ms": 15863.464, "grad_time_ms": 9284.717, "update_time_ms": 7.935, "default": {"kl": 0.015693189576268196, "entropy": 1.1960654258728027, "cur_lr": 0.0005000000237487257, "total_loss": 15.715191841125488, "policy_loss": -0.00794740580022335, "vf_explained_var": 0.938788890838623, "vf_loss": 15.720492362976074, "cur_kl_coeff": 0.16875003278255463}, "num_steps_trained": 4692140, "load_time_ms": 12.742}, "custom_metrics": {"cost1_mean": 338.8034530150193, "outflow_rate_max": 1310.0318531945757, "system_level_velocity_mean": 13.961992904493789, "cost1_min": 22.136965388745633, "cost1_max": 492.7889872816501, "outflow_rate_min": 443.416194152592, "cost2_mean": -0.04118856394825629, "outflow_rate_mean": 1041.6410142306484, "system_level_velocity_min": 9.85551568429145, "cost2_min": -0.5451713273311611, "system_level_velocity_max": 19.99363363739475, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 122, "done": false, "episodes_total": 2236, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a860>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625ab38>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625aef0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 707.8105472385225, "timesteps_this_iter": 37129, "timesteps_total": 4692140, "time_since_restore": 3141.4834394454956, "hostname": "flow-main", "episode_reward_min": 43.54790652925855, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557187635, "time_this_iter_s": 24.774251699447632, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 122, "date": "2019-05-07_00-07-15", "episode_len_mean": 675.79}
{"timesteps_since_restore": 4729273, "policy_reward_mean": {}, "episode_reward_max": 923.0215718248166, "time_total_s": 3167.2087297439575, "info": {"num_steps_sampled": 4729273, "sample_time_ms": 15984.159, "grad_time_ms": 9265.074, "update_time_ms": 8.054, "default": {"kl": 0.016094012185931206, "entropy": 1.1861244440078735, "cur_lr": 0.0005000000237487257, "total_loss": 14.88337516784668, "policy_loss": -0.008227384649217129, "vf_explained_var": 0.9432503581047058, "vf_loss": 14.888887405395508, "cur_kl_coeff": 0.16875003278255463}, "num_steps_trained": 4729273, "load_time_ms": 12.375}, "custom_metrics": {"cost1_mean": 337.84976697934707, "outflow_rate_max": 1303.422079224376, "system_level_velocity_mean": 13.939597337321867, "cost1_min": 22.064230564858295, "cost1_max": 514.8713904526385, "outflow_rate_min": 444.6376780571877, "cost2_mean": -0.037508065756847786, "outflow_rate_mean": 1036.7604358065535, "system_level_velocity_min": 9.85551568429145, "cost2_min": -0.5451713273311611, "system_level_velocity_max": 19.97651998443781, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 123, "done": false, "episodes_total": 2257, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062666d8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266198>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266da0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 702.2699937436419, "timesteps_this_iter": 37133, "timesteps_total": 4729273, "time_since_restore": 3167.2087297439575, "hostname": "flow-main", "episode_reward_min": 42.694919979601615, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557187661, "time_this_iter_s": 25.725290298461914, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 123, "date": "2019-05-07_00-07-41", "episode_len_mean": 675.79}
{"timesteps_since_restore": 4766637, "policy_reward_mean": {}, "episode_reward_max": 923.0215718248166, "time_total_s": 3193.663432121277, "info": {"num_steps_sampled": 4766637, "sample_time_ms": 16096.427, "grad_time_ms": 9217.644, "update_time_ms": 8.182, "default": {"kl": 0.016062431037425995, "entropy": 1.2161093950271606, "cur_lr": 0.0005000000237487257, "total_loss": 11.16606616973877, "policy_loss": -0.008601423352956772, "vf_explained_var": 0.9557998776435852, "vf_loss": 11.171957015991211, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 4766637, "load_time_ms": 12.265}, "custom_metrics": {"cost1_mean": 349.8549398051241, "outflow_rate_max": 1315.2682674322627, "system_level_velocity_mean": 14.193659622240588, "cost1_min": 22.064230564858295, "cost1_max": 514.8713904526385, "outflow_rate_min": 444.6376780571877, "cost2_mean": -0.03501954030839768, "outflow_rate_mean": 1060.075094506453, "system_level_velocity_min": 10.668820268789316, "cost2_min": -0.5451713273311611, "system_level_velocity_max": 19.97651998443781, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 124, "done": false, "episodes_total": 2275, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062667f0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062669e8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266c18>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 713.1222195515987, "timesteps_this_iter": 37364, "timesteps_total": 4766637, "time_since_restore": 3193.663432121277, "hostname": "flow-main", "episode_reward_min": 42.694919979601615, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557187688, "time_this_iter_s": 26.454702377319336, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 124, "date": "2019-05-07_00-08-08", "episode_len_mean": 682.37}
{"timesteps_since_restore": 4804459, "policy_reward_mean": {}, "episode_reward_max": 923.0215718248166, "time_total_s": 3219.5152475833893, "info": {"num_steps_sampled": 4804459, "sample_time_ms": 16258.822, "grad_time_ms": 9148.007, "update_time_ms": 8.132, "default": {"kl": 0.015394894406199455, "entropy": 1.1983168125152588, "cur_lr": 0.0005000000237487257, "total_loss": 13.650437355041504, "policy_loss": -0.007771199569106102, "vf_explained_var": 0.9373152256011963, "vf_loss": 13.655610084533691, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 4804459, "load_time_ms": 12.349}, "custom_metrics": {"cost1_mean": 341.9893933475196, "outflow_rate_max": 1315.2682674322627, "system_level_velocity_mean": 14.26069337154747, "cost1_min": 19.46348178652567, "cost1_max": 514.8713904526385, "outflow_rate_min": 438.2966037840952, "cost2_mean": -0.026045836633555575, "outflow_rate_mean": 1042.5874933609439, "system_level_velocity_min": 10.668820268789316, "cost2_min": -0.3850007799083969, "system_level_velocity_max": 19.97651998443781, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 125, "done": false, "episodes_total": 2296, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625fdd8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f320>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625fc18>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 704.3020368595877, "timesteps_this_iter": 37822, "timesteps_total": 4804459, "time_since_restore": 3219.5152475833893, "hostname": "flow-main", "episode_reward_min": 38.92696357305134, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557187713, "time_this_iter_s": 25.851815462112427, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 125, "date": "2019-05-07_00-08-33", "episode_len_mean": 669.09}
{"timesteps_since_restore": 4842142, "policy_reward_mean": {}, "episode_reward_max": 923.0215718248166, "time_total_s": 3244.8457565307617, "info": {"num_steps_sampled": 4842142, "sample_time_ms": 16384.415, "grad_time_ms": 9094.3, "update_time_ms": 8.179, "default": {"kl": 0.016550743952393532, "entropy": 1.2138246297836304, "cur_lr": 0.0005000000237487257, "total_loss": 11.824357986450195, "policy_loss": -0.007553300820291042, "vf_explained_var": 0.9521121978759766, "vf_loss": 11.829117774963379, "cur_kl_coeff": 0.16875000298023224}, "num_steps_trained": 4842142, "load_time_ms": 12.527}, "custom_metrics": {"cost1_mean": 340.09200724409675, "outflow_rate_max": 1315.2682674322627, "system_level_velocity_mean": 14.379417380785632, "cost1_min": 19.46348178652567, "cost1_max": 514.8713904526385, "outflow_rate_min": 438.2966037840952, "cost2_mean": -0.029502795774744333, "outflow_rate_mean": 1038.401882288466, "system_level_velocity_min": 10.668820268789316, "cost2_min": -0.3850007799083969, "system_level_velocity_max": 19.97651998443781, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 126, "done": false, "episodes_total": 2313, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266e48>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062667b8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062662b0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 698.4699309557534, "timesteps_this_iter": 37683, "timesteps_total": 4842142, "time_since_restore": 3244.8457565307617, "hostname": "flow-main", "episode_reward_min": 38.92696357305134, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 17, "timestamp": 1557187739, "time_this_iter_s": 25.330508947372437, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 126, "date": "2019-05-07_00-08-59", "episode_len_mean": 662.72}
{"timesteps_since_restore": 4879859, "policy_reward_mean": {}, "episode_reward_max": 909.7421293392937, "time_total_s": 3271.6699769496918, "info": {"num_steps_sampled": 4879859, "sample_time_ms": 16630.7, "grad_time_ms": 9029.82, "update_time_ms": 7.981, "default": {"kl": 0.01610630750656128, "entropy": 1.2034380435943604, "cur_lr": 0.0005000000237487257, "total_loss": 12.138896942138672, "policy_loss": -0.00887769740074873, "vf_explained_var": 0.9490885734558105, "vf_loss": 12.14505672454834, "cur_kl_coeff": 0.16875000298023224}, "num_steps_trained": 4879859, "load_time_ms": 12.061}, "custom_metrics": {"cost1_mean": 344.9222702959955, "outflow_rate_max": 1315.2682674322627, "system_level_velocity_mean": 14.441746146889468, "cost1_min": 19.46348178652567, "cost1_max": 514.8713904526385, "outflow_rate_min": 438.2966037840952, "cost2_mean": -0.028441472547505155, "outflow_rate_mean": 1047.7216253738134, "system_level_velocity_min": 10.668820268789316, "cost2_min": -0.3850007799083969, "system_level_velocity_max": 19.97651998443781, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 127, "done": false, "episodes_total": 2334, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247ac8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247a90>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062476a0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 699.8217334068316, "timesteps_this_iter": 37717, "timesteps_total": 4879859, "time_since_restore": 3271.6699769496918, "hostname": "flow-main", "episode_reward_min": 38.92696357305134, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557187766, "time_this_iter_s": 26.824220418930054, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 127, "date": "2019-05-07_00-09-26", "episode_len_mean": 667.02}
{"timesteps_since_restore": 4916953, "policy_reward_mean": {}, "episode_reward_max": 901.788003914511, "time_total_s": 3296.810112476349, "info": {"num_steps_sampled": 4916953, "sample_time_ms": 16673.717, "grad_time_ms": 8948.789, "update_time_ms": 8.024, "default": {"kl": 0.018493156880140305, "entropy": 1.1744787693023682, "cur_lr": 0.0005000000237487257, "total_loss": 11.940218925476074, "policy_loss": -0.009346265345811844, "vf_explained_var": 0.9489923715591431, "vf_loss": 11.946444511413574, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 4916953, "load_time_ms": 12.068}, "custom_metrics": {"cost1_mean": 346.0658075234787, "outflow_rate_max": 1315.2682674322627, "system_level_velocity_mean": 14.304906644930918, "cost1_min": 19.46348178652567, "cost1_max": 486.4816393151444, "outflow_rate_min": 438.2966037840952, "cost2_mean": -0.030483372141419454, "outflow_rate_mean": 1053.2767264342574, "system_level_velocity_min": 10.668820268789316, "cost2_min": -0.36363636363636365, "system_level_velocity_max": 19.745078972899783, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 128, "done": false, "episodes_total": 2352, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f4a8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f5c0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f198>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 709.7888093435045, "timesteps_this_iter": 37094, "timesteps_total": 4916953, "time_since_restore": 3296.810112476349, "hostname": "flow-main", "episode_reward_min": 38.92696357305134, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557187791, "time_this_iter_s": 25.140135526657104, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 128, "date": "2019-05-07_00-09-51", "episode_len_mean": 673.7}
{"timesteps_since_restore": 4954842, "policy_reward_mean": {}, "episode_reward_max": 888.5223224535258, "time_total_s": 3323.2500030994415, "info": {"num_steps_sampled": 4954842, "sample_time_ms": 16826.4, "grad_time_ms": 8927.978, "update_time_ms": 7.951, "default": {"kl": 0.015242613852024078, "entropy": 1.2256187200546265, "cur_lr": 0.0005000000237487257, "total_loss": 14.846026420593262, "policy_loss": -0.008460343815386295, "vf_explained_var": 0.9447466731071472, "vf_loss": 14.85191535949707, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 4954842, "load_time_ms": 12.062}, "custom_metrics": {"cost1_mean": 335.0757307588416, "outflow_rate_max": 1291.437764279919, "system_level_velocity_mean": 14.403763899705854, "cost1_min": 18.28063285404038, "cost1_max": 517.2520080513673, "outflow_rate_min": 434.5186162964645, "cost2_mean": -0.02336068903543533, "outflow_rate_mean": 1031.3875993247575, "system_level_velocity_min": 10.214065464925616, "cost2_min": -0.36363636363636365, "system_level_velocity_max": 20.19320714794986, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 129, "done": false, "episodes_total": 2373, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233550>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233780>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233588>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 687.5397770546354, "timesteps_this_iter": 37889, "timesteps_total": 4954842, "time_since_restore": 3323.2500030994415, "hostname": "flow-main", "episode_reward_min": 36.561265708080754, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557187817, "time_this_iter_s": 26.43989062309265, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 129, "date": "2019-05-07_00-10-17", "episode_len_mean": 654.85}
{"timesteps_since_restore": 4992735, "policy_reward_mean": {}, "episode_reward_max": 890.2013011546861, "time_total_s": 3350.643602371216, "info": {"num_steps_sampled": 4992735, "sample_time_ms": 17004.118, "grad_time_ms": 8947.37, "update_time_ms": 8.084, "default": {"kl": 0.015222860500216484, "entropy": 1.2273808717727661, "cur_lr": 0.0005000000237487257, "total_loss": 12.26378345489502, "policy_loss": -0.008213642053306103, "vf_explained_var": 0.9475522637367249, "vf_loss": 12.269427299499512, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 4992735, "load_time_ms": 11.54}, "custom_metrics": {"cost1_mean": 340.66076206976885, "outflow_rate_max": 1313.9406900070321, "system_level_velocity_mean": 14.43612111465476, "cost1_min": 18.28063285404038, "cost1_max": 517.2520080513673, "outflow_rate_min": 434.5186162964645, "cost2_mean": -0.03692744624215642, "outflow_rate_mean": 1042.1212091175523, "system_level_velocity_min": 10.214065464925616, "cost2_min": -0.5550603118262092, "system_level_velocity_max": 20.19320714794986, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 130, "done": false, "episodes_total": 2392, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266780>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266a20>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266518>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 692.5431456354071, "timesteps_this_iter": 37893, "timesteps_total": 4992735, "time_since_restore": 3350.643602371216, "hostname": "flow-main", "episode_reward_min": 36.561265708080754, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557187845, "time_this_iter_s": 27.393599271774292, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 130, "date": "2019-05-07_00-10-45", "episode_len_mean": 661.42}
{"timesteps_since_restore": 5028790, "policy_reward_mean": {}, "episode_reward_max": 918.8585903073654, "time_total_s": 3375.517724752426, "info": {"num_steps_sampled": 5028790, "sample_time_ms": 16970.297, "grad_time_ms": 8807.634, "update_time_ms": 8.081, "default": {"kl": 0.015882916748523712, "entropy": 1.192574381828308, "cur_lr": 0.0005000000237487257, "total_loss": 11.434836387634277, "policy_loss": -0.0070968009531497955, "vf_explained_var": 0.964695394039154, "vf_loss": 11.439252853393555, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 5028790, "load_time_ms": 11.53}, "custom_metrics": {"cost1_mean": 347.2708187417757, "outflow_rate_max": 1313.9406900070321, "system_level_velocity_mean": 14.327641332394577, "cost1_min": 18.28063285404038, "cost1_max": 517.2520080513673, "outflow_rate_min": 434.5186162964645, "cost2_mean": -0.034115194514506134, "outflow_rate_mean": 1054.3165741499415, "system_level_velocity_min": 10.214065464925616, "cost2_min": -0.5550603118262092, "system_level_velocity_max": 20.19320714794986, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 131, "done": false, "episodes_total": 2412, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233e48>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233cf8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233518>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 703.94258084612, "timesteps_this_iter": 36055, "timesteps_total": 5028790, "time_since_restore": 3375.517724752426, "hostname": "flow-main", "episode_reward_min": 36.561265708080754, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557187870, "time_this_iter_s": 24.874122381210327, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 131, "date": "2019-05-07_00-11-10", "episode_len_mean": 674.5}
{"timesteps_since_restore": 5066042, "policy_reward_mean": {}, "episode_reward_max": 918.8585903073654, "time_total_s": 3402.0575034618378, "info": {"num_steps_sampled": 5066042, "sample_time_ms": 17148.031, "grad_time_ms": 8806.14, "update_time_ms": 8.195, "default": {"kl": 0.018120145425200462, "entropy": 1.1976004838943481, "cur_lr": 0.0005000000237487257, "total_loss": 18.16291618347168, "policy_loss": -0.009315794333815575, "vf_explained_var": 0.9333798289299011, "vf_loss": 18.169174194335938, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 5066042, "load_time_ms": 11.502}, "custom_metrics": {"cost1_mean": 346.0564568623327, "outflow_rate_max": 1313.9406900070321, "system_level_velocity_mean": 14.622468534092377, "cost1_min": 18.28063285404038, "cost1_max": 517.2520080513673, "outflow_rate_min": 434.5186162964645, "cost2_mean": -0.03808037487228881, "outflow_rate_mean": 1054.031228480403, "system_level_velocity_min": 10.214065464925616, "cost2_min": -0.5550603118262092, "system_level_velocity_max": 20.19320714794986, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 132, "done": false, "episodes_total": 2434, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f2e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f5c0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625feb8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 701.5612344686307, "timesteps_this_iter": 37252, "timesteps_total": 5066042, "time_since_restore": 3402.0575034618378, "hostname": "flow-main", "episode_reward_min": 36.561265708080754, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 22, "timestamp": 1557187896, "time_this_iter_s": 26.53977870941162, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 132, "date": "2019-05-07_00-11-36", "episode_len_mean": 662.48}
{"timesteps_since_restore": 5102962, "policy_reward_mean": {}, "episode_reward_max": 918.8585903073654, "time_total_s": 3428.14248251915, "info": {"num_steps_sampled": 5102962, "sample_time_ms": 17117.706, "grad_time_ms": 8871.326, "update_time_ms": 8.271, "default": {"kl": 0.01638350449502468, "entropy": 1.23606538772583, "cur_lr": 0.0005000000237487257, "total_loss": 9.2227144241333, "policy_loss": -0.007959936745464802, "vf_explained_var": 0.9586201906204224, "vf_loss": 9.227909088134766, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 5102962, "load_time_ms": 11.801}, "custom_metrics": {"cost1_mean": 344.47016055638034, "outflow_rate_max": 1313.9406900070321, "system_level_velocity_mean": 14.748219503295804, "cost1_min": 18.28063285404038, "cost1_max": 517.2520080513673, "outflow_rate_min": 434.5186162964645, "cost2_mean": -0.03147885242908684, "outflow_rate_mean": 1049.8507185557028, "system_level_velocity_min": 10.202904038082515, "cost2_min": -0.5550603118262092, "system_level_velocity_max": 20.19320714794986, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 133, "done": false, "episodes_total": 2450, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540623ef60>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540622e240>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540622ecc0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 691.2569131733015, "timesteps_this_iter": 36920, "timesteps_total": 5102962, "time_since_restore": 3428.14248251915, "hostname": "flow-main", "episode_reward_min": 36.561265708080754, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 16, "timestamp": 1557187922, "time_this_iter_s": 26.08497905731201, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 133, "date": "2019-05-07_00-12-02", "episode_len_mean": 655.86}
{"timesteps_since_restore": 5140542, "policy_reward_mean": {}, "episode_reward_max": 918.8585903073654, "time_total_s": 3453.7339012622833, "info": {"num_steps_sampled": 5140542, "sample_time_ms": 17028.597, "grad_time_ms": 8873.676, "update_time_ms": 8.443, "default": {"kl": 0.01586543209850788, "entropy": 1.259637475013733, "cur_lr": 0.0005000000237487257, "total_loss": 15.502907752990723, "policy_loss": -0.0083687212318182, "vf_explained_var": 0.932187020778656, "vf_loss": 15.508601188659668, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 5140542, "load_time_ms": 11.835}, "custom_metrics": {"cost1_mean": 346.1200635653564, "outflow_rate_max": 1313.9406900070321, "system_level_velocity_mean": 14.464571668886697, "cost1_min": 21.008089651710787, "cost1_max": 506.0567781363135, "outflow_rate_min": 429.35693096491684, "cost2_mean": -0.05489601038444143, "outflow_rate_mean": 1051.8616668231364, "system_level_velocity_min": 10.119210569887958, "cost2_min": -1.0544504109944481, "system_level_velocity_max": 20.05695954123517, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 134, "done": false, "episodes_total": 2471, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266a20>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266550>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062669e8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 701.2563996245993, "timesteps_this_iter": 37580, "timesteps_total": 5140542, "time_since_restore": 3453.7339012622833, "hostname": "flow-main", "episode_reward_min": 38.61998097790447, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557187948, "time_this_iter_s": 25.591418743133545, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 134, "date": "2019-05-07_00-12-28", "episode_len_mean": 667.87}
{"timesteps_since_restore": 5178600, "policy_reward_mean": {}, "episode_reward_max": 918.8585903073654, "time_total_s": 3479.2582318782806, "info": {"num_steps_sampled": 5178600, "sample_time_ms": 16988.796, "grad_time_ms": 8879.779, "update_time_ms": 8.49, "default": {"kl": 0.01818150281906128, "entropy": 1.246652364730835, "cur_lr": 0.0005000000237487257, "total_loss": 12.795371055603027, "policy_loss": -0.010340089909732342, "vf_explained_var": 0.9387081861495972, "vf_loss": 12.802642822265625, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 5178600, "load_time_ms": 11.964}, "custom_metrics": {"cost1_mean": 339.6240083661745, "outflow_rate_max": 1313.724226377646, "system_level_velocity_mean": 14.402807577635597, "cost1_min": 21.008089651710787, "cost1_max": 506.0567781363135, "outflow_rate_min": 428.9771522995125, "cost2_mean": -0.05114725824746877, "outflow_rate_mean": 1037.9690143600926, "system_level_velocity_min": 10.119210569887958, "cost2_min": -1.0544504109944481, "system_level_velocity_max": 20.05695954123517, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 135, "done": false, "episodes_total": 2489, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247400>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247358>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247ef0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 691.0751416141284, "timesteps_this_iter": 38058, "timesteps_total": 5178600, "time_since_restore": 3479.2582318782806, "hostname": "flow-main", "episode_reward_min": 38.61998097790447, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557187973, "time_this_iter_s": 25.524330615997314, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 135, "date": "2019-05-07_00-12-53", "episode_len_mean": 661.21}
{"timesteps_since_restore": 5217162, "policy_reward_mean": {}, "episode_reward_max": 909.7840235058674, "time_total_s": 3505.9163269996643, "info": {"num_steps_sampled": 5217162, "sample_time_ms": 17127.683, "grad_time_ms": 8873.654, "update_time_ms": 8.546, "default": {"kl": 0.017297662794589996, "entropy": 1.276681900024414, "cur_lr": 0.0005000000237487257, "total_loss": 13.307823181152344, "policy_loss": -0.008456505835056305, "vf_explained_var": 0.9299771785736084, "vf_loss": 13.313361167907715, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 5217162, "load_time_ms": 12.027}, "custom_metrics": {"cost1_mean": 334.99122837841065, "outflow_rate_max": 1313.724226377646, "system_level_velocity_mean": 14.390355941848053, "cost1_min": 21.008089651710787, "cost1_max": 506.0567781363135, "outflow_rate_min": 428.9771522995125, "cost2_mean": -0.03832928031975978, "outflow_rate_mean": 1029.8850193233136, "system_level_velocity_min": 10.119210569887958, "cost2_min": -1.0544504109944481, "system_level_velocity_max": 20.05695954123517, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 136, "done": false, "episodes_total": 2511, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062666a0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266358>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062665c0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 685.3193880414677, "timesteps_this_iter": 38562, "timesteps_total": 5217162, "time_since_restore": 3505.9163269996643, "hostname": "flow-main", "episode_reward_min": 38.61998097790447, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 22, "timestamp": 1557188000, "time_this_iter_s": 26.658095121383667, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 136, "date": "2019-05-07_00-13-20", "episode_len_mean": 654.78}
{"timesteps_since_restore": 5254129, "policy_reward_mean": {}, "episode_reward_max": 875.4684788230894, "time_total_s": 3530.8225107192993, "info": {"num_steps_sampled": 5254129, "sample_time_ms": 17069.915, "grad_time_ms": 8739.797, "update_time_ms": 8.852, "default": {"kl": 0.01711159199476242, "entropy": 1.2535408735275269, "cur_lr": 0.0005000000237487257, "total_loss": 12.815882682800293, "policy_loss": -0.008944656699895859, "vf_explained_var": 0.946941614151001, "vf_loss": 12.821939468383789, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 5254129, "load_time_ms": 12.402}, "custom_metrics": {"cost1_mean": 337.69488944887763, "outflow_rate_max": 1313.724226377646, "system_level_velocity_mean": 13.987194977044808, "cost1_min": 21.008089651710787, "cost1_max": 506.0567781363135, "outflow_rate_min": 428.9771522995125, "cost2_mean": -0.03668671630610357, "outflow_rate_mean": 1031.3652674894465, "system_level_velocity_min": 10.119210569887958, "cost2_min": -1.0544504109944481, "system_level_velocity_max": 20.05695954123517, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 137, "done": false, "episodes_total": 2531, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235630>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247828>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062479e8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 695.2322488956503, "timesteps_this_iter": 36967, "timesteps_total": 5254129, "time_since_restore": 3530.8225107192993, "hostname": "flow-main", "episode_reward_min": 38.61998097790447, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557188025, "time_this_iter_s": 24.90618371963501, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 137, "date": "2019-05-07_00-13-45", "episode_len_mean": 673.45}
{"timesteps_since_restore": 5291227, "policy_reward_mean": {}, "episode_reward_max": 875.4684788230894, "time_total_s": 3555.3053991794586, "info": {"num_steps_sampled": 5291227, "sample_time_ms": 17056.871, "grad_time_ms": 8687.87, "update_time_ms": 8.761, "default": {"kl": 0.016758102923631668, "entropy": 1.2984308004379272, "cur_lr": 0.0005000000237487257, "total_loss": 13.92063045501709, "policy_loss": -0.009164036251604557, "vf_explained_var": 0.9201714992523193, "vf_loss": 13.926965713500977, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 5291227, "load_time_ms": 12.581}, "custom_metrics": {"cost1_mean": 337.9450674921793, "outflow_rate_max": 1313.724226377646, "system_level_velocity_mean": 13.97753902255212, "cost1_min": 21.008089651710787, "cost1_max": 506.0567781363135, "outflow_rate_min": 428.9771522995125, "cost2_mean": -0.04126877215915003, "outflow_rate_mean": 1032.7859204707806, "system_level_velocity_min": 10.119210569887958, "cost2_min": -1.0544504109944481, "system_level_velocity_max": 20.05695954123517, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 138, "done": false, "episodes_total": 2551, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247780>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062476a0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247ef0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 698.2395574834093, "timesteps_this_iter": 37098, "timesteps_total": 5291227, "time_since_restore": 3555.3053991794586, "hostname": "flow-main", "episode_reward_min": 38.61998097790447, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557188050, "time_this_iter_s": 24.4828884601593, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 138, "date": "2019-05-07_00-14-10", "episode_len_mean": 673.57}
{"timesteps_since_restore": 5329150, "policy_reward_mean": {}, "episode_reward_max": 875.4684788230894, "time_total_s": 3579.2973449230194, "info": {"num_steps_sampled": 5329150, "sample_time_ms": 16903.326, "grad_time_ms": 8596.818, "update_time_ms": 8.732, "default": {"kl": 0.016383180394768715, "entropy": 1.2904349565505981, "cur_lr": 0.0005000000237487257, "total_loss": 8.73971939086914, "policy_loss": -0.008820070885121822, "vf_explained_var": 0.9266437888145447, "vf_loss": 8.745773315429688, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 5329150, "load_time_ms": 12.642}, "custom_metrics": {"cost1_mean": 337.3750004409271, "outflow_rate_max": 1313.724226377646, "system_level_velocity_mean": 13.782609217348647, "cost1_min": 23.236189469330665, "cost1_max": 495.1832772405714, "outflow_rate_min": 428.9771522995125, "cost2_mean": -0.02387316655561592, "outflow_rate_mean": 1034.5171269931825, "system_level_velocity_min": 10.851691553142729, "cost2_min": -0.46245377781139424, "system_level_velocity_max": 19.362086587243024, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 139, "done": false, "episodes_total": 2563, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f6a0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625ff60>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f0b8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 704.1698092016594, "timesteps_this_iter": 37923, "timesteps_total": 5329150, "time_since_restore": 3579.2973449230194, "hostname": "flow-main", "episode_reward_min": 40.30414262167632, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 12, "timestamp": 1557188074, "time_this_iter_s": 23.99194574356079, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 139, "date": "2019-05-07_00-14-34", "episode_len_mean": 680.41}
{"timesteps_since_restore": 5367437, "policy_reward_mean": {}, "episode_reward_max": 894.2040411598834, "time_total_s": 3604.2423672676086, "info": {"num_steps_sampled": 5367437, "sample_time_ms": 16800.285, "grad_time_ms": 8453.803, "update_time_ms": 8.451, "default": {"kl": 0.020243024453520775, "entropy": 1.3021265268325806, "cur_lr": 0.0005000000237487257, "total_loss": 10.209467887878418, "policy_loss": -0.009950080886483192, "vf_explained_var": 0.9444055557250977, "vf_loss": 10.216001510620117, "cur_kl_coeff": 0.16875001788139343}, "num_steps_trained": 5367437, "load_time_ms": 13.051}, "custom_metrics": {"cost1_mean": 342.2813096952378, "outflow_rate_max": 1305.2905789462689, "system_level_velocity_mean": 13.772790329994809, "cost1_min": 34.561271464722545, "cost1_max": 495.1832772405714, "outflow_rate_min": 464.9457247984426, "cost2_mean": -0.03362729866126599, "outflow_rate_mean": 1045.1713384739314, "system_level_velocity_min": 10.203095445962868, "cost2_min": -0.46245377781139424, "system_level_velocity_max": 19.362086587243024, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 140, "done": false, "episodes_total": 2582, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84320>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84160>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84668>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 718.1847333848737, "timesteps_this_iter": 38287, "timesteps_total": 5367437, "time_since_restore": 3604.2423672676086, "hostname": "flow-main", "episode_reward_min": 62.0637846449112, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557188099, "time_this_iter_s": 24.945022344589233, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 140, "date": "2019-05-07_00-14-59", "episode_len_mean": 687.07}
{"timesteps_since_restore": 5405300, "policy_reward_mean": {}, "episode_reward_max": 894.2040411598834, "time_total_s": 3629.406589746475, "info": {"num_steps_sampled": 5405300, "sample_time_ms": 16896.556, "grad_time_ms": 8387.359, "update_time_ms": 8.117, "default": {"kl": 0.013061060570180416, "entropy": 1.287282943725586, "cur_lr": 0.0005000000237487257, "total_loss": 10.938920021057129, "policy_loss": -0.007616049610078335, "vf_explained_var": 0.9429422616958618, "vf_loss": 10.943228721618652, "cur_kl_coeff": 0.2531249523162842}, "num_steps_trained": 5405300, "load_time_ms": 13.173}, "custom_metrics": {"cost1_mean": 339.2236652485342, "outflow_rate_max": 1305.2905789462689, "system_level_velocity_mean": 13.639838748078427, "cost1_min": 34.561271464722545, "cost1_max": 495.1832772405714, "outflow_rate_min": 464.9457247984426, "cost2_mean": -0.0356959881981109, "outflow_rate_mean": 1038.5804708518324, "system_level_velocity_min": 10.203095445962868, "cost2_min": -0.46245377781139424, "system_level_velocity_max": 19.75836610787993, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 141, "done": false, "episodes_total": 2600, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84c50>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84198>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f840b8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 715.8597940531109, "timesteps_this_iter": 37863, "timesteps_total": 5405300, "time_since_restore": 3629.406589746475, "hostname": "flow-main", "episode_reward_min": 62.0637846449112, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557188124, "time_this_iter_s": 25.164222478866577, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 141, "date": "2019-05-07_00-15-24", "episode_len_mean": 687.83}
{"timesteps_since_restore": 5442472, "policy_reward_mean": {}, "episode_reward_max": 894.2040411598834, "time_total_s": 3655.3009498119354, "info": {"num_steps_sampled": 5442472, "sample_time_ms": 16888.885, "grad_time_ms": 8329.345, "update_time_ms": 7.995, "default": {"kl": 0.013583681546151638, "entropy": 1.263616919517517, "cur_lr": 0.0005000000237487257, "total_loss": 16.276460647583008, "policy_loss": -0.008242401294410229, "vf_explained_var": 0.9156060814857483, "vf_loss": 16.281267166137695, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 5442472, "load_time_ms": 13.305}, "custom_metrics": {"cost1_mean": 328.79410009792065, "outflow_rate_max": 1305.2905789462689, "system_level_velocity_mean": 13.763608249078331, "cost1_min": 18.110795621679596, "cost1_max": 495.1832772405714, "outflow_rate_min": 434.44599691538906, "cost2_mean": -0.03896326059222975, "outflow_rate_mean": 1022.5380995112839, "system_level_velocity_min": 9.920555992776386, "cost2_min": -0.46245377781139424, "system_level_velocity_max": 19.883132501894796, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 142, "done": false, "episodes_total": 2624, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233be0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235630>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f898>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 693.7949670534471, "timesteps_this_iter": 37172, "timesteps_total": 5442472, "time_since_restore": 3655.3009498119354, "hostname": "flow-main", "episode_reward_min": 36.221591243359185, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 24, "timestamp": 1557188150, "time_this_iter_s": 25.894360065460205, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 142, "date": "2019-05-07_00-15-50", "episode_len_mean": 668.78}
{"timesteps_since_restore": 5479885, "policy_reward_mean": {}, "episode_reward_max": 894.2040411598834, "time_total_s": 3680.961700439453, "info": {"num_steps_sampled": 5479885, "sample_time_ms": 16961.141, "grad_time_ms": 8214.946, "update_time_ms": 7.845, "default": {"kl": 0.014702118001878262, "entropy": 1.2777795791625977, "cur_lr": 0.0005000000237487257, "total_loss": 13.77518081665039, "policy_loss": -0.008321567438542843, "vf_explained_var": 0.9289788007736206, "vf_loss": 13.779780387878418, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 5479885, "load_time_ms": 13.58}, "custom_metrics": {"cost1_mean": 319.1514722670305, "outflow_rate_max": 1281.4000582749138, "system_level_velocity_mean": 13.763357253489733, "cost1_min": 18.110795621679596, "cost1_max": 479.55977581701205, "outflow_rate_min": 434.44599691538906, "cost2_mean": -0.053387702430079856, "outflow_rate_mean": 1003.966377640621, "system_level_velocity_min": 9.920555992776386, "cost2_min": -0.9384717899752092, "system_level_velocity_max": 19.883132501894796, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 143, "done": false, "episodes_total": 2645, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540622e9e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233f98>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406248c18>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 673.5654111771779, "timesteps_this_iter": 37413, "timesteps_total": 5479885, "time_since_restore": 3680.961700439453, "hostname": "flow-main", "episode_reward_min": 36.221591243359185, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557188175, "time_this_iter_s": 25.6607506275177, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 143, "date": "2019-05-07_00-16-15", "episode_len_mean": 655.56}
{"timesteps_since_restore": 5516830, "policy_reward_mean": {}, "episode_reward_max": 894.2040411598834, "time_total_s": 3706.034180164337, "info": {"num_steps_sampled": 5516830, "sample_time_ms": 16998.793, "grad_time_ms": 8125.809, "update_time_ms": 7.644, "default": {"kl": 0.013600622303783894, "entropy": 1.2888619899749756, "cur_lr": 0.0005000000237487257, "total_loss": 11.05618667602539, "policy_loss": -0.007914663292467594, "vf_explained_var": 0.9356850385665894, "vf_loss": 11.060659408569336, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 5516830, "load_time_ms": 13.403}, "custom_metrics": {"cost1_mean": 319.47435397527994, "outflow_rate_max": 1281.4000582749138, "system_level_velocity_mean": 13.925108303184928, "cost1_min": 18.110795621679596, "cost1_max": 479.55977581701205, "outflow_rate_min": 434.44599691538906, "cost2_mean": -0.04686216613171394, "outflow_rate_mean": 1005.2799110851703, "system_level_velocity_min": 9.920555992776386, "cost2_min": -0.9384717899752092, "system_level_velocity_max": 19.883132501894796, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 144, "done": false, "episodes_total": 2664, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84f60>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f844a8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84c18>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 669.8089396517139, "timesteps_this_iter": 36945, "timesteps_total": 5516830, "time_since_restore": 3706.034180164337, "hostname": "flow-main", "episode_reward_min": 36.221591243359185, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557188200, "time_this_iter_s": 25.072479724884033, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 144, "date": "2019-05-07_00-16-40", "episode_len_mean": 649.93}
{"timesteps_since_restore": 5554297, "policy_reward_mean": {}, "episode_reward_max": 835.2722009563197, "time_total_s": 3733.1844334602356, "info": {"num_steps_sampled": 5554297, "sample_time_ms": 17102.08, "grad_time_ms": 8186.438, "update_time_ms": 7.578, "default": {"kl": 0.013538037426769733, "entropy": 1.3053193092346191, "cur_lr": 0.0005000000237487257, "total_loss": 12.017059326171875, "policy_loss": -0.009623087011277676, "vf_explained_var": 0.9339649677276611, "vf_loss": 12.023255348205566, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 5554297, "load_time_ms": 13.277}, "custom_metrics": {"cost1_mean": 313.94107785656604, "outflow_rate_max": 1276.905574449019, "system_level_velocity_mean": 13.863903927730787, "cost1_min": 18.110795621679596, "cost1_max": 466.1018365151897, "outflow_rate_min": 434.44599691538906, "cost2_mean": -0.038812216432107166, "outflow_rate_mean": 995.4548301226371, "system_level_velocity_min": 9.920555992776386, "cost2_min": -0.9384717899752092, "system_level_velocity_max": 19.883132501894796, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 145, "done": false, "episodes_total": 2683, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f390>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062332b0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062339e8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 659.7295071579409, "timesteps_this_iter": 37467, "timesteps_total": 5554297, "time_since_restore": 3733.1844334602356, "hostname": "flow-main", "episode_reward_min": 36.221591243359185, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557188228, "time_this_iter_s": 27.150253295898438, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 145, "date": "2019-05-07_00-17-08", "episode_len_mean": 645.16}
{"timesteps_since_restore": 5592009, "policy_reward_mean": {}, "episode_reward_max": 890.490562574295, "time_total_s": 3758.4463505744934, "info": {"num_steps_sampled": 5592009, "sample_time_ms": 17045.885, "grad_time_ms": 8104.37, "update_time_ms": 7.975, "default": {"kl": 0.014041813090443611, "entropy": 1.28963041305542, "cur_lr": 0.0005000000237487257, "total_loss": 15.683629035949707, "policy_loss": -0.008742067031562328, "vf_explained_var": 0.9131681323051453, "vf_loss": 15.688815116882324, "cur_kl_coeff": 0.2531249523162842}, "num_steps_trained": 5592009, "load_time_ms": 12.736}, "custom_metrics": {"cost1_mean": 312.61860761668436, "outflow_rate_max": 1276.905574449019, "system_level_velocity_mean": 14.114558372890341, "cost1_min": 18.110795621679596, "cost1_max": 466.1018365151897, "outflow_rate_min": 434.44599691538906, "cost2_mean": -0.04682521276424571, "outflow_rate_mean": 994.8089132653154, "system_level_velocity_min": 9.920555992776386, "cost2_min": -0.9384717899752092, "system_level_velocity_max": 19.883132501894796, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 146, "done": false, "episodes_total": 2702, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266780>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266518>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266ef0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 652.7515353704526, "timesteps_this_iter": 37712, "timesteps_total": 5592009, "time_since_restore": 3758.4463505744934, "hostname": "flow-main", "episode_reward_min": 36.221591243359185, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557188253, "time_this_iter_s": 25.261917114257812, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 146, "date": "2019-05-07_00-17-33", "episode_len_mean": 633.49}
{"timesteps_since_restore": 5629976, "policy_reward_mean": {}, "episode_reward_max": 890.490562574295, "time_total_s": 3784.0031814575195, "info": {"num_steps_sampled": 5629976, "sample_time_ms": 17116.435, "grad_time_ms": 8097.166, "update_time_ms": 7.617, "default": {"kl": 0.015119154937565327, "entropy": 1.2986308336257935, "cur_lr": 0.0005000000237487257, "total_loss": 12.336694717407227, "policy_loss": -0.007617461495101452, "vf_explained_var": 0.9410767555236816, "vf_loss": 12.340486526489258, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 5629976, "load_time_ms": 12.776}, "custom_metrics": {"cost1_mean": 314.7920930192358, "outflow_rate_max": 1280.7662353541537, "system_level_velocity_mean": 14.023643551463811, "cost1_min": 26.969084054531326, "cost1_max": 470.08782433849, "outflow_rate_min": 449.88502780643296, "cost2_mean": -0.04667836415256607, "outflow_rate_mean": 996.9177057143419, "system_level_velocity_min": 9.920555992776386, "cost2_min": -0.9384717899752092, "system_level_velocity_max": 19.883132501894796, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 147, "done": false, "episodes_total": 2722, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84f60>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84390>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84710>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 660.6058348652243, "timesteps_this_iter": 37967, "timesteps_total": 5629976, "time_since_restore": 3784.0031814575195, "hostname": "flow-main", "episode_reward_min": 47.68599447716459, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557188279, "time_this_iter_s": 25.556830883026123, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 147, "date": "2019-05-07_00-17-59", "episode_len_mean": 639.38}
{"timesteps_since_restore": 5667969, "policy_reward_mean": {}, "episode_reward_max": 890.490562574295, "time_total_s": 3808.878973722458, "info": {"num_steps_sampled": 5667969, "sample_time_ms": 17170.935, "grad_time_ms": 8082.686, "update_time_ms": 7.681, "default": {"kl": 0.013667945750057697, "entropy": 1.2941147089004517, "cur_lr": 0.0005000000237487257, "total_loss": 9.649332046508789, "policy_loss": -0.00932069681584835, "vf_explained_var": 0.9586698412895203, "vf_loss": 9.655192375183105, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 5667969, "load_time_ms": 12.132}, "custom_metrics": {"cost1_mean": 325.4332632992334, "outflow_rate_max": 1280.7662353541537, "system_level_velocity_mean": 13.87129217649287, "cost1_min": 26.969084054531326, "cost1_max": 470.08782433849, "outflow_rate_min": 449.88502780643296, "cost2_mean": -0.03726214462671954, "outflow_rate_mean": 1016.7611215225104, "system_level_velocity_min": 10.268870774869944, "cost2_min": -0.7382286184660487, "system_level_velocity_max": 19.860994383238843, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 148, "done": false, "episodes_total": 2739, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625abe0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a588>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625ae48>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 688.5710084461841, "timesteps_this_iter": 37993, "timesteps_total": 5667969, "time_since_restore": 3808.878973722458, "hostname": "flow-main", "episode_reward_min": 47.68599447716459, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 17, "timestamp": 1557188303, "time_this_iter_s": 24.875792264938354, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 148, "date": "2019-05-07_00-18-23", "episode_len_mean": 659.06}
{"timesteps_since_restore": 5705738, "policy_reward_mean": {}, "episode_reward_max": 890.490562574295, "time_total_s": 3835.6143548488617, "info": {"num_steps_sampled": 5705738, "sample_time_ms": 17435.826, "grad_time_ms": 8091.936, "update_time_ms": 7.504, "default": {"kl": 0.013114838860929012, "entropy": 1.26690673828125, "cur_lr": 0.0005000000237487257, "total_loss": 13.29344367980957, "policy_loss": -0.006828243378549814, "vf_explained_var": 0.9446086287498474, "vf_loss": 13.296953201293945, "cur_kl_coeff": 0.2531249523162842}, "num_steps_trained": 5705738, "load_time_ms": 11.984}, "custom_metrics": {"cost1_mean": 335.8301651059292, "outflow_rate_max": 1280.7662353541537, "system_level_velocity_mean": 14.097034271351568, "cost1_min": 27.517503171259648, "cost1_max": 502.39217660398594, "outflow_rate_min": 423.27425061290734, "cost2_mean": -0.03819925097416837, "outflow_rate_mean": 1031.2426278743865, "system_level_velocity_min": 10.030522193214253, "cost2_min": -0.7382286184660487, "system_level_velocity_max": 19.713050354662297, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 149, "done": false, "episodes_total": 2761, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266eb8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062665f8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062666d8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 698.6901670123232, "timesteps_this_iter": 37769, "timesteps_total": 5705738, "time_since_restore": 3835.6143548488617, "hostname": "flow-main", "episode_reward_min": 48.12222950598224, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 22, "timestamp": 1557188330, "time_this_iter_s": 26.73538112640381, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 149, "date": "2019-05-07_00-18-50", "episode_len_mean": 664.71}
{"timesteps_since_restore": 5744408, "policy_reward_mean": {}, "episode_reward_max": 938.3411981793299, "time_total_s": 3860.674794435501, "info": {"num_steps_sampled": 5744408, "sample_time_ms": 17521.126, "grad_time_ms": 8019.487, "update_time_ms": 7.536, "default": {"kl": 0.013881942257285118, "entropy": 1.3155395984649658, "cur_lr": 0.0005000000237487257, "total_loss": 9.549484252929688, "policy_loss": -0.009416024200618267, "vf_explained_var": 0.9498454928398132, "vf_loss": 9.55538558959961, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 5744408, "load_time_ms": 12.134}, "custom_metrics": {"cost1_mean": 338.66827728085633, "outflow_rate_max": 1301.4185717302216, "system_level_velocity_mean": 14.07430380393839, "cost1_min": 27.517503171259648, "cost1_max": 502.39217660398594, "outflow_rate_min": 423.27425061290734, "cost2_mean": -0.07689562647728668, "outflow_rate_mean": 1037.2154188772363, "system_level_velocity_min": 10.030522193214253, "cost2_min": -2.2896542742942008, "system_level_velocity_max": 19.421471622740473, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 150, "done": false, "episodes_total": 2778, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266ef0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266518>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062666a0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 706.1808921535527, "timesteps_this_iter": 38670, "timesteps_total": 5744408, "time_since_restore": 3860.674794435501, "hostname": "flow-main", "episode_reward_min": 48.12222950598224, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 17, "timestamp": 1557188355, "time_this_iter_s": 25.060439586639404, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 150, "date": "2019-05-07_00-19-15", "episode_len_mean": 669.48}
{"timesteps_since_restore": 5782558, "policy_reward_mean": {}, "episode_reward_max": 938.3411981793299, "time_total_s": 3886.141985177994, "info": {"num_steps_sampled": 5782558, "sample_time_ms": 17551.73, "grad_time_ms": 8019.388, "update_time_ms": 7.509, "default": {"kl": 0.015006647445261478, "entropy": 1.3041352033615112, "cur_lr": 0.0005000000237487257, "total_loss": 11.13883113861084, "policy_loss": -0.009524688124656677, "vf_explained_var": 0.941749632358551, "vf_loss": 11.144556999206543, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 5782558, "load_time_ms": 12.004}, "custom_metrics": {"cost1_mean": 342.89767088997644, "outflow_rate_max": 1301.4185717302216, "system_level_velocity_mean": 13.895214028290336, "cost1_min": 27.517503171259648, "cost1_max": 502.39217660398594, "outflow_rate_min": 423.27425061290734, "cost2_mean": -0.07670803880370893, "outflow_rate_mean": 1044.4773744272636, "system_level_velocity_min": 10.030522193214253, "cost2_min": -2.2896542742942008, "system_level_velocity_max": 19.50288118859921, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 151, "done": false, "episodes_total": 2797, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625ab38>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625ac50>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625af28>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 718.069825747177, "timesteps_this_iter": 38150, "timesteps_total": 5782558, "time_since_restore": 3886.141985177994, "hostname": "flow-main", "episode_reward_min": 48.12222950598224, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557188381, "time_this_iter_s": 25.467190742492676, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 151, "date": "2019-05-07_00-19-41", "episode_len_mean": 682.16}
{"timesteps_since_restore": 5820356, "policy_reward_mean": {}, "episode_reward_max": 938.3411981793299, "time_total_s": 3911.6917717456818, "info": {"num_steps_sampled": 5820356, "sample_time_ms": 17569.038, "grad_time_ms": 7968.932, "update_time_ms": 7.395, "default": {"kl": 0.014747821725904942, "entropy": 1.3195178508758545, "cur_lr": 0.0005000000237487257, "total_loss": 11.686019897460938, "policy_loss": -0.010666546411812305, "vf_explained_var": 0.9254171252250671, "vf_loss": 11.692952156066895, "cur_kl_coeff": 0.2531249523162842}, "num_steps_trained": 5820356, "load_time_ms": 11.927}, "custom_metrics": {"cost1_mean": 335.83796628816066, "outflow_rate_max": 1301.4185717302216, "system_level_velocity_mean": 13.81467142612253, "cost1_min": 22.840562078206837, "cost1_max": 502.39217660398594, "outflow_rate_min": 423.27425061290734, "cost2_mean": -0.0719981668493621, "outflow_rate_mean": 1032.7321537059822, "system_level_velocity_min": 10.030522193214253, "cost2_min": -2.2896542742942008, "system_level_velocity_max": 19.50288118859921, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 152, "done": false, "episodes_total": 2815, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266898>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266e80>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266c50>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 709.6753372517946, "timesteps_this_iter": 37798, "timesteps_total": 5820356, "time_since_restore": 3911.6917717456818, "hostname": "flow-main", "episode_reward_min": 42.25967018273511, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557188406, "time_this_iter_s": 25.54978656768799, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 152, "date": "2019-05-07_00-20-06", "episode_len_mean": 675.5}
{"timesteps_since_restore": 5858777, "policy_reward_mean": {}, "episode_reward_max": 938.3411981793299, "time_total_s": 3936.9432847499847, "info": {"num_steps_sampled": 5858777, "sample_time_ms": 17604.152, "grad_time_ms": 7893.142, "update_time_ms": 7.56, "default": {"kl": 0.013106361031532288, "entropy": 1.3062481880187988, "cur_lr": 0.0005000000237487257, "total_loss": 13.922070503234863, "policy_loss": -0.007945096120238304, "vf_explained_var": 0.9354122877120972, "vf_loss": 13.926697731018066, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 5858777, "load_time_ms": 11.762}, "custom_metrics": {"cost1_mean": 327.3496001304268, "outflow_rate_max": 1301.4185717302216, "system_level_velocity_mean": 13.865913390018033, "cost1_min": 22.840562078206837, "cost1_max": 502.39217660398594, "outflow_rate_min": 423.27425061290734, "cost2_mean": -0.0745493291974772, "outflow_rate_mean": 1018.0302309460436, "system_level_velocity_min": 10.030522193214253, "cost2_min": -2.2896542742942008, "system_level_velocity_max": 19.916648545865037, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 153, "done": false, "episodes_total": 2836, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f843c8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f842b0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84470>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 694.2258876583392, "timesteps_this_iter": 38421, "timesteps_total": 5858777, "time_since_restore": 3936.9432847499847, "hostname": "flow-main", "episode_reward_min": 42.25967018273511, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557188432, "time_this_iter_s": 25.25151300430298, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 153, "date": "2019-05-07_00-20-32", "episode_len_mean": 662.38}
{"timesteps_since_restore": 5896935, "policy_reward_mean": {}, "episode_reward_max": 938.3411981793299, "time_total_s": 3962.173999786377, "info": {"num_steps_sampled": 5896935, "sample_time_ms": 17613.075, "grad_time_ms": 7897.944, "update_time_ms": 7.734, "default": {"kl": 0.015876609832048416, "entropy": 1.3063483238220215, "cur_lr": 0.0005000000237487257, "total_loss": 10.857388496398926, "policy_loss": -0.010115779004991055, "vf_explained_var": 0.9457190632820129, "vf_loss": 10.863485336303711, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 5896935, "load_time_ms": 11.871}, "custom_metrics": {"cost1_mean": 320.5324046355867, "outflow_rate_max": 1301.4185717302216, "system_level_velocity_mean": 13.619135781613103, "cost1_min": 22.840562078206837, "cost1_max": 476.4664022250419, "outflow_rate_min": 423.27425061290734, "cost2_mean": -0.09115389078226062, "outflow_rate_mean": 1009.7705022463878, "system_level_velocity_min": 10.176418911745788, "cost2_min": -2.2896542742942008, "system_level_velocity_max": 19.916648545865037, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 154, "done": false, "episodes_total": 2856, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f840b8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062331d0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84278>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 697.7836898677316, "timesteps_this_iter": 38158, "timesteps_total": 5896935, "time_since_restore": 3962.173999786377, "hostname": "flow-main", "episode_reward_min": 42.25967018273511, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557188457, "time_this_iter_s": 25.230715036392212, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 154, "date": "2019-05-07_00-20-57", "episode_len_mean": 662.38}
{"timesteps_since_restore": 5934139, "policy_reward_mean": {}, "episode_reward_max": 938.3411981793299, "time_total_s": 3987.45770406723, "info": {"num_steps_sampled": 5934139, "sample_time_ms": 17602.127, "grad_time_ms": 7722.447, "update_time_ms": 7.898, "default": {"kl": 0.014408075250685215, "entropy": 1.2809869050979614, "cur_lr": 0.0005000000237487257, "total_loss": 12.03334903717041, "policy_loss": -0.006960737984627485, "vf_explained_var": 0.9523317813873291, "vf_loss": 12.036663055419922, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 5934139, "load_time_ms": 11.753}, "custom_metrics": {"cost1_mean": 324.4670082587003, "outflow_rate_max": 1301.4185717302216, "system_level_velocity_mean": 13.653549471729205, "cost1_min": 22.840562078206837, "cost1_max": 476.4664022250419, "outflow_rate_min": 431.0614505857561, "cost2_mean": -0.0641207325107788, "outflow_rate_mean": 1016.8507366445989, "system_level_velocity_min": 10.176418911745788, "cost2_min": -1.4564349855933005, "system_level_velocity_max": 19.980647647537428, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 155, "done": false, "episodes_total": 2871, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a3c8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625af28>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a320>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 701.5144276485287, "timesteps_this_iter": 37204, "timesteps_total": 5934139, "time_since_restore": 3987.45770406723, "hostname": "flow-main", "episode_reward_min": 42.25967018273511, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 15, "timestamp": 1557188482, "time_this_iter_s": 25.28370428085327, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 155, "date": "2019-05-07_00-21-22", "episode_len_mean": 667.38}
{"timesteps_since_restore": 5972138, "policy_reward_mean": {}, "episode_reward_max": 902.4214761748335, "time_total_s": 4014.730476617813, "info": {"num_steps_sampled": 5972138, "sample_time_ms": 17757.978, "grad_time_ms": 7766.741, "update_time_ms": 7.541, "default": {"kl": 0.013524338603019714, "entropy": 1.2675546407699585, "cur_lr": 0.0005000000237487257, "total_loss": 15.455041885375977, "policy_loss": -0.00829517561942339, "vf_explained_var": 0.9306028485298157, "vf_loss": 15.459915161132812, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 5972138, "load_time_ms": 11.804}, "custom_metrics": {"cost1_mean": 328.6184740499524, "outflow_rate_max": 1306.3955153420554, "system_level_velocity_mean": 13.872413753065342, "cost1_min": 22.840562078206837, "cost1_max": 518.8144766938551, "outflow_rate_min": 431.0614505857561, "cost2_mean": -0.07213515135985828, "outflow_rate_mean": 1021.4533007494654, "system_level_velocity_min": 10.176418911745788, "cost2_min": -1.4564349855933005, "system_level_velocity_max": 20.261935706256256, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 156, "done": false, "episodes_total": 2893, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062663c8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062669b0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266d30>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 700.1679647489487, "timesteps_this_iter": 37999, "timesteps_total": 5972138, "time_since_restore": 4014.730476617813, "hostname": "flow-main", "episode_reward_min": 42.25967018273511, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 22, "timestamp": 1557188510, "time_this_iter_s": 27.272772550582886, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 156, "date": "2019-05-07_00-21-50", "episode_len_mean": 665.41}
{"timesteps_since_restore": 6009461, "policy_reward_mean": {}, "episode_reward_max": 902.4214761748335, "time_total_s": 4041.146713256836, "info": {"num_steps_sampled": 6009461, "sample_time_ms": 17699.794, "grad_time_ms": 7911.967, "update_time_ms": 7.859, "default": {"kl": 0.012982292100787163, "entropy": 1.3129141330718994, "cur_lr": 0.0005000000237487257, "total_loss": 10.811145782470703, "policy_loss": -0.007419310975819826, "vf_explained_var": 0.9424278140068054, "vf_loss": 10.815279960632324, "cur_kl_coeff": 0.2531249523162842}, "num_steps_trained": 6009461, "load_time_ms": 11.947}, "custom_metrics": {"cost1_mean": 331.4548598361825, "outflow_rate_max": 1306.3955153420554, "system_level_velocity_mean": 13.80066504451833, "cost1_min": 23.085005234393165, "cost1_max": 518.8144766938551, "outflow_rate_min": 431.0614505857561, "cost2_mean": -0.06675011215426062, "outflow_rate_mean": 1025.2306968923951, "system_level_velocity_min": 10.176418911745788, "cost2_min": -1.4564349855933005, "system_level_velocity_max": 20.261935706256256, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 157, "done": false, "episodes_total": 2912, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266a90>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266438>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266278>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 703.2117830705586, "timesteps_this_iter": 37323, "timesteps_total": 6009461, "time_since_restore": 4041.146713256836, "hostname": "flow-main", "episode_reward_min": 42.78566649321242, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557188536, "time_this_iter_s": 26.416236639022827, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 157, "date": "2019-05-07_00-22-16", "episode_len_mean": 672.07}
{"timesteps_since_restore": 6046639, "policy_reward_mean": {}, "episode_reward_max": 902.4214761748335, "time_total_s": 4066.59188246727, "info": {"num_steps_sampled": 6046639, "sample_time_ms": 17774.83, "grad_time_ms": 7891.549, "update_time_ms": 8.163, "default": {"kl": 0.015500913374125957, "entropy": 1.3130064010620117, "cur_lr": 0.0005000000237487257, "total_loss": 11.954219818115234, "policy_loss": -0.008341634646058083, "vf_explained_var": 0.926728367805481, "vf_loss": 11.958639144897461, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 6046639, "load_time_ms": 12.68}, "custom_metrics": {"cost1_mean": 336.8044931439773, "outflow_rate_max": 1306.3955153420554, "system_level_velocity_mean": 13.665801478805705, "cost1_min": 25.79679679093371, "cost1_max": 518.8144766938551, "outflow_rate_min": 440.8690944596281, "cost2_mean": -0.05900858294337628, "outflow_rate_mean": 1035.590233856285, "system_level_velocity_min": 10.178622715730338, "cost2_min": -1.4564349855933005, "system_level_velocity_max": 20.261935706256256, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 158, "done": false, "episodes_total": 2930, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f7b8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625fc18>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f278>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 709.3250070083475, "timesteps_this_iter": 37178, "timesteps_total": 6046639, "time_since_restore": 4066.59188246727, "hostname": "flow-main", "episode_reward_min": 44.54137712363287, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557188561, "time_this_iter_s": 25.44516921043396, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 158, "date": "2019-05-07_00-22-41", "episode_len_mean": 685.24}
{"timesteps_since_restore": 6084079, "policy_reward_mean": {}, "episode_reward_max": 902.4214761748335, "time_total_s": 4091.4566617012024, "info": {"num_steps_sampled": 6084079, "sample_time_ms": 17647.644, "grad_time_ms": 7831.716, "update_time_ms": 8.484, "default": {"kl": 0.015164553187787533, "entropy": 1.310437560081482, "cur_lr": 0.0005000000237487257, "total_loss": 11.254794120788574, "policy_loss": -0.00995693076401949, "vf_explained_var": 0.9412384033203125, "vf_loss": 11.260912895202637, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 6084079, "load_time_ms": 12.742}, "custom_metrics": {"cost1_mean": 344.1432141752737, "outflow_rate_max": 1306.3955153420554, "system_level_velocity_mean": 13.754005892984733, "cost1_min": 25.79679679093371, "cost1_max": 518.8144766938551, "outflow_rate_min": 440.8690944596281, "cost2_mean": -0.0420692089502137, "outflow_rate_mean": 1050.0675302663576, "system_level_velocity_min": 10.178622715730338, "cost2_min": -1.0937468669596153, "system_level_velocity_max": 20.261935706256256, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 159, "done": false, "episodes_total": 2949, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625aeb8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266a20>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266400>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 713.1536731298406, "timesteps_this_iter": 37440, "timesteps_total": 6084079, "time_since_restore": 4091.4566617012024, "hostname": "flow-main", "episode_reward_min": 44.54137712363287, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557188586, "time_this_iter_s": 24.864779233932495, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 159, "date": "2019-05-07_00-23-06", "episode_len_mean": 691.78}
{"timesteps_since_restore": 6121618, "policy_reward_mean": {}, "episode_reward_max": 902.4214761748335, "time_total_s": 4117.24688243866, "info": {"num_steps_sampled": 6121618, "sample_time_ms": 17677.53, "grad_time_ms": 7873.478, "update_time_ms": 8.621, "default": {"kl": 0.015687067061662674, "entropy": 1.3319743871688843, "cur_lr": 0.0005000000237487257, "total_loss": 12.197627067565918, "policy_loss": -0.006736118812114, "vf_explained_var": 0.9370588064193726, "vf_loss": 12.200393676757812, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 6121618, "load_time_ms": 12.811}, "custom_metrics": {"cost1_mean": 338.5085922024909, "outflow_rate_max": 1306.3955153420554, "system_level_velocity_mean": 13.601102600030412, "cost1_min": 25.79679679093371, "cost1_max": 518.8144766938551, "outflow_rate_min": 440.8690944596281, "cost2_mean": -0.039597550657052366, "outflow_rate_mean": 1039.7177562042527, "system_level_velocity_min": 10.178622715730338, "cost2_min": -1.0937468669596153, "system_level_velocity_max": 20.261935706256256, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 160, "done": false, "episodes_total": 2968, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062662b0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266208>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266fd0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 704.1458909367761, "timesteps_this_iter": 37539, "timesteps_total": 6121618, "time_since_restore": 4117.24688243866, "hostname": "flow-main", "episode_reward_min": 44.54137712363287, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557188612, "time_this_iter_s": 25.790220737457275, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 160, "date": "2019-05-07_00-23-32", "episode_len_mean": 689.07}
{"timesteps_since_restore": 6158830, "policy_reward_mean": {}, "episode_reward_max": 902.4214761748335, "time_total_s": 4142.977411985397, "info": {"num_steps_sampled": 6158830, "sample_time_ms": 17681.151, "grad_time_ms": 7896.116, "update_time_ms": 8.984, "default": {"kl": 0.014256526716053486, "entropy": 1.3040072917938232, "cur_lr": 0.0005000000237487257, "total_loss": 10.429397583007812, "policy_loss": -0.008731476031243801, "vf_explained_var": 0.9598292112350464, "vf_loss": 10.434520721435547, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 6158830, "load_time_ms": 12.848}, "custom_metrics": {"cost1_mean": 341.2283742790549, "outflow_rate_max": 1305.3393305500426, "system_level_velocity_mean": 13.515170608524445, "cost1_min": 192.02239330573343, "cost1_max": 491.12076470743574, "outflow_rate_min": 856.0500753603177, "cost2_mean": -0.03162482148324821, "outflow_rate_mean": 1047.567143689149, "system_level_velocity_min": 10.227147064224704, "cost2_min": -0.5513681328945534, "system_level_velocity_max": 19.15032217214116, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 161, "done": false, "episodes_total": 2985, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062359b0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8ca90>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406235208>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 711.0990999742431, "timesteps_this_iter": 37212, "timesteps_total": 6158830, "time_since_restore": 4142.977411985397, "hostname": "flow-main", "episode_reward_min": 377.59982335177597, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 17, "timestamp": 1557188638, "time_this_iter_s": 25.73052954673767, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 161, "date": "2019-05-07_00-23-58", "episode_len_mean": 695.7}
{"timesteps_since_restore": 6197017, "policy_reward_mean": {}, "episode_reward_max": 850.6579023614273, "time_total_s": 4169.249289035797, "info": {"num_steps_sampled": 6197017, "sample_time_ms": 17695.532, "grad_time_ms": 7953.179, "update_time_ms": 9.085, "default": {"kl": 0.014565517194569111, "entropy": 1.299087643623352, "cur_lr": 0.0005000000237487257, "total_loss": 12.933755874633789, "policy_loss": -0.008082414977252483, "vf_explained_var": 0.9460581541061401, "vf_loss": 12.938152313232422, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 6197017, "load_time_ms": 12.979}, "custom_metrics": {"cost1_mean": 339.0522357104958, "outflow_rate_max": 1305.3393305500426, "system_level_velocity_mean": 13.748123326306665, "cost1_min": 26.466456354006656, "cost1_max": 479.25864408631674, "outflow_rate_min": 449.88502780643296, "cost2_mean": -0.03531948959964191, "outflow_rate_mean": 1044.4449382710234, "system_level_velocity_min": 10.227147064224704, "cost2_min": -0.5513681328945534, "system_level_velocity_max": 20.057875979802187, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 162, "done": false, "episodes_total": 3007, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a588>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c240>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406247358>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 701.008939366847, "timesteps_this_iter": 38187, "timesteps_total": 6197017, "time_since_restore": 4169.249289035797, "hostname": "flow-main", "episode_reward_min": 50.494057572168984, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 22, "timestamp": 1557188664, "time_this_iter_s": 26.27187705039978, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 162, "date": "2019-05-07_00-24-24", "episode_len_mean": 684.42}
{"timesteps_since_restore": 6236019, "policy_reward_mean": {}, "episode_reward_max": 851.7814561698665, "time_total_s": 4194.908783197403, "info": {"num_steps_sampled": 6236019, "sample_time_ms": 17644.78, "grad_time_ms": 8044.315, "update_time_ms": 9.004, "default": {"kl": 0.015920963138341904, "entropy": 1.33705472946167, "cur_lr": 0.0005000000237487257, "total_loss": 9.707077980041504, "policy_loss": -0.009979802183806896, "vf_explained_var": 0.950382649898529, "vf_loss": 9.713027000427246, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 6236019, "load_time_ms": 13.049}, "custom_metrics": {"cost1_mean": 343.03565599230126, "outflow_rate_max": 1305.3393305500426, "system_level_velocity_mean": 13.903507690960561, "cost1_min": 26.466456354006656, "cost1_max": 479.25864408631674, "outflow_rate_min": 449.88502780643296, "cost2_mean": -0.04277070595642043, "outflow_rate_mean": 1053.3028918558923, "system_level_velocity_min": 10.227147064224704, "cost2_min": -0.5513681328945534, "system_level_velocity_max": 20.057875979802187, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 163, "done": false, "episodes_total": 3023, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625ad30>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625aac8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a9e8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 707.172429601998, "timesteps_this_iter": 39002, "timesteps_total": 6236019, "time_since_restore": 4194.908783197403, "hostname": "flow-main", "episode_reward_min": 50.494057572168984, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 16, "timestamp": 1557188690, "time_this_iter_s": 25.659494161605835, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 163, "date": "2019-05-07_00-24-50", "episode_len_mean": 684.42}
{"timesteps_since_restore": 6274379, "policy_reward_mean": {}, "episode_reward_max": 851.7814561698665, "time_total_s": 4220.288030385971, "info": {"num_steps_sampled": 6274379, "sample_time_ms": 17596.954, "grad_time_ms": 8107.553, "update_time_ms": 8.772, "default": {"kl": 0.015029105357825756, "entropy": 1.3207876682281494, "cur_lr": 0.0005000000237487257, "total_loss": 10.692302703857422, "policy_loss": -0.009833007119596004, "vf_explained_var": 0.9410251379013062, "vf_loss": 10.698331832885742, "cur_kl_coeff": 0.2531249523162842}, "num_steps_trained": 6274379, "load_time_ms": 13.151}, "custom_metrics": {"cost1_mean": 342.5635367178579, "outflow_rate_max": 1305.3393305500426, "system_level_velocity_mean": 13.942221369317053, "cost1_min": 26.466456354006656, "cost1_max": 479.25864408631674, "outflow_rate_min": 449.88502780643296, "cost2_mean": -0.04700581126372982, "outflow_rate_mean": 1052.4104039207068, "system_level_velocity_min": 10.260577237745165, "cost2_min": -0.5513681328945534, "system_level_velocity_max": 20.057875979802187, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 164, "done": false, "episodes_total": 3039, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266898>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266358>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266b70>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 708.3962808906753, "timesteps_this_iter": 38360, "timesteps_total": 6274379, "time_since_restore": 4220.288030385971, "hostname": "flow-main", "episode_reward_min": 50.494057572168984, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 16, "timestamp": 1557188715, "time_this_iter_s": 25.379247188568115, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 164, "date": "2019-05-07_00-25-15", "episode_len_mean": 682.23}
{"timesteps_since_restore": 6312013, "policy_reward_mean": {}, "episode_reward_max": 851.7814561698665, "time_total_s": 4246.591611623764, "info": {"num_steps_sampled": 6312013, "sample_time_ms": 17617.583, "grad_time_ms": 8188.508, "update_time_ms": 8.653, "default": {"kl": 0.01395400706678629, "entropy": 1.315490484237671, "cur_lr": 0.0005000000237487257, "total_loss": 14.05167293548584, "policy_loss": -0.00664606224745512, "vf_explained_var": 0.9406408071517944, "vf_loss": 14.054786682128906, "cur_kl_coeff": 0.2531249523162842}, "num_steps_trained": 6312013, "load_time_ms": 13.224}, "custom_metrics": {"cost1_mean": 337.2600251772775, "outflow_rate_max": 1305.3393305500426, "system_level_velocity_mean": 13.87410762147447, "cost1_min": 26.466456354006656, "cost1_max": 479.25864408631674, "outflow_rate_min": 449.88502780643296, "cost2_mean": -0.0573831848529292, "outflow_rate_mean": 1044.6690215489177, "system_level_velocity_min": 9.521111429833343, "cost2_min": -0.5513681328945534, "system_level_velocity_max": 20.057875979802187, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 165, "done": false, "episodes_total": 3061, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cd68>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cd30>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cf60>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 705.1664071183606, "timesteps_this_iter": 37634, "timesteps_total": 6312013, "time_since_restore": 4246.591611623764, "hostname": "flow-main", "episode_reward_min": 50.494057572168984, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 22, "timestamp": 1557188742, "time_this_iter_s": 26.30358123779297, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 165, "date": "2019-05-07_00-25-42", "episode_len_mean": 677.59}
{"timesteps_since_restore": 6348905, "policy_reward_mean": {}, "episode_reward_max": 851.7814561698665, "time_total_s": 4273.217868566513, "info": {"num_steps_sampled": 6348905, "sample_time_ms": 17537.428, "grad_time_ms": 8203.908, "update_time_ms": 8.748, "default": {"kl": 0.012843746691942215, "entropy": 1.311984896659851, "cur_lr": 0.0005000000237487257, "total_loss": 12.227656364440918, "policy_loss": -0.007899673655629158, "vf_explained_var": 0.9440871477127075, "vf_loss": 12.232304573059082, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 6348905, "load_time_ms": 13.218}, "custom_metrics": {"cost1_mean": 339.5239929416798, "outflow_rate_max": 1256.569570038703, "system_level_velocity_mean": 13.849215751422522, "cost1_min": 26.466456354006656, "cost1_max": 479.25864408631674, "outflow_rate_min": 449.88502780643296, "cost2_mean": -0.07214865859959303, "outflow_rate_mean": 1047.21288342408, "system_level_velocity_min": 9.521111429833343, "cost2_min": -1.2647231224713629, "system_level_velocity_max": 20.057875979802187, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 166, "done": false, "episodes_total": 3081, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c6a0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8ce48>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cdd8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 708.6368134159708, "timesteps_this_iter": 36892, "timesteps_total": 6348905, "time_since_restore": 4273.217868566513, "hostname": "flow-main", "episode_reward_min": 50.494057572168984, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557188768, "time_this_iter_s": 26.626256942749023, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 166, "date": "2019-05-07_00-26-08", "episode_len_mean": 681.89}
{"timesteps_since_restore": 6386232, "policy_reward_mean": {}, "episode_reward_max": 865.7600769476638, "time_total_s": 4299.3919196128845, "info": {"num_steps_sampled": 6386232, "sample_time_ms": 17596.154, "grad_time_ms": 8121.431, "update_time_ms": 8.613, "default": {"kl": 0.012548081576824188, "entropy": 1.33242928981781, "cur_lr": 0.0005000000237487257, "total_loss": 12.946682929992676, "policy_loss": -0.007686618249863386, "vf_explained_var": 0.9351239204406738, "vf_loss": 12.951193809509277, "cur_kl_coeff": 0.2531249523162842}, "num_steps_trained": 6386232, "load_time_ms": 13.204}, "custom_metrics": {"cost1_mean": 336.6642702639604, "outflow_rate_max": 1256.39635937052, "system_level_velocity_mean": 13.765877244974602, "cost1_min": 26.466456354006656, "cost1_max": 450.5142065359382, "outflow_rate_min": 449.88502780643296, "cost2_mean": -0.08447885553154925, "outflow_rate_mean": 1042.910257672976, "system_level_velocity_min": 9.521111429833343, "cost2_min": -1.2647231224713629, "system_level_velocity_max": 19.97225859632461, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 167, "done": false, "episodes_total": 3101, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a550>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233668>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f54062330f0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 703.1527104617027, "timesteps_this_iter": 37327, "timesteps_total": 6386232, "time_since_restore": 4299.3919196128845, "hostname": "flow-main", "episode_reward_min": 50.494057572168984, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557188794, "time_this_iter_s": 26.17405104637146, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 167, "date": "2019-05-07_00-26-34", "episode_len_mean": 680.88}
{"timesteps_since_restore": 6424043, "policy_reward_mean": {}, "episode_reward_max": 865.7600769476638, "time_total_s": 4325.122673034668, "info": {"num_steps_sampled": 6424043, "sample_time_ms": 17518.079, "grad_time_ms": 8229.138, "update_time_ms": 8.225, "default": {"kl": 0.01501933578401804, "entropy": 1.343412160873413, "cur_lr": 0.0005000000237487257, "total_loss": 9.368712425231934, "policy_loss": -0.007737678475677967, "vf_explained_var": 0.9414563179016113, "vf_loss": 9.372649192810059, "cur_kl_coeff": 0.2531249523162842}, "num_steps_trained": 6424043, "load_time_ms": 12.894}, "custom_metrics": {"cost1_mean": 332.4462681044793, "outflow_rate_max": 1256.39635937052, "system_level_velocity_mean": 13.599864324041706, "cost1_min": 31.646250256934184, "cost1_max": 450.5142065359382, "outflow_rate_min": 441.5774206399729, "cost2_mean": -0.08168272080627215, "outflow_rate_mean": 1033.5934534239702, "system_level_velocity_min": 9.521111429833343, "cost2_min": -1.2647231224713629, "system_level_velocity_max": 19.97225859632461, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 168, "done": false, "episodes_total": 3116, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f840b8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84c18>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84898>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 700.2707822977839, "timesteps_this_iter": 37811, "timesteps_total": 6424043, "time_since_restore": 4325.122673034668, "hostname": "flow-main", "episode_reward_min": 49.45637801046813, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 15, "timestamp": 1557188820, "time_this_iter_s": 25.730753421783447, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 168, "date": "2019-05-07_00-27-00", "episode_len_mean": 680.95}
{"timesteps_since_restore": 6462412, "policy_reward_mean": {}, "episode_reward_max": 865.7600769476638, "time_total_s": 4353.195312976837, "info": {"num_steps_sampled": 6462412, "sample_time_ms": 17594.562, "grad_time_ms": 8474.282, "update_time_ms": 8.138, "default": {"kl": 0.0152409877628088, "entropy": 1.3638018369674683, "cur_lr": 0.0005000000237487257, "total_loss": 11.17762279510498, "policy_loss": -0.009737743064761162, "vf_explained_var": 0.9220389127731323, "vf_loss": 11.183504104614258, "cur_kl_coeff": 0.2531249523162842}, "num_steps_trained": 6462412, "load_time_ms": 12.704}, "custom_metrics": {"cost1_mean": 327.4958891075912, "outflow_rate_max": 1256.39635937052, "system_level_velocity_mean": 13.527144152844716, "cost1_min": 25.902193385285663, "cost1_max": 450.5142065359382, "outflow_rate_min": 441.5774206399729, "cost2_mean": -0.07262437290594924, "outflow_rate_mean": 1024.0325747916575, "system_level_velocity_min": 9.521111429833343, "cost2_min": -1.2647231224713629, "system_level_velocity_max": 19.97225859632461, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 169, "done": false, "episodes_total": 3135, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c198>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cda0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cc50>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 695.0889753976505, "timesteps_this_iter": 38369, "timesteps_total": 6462412, "time_since_restore": 4353.195312976837, "hostname": "flow-main", "episode_reward_min": 46.87279743457682, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557188848, "time_this_iter_s": 28.07263994216919, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 169, "date": "2019-05-07_00-27-28", "episode_len_mean": 676.52}
{"timesteps_since_restore": 6499609, "policy_reward_mean": {}, "episode_reward_max": 865.7600769476638, "time_total_s": 4379.59258723259, "info": {"num_steps_sampled": 6499609, "sample_time_ms": 17603.943, "grad_time_ms": 8526.404, "update_time_ms": 8.136, "default": {"kl": 0.014205886982381344, "entropy": 1.3163652420043945, "cur_lr": 0.0005000000237487257, "total_loss": 15.172882080078125, "policy_loss": -0.007856415584683418, "vf_explained_var": 0.9357668161392212, "vf_loss": 15.177142143249512, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 6499609, "load_time_ms": 12.414}, "custom_metrics": {"cost1_mean": 328.8872086945832, "outflow_rate_max": 1256.39635937052, "system_level_velocity_mean": 13.600417068750424, "cost1_min": 25.902193385285663, "cost1_max": 450.5142065359382, "outflow_rate_min": 441.5774206399729, "cost2_mean": -0.061503062696317085, "outflow_rate_mean": 1026.2640667360452, "system_level_velocity_min": 10.760716135381035, "cost2_min": -1.2647231224713629, "system_level_velocity_max": 19.97225859632461, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 170, "done": false, "episodes_total": 3155, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8ccf8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cb38>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c908>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 697.3515074698897, "timesteps_this_iter": 37197, "timesteps_total": 6499609, "time_since_restore": 4379.59258723259, "hostname": "flow-main", "episode_reward_min": 46.87279743457682, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557188875, "time_this_iter_s": 26.397274255752563, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 170, "date": "2019-05-07_00-27-55", "episode_len_mean": 675.44}
{"timesteps_since_restore": 6537893, "policy_reward_mean": {}, "episode_reward_max": 891.9794684923105, "time_total_s": 4405.856302022934, "info": {"num_steps_sampled": 6537893, "sample_time_ms": 17560.371, "grad_time_ms": 8622.842, "update_time_ms": 7.841, "default": {"kl": 0.015234624966979027, "entropy": 1.3198459148406982, "cur_lr": 0.0005000000237487257, "total_loss": 13.619624137878418, "policy_loss": -0.008993840776383877, "vf_explained_var": 0.9419151544570923, "vf_loss": 13.624761581420898, "cur_kl_coeff": 0.2531249523162842}, "num_steps_trained": 6537893, "load_time_ms": 12.227}, "custom_metrics": {"cost1_mean": 331.1118733337234, "outflow_rate_max": 1286.8336912411748, "system_level_velocity_mean": 13.82634176572152, "cost1_min": 25.902193385285663, "cost1_max": 471.3300832288395, "outflow_rate_min": 441.5774206399729, "cost2_mean": -0.03543559824148248, "outflow_rate_mean": 1031.7395236854063, "system_level_velocity_min": 10.760716135381035, "cost2_min": -0.6378252426166313, "system_level_velocity_max": 19.97225859632461, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 171, "done": false, "episodes_total": 3175, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c710>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c898>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c128>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 696.6992864992087, "timesteps_this_iter": 38284, "timesteps_total": 6537893, "time_since_restore": 4405.856302022934, "hostname": "flow-main", "episode_reward_min": 46.87279743457682, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557188901, "time_this_iter_s": 26.26371479034424, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 171, "date": "2019-05-07_00-28-21", "episode_len_mean": 669.94}
{"timesteps_since_restore": 6574647, "policy_reward_mean": {}, "episode_reward_max": 894.1577972008489, "time_total_s": 4431.296348571777, "info": {"num_steps_sampled": 6574647, "sample_time_ms": 17421.217, "grad_time_ms": 8678.891, "update_time_ms": 8.1, "default": {"kl": 0.014345891773700714, "entropy": 1.2976316213607788, "cur_lr": 0.0005000000237487257, "total_loss": 14.18449592590332, "policy_loss": -0.009256897494196892, "vf_explained_var": 0.9389874935150146, "vf_loss": 14.190120697021484, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 6574647, "load_time_ms": 12.139}, "custom_metrics": {"cost1_mean": 332.8784436380895, "outflow_rate_max": 1286.8336912411748, "system_level_velocity_mean": 13.89133453409018, "cost1_min": 25.902193385285663, "cost1_max": 477.6700257817082, "outflow_rate_min": 441.5774206399729, "cost2_mean": -0.030911433801698574, "outflow_rate_mean": 1034.3880163191034, "system_level_velocity_min": 10.887399769440242, "cost2_min": -0.6378252426166313, "system_level_velocity_max": 19.861487472304713, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 172, "done": false, "episodes_total": 3195, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84470>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84a58>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f840b8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 703.7858142106453, "timesteps_this_iter": 36754, "timesteps_total": 6574647, "time_since_restore": 4431.296348571777, "hostname": "flow-main", "episode_reward_min": 46.87279743457682, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557188927, "time_this_iter_s": 25.440046548843384, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 172, "date": "2019-05-07_00-28-47", "episode_len_mean": 670.1}
{"timesteps_since_restore": 6611422, "policy_reward_mean": {}, "episode_reward_max": 894.1577972008489, "time_total_s": 4457.089865684509, "info": {"num_steps_sampled": 6611422, "sample_time_ms": 17434.626, "grad_time_ms": 8680.404, "update_time_ms": 8.074, "default": {"kl": 0.015481214039027691, "entropy": 1.3262711763381958, "cur_lr": 0.0005000000237487257, "total_loss": 14.927942276000977, "policy_loss": -0.01107034645974636, "vf_explained_var": 0.9389469027519226, "vf_loss": 14.93509292602539, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 6611422, "load_time_ms": 11.741}, "custom_metrics": {"cost1_mean": 333.7569463265448, "outflow_rate_max": 1286.8336912411748, "system_level_velocity_mean": 14.04926003513317, "cost1_min": 25.902193385285663, "cost1_max": 477.6700257817082, "outflow_rate_min": 443.2983766628436, "cost2_mean": -0.018634528312560246, "outflow_rate_mean": 1037.619455130573, "system_level_velocity_min": 10.887399769440242, "cost2_min": -0.3032085807113142, "system_level_velocity_max": 20.046753758255743, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 173, "done": false, "episodes_total": 3215, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f898>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f160>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f710>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 700.3021620664289, "timesteps_this_iter": 36775, "timesteps_total": 6611422, "time_since_restore": 4457.089865684509, "hostname": "flow-main", "episode_reward_min": 46.87279743457682, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557188952, "time_this_iter_s": 25.793517112731934, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 173, "date": "2019-05-07_00-29-12", "episode_len_mean": 665.88}
{"timesteps_since_restore": 6648395, "policy_reward_mean": {}, "episode_reward_max": 894.1577972008489, "time_total_s": 4482.088401079178, "info": {"num_steps_sampled": 6648395, "sample_time_ms": 17370.226, "grad_time_ms": 8708.71, "update_time_ms": 8.15, "default": {"kl": 0.014929761178791523, "entropy": 1.3402557373046875, "cur_lr": 0.0005000000237487257, "total_loss": 13.17271614074707, "policy_loss": -0.008710562251508236, "vf_explained_var": 0.9414408206939697, "vf_loss": 13.177647590637207, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 6648395, "load_time_ms": 11.417}, "custom_metrics": {"cost1_mean": 343.24575901350005, "outflow_rate_max": 1286.8336912411748, "system_level_velocity_mean": 14.232264695037932, "cost1_min": 90.68830584473562, "cost1_max": 503.74380761425925, "outflow_rate_min": 660.4887249518509, "cost2_mean": -0.02033009810131391, "outflow_rate_mean": 1054.7652775470178, "system_level_velocity_min": 10.887399769440242, "cost2_min": -0.3032085807113142, "system_level_velocity_max": 20.046753758255743, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 174, "done": false, "episodes_total": 3233, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233a90>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233198>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233320>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 708.7135293495852, "timesteps_this_iter": 36973, "timesteps_total": 6648395, "time_since_restore": 4482.088401079178, "hostname": "flow-main", "episode_reward_min": 143.10792239856042, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557188977, "time_this_iter_s": 24.99853539466858, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 174, "date": "2019-05-07_00-29-37", "episode_len_mean": 672.5}
{"timesteps_since_restore": 6685786, "policy_reward_mean": {}, "episode_reward_max": 894.1577972008489, "time_total_s": 4506.491896152496, "info": {"num_steps_sampled": 6685786, "sample_time_ms": 17158.225, "grad_time_ms": 8731.36, "update_time_ms": 8.304, "default": {"kl": 0.015228674747049809, "entropy": 1.3074017763137817, "cur_lr": 0.0005000000237487257, "total_loss": 13.888547897338867, "policy_loss": -0.007548050489276648, "vf_explained_var": 0.9489706158638, "vf_loss": 13.892242431640625, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 6685786, "load_time_ms": 11.264}, "custom_metrics": {"cost1_mean": 351.79366054388754, "outflow_rate_max": 1286.8336912411748, "system_level_velocity_mean": 14.41094913226692, "cost1_min": 104.29775618908081, "cost1_max": 509.77037087242405, "outflow_rate_min": 661.7438926548908, "cost2_mean": -0.030677196209425713, "outflow_rate_mean": 1066.113774335276, "system_level_velocity_min": 10.718713270726374, "cost2_min": -0.43021271682362316, "system_level_velocity_max": 20.046753758255743, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 175, "done": false, "episodes_total": 3251, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f846d8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84f28>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84860>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 718.8500438618429, "timesteps_this_iter": 37391, "timesteps_total": 6685786, "time_since_restore": 4506.491896152496, "hostname": "flow-main", "episode_reward_min": 190.29375619201852, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557189002, "time_this_iter_s": 24.40349507331848, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 175, "date": "2019-05-07_00-30-02", "episode_len_mean": 678.22}
{"timesteps_since_restore": 6722562, "policy_reward_mean": {}, "episode_reward_max": 930.2853290376911, "time_total_s": 4532.228777885437, "info": {"num_steps_sampled": 6722562, "sample_time_ms": 17045.078, "grad_time_ms": 8756.004, "update_time_ms": 8.321, "default": {"kl": 0.015010124072432518, "entropy": 1.3032656908035278, "cur_lr": 0.0005000000237487257, "total_loss": 14.336507797241211, "policy_loss": -0.007577229756861925, "vf_explained_var": 0.9463357329368591, "vf_loss": 14.340286254882812, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 6722562, "load_time_ms": 11.187}, "custom_metrics": {"cost1_mean": 347.23463267050937, "outflow_rate_max": 1304.7098096037046, "system_level_velocity_mean": 14.453031023658836, "cost1_min": 29.926234363683495, "cost1_max": 521.3780164421112, "outflow_rate_min": 447.4818926947498, "cost2_mean": -0.045878835248299416, "outflow_rate_mean": 1055.695239458338, "system_level_velocity_min": 10.156026817127508, "cost2_min": -0.8527772389335648, "system_level_velocity_max": 20.43292781809407, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 176, "done": false, "episodes_total": 3272, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062666a0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266ba8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266518>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 713.0474649192852, "timesteps_this_iter": 36776, "timesteps_total": 6722562, "time_since_restore": 4532.228777885437, "hostname": "flow-main", "episode_reward_min": 49.34152126255727, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557189028, "time_this_iter_s": 25.736881732940674, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 176, "date": "2019-05-07_00-30-28", "episode_len_mean": 670.65}
{"timesteps_since_restore": 6759714, "policy_reward_mean": {}, "episode_reward_max": 930.2853290376911, "time_total_s": 4558.506870508194, "info": {"num_steps_sampled": 6759714, "sample_time_ms": 16953.254, "grad_time_ms": 8855.576, "update_time_ms": 8.563, "default": {"kl": 0.015543697401881218, "entropy": 1.3729300498962402, "cur_lr": 0.0005000000237487257, "total_loss": 12.958436965942383, "policy_loss": -0.00962246023118496, "vf_explained_var": 0.9251664876937866, "vf_loss": 12.96412467956543, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 6759714, "load_time_ms": 11.005}, "custom_metrics": {"cost1_mean": 345.8852626892895, "outflow_rate_max": 1304.7098096037046, "system_level_velocity_mean": 14.385809552602149, "cost1_min": 29.926234363683495, "cost1_max": 521.3780164421112, "outflow_rate_min": 447.4818926947498, "cost2_mean": -0.047844641710877295, "outflow_rate_mean": 1055.07996606538, "system_level_velocity_min": 10.156026817127508, "cost2_min": -0.8527772389335648, "system_level_velocity_max": 20.43292781809407, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 177, "done": false, "episodes_total": 3291, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f849e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84eb8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f845c0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 712.30619979901, "timesteps_this_iter": 37152, "timesteps_total": 6759714, "time_since_restore": 4558.506870508194, "hostname": "flow-main", "episode_reward_min": 49.34152126255727, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557189054, "time_this_iter_s": 26.278092622756958, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 177, "date": "2019-05-07_00-30-54", "episode_len_mean": 671.54}
{"timesteps_since_restore": 6797759, "policy_reward_mean": {}, "episode_reward_max": 930.2853290376911, "time_total_s": 4584.293691635132, "info": {"num_steps_sampled": 6797759, "sample_time_ms": 16914.32, "grad_time_ms": 8897.65, "update_time_ms": 8.653, "default": {"kl": 0.014809663407504559, "entropy": 1.3823448419570923, "cur_lr": 0.0005000000237487257, "total_loss": 11.13542366027832, "policy_loss": -0.007488623261451721, "vf_explained_var": 0.9304904341697693, "vf_loss": 11.13916301727295, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 6797759, "load_time_ms": 11.018}, "custom_metrics": {"cost1_mean": 340.8880457394602, "outflow_rate_max": 1304.7098096037046, "system_level_velocity_mean": 14.228159320102144, "cost1_min": 29.82452478518664, "cost1_max": 521.3780164421112, "outflow_rate_min": 447.4818926947498, "cost2_mean": -0.05856293773080081, "outflow_rate_mean": 1044.6353545499298, "system_level_velocity_min": 10.156026817127508, "cost2_min": -1.0, "system_level_velocity_max": 20.43292781809407, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 178, "done": false, "episodes_total": 3309, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625af98>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a9e8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a860>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 710.5538340506215, "timesteps_this_iter": 38045, "timesteps_total": 6797759, "time_since_restore": 4584.293691635132, "hostname": "flow-main", "episode_reward_min": 48.47214629408757, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557189080, "time_this_iter_s": 25.786821126937866, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 178, "date": "2019-05-07_00-31-20", "episode_len_mean": 670.36}
{"timesteps_since_restore": 6835358, "policy_reward_mean": {}, "episode_reward_max": 930.2853290376911, "time_total_s": 4610.267043828964, "info": {"num_steps_sampled": 6835358, "sample_time_ms": 16765.554, "grad_time_ms": 8835.82, "update_time_ms": 8.708, "default": {"kl": 0.014489056542515755, "entropy": 1.3667478561401367, "cur_lr": 0.0005000000237487257, "total_loss": 10.8975191116333, "policy_loss": -0.008527485653758049, "vf_explained_var": 0.9427894353866577, "vf_loss": 10.902379989624023, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 6835358, "load_time_ms": 11.153}, "custom_metrics": {"cost1_mean": 338.14582283933544, "outflow_rate_max": 1304.7098096037046, "system_level_velocity_mean": 13.97163301168975, "cost1_min": 29.82452478518664, "cost1_max": 521.3780164421112, "outflow_rate_min": 447.4818926947498, "cost2_mean": -0.07702411068697224, "outflow_rate_mean": 1040.261596050979, "system_level_velocity_min": 10.156026817127508, "cost2_min": -1.0, "system_level_velocity_max": 20.43292781809407, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 179, "done": false, "episodes_total": 3327, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f6d8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a978>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f6a0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 713.809212970442, "timesteps_this_iter": 37599, "timesteps_total": 6835358, "time_since_restore": 4610.267043828964, "hostname": "flow-main", "episode_reward_min": 48.47214629408757, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557189106, "time_this_iter_s": 25.973352193832397, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 179, "date": "2019-05-07_00-31-46", "episode_len_mean": 675.73}
{"timesteps_since_restore": 6872251, "policy_reward_mean": {}, "episode_reward_max": 930.2853290376911, "time_total_s": 4636.883934497833, "info": {"num_steps_sampled": 6872251, "sample_time_ms": 16746.618, "grad_time_ms": 8874.482, "update_time_ms": 8.91, "default": {"kl": 0.014292152598500252, "entropy": 1.322184681892395, "cur_lr": 0.0005000000237487257, "total_loss": 15.528209686279297, "policy_loss": -0.007472734432667494, "vf_explained_var": 0.9354792833328247, "vf_loss": 15.532063484191895, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 6872251, "load_time_ms": 11.286}, "custom_metrics": {"cost1_mean": 324.53987900451773, "outflow_rate_max": 1304.7098096037046, "system_level_velocity_mean": 14.126977886115139, "cost1_min": 23.61460635601692, "cost1_max": 521.3780164421112, "outflow_rate_min": 429.9650555148513, "cost2_mean": -0.07634028770552183, "outflow_rate_mean": 1020.0326761127269, "system_level_velocity_min": 10.156026817127508, "cost2_min": -1.0, "system_level_velocity_max": 20.43292781809407, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 180, "done": false, "episodes_total": 3348, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266d30>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266828>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266198>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 688.3001163726897, "timesteps_this_iter": 36893, "timesteps_total": 6872251, "time_since_restore": 4636.883934497833, "hostname": "flow-main", "episode_reward_min": 46.51260002566241, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557189132, "time_this_iter_s": 26.61689066886902, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 180, "date": "2019-05-07_00-32-12", "episode_len_mean": 651.22}
{"timesteps_since_restore": 6909594, "policy_reward_mean": {}, "episode_reward_max": 930.2853290376911, "time_total_s": 4664.438242197037, "info": {"num_steps_sampled": 6909594, "sample_time_ms": 16764.508, "grad_time_ms": 8984.406, "update_time_ms": 9.144, "default": {"kl": 0.015009644441306591, "entropy": 1.3275521993637085, "cur_lr": 0.0005000000237487257, "total_loss": 13.787099838256836, "policy_loss": -0.009382638148963451, "vf_explained_var": 0.9438592195510864, "vf_loss": 13.792684555053711, "cur_kl_coeff": 0.2531249523162842}, "num_steps_trained": 6909594, "load_time_ms": 11.466}, "custom_metrics": {"cost1_mean": 328.8750802616636, "outflow_rate_max": 1304.7098096037046, "system_level_velocity_mean": 13.927807221153648, "cost1_min": 23.61460635601692, "cost1_max": 506.71871323104085, "outflow_rate_min": 429.9650555148513, "cost2_mean": -0.06991455290085194, "outflow_rate_mean": 1027.9349274347278, "system_level_velocity_min": 10.156026817127508, "cost2_min": -1.0, "system_level_velocity_max": 19.883438912914393, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 181, "done": false, "episodes_total": 3369, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84d30>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84470>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84be0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 697.9500249261655, "timesteps_this_iter": 37343, "timesteps_total": 6909594, "time_since_restore": 4664.438242197037, "hostname": "flow-main", "episode_reward_min": 46.51260002566241, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 21, "timestamp": 1557189160, "time_this_iter_s": 27.55430769920349, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 181, "date": "2019-05-07_00-32-40", "episode_len_mean": 664.29}
{"timesteps_since_restore": 6947611, "policy_reward_mean": {}, "episode_reward_max": 904.0988321080557, "time_total_s": 4691.128031730652, "info": {"num_steps_sampled": 6947611, "sample_time_ms": 16762.613, "grad_time_ms": 9110.391, "update_time_ms": 9.087, "default": {"kl": 0.015164417214691639, "entropy": 1.3808903694152832, "cur_lr": 0.0005000000237487257, "total_loss": 11.704362869262695, "policy_loss": -0.011013813316822052, "vf_explained_var": 0.9363863468170166, "vf_loss": 11.711538314819336, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 6947611, "load_time_ms": 11.811}, "custom_metrics": {"cost1_mean": 324.4751269506894, "outflow_rate_max": 1299.7773244230352, "system_level_velocity_mean": 14.15356020692375, "cost1_min": 22.170331678782468, "cost1_max": 506.71871323104085, "outflow_rate_min": 429.9650555148513, "cost2_mean": -0.07444463404462719, "outflow_rate_mean": 1018.6080224117628, "system_level_velocity_min": 10.315558251339796, "cost2_min": -1.0029604416154314, "system_level_velocity_max": 20.02710713039798, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 182, "done": false, "episodes_total": 3389, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625a9e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625af98>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625aac8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 683.4594822407879, "timesteps_this_iter": 38017, "timesteps_total": 6947611, "time_since_restore": 4691.128031730652, "hostname": "flow-main", "episode_reward_min": 43.61439383905245, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557189187, "time_this_iter_s": 26.689789533615112, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 182, "date": "2019-05-07_00-33-07", "episode_len_mean": 650.07}
{"timesteps_since_restore": 6984638, "policy_reward_mean": {}, "episode_reward_max": 904.0988321080557, "time_total_s": 4717.169483184814, "info": {"num_steps_sampled": 6984638, "sample_time_ms": 16754.479, "grad_time_ms": 9141.968, "update_time_ms": 9.17, "default": {"kl": 0.015793727710843086, "entropy": 1.3409935235977173, "cur_lr": 0.0005000000237487257, "total_loss": 11.571403503417969, "policy_loss": -0.009357173927128315, "vf_explained_var": 0.9543845653533936, "vf_loss": 11.576763153076172, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 6984638, "load_time_ms": 12.146}, "custom_metrics": {"cost1_mean": 329.0998636644849, "outflow_rate_max": 1299.7773244230352, "system_level_velocity_mean": 14.14594101795466, "cost1_min": 22.170331678782468, "cost1_max": 506.71871323104085, "outflow_rate_min": 429.9650555148513, "cost2_mean": -0.06879590777186546, "outflow_rate_mean": 1025.7166863003636, "system_level_velocity_min": 10.30366006232716, "cost2_min": -1.0029604416154314, "system_level_velocity_max": 20.02710713039798, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 183, "done": false, "episodes_total": 3407, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625feb8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625fe10>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f198>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 688.4428236418047, "timesteps_this_iter": 37027, "timesteps_total": 6984638, "time_since_restore": 4717.169483184814, "hostname": "flow-main", "episode_reward_min": 43.61439383905245, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 18, "timestamp": 1557189213, "time_this_iter_s": 26.041451454162598, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 183, "date": "2019-05-07_00-33-33", "episode_len_mean": 656.64}
{"timesteps_since_restore": 7022251, "policy_reward_mean": {}, "episode_reward_max": 904.0988321080557, "time_total_s": 4743.3620183467865, "info": {"num_steps_sampled": 7022251, "sample_time_ms": 16833.187, "grad_time_ms": 9181.302, "update_time_ms": 9.244, "default": {"kl": 0.01744072698056698, "entropy": 1.3474587202072144, "cur_lr": 0.0005000000237487257, "total_loss": 13.067219734191895, "policy_loss": -0.010111172683537006, "vf_explained_var": 0.9511672854423523, "vf_loss": 13.072916030883789, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 7022251, "load_time_ms": 12.378}, "custom_metrics": {"cost1_mean": 334.064637699214, "outflow_rate_max": 1299.7773244230352, "system_level_velocity_mean": 14.524374037500051, "cost1_min": 22.170331678782468, "cost1_max": 513.1753430925851, "outflow_rate_min": 429.9650555148513, "cost2_mean": -0.0731002974440721, "outflow_rate_mean": 1034.1649387749574, "system_level_velocity_min": 10.30366006232716, "cost2_min": -2.2851046101687578, "system_level_velocity_max": 20.1517077419784, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 184, "done": false, "episodes_total": 3429, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233320>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233668>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233be0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 687.9189793166225, "timesteps_this_iter": 37613, "timesteps_total": 7022251, "time_since_restore": 4743.3620183467865, "hostname": "flow-main", "episode_reward_min": 43.61439383905245, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 22, "timestamp": 1557189239, "time_this_iter_s": 26.192535161972046, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 184, "date": "2019-05-07_00-33-59", "episode_len_mean": 650.05}
{"timesteps_since_restore": 7059785, "policy_reward_mean": {}, "episode_reward_max": 889.4566984120555, "time_total_s": 4769.411103487015, "info": {"num_steps_sampled": 7059785, "sample_time_ms": 16935.692, "grad_time_ms": 9242.69, "update_time_ms": 9.279, "default": {"kl": 0.01474340446293354, "entropy": 1.400062084197998, "cur_lr": 0.0005000000237487257, "total_loss": 10.155906677246094, "policy_loss": -0.008096697740256786, "vf_explained_var": 0.947898805141449, "vf_loss": 10.160271644592285, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 7059785, "load_time_ms": 12.027}, "custom_metrics": {"cost1_mean": 347.1038426106424, "outflow_rate_max": 1303.006047753319, "system_level_velocity_mean": 14.349396447782519, "cost1_min": 22.170331678782468, "cost1_max": 513.1753430925851, "outflow_rate_min": 438.76457441503055, "cost2_mean": -0.06313293485570164, "outflow_rate_mean": 1057.3112562117765, "system_level_velocity_min": 10.30366006232716, "cost2_min": -2.2851046101687578, "system_level_velocity_max": 20.1517077419784, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 185, "done": false, "episodes_total": 3445, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80ac8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f802b0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f805c0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 709.4139216415248, "timesteps_this_iter": 37534, "timesteps_total": 7059785, "time_since_restore": 4769.411103487015, "hostname": "flow-main", "episode_reward_min": 43.61439383905245, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 16, "timestamp": 1557189265, "time_this_iter_s": 26.04908514022827, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 185, "date": "2019-05-07_00-34-25", "episode_len_mean": 674.56}
{"timesteps_since_restore": 7097504, "policy_reward_mean": {}, "episode_reward_max": 889.4566984120555, "time_total_s": 4796.459724187851, "info": {"num_steps_sampled": 7097504, "sample_time_ms": 17008.288, "grad_time_ms": 9301.745, "update_time_ms": 9.224, "default": {"kl": 0.015589272603392601, "entropy": 1.4196592569351196, "cur_lr": 0.0005000000237487257, "total_loss": 13.931120872497559, "policy_loss": -0.009597063064575195, "vf_explained_var": 0.9301340579986572, "vf_loss": 13.936772346496582, "cur_kl_coeff": 0.2531249523162842}, "num_steps_trained": 7097504, "load_time_ms": 12.35}, "custom_metrics": {"cost1_mean": 337.89700355378324, "outflow_rate_max": 1303.006047753319, "system_level_velocity_mean": 14.282961750573547, "cost1_min": 22.170331678782468, "cost1_max": 513.1753430925851, "outflow_rate_min": 412.4627416656092, "cost2_mean": -0.057207641084935805, "outflow_rate_mean": 1042.3567650848884, "system_level_velocity_min": 10.30366006232716, "cost2_min": -2.2851046101687578, "system_level_velocity_max": 20.1517077419784, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 186, "done": false, "episodes_total": 3465, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233d68>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233c88>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233b38>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 693.1893845485815, "timesteps_this_iter": 37719, "timesteps_total": 7097504, "time_since_restore": 4796.459724187851, "hostname": "flow-main", "episode_reward_min": 43.61439383905245, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557189292, "time_this_iter_s": 27.04862070083618, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 186, "date": "2019-05-07_00-34-52", "episode_len_mean": 663.65}
{"timesteps_since_restore": 7134745, "policy_reward_mean": {}, "episode_reward_max": 889.4566984120555, "time_total_s": 4821.746516704559, "info": {"num_steps_sampled": 7134745, "sample_time_ms": 16916.239, "grad_time_ms": 9297.176, "update_time_ms": 8.927, "default": {"kl": 0.015834156423807144, "entropy": 1.4209380149841309, "cur_lr": 0.0005000000237487257, "total_loss": 12.617491722106934, "policy_loss": -0.010104678571224213, "vf_explained_var": 0.9421276450157166, "vf_loss": 12.623588562011719, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 7134745, "load_time_ms": 12.338}, "custom_metrics": {"cost1_mean": 339.98626751391566, "outflow_rate_max": 1303.006047753319, "system_level_velocity_mean": 14.16556783843835, "cost1_min": 25.094302611781288, "cost1_max": 513.1753430925851, "outflow_rate_min": 412.4627416656092, "cost2_mean": -0.046776109345673896, "outflow_rate_mean": 1046.090279905578, "system_level_velocity_min": 10.30366006232716, "cost2_min": -2.2851046101687578, "system_level_velocity_max": 20.1517077419784, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 187, "done": false, "episodes_total": 3485, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625fb00>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f390>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625fbe0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 701.3418584998441, "timesteps_this_iter": 37241, "timesteps_total": 7134745, "time_since_restore": 4821.746516704559, "hostname": "flow-main", "episode_reward_min": 48.79973852226298, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557189317, "time_this_iter_s": 25.286792516708374, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 187, "date": "2019-05-07_00-35-17", "episode_len_mean": 670.66}
{"timesteps_since_restore": 7172378, "policy_reward_mean": {}, "episode_reward_max": 889.4566984120555, "time_total_s": 4847.4500644207, "info": {"num_steps_sampled": 7172378, "sample_time_ms": 16883.246, "grad_time_ms": 9320.833, "update_time_ms": 8.847, "default": {"kl": 0.01685052178800106, "entropy": 1.4273737668991089, "cur_lr": 0.0005000000237487257, "total_loss": 16.591922760009766, "policy_loss": -0.010038360022008419, "vf_explained_var": 0.9250664710998535, "vf_loss": 16.59769630432129, "cur_kl_coeff": 0.2531249523162842}, "num_steps_trained": 7172378, "load_time_ms": 12.494}, "custom_metrics": {"cost1_mean": 336.5687593077164, "outflow_rate_max": 1303.006047753319, "system_level_velocity_mean": 14.375047029335047, "cost1_min": 25.094302611781288, "cost1_max": 513.1753430925851, "outflow_rate_min": 392.3180559078364, "cost2_mean": -0.05699060076799543, "outflow_rate_mean": 1040.627925262489, "system_level_velocity_min": 10.401354874262445, "cost2_min": -2.2851046101687578, "system_level_velocity_max": 20.1517077419784, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 188, "done": false, "episodes_total": 3508, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f804e0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80f60>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80860>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 689.7761431439784, "timesteps_this_iter": 37633, "timesteps_total": 7172378, "time_since_restore": 4847.4500644207, "hostname": "flow-main", "episode_reward_min": 48.79973852226298, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 23, "timestamp": 1557189343, "time_this_iter_s": 25.703547716140747, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 188, "date": "2019-05-07_00-35-43", "episode_len_mean": 657.56}
{"timesteps_since_restore": 7208896, "policy_reward_mean": {}, "episode_reward_max": 898.6741734192864, "time_total_s": 4871.376352310181, "info": {"num_steps_sampled": 7208896, "sample_time_ms": 16741.474, "grad_time_ms": 9255.694, "update_time_ms": 8.786, "default": {"kl": 0.014452964067459106, "entropy": 1.4219210147857666, "cur_lr": 0.0005000000237487257, "total_loss": 13.885533332824707, "policy_loss": -0.010313416831195354, "vf_explained_var": 0.9491041898727417, "vf_loss": 13.89218807220459, "cur_kl_coeff": 0.2531249523162842}, "num_steps_trained": 7208896, "load_time_ms": 12.706}, "custom_metrics": {"cost1_mean": 330.7051842787538, "outflow_rate_max": 1303.006047753319, "system_level_velocity_mean": 14.308579626146596, "cost1_min": 18.882533845813402, "cost1_max": 497.28007238576305, "outflow_rate_min": 392.3180559078364, "cost2_mean": -0.03562267894194802, "outflow_rate_mean": 1028.6915300018723, "system_level_velocity_min": 10.905385955513264, "cost2_min": -0.3907039604237398, "system_level_velocity_max": 20.1383137870451, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 189, "done": false, "episodes_total": 3528, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80198>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80278>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f802b0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 682.7402287901396, "timesteps_this_iter": 36518, "timesteps_total": 7208896, "time_since_restore": 4871.376352310181, "hostname": "flow-main", "episode_reward_min": 37.76506769162681, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557189367, "time_this_iter_s": 23.92628788948059, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 189, "date": "2019-05-07_00-36-07", "episode_len_mean": 650.9}
{"timesteps_since_restore": 7245187, "policy_reward_mean": {}, "episode_reward_max": 898.6741734192864, "time_total_s": 4896.255700588226, "info": {"num_steps_sampled": 7245187, "sample_time_ms": 16553.911, "grad_time_ms": 9272.365, "update_time_ms": 8.618, "default": {"kl": 0.015333002433180809, "entropy": 1.4049757719039917, "cur_lr": 0.0005000000237487257, "total_loss": 10.893401145935059, "policy_loss": -0.008901829831302166, "vf_explained_var": 0.9603148698806763, "vf_loss": 10.898422241210938, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 7245187, "load_time_ms": 12.612}, "custom_metrics": {"cost1_mean": 334.6893156519832, "outflow_rate_max": 1328.6353152597967, "system_level_velocity_mean": 14.327600088331813, "cost1_min": 18.882533845813402, "cost1_max": 497.28007238576305, "outflow_rate_min": 392.3180559078364, "cost2_mean": -0.04403931910804184, "outflow_rate_mean": 1035.0962181120158, "system_level_velocity_min": 10.905385955513264, "cost2_min": -0.504393730578131, "system_level_velocity_max": 19.916373111576007, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 190, "done": false, "episodes_total": 3548, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233e48>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233198>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233390>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 687.2451758029912, "timesteps_this_iter": 36291, "timesteps_total": 7245187, "time_since_restore": 4896.255700588226, "hostname": "flow-main", "episode_reward_min": 37.76506769162681, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557189392, "time_this_iter_s": 24.879348278045654, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 190, "date": "2019-05-07_00-36-32", "episode_len_mean": 655.18}
{"timesteps_since_restore": 7282733, "policy_reward_mean": {}, "episode_reward_max": 898.6741734192864, "time_total_s": 4921.891530275345, "info": {"num_steps_sampled": 7282733, "sample_time_ms": 16382.578, "grad_time_ms": 9252.597, "update_time_ms": 8.489, "default": {"kl": 0.017068563029170036, "entropy": 1.4438010454177856, "cur_lr": 0.0005000000237487257, "total_loss": 12.696078300476074, "policy_loss": -0.008711131289601326, "vf_explained_var": 0.9358605146408081, "vf_loss": 12.700469017028809, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 7282733, "load_time_ms": 12.608}, "custom_metrics": {"cost1_mean": 335.92412651638006, "outflow_rate_max": 1328.6353152597967, "system_level_velocity_mean": 14.577974102623696, "cost1_min": 18.882533845813402, "cost1_max": 503.5045944902023, "outflow_rate_min": 392.3180559078364, "cost2_mean": -0.04482464139125084, "outflow_rate_mean": 1034.2906687324496, "system_level_velocity_min": 10.905385955513264, "cost2_min": -0.504393730578131, "system_level_velocity_max": 19.916373111576007, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 191, "done": false, "episodes_total": 3568, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f438>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625f390>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540625fcf8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 680.2382448394438, "timesteps_this_iter": 37546, "timesteps_total": 7282733, "time_since_restore": 4921.891530275345, "hostname": "flow-main", "episode_reward_min": 37.76506769162681, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557189418, "time_this_iter_s": 25.63582968711853, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 191, "date": "2019-05-07_00-36-58", "episode_len_mean": 648.51}
{"timesteps_since_restore": 7320421, "policy_reward_mean": {}, "episode_reward_max": 898.6741734192864, "time_total_s": 4947.676347255707, "info": {"num_steps_sampled": 7320421, "sample_time_ms": 16350.498, "grad_time_ms": 9195.524, "update_time_ms": 8.547, "default": {"kl": 0.016589593142271042, "entropy": 1.4386003017425537, "cur_lr": 0.0005000000237487257, "total_loss": 11.542725563049316, "policy_loss": -0.008593744598329067, "vf_explained_var": 0.9385034441947937, "vf_loss": 11.547119140625, "cur_kl_coeff": 0.2531249523162842}, "num_steps_trained": 7320421, "load_time_ms": 12.173}, "custom_metrics": {"cost1_mean": 333.7349155928774, "outflow_rate_max": 1328.6353152597967, "system_level_velocity_mean": 14.5213808784386, "cost1_min": 18.882533845813402, "cost1_max": 503.5045944902023, "outflow_rate_min": 392.3180559078364, "cost2_mean": -0.040733390421171266, "outflow_rate_mean": 1029.066317503846, "system_level_velocity_min": 10.905385955513264, "cost2_min": -0.504393730578131, "system_level_velocity_max": 19.916373111576007, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 192, "done": false, "episodes_total": 3588, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84668>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84be0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f84710>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 681.953113283664, "timesteps_this_iter": 37688, "timesteps_total": 7320421, "time_since_restore": 4947.676347255707, "hostname": "flow-main", "episode_reward_min": 37.76506769162681, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557189444, "time_this_iter_s": 25.78481698036194, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 192, "date": "2019-05-07_00-37-24", "episode_len_mean": 647.14}
{"timesteps_since_restore": 7357615, "policy_reward_mean": {}, "episode_reward_max": 898.6741734192864, "time_total_s": 4973.891632080078, "info": {"num_steps_sampled": 7357615, "sample_time_ms": 16236.887, "grad_time_ms": 9325.783, "update_time_ms": 8.578, "default": {"kl": 0.014556790702044964, "entropy": 1.4063063859939575, "cur_lr": 0.0005000000237487257, "total_loss": 13.049151420593262, "policy_loss": -0.009700876660645008, "vf_explained_var": 0.9488781094551086, "vf_loss": 13.055167198181152, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 7357615, "load_time_ms": 12.427}, "custom_metrics": {"cost1_mean": 341.4670453323116, "outflow_rate_max": 1328.6353152597967, "system_level_velocity_mean": 14.635629540825773, "cost1_min": 18.882533845813402, "cost1_max": 503.5045944902023, "outflow_rate_min": 428.6895618632986, "cost2_mean": -0.03163168868530316, "outflow_rate_mean": 1043.7857923929978, "system_level_velocity_min": 10.905385955513264, "cost2_min": -0.504393730578131, "system_level_velocity_max": 19.871290863793604, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 193, "done": false, "episodes_total": 3608, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80160>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80438>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80400>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 690.7165999659312, "timesteps_this_iter": 37194, "timesteps_total": 7357615, "time_since_restore": 4973.891632080078, "hostname": "flow-main", "episode_reward_min": 37.76506769162681, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557189470, "time_this_iter_s": 26.215284824371338, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 193, "date": "2019-05-07_00-37-50", "episode_len_mean": 654.34}
{"timesteps_since_restore": 7395045, "policy_reward_mean": {}, "episode_reward_max": 896.335234797584, "time_total_s": 4998.847415685654, "info": {"num_steps_sampled": 7395045, "sample_time_ms": 16136.222, "grad_time_ms": 9302.485, "update_time_ms": 8.598, "default": {"kl": 0.01732214167714119, "entropy": 1.4255409240722656, "cur_lr": 0.0005000000237487257, "total_loss": 12.211321830749512, "policy_loss": -0.010830627754330635, "vf_explained_var": 0.9439995288848877, "vf_loss": 12.217768669128418, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 7395045, "load_time_ms": 12.581}, "custom_metrics": {"cost1_mean": 347.18356848405034, "outflow_rate_max": 1328.6353152597967, "system_level_velocity_mean": 14.508049743183172, "cost1_min": 22.653026570228043, "cost1_max": 503.5045944902023, "outflow_rate_min": 445.4682702993771, "cost2_mean": -0.037430107167457316, "outflow_rate_mean": 1056.4154161111016, "system_level_velocity_min": 10.440656953814253, "cost2_min": -0.504393730578131, "system_level_velocity_max": 19.871290863793604, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 194, "done": false, "episodes_total": 3628, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f809e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80c88>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f80128>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 706.7051698707368, "timesteps_this_iter": 37430, "timesteps_total": 7395045, "time_since_restore": 4998.847415685654, "hostname": "flow-main", "episode_reward_min": 40.86309923040191, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557189495, "time_this_iter_s": 24.95578360557556, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 194, "date": "2019-05-07_00-38-15", "episode_len_mean": 667.59}
{"timesteps_since_restore": 7432199, "policy_reward_mean": {}, "episode_reward_max": 896.335234797584, "time_total_s": 5025.743346452713, "info": {"num_steps_sampled": 7432199, "sample_time_ms": 16287.853, "grad_time_ms": 9235.788, "update_time_ms": 8.42, "default": {"kl": 0.015227062627673149, "entropy": 1.4392783641815186, "cur_lr": 0.0005000000237487257, "total_loss": 13.491790771484375, "policy_loss": -0.009971409104764462, "vf_explained_var": 0.9463610649108887, "vf_loss": 13.497907638549805, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 7432199, "load_time_ms": 12.963}, "custom_metrics": {"cost1_mean": 341.91529474819123, "outflow_rate_max": 1310.6244400346825, "system_level_velocity_mean": 14.683192329690867, "cost1_min": 21.415868138531618, "cost1_max": 503.5045944902023, "outflow_rate_min": 442.3333466763607, "cost2_mean": -0.034503590043218804, "outflow_rate_mean": 1044.2472037176406, "system_level_velocity_min": 10.440656953814253, "cost2_min": -0.6556328369002249, "system_level_velocity_max": 20.15345481310889, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 195, "done": false, "episodes_total": 3648, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540625ff60>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062337b8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406233be0>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 691.2038124798981, "timesteps_this_iter": 37154, "timesteps_total": 7432199, "time_since_restore": 5025.743346452713, "hostname": "flow-main", "episode_reward_min": 38.705665053993584, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557189522, "time_this_iter_s": 26.895930767059326, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 195, "date": "2019-05-07_00-38-42", "episode_len_mean": 654.51}
{"timesteps_since_restore": 7469494, "policy_reward_mean": {}, "episode_reward_max": 896.335234797584, "time_total_s": 5051.018707752228, "info": {"num_steps_sampled": 7469494, "sample_time_ms": 16149.694, "grad_time_ms": 9195.91, "update_time_ms": 8.298, "default": {"kl": 0.01553142536431551, "entropy": 1.4629547595977783, "cur_lr": 0.0005000000237487257, "total_loss": 12.897987365722656, "policy_loss": -0.0099338935688138, "vf_explained_var": 0.9393530488014221, "vf_loss": 12.903989791870117, "cur_kl_coeff": 0.2531249523162842}, "num_steps_trained": 7469494, "load_time_ms": 13.077}, "custom_metrics": {"cost1_mean": 338.39545750608363, "outflow_rate_max": 1293.8141196777588, "system_level_velocity_mean": 14.370359433626003, "cost1_min": 20.3008049892677, "cost1_max": 502.54104119943577, "outflow_rate_min": 436.8702661154352, "cost2_mean": -0.04859763777894264, "outflow_rate_mean": 1037.98263108934, "system_level_velocity_min": 10.440656953814253, "cost2_min": -1.2296345682500702, "system_level_velocity_max": 20.15345481310889, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 196, "done": false, "episodes_total": 3667, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062662e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266c88>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406266a20>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 692.326689479097, "timesteps_this_iter": 37295, "timesteps_total": 7469494, "time_since_restore": 5051.018707752228, "hostname": "flow-main", "episode_reward_min": 37.186228055731, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 19, "timestamp": 1557189547, "time_this_iter_s": 25.27536129951477, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 196, "date": "2019-05-07_00-39-07", "episode_len_mean": 661.11}
{"timesteps_since_restore": 7506491, "policy_reward_mean": {}, "episode_reward_max": 896.335234797584, "time_total_s": 5078.399194717407, "info": {"num_steps_sampled": 7506491, "sample_time_ms": 16246.072, "grad_time_ms": 9293.777, "update_time_ms": 8.351, "default": {"kl": 0.015479551628232002, "entropy": 1.4624853134155273, "cur_lr": 0.0005000000237487257, "total_loss": 14.845114707946777, "policy_loss": -0.009719839319586754, "vf_explained_var": 0.9342650175094604, "vf_loss": 14.850918769836426, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 7506491, "load_time_ms": 13.362}, "custom_metrics": {"cost1_mean": 338.03765079093967, "outflow_rate_max": 1293.8141196777588, "system_level_velocity_mean": 14.360556494202026, "cost1_min": 18.267639142649024, "cost1_max": 502.54104119943577, "outflow_rate_min": 434.44599691538906, "cost2_mean": -0.06736800390057245, "outflow_rate_mean": 1037.6887872891195, "system_level_velocity_min": 10.440656953814253, "cost2_min": -1.2296345682500702, "system_level_velocity_max": 20.15345481310889, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 197, "done": false, "episodes_total": 3689, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f540626ac18>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540626af60>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540626acf8>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 689.90096405837, "timesteps_this_iter": 36997, "timesteps_total": 7506491, "time_since_restore": 5078.399194717407, "hostname": "flow-main", "episode_reward_min": 33.107046914414624, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 22, "timestamp": 1557189574, "time_this_iter_s": 27.380486965179443, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 197, "date": "2019-05-07_00-39-34", "episode_len_mean": 661.08}
{"timesteps_since_restore": 7544712, "policy_reward_mean": {}, "episode_reward_max": 896.335234797584, "time_total_s": 5124.171809434891, "info": {"num_steps_sampled": 7544712, "sample_time_ms": 17819.741, "grad_time_ms": 9724.144, "update_time_ms": 10.279, "default": {"kl": 0.01500531006604433, "entropy": 1.4597094058990479, "cur_lr": 0.0005000000237487257, "total_loss": 9.561758041381836, "policy_loss": -0.00962765235453844, "vf_explained_var": 0.9468647837638855, "vf_loss": 9.567586898803711, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 7544712, "load_time_ms": 13.529}, "custom_metrics": {"cost1_mean": 341.0506892143904, "outflow_rate_max": 1299.4761693393332, "system_level_velocity_mean": 14.307375709926063, "cost1_min": 18.267639142649024, "cost1_max": 502.54104119943577, "outflow_rate_min": 434.44599691538906, "cost2_mean": -0.06653508073726291, "outflow_rate_mean": 1041.8950783644395, "system_level_velocity_min": 10.440656953814253, "cost2_min": -1.2296345682500702, "system_level_velocity_max": 20.15345481310889, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 198, "done": false, "episodes_total": 3705, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062a5c88>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f540625ae48>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f540623ef60>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 693.9463523964504, "timesteps_this_iter": 38221, "timesteps_total": 7544712, "time_since_restore": 5124.171809434891, "hostname": "flow-main", "episode_reward_min": 33.107046914414624, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 16, "timestamp": 1557189620, "time_this_iter_s": 45.77261471748352, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 198, "date": "2019-05-07_00-40-20", "episode_len_mean": 666.98}
{"timesteps_since_restore": 7582188, "policy_reward_mean": {}, "episode_reward_max": 887.6076438906382, "time_total_s": 5147.571033716202, "info": {"num_steps_sampled": 7582188, "sample_time_ms": 17945.148, "grad_time_ms": 9549.05, "update_time_ms": 10.428, "default": {"kl": 0.014913121238350868, "entropy": 1.4440209865570068, "cur_lr": 0.0005000000237487257, "total_loss": 13.582337379455566, "policy_loss": -0.008499017916619778, "vf_explained_var": 0.9470770955085754, "vf_loss": 13.587060928344727, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 7582188, "load_time_ms": 13.121}, "custom_metrics": {"cost1_mean": 336.1629423066962, "outflow_rate_max": 1299.4761693393332, "system_level_velocity_mean": 14.382176493940609, "cost1_min": 18.267639142649024, "cost1_max": 502.54104119943577, "outflow_rate_min": 434.44599691538906, "cost2_mean": -0.08223413372795496, "outflow_rate_mean": 1033.3154981261703, "system_level_velocity_min": 10.605438463532444, "cost2_min": -1.2296345682500702, "system_level_velocity_max": 20.15345481310889, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 199, "done": false, "episodes_total": 3727, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f54062899e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f54062890f0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5406289978>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 679.9950731422983, "timesteps_this_iter": 37476, "timesteps_total": 7582188, "time_since_restore": 5147.571033716202, "hostname": "flow-main", "episode_reward_min": 33.107046914414624, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 22, "timestamp": 1557189644, "time_this_iter_s": 23.399224281311035, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 199, "date": "2019-05-07_00-40-44", "episode_len_mean": 656.76}
{"timesteps_since_restore": 7618978, "policy_reward_mean": {}, "episode_reward_max": 887.6076438906382, "time_total_s": 5171.89391541481, "info": {"num_steps_sampled": 7618978, "sample_time_ms": 17891.498, "grad_time_ms": 9543.349, "update_time_ms": 10.192, "default": {"kl": 0.016304994001984596, "entropy": 1.4402345418930054, "cur_lr": 0.0005000000237487257, "total_loss": 12.251099586486816, "policy_loss": -0.010322748683393002, "vf_explained_var": 0.950587272644043, "vf_loss": 12.257295608520508, "cur_kl_coeff": 0.25312498211860657}, "num_steps_trained": 7618978, "load_time_ms": 13.102}, "custom_metrics": {"cost1_mean": 336.43202588575286, "outflow_rate_max": 1299.4761693393332, "system_level_velocity_mean": 14.186101794619805, "cost1_min": 18.267639142649024, "cost1_max": 474.4932994153656, "outflow_rate_min": 434.44599691538906, "cost2_mean": -0.08107385156221056, "outflow_rate_mean": 1036.300158611181, "system_level_velocity_min": 10.160464324712846, "cost2_min": -1.2296345682500702, "system_level_velocity_max": 20.118868404583583, "cost2_max": 0.0}, "node_ip": "10.138.0.2", "iterations_since_restore": 200, "done": true, "episodes_total": 3747, "config": {"lr": 0.0005, "num_gpus": 0, "output_max_file_size": 67108864, "observation_filter": "NoFilter", "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "preprocessor_pref": "deepmind", "lambda": 0.97, "horizon": 1500, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "clip_rewards": null, "straggler_mitigation": false, "input_evaluation": null, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c978>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8c278>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f5401f8cc50>"}, "log_level": "INFO", "num_gpus_per_worker": 0, "synchronize_filters": true, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "monitor": false, "model": {"custom_preprocessor": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "dim": 84, "conv_activation": "relu", "max_seq_len": 20, "grayscale": false, "lstm_use_prev_action_reward": false, "channel_major": false, "framestack": true, "conv_filters": null, "use_lstm": false, "free_log_std": false, "fcnet_activation": "tanh", "squash_to_range": false, "custom_model": null, "custom_options": {}, "lstm_cell_size": 256}, "sample_batch_size": 200, "vf_share_layers": false, "vf_clip_param": 1000000.0, "use_gae": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "lr_schedule": null, "entropy_coeff": 0.0, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "gamma": 0.99, "num_envs_per_worker": 1, "clip_actions": false, "input": "sampler", "compress_observations": false, "collect_metrics_timeout": 180, "output": null, "num_sgd_iter": 10, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_cpus_per_worker": 1, "sample_async": false, "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "kl_target": 0.01, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true}}, "episode_reward_mean": 689.2796113164555, "timesteps_this_iter": 36790, "timesteps_total": 7618978, "time_since_restore": 5171.89391541481, "hostname": "flow-main", "episode_reward_min": 33.107046914414624, "num_metric_batches_dropped": 0, "pid": 25279, "episodes_this_iter": 20, "timestamp": 1557189668, "time_this_iter_s": 24.3228816986084, "experiment_id": "b184a9a3b8da47d9ac5a74cccf19009c", "training_iteration": 200, "date": "2019-05-07_00-41-08", "episode_len_mean": 664.21}

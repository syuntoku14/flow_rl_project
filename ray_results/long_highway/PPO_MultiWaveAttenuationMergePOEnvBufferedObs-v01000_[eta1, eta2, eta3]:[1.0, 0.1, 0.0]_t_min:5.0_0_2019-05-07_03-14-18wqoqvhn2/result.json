{"info": {"update_time_ms": 1324.72, "num_steps_sampled": 52074, "num_steps_trained": 52074, "default": {"entropy": 1.4150737524032593, "policy_loss": 3.881741577060893e-05, "cur_kl_coeff": 0.20000004768371582, "vf_explained_var": 0.9107492566108704, "vf_loss": 2.0023114681243896, "total_loss": 2.0024073123931885, "cur_lr": 0.0005000000237487257, "kl": 0.0002864534908439964}, "sample_time_ms": 38387.77, "load_time_ms": 92.988, "grad_time_ms": 12434.301}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 52074, "time_this_iter_s": 52.407010316848755, "date": "2019-05-07_03-15-45", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42bfb1ddd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42bfb1de10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42bfb1de48>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 33.87168304500957, "cost2_max": -17.628666013052023, "outflow_rate_min": 319.92940939152567, "cost1_max": 33.87168304500957, "cost1_mean": 33.87168304500957, "system_level_velocity_mean": 18.73950113649579, "cost2_min": -17.628666013052023, "system_level_velocity_min": 18.73950113649579, "outflow_rate_max": 319.92940939152567, "system_level_velocity_max": 18.73950113649579, "outflow_rate_mean": 319.92940939152567, "cost2_mean": -17.628666013052023}, "policy_reward_mean": {}, "timesteps_this_iter": 52074, "episodes_this_iter": 1, "training_iteration": 1, "episode_reward_min": 69.63189810126434, "episode_reward_mean": 69.63189810126434, "iterations_since_restore": 1, "time_total_s": 52.407010316848755, "timestamp": 1557198945, "pid": 300, "time_since_restore": 52.407010316848755, "episode_len_mean": 50.0, "episode_reward_max": 69.63189810126434, "episodes_total": 1, "timesteps_since_restore": 52074, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 667.597, "num_steps_sampled": 97579, "num_steps_trained": 97579, "default": {"entropy": 1.4277126789093018, "policy_loss": -0.00047780468594282866, "cur_kl_coeff": 0.10000002384185791, "vf_explained_var": 0.9799559712409973, "vf_loss": 1.143290638923645, "total_loss": 1.143241047859192, "cur_lr": 0.0005000000237487257, "kl": 0.004280866123735905}, "sample_time_ms": 28162.51, "load_time_ms": 53.908, "grad_time_ms": 11115.041}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 97579, "time_this_iter_s": 27.837397813796997, "date": "2019-05-07_03-16-13", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e698d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e69908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e69940>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 33.87168304500957, "cost2_max": -17.628666013052023, "outflow_rate_min": 319.92940939152567, "cost1_max": 275.5980769744767, "cost1_mean": 225.07627273934472, "system_level_velocity_mean": 9.364228647127621, "cost2_min": -101.98408790371813, "system_level_velocity_min": 7.024507345878611, "outflow_rate_max": 731.8836831164224, "system_level_velocity_max": 18.73950113649579, "outflow_rate_mean": 564.7410184259987, "cost2_mean": -74.12862848575871}, "policy_reward_mean": {}, "timesteps_this_iter": 45505, "episodes_this_iter": 20, "training_iteration": 2, "episode_reward_min": 69.63189810126434, "episode_reward_mean": 632.1746060872664, "iterations_since_restore": 2, "time_total_s": 80.24440813064575, "timestamp": 1557198973, "pid": 300, "time_since_restore": 80.24440813064575, "episode_len_mean": 669.047619047619, "episode_reward_max": 777.1669635783076, "episodes_total": 21, "timesteps_since_restore": 97579, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 447.268, "num_steps_sampled": 149681, "num_steps_trained": 149681, "default": {"entropy": 1.4271916151046753, "policy_loss": -0.0024200554471462965, "cur_kl_coeff": 0.050000011920928955, "vf_explained_var": 0.9837303161621094, "vf_loss": 0.9446125626564026, "total_loss": 0.9426711797714233, "cur_lr": 0.0005000000237487257, "kl": 0.009574676863849163}, "sample_time_ms": 25531.846, "load_time_ms": 38.842, "grad_time_ms": 11877.987}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 149681, "time_this_iter_s": 33.78897666931152, "date": "2019-05-07_03-16-47", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e719e8>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 33.87168304500957, "cost2_max": -17.628666013052023, "outflow_rate_min": 319.92940939152567, "cost1_max": 335.62377428931995, "cost1_mean": 234.93024957021805, "system_level_velocity_mean": 9.405315406572674, "cost2_min": -102.26799418037797, "system_level_velocity_min": 7.024507345878611, "outflow_rate_max": 825.6003944542217, "system_level_velocity_max": 18.73950113649579, "outflow_rate_mean": 585.7896963014493, "cost2_mean": -77.94636169464637}, "policy_reward_mean": {}, "timesteps_this_iter": 52102, "episodes_this_iter": 15, "training_iteration": 3, "episode_reward_min": 69.63189810126434, "episode_reward_mean": 650.597664895129, "iterations_since_restore": 3, "time_total_s": 114.03338479995728, "timestamp": 1557199007, "pid": 300, "time_since_restore": 114.03338479995728, "episode_len_mean": 681.9444444444445, "episode_reward_max": 921.2904344349773, "episodes_total": 36, "timesteps_since_restore": 149681, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 337.605, "num_steps_sampled": 201595, "num_steps_trained": 201595, "default": {"entropy": 1.414156436920166, "policy_loss": -0.0019662645645439625, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9774519801139832, "vf_loss": 1.8315389156341553, "total_loss": 1.8298652172088623, "cur_lr": 0.0005000000237487257, "kl": 0.005851460620760918}, "sample_time_ms": 23278.261, "load_time_ms": 31.543, "grad_time_ms": 12002.899}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 201595, "time_this_iter_s": 29.027193546295166, "date": "2019-05-07_03-17-16", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e714a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e710f0>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 33.87168304500957, "cost2_max": -17.628666013052023, "outflow_rate_min": 319.92940939152567, "cost1_max": 335.62377428931995, "cost1_mean": 233.16560050048324, "system_level_velocity_mean": 9.7096293373051, "cost2_min": -106.49967710288149, "system_level_velocity_min": 7.024507345878611, "outflow_rate_max": 825.6003944542217, "system_level_velocity_max": 19.222066005845793, "outflow_rate_mean": 583.4033567320655, "cost2_mean": -78.51390953417295}, "policy_reward_mean": {}, "timesteps_this_iter": 51914, "episodes_this_iter": 6, "training_iteration": 4, "episode_reward_min": 69.63189810126434, "episode_reward_mean": 653.0115619536408, "iterations_since_restore": 4, "time_total_s": 143.06057834625244, "timestamp": 1557199036, "pid": 300, "time_since_restore": 143.06057834625244, "episode_len_mean": 669.047619047619, "episode_reward_max": 921.2904344349773, "episodes_total": 42, "timesteps_since_restore": 201595, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 271.945, "num_steps_sampled": 250147, "num_steps_trained": 250147, "default": {"entropy": 1.4004677534103394, "policy_loss": -0.002362773520871997, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.9802312254905701, "vf_loss": 2.4666213989257812, "total_loss": 2.464615821838379, "cur_lr": 0.0005000000237487257, "kl": 0.0071481685154139996}, "sample_time_ms": 22030.486, "load_time_ms": 26.633, "grad_time_ms": 11943.955}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 250147, "time_this_iter_s": 28.87005877494812, "date": "2019-05-07_03-17-45", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e796d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e79da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e79b00>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 33.87168304500957, "cost2_max": -17.628666013052023, "outflow_rate_min": 319.92940939152567, "cost1_max": 335.62377428931995, "cost1_mean": 236.24584737124826, "system_level_velocity_mean": 9.608494291317509, "cost2_min": -106.99981163111812, "system_level_velocity_min": 7.024507345878611, "outflow_rate_max": 825.6003944542217, "system_level_velocity_max": 19.222066005845793, "outflow_rate_mean": 586.736172928667, "cost2_mean": -81.24618072342672}, "policy_reward_mean": {}, "timesteps_this_iter": 48552, "episodes_this_iter": 15, "training_iteration": 5, "episode_reward_min": 69.63189810126434, "episode_reward_mean": 685.8225657215759, "iterations_since_restore": 5, "time_total_s": 171.93063712120056, "timestamp": 1557199065, "pid": 300, "time_since_restore": 171.93063712120056, "episode_len_mean": 677.1929824561404, "episode_reward_max": 976.7257096506177, "episodes_total": 57, "timesteps_since_restore": 250147, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 227.922, "num_steps_sampled": 297311, "num_steps_trained": 297311, "default": {"entropy": 1.4232698678970337, "policy_loss": -0.001122697489336133, "cur_kl_coeff": 0.05000000447034836, "vf_explained_var": 0.9852057099342346, "vf_loss": 1.712018370628357, "total_loss": 1.7112014293670654, "cur_lr": 0.0005000000237487257, "kl": 0.006114956922829151}, "sample_time_ms": 21062.583, "load_time_ms": 23.549, "grad_time_ms": 11817.229}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 297311, "time_this_iter_s": 27.533892393112183, "date": "2019-05-07_03-18-12", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e69f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e69b00>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 33.87168304500957, "cost2_max": -17.628666013052023, "outflow_rate_min": 319.92940939152567, "cost1_max": 362.7201161247725, "cost1_mean": 245.23254063392505, "system_level_velocity_mean": 9.766911815963708, "cost2_min": -129.41444326044348, "system_level_velocity_min": 7.024507345878611, "outflow_rate_max": 937.5219611934375, "system_level_velocity_max": 19.222066005845793, "outflow_rate_mean": 608.0760285666297, "cost2_mean": -88.65600266786792}, "policy_reward_mean": {}, "timesteps_this_iter": 47164, "episodes_this_iter": 19, "training_iteration": 6, "episode_reward_min": 69.63189810126434, "episode_reward_mean": 739.2958089691142, "iterations_since_restore": 6, "time_total_s": 199.46452951431274, "timestamp": 1557199092, "pid": 300, "time_since_restore": 199.46452951431274, "episode_len_mean": 682.8947368421053, "episode_reward_max": 1204.7489205503298, "episodes_total": 76, "timesteps_since_restore": 297311, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 196.567, "num_steps_sampled": 349406, "num_steps_trained": 349406, "default": {"entropy": 1.4138234853744507, "policy_loss": -0.002093574730679393, "cur_kl_coeff": 0.050000011920928955, "vf_explained_var": 0.9859064221382141, "vf_loss": 1.1329869031906128, "total_loss": 1.131224274635315, "cur_lr": 0.0005000000237487257, "kl": 0.006617482751607895}, "sample_time_ms": 20203.491, "load_time_ms": 21.29, "grad_time_ms": 11852.386}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 349406, "time_this_iter_s": 27.217602968215942, "date": "2019-05-07_03-18-39", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e69ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71048>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 33.87168304500957, "cost2_max": -17.628666013052023, "outflow_rate_min": 319.92940939152567, "cost1_max": 362.7201161247725, "cost1_mean": 246.6790007825403, "system_level_velocity_mean": 9.78455501188348, "cost2_min": -129.41444326044348, "system_level_velocity_min": 7.024507345878611, "outflow_rate_max": 937.5219611934375, "system_level_velocity_max": 19.222066005845793, "outflow_rate_mean": 614.0325905901899, "cost2_mean": -89.75244340112825}, "policy_reward_mean": {}, "timesteps_this_iter": 52095, "episodes_this_iter": 5, "training_iteration": 7, "episode_reward_min": 69.63189810126434, "episode_reward_mean": 751.1069673888844, "iterations_since_restore": 7, "time_total_s": 226.6821324825287, "timestamp": 1557199119, "pid": 300, "time_since_restore": 226.6821324825287, "episode_len_mean": 683.9506172839506, "episode_reward_max": 1204.7489205503298, "episodes_total": 81, "timesteps_since_restore": 349406, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 173.212, "num_steps_sampled": 396826, "num_steps_trained": 396826, "default": {"entropy": 1.3714091777801514, "policy_loss": -0.0009686619741842151, "cur_kl_coeff": 0.05000000447034836, "vf_explained_var": 0.9851338267326355, "vf_loss": 2.098334789276123, "total_loss": 2.097598075866699, "cur_lr": 0.0005000000237487257, "kl": 0.00463902810588479}, "sample_time_ms": 19673.159, "load_time_ms": 19.458, "grad_time_ms": 11722.382}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 396826, "time_this_iter_s": 26.87528896331787, "date": "2019-05-07_03-19-06", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e79748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e79c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42bfb008d0>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 33.87168304500957, "cost2_max": -17.628666013052023, "outflow_rate_min": 319.92940939152567, "cost1_max": 362.7201161247725, "cost1_mean": 248.55592719810747, "system_level_velocity_mean": 9.77358412406612, "cost2_min": -129.41444326044348, "system_level_velocity_min": 7.024507345878611, "outflow_rate_max": 937.5219611934375, "system_level_velocity_max": 19.222066005845793, "outflow_rate_mean": 623.4730834180727, "cost2_mean": -92.44546382200201}, "policy_reward_mean": {}, "timesteps_this_iter": 47420, "episodes_this_iter": 15, "training_iteration": 8, "episode_reward_min": 69.63189810126434, "episode_reward_mean": 776.5656428497801, "iterations_since_restore": 8, "time_total_s": 253.55742144584656, "timestamp": 1557199146, "pid": 300, "time_since_restore": 253.55742144584656, "episode_len_mean": 686.4583333333334, "episode_reward_max": 1204.7489205503298, "episodes_total": 96, "timesteps_since_restore": 396826, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 154.8, "num_steps_sampled": 444919, "num_steps_trained": 444919, "default": {"entropy": 1.3739784955978394, "policy_loss": -0.001090899808332324, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.9555342793464661, "vf_loss": 3.841968059539795, "total_loss": 3.841054677963257, "cur_lr": 0.0005000000237487257, "kl": 0.007118808105587959}, "sample_time_ms": 19492.645, "load_time_ms": 18.064, "grad_time_ms": 11740.438}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 444919, "time_this_iter_s": 30.03379511833191, "date": "2019-05-07_03-19-36", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e69908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e69438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e694e0>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 34.196339435820924, "cost2_max": -17.69578234904849, "outflow_rate_min": 326.3279975793562, "cost1_max": 362.7201161247725, "cost1_mean": 254.24619607963436, "system_level_velocity_mean": 9.775873905125088, "cost2_min": -130.311901622957, "system_level_velocity_min": 7.024507345878611, "outflow_rate_max": 937.5219611934375, "system_level_velocity_max": 19.222066005845793, "outflow_rate_mean": 641.4056568344478, "cost2_mean": -98.40977182205772}, "policy_reward_mean": {}, "timesteps_this_iter": 48093, "episodes_this_iter": 19, "training_iteration": 9, "episode_reward_min": 70.37572643558701, "episode_reward_mean": 836.9411126701685, "iterations_since_restore": 9, "time_total_s": 283.59121656417847, "timestamp": 1557199176, "pid": 300, "time_since_restore": 283.59121656417847, "episode_len_mean": 693.5, "episode_reward_max": 1204.7489205503298, "episodes_total": 115, "timesteps_since_restore": 444919, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 140.116, "num_steps_sampled": 493556, "num_steps_trained": 493556, "default": {"entropy": 1.3462640047073364, "policy_loss": -0.0016099326312541962, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9827046394348145, "vf_loss": 1.7805652618408203, "total_loss": 1.7791253328323364, "cur_lr": 0.0005000000237487257, "kl": 0.006800916977226734}, "sample_time_ms": 19129.742, "load_time_ms": 17.19, "grad_time_ms": 11730.904}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 493556, "time_this_iter_s": 27.624340057373047, "date": "2019-05-07_03-20-04", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e712b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71710>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 34.196339435820924, "cost2_max": -17.69578234904849, "outflow_rate_min": 326.3279975793562, "cost1_max": 362.7201161247725, "cost1_mean": 256.70219625289354, "system_level_velocity_mean": 9.864193937974878, "cost2_min": -130.311901622957, "system_level_velocity_min": 7.089635416296132, "outflow_rate_max": 937.5219611934375, "system_level_velocity_max": 19.222066005845793, "outflow_rate_mean": 650.3032534421993, "cost2_mean": -100.26344122195088}, "policy_reward_mean": {}, "timesteps_this_iter": 48637, "episodes_this_iter": 5, "training_iteration": 10, "episode_reward_min": 70.37572643558701, "episode_reward_mean": 852.6610718236235, "iterations_since_restore": 10, "time_total_s": 311.2155566215515, "timestamp": 1557199204, "pid": 300, "time_since_restore": 311.2155566215515, "episode_len_mean": 693.5, "episode_reward_max": 1204.7489205503298, "episodes_total": 120, "timesteps_since_restore": 493556, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 8.743, "num_steps_sampled": 540896, "num_steps_trained": 540896, "default": {"entropy": 1.3373236656188965, "policy_loss": -0.000492844614200294, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9530415534973145, "vf_loss": 5.390620231628418, "total_loss": 5.390273571014404, "cur_lr": 0.0005000000237487257, "kl": 0.005874029826372862}, "sample_time_ms": 16959.717, "load_time_ms": 8.767, "grad_time_ms": 11656.251}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 540896, "time_this_iter_s": 28.480449438095093, "date": "2019-05-07_03-20-33", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e795c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71860>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 34.196339435820924, "cost2_max": -17.69578234904849, "outflow_rate_min": 326.3279975793562, "cost1_max": 362.7201161247725, "cost1_mean": 260.29429268598386, "system_level_velocity_mean": 9.97698213608484, "cost2_min": -130.311901622957, "system_level_velocity_min": 7.089635416296132, "outflow_rate_max": 937.5219611934375, "system_level_velocity_max": 19.222066005845793, "outflow_rate_mean": 666.8813372175314, "cost2_mean": -102.73631327775088}, "policy_reward_mean": {}, "timesteps_this_iter": 47340, "episodes_this_iter": 15, "training_iteration": 11, "episode_reward_min": 70.37572643558701, "episode_reward_mean": 896.5259508024366, "iterations_since_restore": 11, "time_total_s": 339.6960060596466, "timestamp": 1557199233, "pid": 300, "time_since_restore": 339.6960060596466, "episode_len_mean": 693.5, "episode_reward_max": 1204.7489205503298, "episodes_total": 135, "timesteps_since_restore": 540896, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 8.339, "num_steps_sampled": 586212, "num_steps_trained": 586212, "default": {"entropy": 1.3290276527404785, "policy_loss": -0.0023852188605815172, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9547895193099976, "vf_loss": 5.542446136474609, "total_loss": 5.540323734283447, "cur_lr": 0.0005000000237487257, "kl": 0.010510899126529694}, "sample_time_ms": 16907.622, "load_time_ms": 8.132, "grad_time_ms": 11809.683}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 586212, "time_this_iter_s": 28.855108976364136, "date": "2019-05-07_03-21-02", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e794a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e798d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e79da0>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 189.165840992531, "cost2_max": -64.01356606134064, "outflow_rate_min": 370.9371194592311, "cost1_max": 362.7201161247725, "cost1_mean": 267.7928871251661, "system_level_velocity_mean": 10.036425827929879, "cost2_min": -140.382961458846, "system_level_velocity_min": 7.089635416296132, "outflow_rate_max": 937.5219611934375, "system_level_velocity_max": 13.339444796243916, "outflow_rate_mean": 690.9636732294767, "cost2_mean": -108.00716845385148}, "policy_reward_mean": {}, "timesteps_this_iter": 45316, "episodes_this_iter": 18, "training_iteration": 12, "episode_reward_min": 581.0212855711773, "episode_reward_mean": 951.6395052939654, "iterations_since_restore": 12, "time_total_s": 368.55111503601074, "timestamp": 1557199262, "pid": 300, "time_since_restore": 368.55111503601074, "episode_len_mean": 700.0, "episode_reward_max": 1204.7489205503298, "episodes_total": 153, "timesteps_since_restore": 586212, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 8.354, "num_steps_sampled": 632645, "num_steps_trained": 632645, "default": {"entropy": 1.3314965963363647, "policy_loss": -0.0017550521297380328, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.9701622128486633, "vf_loss": 3.1915578842163086, "total_loss": 3.1899912357330322, "cur_lr": 0.0005000000237487257, "kl": 0.007542306557297707}, "sample_time_ms": 16409.186, "load_time_ms": 8.086, "grad_time_ms": 11553.445}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 632645, "time_this_iter_s": 26.22382116317749, "date": "2019-05-07_03-21-28", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e69710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e69630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e69cf8>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 189.165840992531, "cost2_max": -78.36053683284865, "outflow_rate_min": 370.9371194592311, "cost1_max": 362.7201161247725, "cost1_mean": 271.683921223498, "system_level_velocity_mean": 10.156449982548406, "cost2_min": -140.382961458846, "system_level_velocity_min": 7.089635416296132, "outflow_rate_max": 937.5219611934375, "system_level_velocity_max": 13.339444796243916, "outflow_rate_mean": 703.7205865963051, "cost2_mean": -109.0438138514589}, "policy_reward_mean": {}, "timesteps_this_iter": 46433, "episodes_this_iter": 8, "training_iteration": 13, "episode_reward_min": 685.686042389897, "episode_reward_mean": 975.0113329070634, "iterations_since_restore": 13, "time_total_s": 394.77493619918823, "timestamp": 1557199288, "pid": 300, "time_since_restore": 394.77493619918823, "episode_len_mean": 700.0, "episode_reward_max": 1211.6804645430134, "episodes_total": 161, "timesteps_since_restore": 632645, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 8.222, "num_steps_sampled": 680475, "num_steps_trained": 680475, "default": {"entropy": 1.318472146987915, "policy_loss": -0.001842755707912147, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9709696769714355, "vf_loss": 3.9106550216674805, "total_loss": 3.9090511798858643, "cur_lr": 0.0005000000237487257, "kl": 0.009553581476211548}, "sample_time_ms": 16606.088, "load_time_ms": 8.032, "grad_time_ms": 11569.008}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 680475, "time_this_iter_s": 31.11835503578186, "date": "2019-05-07_03-21-59", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e714e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e714a8>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 207.92062627798472, "cost2_max": -78.36053683284865, "outflow_rate_min": 527.6257484804904, "cost1_max": 346.7697456293208, "cost1_mean": 274.4345527531341, "system_level_velocity_mean": 10.234378729819806, "cost2_min": -140.382961458846, "system_level_velocity_min": 7.81859272018015, "outflow_rate_max": 845.6839527368477, "system_level_velocity_max": 12.893064337642313, "outflow_rate_mean": 714.9847602417136, "cost2_mean": -110.83484608500561}, "policy_reward_mean": {}, "timesteps_this_iter": 47830, "episodes_this_iter": 13, "training_iteration": 14, "episode_reward_min": 757.2355107612003, "episode_reward_mean": 996.9421848236732, "iterations_since_restore": 14, "time_total_s": 425.8932912349701, "timestamp": 1557199319, "pid": 300, "time_since_restore": 425.8932912349701, "episode_len_mean": 700.0, "episode_reward_max": 1272.3972175782928, "episodes_total": 174, "timesteps_since_restore": 680475, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.951, "num_steps_sampled": 726963, "num_steps_trained": 726963, "default": {"entropy": 1.3296663761138916, "policy_loss": -0.0015350672183558345, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9583261013031006, "vf_loss": 6.116162300109863, "total_loss": 6.1148200035095215, "cur_lr": 0.0005000000237487257, "kl": 0.007685392163693905}, "sample_time_ms": 16570.739, "load_time_ms": 8.252, "grad_time_ms": 11508.544}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 726963, "time_this_iter_s": 27.887704849243164, "date": "2019-05-07_03-22-27", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e69978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71908>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 228.87244677463087, "cost2_max": -78.36053683284865, "outflow_rate_min": 588.3243941035528, "cost1_max": 346.7697456293208, "cost1_mean": 281.71631826638554, "system_level_velocity_mean": 10.473675111260846, "cost2_min": -140.382961458846, "system_level_velocity_min": 8.593845935244225, "outflow_rate_max": 845.6839527368477, "system_level_velocity_max": 12.893064337642313, "outflow_rate_mean": 732.5490668728179, "cost2_mean": -112.32355488817036}, "policy_reward_mean": {}, "timesteps_this_iter": 46488, "episodes_this_iter": 19, "training_iteration": 15, "episode_reward_min": 822.5918463932471, "episode_reward_mean": 1031.4283835763533, "iterations_since_restore": 15, "time_total_s": 453.78099608421326, "timestamp": 1557199347, "pid": 300, "time_since_restore": 453.78099608421326, "episode_len_mean": 700.0, "episode_reward_max": 1272.3972175782928, "episodes_total": 193, "timesteps_since_restore": 726963, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.932, "num_steps_sampled": 772544, "num_steps_trained": 772544, "default": {"entropy": 1.3057206869125366, "policy_loss": -0.0026701930910348892, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9656267762184143, "vf_loss": 4.30446195602417, "total_loss": 4.302049160003662, "cur_lr": 0.0005000000237487257, "kl": 0.010300327092409134}, "sample_time_ms": 16446.978, "load_time_ms": 8.158, "grad_time_ms": 11474.155}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 772544, "time_this_iter_s": 25.929676055908203, "date": "2019-05-07_03-22-53", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e798d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e79ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e79748>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 31.23431043285616, "cost2_max": -11.987629481495656, "outflow_rate_min": 327.87941281053116, "cost1_max": 351.65194966302056, "cost1_mean": 284.36024220869973, "system_level_velocity_mean": 10.735642533428523, "cost2_min": -140.382961458846, "system_level_velocity_min": 8.593845935244225, "outflow_rate_max": 875.5850271504077, "system_level_velocity_max": 18.861420974470455, "outflow_rate_mean": 740.8968179761011, "cost2_mean": -111.17680053023932}, "policy_reward_mean": {}, "timesteps_this_iter": 45581, "episodes_this_iter": 10, "training_iteration": 16, "episode_reward_min": 63.40291684055154, "episode_reward_mean": 1036.887118545196, "iterations_since_restore": 16, "time_total_s": 479.71067214012146, "timestamp": 1557199373, "pid": 300, "time_since_restore": 479.71067214012146, "episode_len_mean": 693.47, "episode_reward_max": 1272.3972175782928, "episodes_total": 203, "timesteps_since_restore": 772544, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.849, "num_steps_sampled": 819819, "num_steps_trained": 819819, "default": {"entropy": 1.2927290201187134, "policy_loss": -0.0017856379272416234, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9746565222740173, "vf_loss": 4.306721210479736, "total_loss": 4.305211067199707, "cur_lr": 0.0005000000237487257, "kl": 0.011016298085451126}, "sample_time_ms": 16731.6, "load_time_ms": 8.149, "grad_time_ms": 11347.604}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 819819, "time_this_iter_s": 28.789185762405396, "date": "2019-05-07_03-23-22", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7c160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7c048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7c278>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 31.23431043285616, "cost2_max": -11.987629481495656, "outflow_rate_min": 327.87941281053116, "cost1_max": 351.65194966302056, "cost1_mean": 291.0726729317678, "system_level_velocity_mean": 10.962612291008645, "cost2_min": -140.382961458846, "system_level_velocity_min": 8.67772140743454, "outflow_rate_max": 875.5850271504077, "system_level_velocity_max": 18.861420974470455, "outflow_rate_mean": 755.0471754153914, "cost2_mean": -111.36344450465582}, "policy_reward_mean": {}, "timesteps_this_iter": 47275, "episodes_this_iter": 13, "training_iteration": 17, "episode_reward_min": 63.40291684055154, "episode_reward_mean": 1059.234488423709, "iterations_since_restore": 17, "time_total_s": 508.49985790252686, "timestamp": 1557199402, "pid": 300, "time_since_restore": 508.49985790252686, "episode_len_mean": 693.47, "episode_reward_max": 1280.1953927525299, "episodes_total": 216, "timesteps_since_restore": 819819, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.539, "num_steps_sampled": 865842, "num_steps_trained": 865842, "default": {"entropy": 1.2855827808380127, "policy_loss": -0.002490764483809471, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.9715426564216614, "vf_loss": 5.417503356933594, "total_loss": 5.415255069732666, "cur_lr": 0.0005000000237487257, "kl": 0.009700204245746136}, "sample_time_ms": 16787.621, "load_time_ms": 8.269, "grad_time_ms": 11316.545}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 865842, "time_this_iter_s": 27.13597798347473, "date": "2019-05-07_03-23-49", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71198>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 28.87149749285334, "cost2_max": -10.515226294556221, "outflow_rate_min": 321.7894561743987, "cost1_max": 352.811446407988, "cost1_mean": 297.260378988656, "system_level_velocity_mean": 11.360639834790778, "cost2_min": -140.382961458846, "system_level_velocity_min": 8.67772140743454, "outflow_rate_max": 903.502383198586, "system_level_velocity_max": 19.542729096532486, "outflow_rate_mean": 771.6783170173873, "cost2_mean": -112.00750265296732}, "policy_reward_mean": {}, "timesteps_this_iter": 46023, "episodes_this_iter": 18, "training_iteration": 18, "episode_reward_min": 53.162189279241645, "episode_reward_mean": 1075.0766156030236, "iterations_since_restore": 18, "time_total_s": 535.6358358860016, "timestamp": 1557199429, "pid": 300, "time_since_restore": 535.6358358860016, "episode_len_mean": 686.9, "episode_reward_max": 1297.278791323314, "episodes_total": 234, "timesteps_since_restore": 865842, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.489, "num_steps_sampled": 913588, "num_steps_trained": 913588, "default": {"entropy": 1.2873950004577637, "policy_loss": -0.002427553292363882, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9757420420646667, "vf_loss": 4.287374019622803, "total_loss": 4.285158157348633, "cur_lr": 0.0005000000237487257, "kl": 0.008472266606986523}, "sample_time_ms": 16729.593, "load_time_ms": 8.224, "grad_time_ms": 11202.028}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 913588, "time_this_iter_s": 28.302995204925537, "date": "2019-05-07_03-24-17", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71518>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 28.87149749285334, "cost2_max": -9.315130590543525, "outflow_rate_min": 316.2705838461859, "cost1_max": 352.811446407988, "cost1_mean": 299.28659522091027, "system_level_velocity_mean": 11.602003705173727, "cost2_min": -139.53031247785916, "system_level_velocity_min": 8.67772140743454, "outflow_rate_max": 903.502383198586, "system_level_velocity_max": 19.542729096532486, "outflow_rate_mean": 777.5714871843339, "cost2_mean": -111.42633883300738}, "policy_reward_mean": {}, "timesteps_this_iter": 47746, "episodes_this_iter": 13, "training_iteration": 19, "episode_reward_min": 53.162189279241645, "episode_reward_mean": 1073.9137755206186, "iterations_since_restore": 19, "time_total_s": 563.9388310909271, "timestamp": 1557199457, "pid": 300, "time_since_restore": 563.9388310909271, "episode_len_mean": 680.35, "episode_reward_max": 1297.278791323314, "episodes_total": 247, "timesteps_since_restore": 913588, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.463, "num_steps_sampled": 960814, "num_steps_trained": 960814, "default": {"entropy": 1.2493293285369873, "policy_loss": -0.0020047221332788467, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.9866840243339539, "vf_loss": 2.8472983837127686, "total_loss": 2.8455591201782227, "cur_lr": 0.0005000000237487257, "kl": 0.010623650625348091}, "sample_time_ms": 17005.845, "load_time_ms": 8.116, "grad_time_ms": 11116.238}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 960814, "time_this_iter_s": 29.526339054107666, "date": "2019-05-07_03-24-47", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7c780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7c358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7c0f0>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 28.87149749285334, "cost2_max": -9.315130590543525, "outflow_rate_min": 316.2705838461859, "cost1_max": 359.82695218466904, "cost1_mean": 304.2444706329024, "system_level_velocity_mean": 11.779777947157664, "cost2_min": -143.88206604314541, "system_level_velocity_min": 9.187021761551165, "outflow_rate_max": 903.502383198586, "system_level_velocity_max": 19.542729096532486, "outflow_rate_mean": 789.3953681582508, "cost2_mean": -112.68634542838005}, "policy_reward_mean": {}, "timesteps_this_iter": 47226, "episodes_this_iter": 12, "training_iteration": 20, "episode_reward_min": 53.162189279241645, "episode_reward_mean": 1084.030346458697, "iterations_since_restore": 20, "time_total_s": 593.4651701450348, "timestamp": 1557199487, "pid": 300, "time_since_restore": 593.4651701450348, "episode_len_mean": 680.35, "episode_reward_max": 1297.278791323314, "episodes_total": 259, "timesteps_since_restore": 960814, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.382, "num_steps_sampled": 1007560, "num_steps_trained": 1007560, "default": {"entropy": 1.2524608373641968, "policy_loss": -0.0014651413075625896, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.9829077124595642, "vf_loss": 3.8083395957946777, "total_loss": 3.807115077972412, "cur_lr": 0.0005000000237487257, "kl": 0.009641547687351704}, "sample_time_ms": 17048.991, "load_time_ms": 8.086, "grad_time_ms": 11074.315}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 1007560, "time_this_iter_s": 28.489848852157593, "date": "2019-05-07_03-25-15", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e69470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e69dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e69ef0>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 28.87149749285334, "cost2_max": -9.315130590543525, "outflow_rate_min": 316.2705838461859, "cost1_max": 359.82695218466904, "cost1_mean": 305.2819519357803, "system_level_velocity_mean": 11.836404112090262, "cost2_min": -143.88206604314541, "system_level_velocity_min": 9.187021761551165, "outflow_rate_max": 905.4676231376129, "system_level_velocity_max": 19.542729096532486, "outflow_rate_mean": 793.5958190318227, "cost2_mean": -111.95763510164436}, "policy_reward_mean": {}, "timesteps_this_iter": 46746, "episodes_this_iter": 16, "training_iteration": 21, "episode_reward_min": 53.162189279241645, "episode_reward_mean": 1083.9059141620323, "iterations_since_restore": 21, "time_total_s": 621.9550189971924, "timestamp": 1557199515, "pid": 300, "time_since_restore": 621.9550189971924, "episode_len_mean": 680.35, "episode_reward_max": 1297.278791323314, "episodes_total": 275, "timesteps_since_restore": 1007560, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.648, "num_steps_sampled": 1055324, "num_steps_trained": 1055324, "default": {"entropy": 1.2377800941467285, "policy_loss": -0.002168585080653429, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9870079159736633, "vf_loss": 2.7265548706054688, "total_loss": 2.724611759185791, "cur_lr": 0.0005000000237487257, "kl": 0.009015953168272972}, "sample_time_ms": 16900.786, "load_time_ms": 8.119, "grad_time_ms": 10988.01}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 1055324, "time_this_iter_s": 26.5060932636261, "date": "2019-05-07_03-25-42", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7cd30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7c390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7ceb8>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 28.87149749285334, "cost2_max": -9.315130590543525, "outflow_rate_min": 316.2705838461859, "cost1_max": 361.87110352787516, "cost1_mean": 309.9188362086051, "system_level_velocity_mean": 12.015020394118638, "cost2_min": -143.88206604314541, "system_level_velocity_min": 9.187021761551165, "outflow_rate_max": 905.4676231376129, "system_level_velocity_max": 19.542729096532486, "outflow_rate_mean": 805.3514407952507, "cost2_mean": -112.15437864802514}, "policy_reward_mean": {}, "timesteps_this_iter": 47764, "episodes_this_iter": 12, "training_iteration": 22, "episode_reward_min": 53.162189279241645, "episode_reward_mean": 1090.3124978268766, "iterations_since_restore": 22, "time_total_s": 648.4611122608185, "timestamp": 1557199542, "pid": 300, "time_since_restore": 648.4611122608185, "episode_len_mean": 680.35, "episode_reward_max": 1297.278791323314, "episodes_total": 287, "timesteps_since_restore": 1055324, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.675, "num_steps_sampled": 1101791, "num_steps_trained": 1101791, "default": {"entropy": 1.2211778163909912, "policy_loss": -0.0014438318321481347, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9842243194580078, "vf_loss": 3.4707531929016113, "total_loss": 3.4695422649383545, "cur_lr": 0.0005000000237487257, "kl": 0.009324360638856888}, "sample_time_ms": 16982.712, "load_time_ms": 8.083, "grad_time_ms": 10915.206}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 1101791, "time_this_iter_s": 26.3322594165802, "date": "2019-05-07_03-26-08", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71438>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 28.87149749285334, "cost2_max": -9.315130590543525, "outflow_rate_min": 316.2705838461859, "cost1_max": 371.1718966368294, "cost1_mean": 315.7646461345459, "system_level_velocity_mean": 12.05895079566811, "cost2_min": -143.88206604314541, "system_level_velocity_min": 10.287843295805038, "outflow_rate_max": 905.4676231376129, "system_level_velocity_max": 19.542729096532486, "outflow_rate_mean": 818.2958824232545, "cost2_mean": -114.24845082583151}, "policy_reward_mean": {}, "timesteps_this_iter": 46467, "episodes_this_iter": 13, "training_iteration": 23, "episode_reward_min": 53.162189279241645, "episode_reward_mean": 1110.319706981168, "iterations_since_restore": 23, "time_total_s": 674.7933716773987, "timestamp": 1557199568, "pid": 300, "time_since_restore": 674.7933716773987, "episode_len_mean": 686.88, "episode_reward_max": 1339.5405373194674, "episodes_total": 300, "timesteps_since_restore": 1101791, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.735, "num_steps_sampled": 1147990, "num_steps_trained": 1147990, "default": {"entropy": 1.2272143363952637, "policy_loss": -0.001955063547939062, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.9778032302856445, "vf_loss": 4.833701133728027, "total_loss": 4.831970691680908, "cur_lr": 0.0005000000237487257, "kl": 0.008992706425487995}, "sample_time_ms": 16997.811, "load_time_ms": 8.057, "grad_time_ms": 10709.436}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 1147990, "time_this_iter_s": 29.214013814926147, "date": "2019-05-07_03-26-37", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e797b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e79860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e79390>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 28.87149749285334, "cost2_max": -9.315130590543525, "outflow_rate_min": 316.2705838461859, "cost1_max": 371.1718966368294, "cost1_mean": 317.8892630121946, "system_level_velocity_mean": 12.146746760878372, "cost2_min": -143.88206604314541, "system_level_velocity_min": 10.64485125240454, "outflow_rate_max": 932.2657975804534, "system_level_velocity_max": 19.542729096532486, "outflow_rate_mean": 825.0265958336546, "cost2_mean": -115.66568744214804}, "policy_reward_mean": {}, "timesteps_this_iter": 46199, "episodes_this_iter": 16, "training_iteration": 24, "episode_reward_min": 53.162189279241645, "episode_reward_mean": 1109.9449901708526, "iterations_since_restore": 24, "time_total_s": 704.0073854923248, "timestamp": 1557199597, "pid": 300, "time_since_restore": 704.0073854923248, "episode_len_mean": 686.88, "episode_reward_max": 1339.5405373194674, "episodes_total": 316, "timesteps_since_restore": 1147990, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.81, "num_steps_sampled": 1194450, "num_steps_trained": 1194450, "default": {"entropy": 1.2135030031204224, "policy_loss": -0.003333369269967079, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.972577691078186, "vf_loss": 5.905384540557861, "total_loss": 5.902350425720215, "cur_lr": 0.0005000000237487257, "kl": 0.011970891617238522}, "sample_time_ms": 17055.661, "load_time_ms": 7.999, "grad_time_ms": 10765.584}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 1194450, "time_this_iter_s": 29.034319639205933, "date": "2019-05-07_03-27-06", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7cb70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7c198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7c588>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 28.979414279303292, "cost2_max": -9.315130590543525, "outflow_rate_min": 316.2705838461859, "cost1_max": 371.1718966368294, "cost1_mean": 319.57701589072366, "system_level_velocity_mean": 12.209638259858904, "cost2_min": -143.88206604314541, "system_level_velocity_min": 10.532196831845827, "outflow_rate_max": 948.2974471256161, "system_level_velocity_max": 19.542453406258836, "outflow_rate_mean": 828.1449253066618, "cost2_mean": -115.62767959909594}, "policy_reward_mean": {}, "timesteps_this_iter": 46460, "episodes_this_iter": 14, "training_iteration": 25, "episode_reward_min": 52.770572699242564, "episode_reward_mean": 1114.4095514492487, "iterations_since_restore": 25, "time_total_s": 733.0417051315308, "timestamp": 1557199626, "pid": 300, "time_since_restore": 733.0417051315308, "episode_len_mean": 686.88, "episode_reward_max": 1356.747230000157, "episodes_total": 330, "timesteps_since_restore": 1194450, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.745, "num_steps_sampled": 1239750, "num_steps_trained": 1239750, "default": {"entropy": 1.198974609375, "policy_loss": -0.002450088504701853, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.9772316217422485, "vf_loss": 4.932741641998291, "total_loss": 4.9305548667907715, "cur_lr": 0.0005000000237487257, "kl": 0.010529577732086182}, "sample_time_ms": 17317.932, "load_time_ms": 8.052, "grad_time_ms": 10742.696}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 1239750, "time_this_iter_s": 28.308019399642944, "date": "2019-05-07_03-27-35", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8cd68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8cda0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8cdd8>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 28.979414279303292, "cost2_max": -10.515212000190244, "outflow_rate_min": 329.6337234057179, "cost1_max": 375.2051482411467, "cost1_mean": 323.8598405568937, "system_level_velocity_mean": 12.190264187533378, "cost2_min": -143.88206604314541, "system_level_velocity_min": 10.532196831845827, "outflow_rate_max": 950.6623501515041, "system_level_velocity_max": 19.542453406258836, "outflow_rate_mean": 836.0878773268506, "cost2_mean": -116.49173382673307}, "policy_reward_mean": {}, "timesteps_this_iter": 45300, "episodes_this_iter": 14, "training_iteration": 26, "episode_reward_min": 52.770572699242564, "episode_reward_mean": 1138.3309688828592, "iterations_since_restore": 26, "time_total_s": 761.3497245311737, "timestamp": 1557199655, "pid": 300, "time_since_restore": 761.3497245311737, "episode_len_mean": 693.43, "episode_reward_max": 1356.747230000157, "episodes_total": 344, "timesteps_since_restore": 1239750, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.685, "num_steps_sampled": 1285451, "num_steps_trained": 1285451, "default": {"entropy": 1.1921155452728271, "policy_loss": -0.00200715777464211, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9675326943397522, "vf_loss": 7.166313648223877, "total_loss": 7.1645588874816895, "cur_lr": 0.0005000000237487257, "kl": 0.010127744637429714}, "sample_time_ms": 17168.088, "load_time_ms": 8.059, "grad_time_ms": 10748.196}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 1285451, "time_this_iter_s": 27.37877082824707, "date": "2019-05-07_03-28-02", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83c18>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 28.979414279303292, "cost2_max": -10.515212000190244, "outflow_rate_min": 329.6337234057179, "cost1_max": 376.9893937473388, "cost1_mean": 327.20802841149975, "system_level_velocity_mean": 12.315973778679693, "cost2_min": -141.72319075701358, "system_level_velocity_min": 10.532196831845827, "outflow_rate_max": 962.9182403986383, "system_level_velocity_max": 19.542453406258836, "outflow_rate_mean": 842.5493369449922, "cost2_mean": -114.9942379296748}, "policy_reward_mean": {}, "timesteps_this_iter": 45701, "episodes_this_iter": 16, "training_iteration": 27, "episode_reward_min": 52.770572699242564, "episode_reward_mean": 1147.3428486431399, "iterations_since_restore": 27, "time_total_s": 788.7284953594208, "timestamp": 1557199682, "pid": 300, "time_since_restore": 788.7284953594208, "episode_len_mean": 693.43, "episode_reward_max": 1373.57597904376, "episodes_total": 360, "timesteps_since_restore": 1285451, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.905, "num_steps_sampled": 1331833, "num_steps_trained": 1331833, "default": {"entropy": 1.1657750606536865, "policy_loss": -0.0026308565866202116, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.9855307936668396, "vf_loss": 3.322490930557251, "total_loss": 3.320159435272217, "cur_lr": 0.0005000000237487257, "kl": 0.011971852742135525}, "sample_time_ms": 17153.029, "load_time_ms": 7.999, "grad_time_ms": 10787.922}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 1331833, "time_this_iter_s": 27.370723247528076, "date": "2019-05-07_03-28-30", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8c390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8c0b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8c358>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 28.979414279303292, "cost2_max": -10.515212000190244, "outflow_rate_min": 329.6337234057179, "cost1_max": 378.49295286353504, "cost1_mean": 330.2926598644448, "system_level_velocity_mean": 12.420979075096527, "cost2_min": -141.72319075701358, "system_level_velocity_min": 10.532196831845827, "outflow_rate_max": 962.9182403986383, "system_level_velocity_max": 19.542453406258836, "outflow_rate_mean": 848.7878988418349, "cost2_mean": -114.65648466331977}, "policy_reward_mean": {}, "timesteps_this_iter": 46382, "episodes_this_iter": 11, "training_iteration": 28, "episode_reward_min": 52.770572699242564, "episode_reward_mean": 1155.8662036092442, "iterations_since_restore": 28, "time_total_s": 816.0992186069489, "timestamp": 1557199710, "pid": 300, "time_since_restore": 816.0992186069489, "episode_len_mean": 693.43, "episode_reward_max": 1373.57597904376, "episodes_total": 371, "timesteps_since_restore": 1331833, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 8.001, "num_steps_sampled": 1376794, "num_steps_trained": 1376794, "default": {"entropy": 1.1464147567749023, "policy_loss": -0.0020068553276360035, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9831437468528748, "vf_loss": 4.288244724273682, "total_loss": 4.286540508270264, "cur_lr": 0.0005000000237487257, "kl": 0.012123119086027145}, "sample_time_ms": 16954.111, "load_time_ms": 8.097, "grad_time_ms": 10715.013}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 1376794, "time_this_iter_s": 25.59272527694702, "date": "2019-05-07_03-28-55", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e714e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71be0>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 28.979414279303292, "cost2_max": -10.515212000190244, "outflow_rate_min": 329.6337234057179, "cost1_max": 387.4313956344058, "cost1_mean": 334.0439406683061, "system_level_velocity_mean": 12.557884614369204, "cost2_min": -141.72319075701358, "system_level_velocity_min": 10.532196831845827, "outflow_rate_max": 974.802738589313, "system_level_velocity_max": 19.542453406258836, "outflow_rate_mean": 856.8405488548304, "cost2_mean": -113.43771035811193}, "policy_reward_mean": {}, "timesteps_this_iter": 44961, "episodes_this_iter": 14, "training_iteration": 29, "episode_reward_min": 52.770572699242564, "episode_reward_mean": 1162.3473732807308, "iterations_since_restore": 29, "time_total_s": 841.6919438838959, "timestamp": 1557199735, "pid": 300, "time_since_restore": 841.6919438838959, "episode_len_mean": 693.43, "episode_reward_max": 1383.9970374468685, "episodes_total": 385, "timesteps_since_restore": 1376794, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 8.259, "num_steps_sampled": 1421524, "num_steps_trained": 1421524, "default": {"entropy": 1.1604951620101929, "policy_loss": -0.0018133396515622735, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.9780181646347046, "vf_loss": 6.281401634216309, "total_loss": 6.279886722564697, "cur_lr": 0.0005000000237487257, "kl": 0.01192790549248457}, "sample_time_ms": 16782.248, "load_time_ms": 8.082, "grad_time_ms": 10671.349}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 1421524, "time_this_iter_s": 27.364428758621216, "date": "2019-05-07_03-29-23", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8cc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8c978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8c860>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 28.979414279303292, "cost2_max": -10.515212000190244, "outflow_rate_min": 329.6337234057179, "cost1_max": 406.0758292361424, "cost1_mean": 336.36293880694376, "system_level_velocity_mean": 12.669047009758447, "cost2_min": -141.72319075701358, "system_level_velocity_min": 10.532196831845827, "outflow_rate_max": 1012.9228229867814, "system_level_velocity_max": 19.542453406258836, "outflow_rate_mean": 861.1573496898797, "cost2_mean": -112.53650330228598}, "policy_reward_mean": {}, "timesteps_this_iter": 44730, "episodes_this_iter": 19, "training_iteration": 30, "episode_reward_min": 52.770572699242564, "episode_reward_mean": 1153.423810921118, "iterations_since_restore": 30, "time_total_s": 869.0563726425171, "timestamp": 1557199763, "pid": 300, "time_since_restore": 869.0563726425171, "episode_len_mean": 693.43, "episode_reward_max": 1390.269653423041, "episodes_total": 404, "timesteps_since_restore": 1421524, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 8.1, "num_steps_sampled": 1467128, "num_steps_trained": 1467128, "default": {"entropy": 1.156583309173584, "policy_loss": -0.003230038098990917, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9884287714958191, "vf_loss": 2.8834543228149414, "total_loss": 2.8805055618286133, "cur_lr": 0.0005000000237487257, "kl": 0.01126151904463768}, "sample_time_ms": 16823.169, "load_time_ms": 8.041, "grad_time_ms": 10588.431}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 1467128, "time_this_iter_s": 28.064220190048218, "date": "2019-05-07_03-29-51", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e836a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83128>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 28.979414279303292, "cost2_max": -10.515212000190244, "outflow_rate_min": 329.6337234057179, "cost1_max": 410.2539383350278, "cost1_mean": 339.40667447726105, "system_level_velocity_mean": 12.791289736476193, "cost2_min": -139.03362467266248, "system_level_velocity_min": 10.532196831845827, "outflow_rate_max": 1012.9228229867814, "system_level_velocity_max": 19.542453406258836, "outflow_rate_mean": 866.7375956288072, "cost2_mean": -111.90349004835883}, "policy_reward_mean": {}, "timesteps_this_iter": 45604, "episodes_this_iter": 9, "training_iteration": 31, "episode_reward_min": 52.770572699242564, "episode_reward_mean": 1158.2290542761439, "iterations_since_restore": 31, "time_total_s": 897.1205928325653, "timestamp": 1557199791, "pid": 300, "time_since_restore": 897.1205928325653, "episode_len_mean": 693.43, "episode_reward_max": 1390.269653423041, "episodes_total": 413, "timesteps_since_restore": 1467128, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.977, "num_steps_sampled": 1512407, "num_steps_trained": 1512407, "default": {"entropy": 1.1143206357955933, "policy_loss": -0.0031474358402192593, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.9761976599693298, "vf_loss": 6.5009260177612305, "total_loss": 6.498106479644775, "cur_lr": 0.0005000000237487257, "kl": 0.013089018873870373}, "sample_time_ms": 16953.778, "load_time_ms": 7.988, "grad_time_ms": 10500.898}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 1512407, "time_this_iter_s": 26.936017990112305, "date": "2019-05-07_03-30-18", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8c198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8c240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8c400>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 280.56459560140297, "cost2_max": -73.73370210944852, "outflow_rate_min": 730.3422686672152, "cost1_max": 410.2539383350278, "cost1_mean": 344.19831171905906, "system_level_velocity_mean": 12.801911246856925, "cost2_min": -139.03362467266248, "system_level_velocity_min": 10.532196831845827, "outflow_rate_max": 1012.9228229867814, "system_level_velocity_max": 15.316980132943117, "outflow_rate_mean": 876.7547762354546, "cost2_mean": -113.17661490633819}, "policy_reward_mean": {}, "timesteps_this_iter": 45279, "episodes_this_iter": 14, "training_iteration": 32, "episode_reward_min": 925.9033811076812, "episode_reward_mean": 1168.7693414368334, "iterations_since_restore": 32, "time_total_s": 924.0566108226776, "timestamp": 1557199818, "pid": 300, "time_since_restore": 924.0566108226776, "episode_len_mean": 700.0, "episode_reward_max": 1390.269653423041, "episodes_total": 427, "timesteps_since_restore": 1512407, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 8.046, "num_steps_sampled": 1557653, "num_steps_trained": 1557653, "default": {"entropy": 1.1336840391159058, "policy_loss": -0.003862683894112706, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.9720408916473389, "vf_loss": 7.326254844665527, "total_loss": 7.322698593139648, "cur_lr": 0.0005000000237487257, "kl": 0.012234337627887726}, "sample_time_ms": 17002.154, "load_time_ms": 7.541, "grad_time_ms": 10473.181}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 1557653, "time_this_iter_s": 26.51847267150879, "date": "2019-05-07_03-30-44", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83f98>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 33.3649275014601, "cost2_max": -12.3336170056064, "outflow_rate_min": 323.4363846761304, "cost1_max": 410.2539383350278, "cost1_mean": 344.60348342078464, "system_level_velocity_mean": 13.020365276338811, "cost2_min": -141.19735871075477, "system_level_velocity_min": 10.642854056294611, "outflow_rate_max": 1012.9228229867814, "system_level_velocity_max": 18.20269152188299, "outflow_rate_mean": 881.5079375405834, "cost2_mean": -113.08958337743479}, "policy_reward_mean": {}, "timesteps_this_iter": 45246, "episodes_this_iter": 20, "training_iteration": 33, "episode_reward_min": 61.16316517815547, "episode_reward_mean": 1149.0662671390353, "iterations_since_restore": 33, "time_total_s": 950.5750834941864, "timestamp": 1557199844, "pid": 300, "time_since_restore": 950.5750834941864, "episode_len_mean": 693.5, "episode_reward_max": 1390.269653423041, "episodes_total": 447, "timesteps_since_restore": 1557653, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 8.014, "num_steps_sampled": 1603826, "num_steps_trained": 1603826, "default": {"entropy": 1.1365877389907837, "policy_loss": -0.0030525352340191603, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.987392008304596, "vf_loss": 3.677354574203491, "total_loss": 3.674603223800659, "cur_lr": 0.0005000000237487257, "kl": 0.012045666575431824}, "sample_time_ms": 16890.756, "load_time_ms": 7.479, "grad_time_ms": 10438.337}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 1603826, "time_this_iter_s": 27.74819850921631, "date": "2019-05-07_03-31-12", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8ccf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8cb00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8cf28>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 33.3649275014601, "cost2_max": -12.3336170056064, "outflow_rate_min": 323.4363846761304, "cost1_max": 410.2539383350278, "cost1_mean": 345.297950568388, "system_level_velocity_mean": 13.063106260741938, "cost2_min": -141.19735871075477, "system_level_velocity_min": 10.642854056294611, "outflow_rate_max": 1012.9228229867814, "system_level_velocity_max": 18.20269152188299, "outflow_rate_mean": 884.4644914907946, "cost2_mean": -113.32892165053835}, "policy_reward_mean": {}, "timesteps_this_iter": 46173, "episodes_this_iter": 10, "training_iteration": 34, "episode_reward_min": 61.16316517815547, "episode_reward_mean": 1141.8364276583281, "iterations_since_restore": 34, "time_total_s": 978.3232820034027, "timestamp": 1557199872, "pid": 300, "time_since_restore": 978.3232820034027, "episode_len_mean": 693.5, "episode_reward_max": 1390.269653423041, "episodes_total": 457, "timesteps_since_restore": 1603826, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 8.003, "num_steps_sampled": 1649694, "num_steps_trained": 1649694, "default": {"entropy": 1.1015864610671997, "policy_loss": -0.002767043188214302, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9806007146835327, "vf_loss": 5.690598964691162, "total_loss": 5.688116073608398, "cur_lr": 0.0005000000237487257, "kl": 0.011382297612726688}, "sample_time_ms": 16849.036, "load_time_ms": 7.423, "grad_time_ms": 10282.245}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 1649694, "time_this_iter_s": 27.05747103691101, "date": "2019-05-07_03-31-39", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83320>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 33.3649275014601, "cost2_max": -12.3336170056064, "outflow_rate_min": 323.4363846761304, "cost1_max": 416.68550622307725, "cost1_mean": 342.3122775959215, "system_level_velocity_mean": 13.150979092952022, "cost2_min": -141.19735871075477, "system_level_velocity_min": 10.218349884604141, "outflow_rate_max": 1012.9228229867814, "system_level_velocity_max": 18.799322666608063, "outflow_rate_mean": 878.7178971143554, "cost2_mean": -113.83309880013513}, "policy_reward_mean": {}, "timesteps_this_iter": 45868, "episodes_this_iter": 15, "training_iteration": 35, "episode_reward_min": 61.16316517815547, "episode_reward_mean": 1125.247786589079, "iterations_since_restore": 35, "time_total_s": 1005.3807530403137, "timestamp": 1557199899, "pid": 300, "time_since_restore": 1005.3807530403137, "episode_len_mean": 687.0, "episode_reward_max": 1390.269653423041, "episodes_total": 472, "timesteps_since_restore": 1649694, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 8.025, "num_steps_sampled": 1696985, "num_steps_trained": 1696985, "default": {"entropy": 1.136912226676941, "policy_loss": -0.0028965547680854797, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.9800816774368286, "vf_loss": 5.513437271118164, "total_loss": 5.510864734649658, "cur_lr": 0.0005000000237487257, "kl": 0.012973375618457794}, "sample_time_ms": 16855.904, "load_time_ms": 7.566, "grad_time_ms": 10316.699}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 1696985, "time_this_iter_s": 28.747854471206665, "date": "2019-05-07_03-32-08", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8c0f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8c400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8c160>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 33.3649275014601, "cost2_max": -12.3336170056064, "outflow_rate_min": 323.4363846761304, "cost1_max": 416.68550622307725, "cost1_mean": 341.09348351193114, "system_level_velocity_mean": 13.122299538233728, "cost2_min": -147.7388220930195, "system_level_velocity_min": 10.218349884604141, "outflow_rate_max": 1012.9228229867814, "system_level_velocity_max": 18.799322666608063, "outflow_rate_mean": 877.263507139554, "cost2_mean": -116.70491757962705}, "policy_reward_mean": {}, "timesteps_this_iter": 47291, "episodes_this_iter": 17, "training_iteration": 36, "episode_reward_min": 61.16316517815547, "episode_reward_mean": 1116.0649191393036, "iterations_since_restore": 36, "time_total_s": 1034.1286075115204, "timestamp": 1557199928, "pid": 300, "time_since_restore": 1034.1286075115204, "episode_len_mean": 687.0, "episode_reward_max": 1390.269653423041, "episodes_total": 489, "timesteps_since_restore": 1696985, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 8.078, "num_steps_sampled": 1743831, "num_steps_trained": 1743831, "default": {"entropy": 1.1107134819030762, "policy_loss": -0.002484916942194104, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.9883105754852295, "vf_loss": 3.1484339237213135, "total_loss": 3.1462271213531494, "cur_lr": 0.0005000000237487257, "kl": 0.011136560700833797}, "sample_time_ms": 16818.834, "load_time_ms": 7.607, "grad_time_ms": 10243.505}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 1743831, "time_this_iter_s": 26.253607034683228, "date": "2019-05-07_03-32-34", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e792b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e798d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e79940>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 33.3649275014601, "cost2_max": -12.3336170056064, "outflow_rate_min": 323.4363846761304, "cost1_max": 421.40817341820815, "cost1_mean": 341.8527241622804, "system_level_velocity_mean": 13.144494762340232, "cost2_min": -147.7388220930195, "system_level_velocity_min": 10.218349884604141, "outflow_rate_max": 1007.8612829376598, "system_level_velocity_max": 18.799322666608063, "outflow_rate_mean": 879.047287234003, "cost2_mean": -117.1339144173208}, "policy_reward_mean": {}, "timesteps_this_iter": 46846, "episodes_this_iter": 10, "training_iteration": 37, "episode_reward_min": 61.16316517815547, "episode_reward_mean": 1119.5463218674115, "iterations_since_restore": 37, "time_total_s": 1060.3822145462036, "timestamp": 1557199954, "pid": 300, "time_since_restore": 1060.3822145462036, "episode_len_mean": 687.0, "episode_reward_max": 1383.8419424618755, "episodes_total": 499, "timesteps_since_restore": 1743831, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 8.004, "num_steps_sampled": 1788430, "num_steps_trained": 1788430, "default": {"entropy": 1.1121894121170044, "policy_loss": -0.005813894793391228, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.978428304195404, "vf_loss": 6.578812599182129, "total_loss": 6.5735368728637695, "cur_lr": 0.0005000000237487257, "kl": 0.02152630314230919}, "sample_time_ms": 16765.923, "load_time_ms": 7.691, "grad_time_ms": 10143.249}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 1788430, "time_this_iter_s": 25.83571720123291, "date": "2019-05-07_03-33-00", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8cc18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8cb38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8cf28>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 33.3649275014601, "cost2_max": -11.327870135974257, "outflow_rate_min": 315.659224733971, "cost1_max": 421.40817341820815, "cost1_mean": 337.0649867647024, "system_level_velocity_mean": 13.146819727888026, "cost2_min": -147.7388220930195, "system_level_velocity_min": 10.218349884604141, "outflow_rate_max": 1018.8001467942689, "system_level_velocity_max": 18.799322666608063, "outflow_rate_mean": 869.6550249746917, "cost2_mean": -115.93667416185586}, "policy_reward_mean": {}, "timesteps_this_iter": 44599, "episodes_this_iter": 17, "training_iteration": 38, "episode_reward_min": 61.16316517815547, "episode_reward_mean": 1102.2646504637926, "iterations_since_restore": 38, "time_total_s": 1086.2179317474365, "timestamp": 1557199980, "pid": 300, "time_since_restore": 1086.2179317474365, "episode_len_mean": 680.52, "episode_reward_max": 1382.2854591857247, "episodes_total": 516, "timesteps_since_restore": 1788430, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.96, "num_steps_sampled": 1834428, "num_steps_trained": 1834428, "default": {"entropy": 1.139902114868164, "policy_loss": -0.00264772423543036, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9870729446411133, "vf_loss": 3.592996120452881, "total_loss": 3.590822458267212, "cur_lr": 0.0005000000237487257, "kl": 0.012634629383683205}, "sample_time_ms": 16944.494, "load_time_ms": 7.878, "grad_time_ms": 10112.94}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 1834428, "time_this_iter_s": 27.07728385925293, "date": "2019-05-07_03-33-27", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96400>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 33.94172922307231, "cost2_max": -11.327870135974257, "outflow_rate_min": 315.659224733971, "cost1_max": 421.40817341820815, "cost1_mean": 340.3972935859381, "system_level_velocity_mean": 13.095224397143204, "cost2_min": -147.7388220930195, "system_level_velocity_min": 10.218349884604141, "outflow_rate_max": 1018.8001467942689, "system_level_velocity_max": 18.799322666608063, "outflow_rate_mean": 872.670347047347, "cost2_mean": -117.0843918633108}, "policy_reward_mean": {}, "timesteps_this_iter": 45998, "episodes_this_iter": 16, "training_iteration": 39, "episode_reward_min": 62.14416930098245, "episode_reward_mean": 1115.1477433399557, "iterations_since_restore": 39, "time_total_s": 1113.2952156066895, "timestamp": 1557200007, "pid": 300, "time_since_restore": 1113.2952156066895, "episode_len_mean": 687.02, "episode_reward_max": 1382.2854591857247, "episodes_total": 532, "timesteps_since_restore": 1834428, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.582, "num_steps_sampled": 1880418, "num_steps_trained": 1880418, "default": {"entropy": 1.1054660081863403, "policy_loss": -0.0031702567357569933, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9915030002593994, "vf_loss": 2.573672294616699, "total_loss": 2.5709633827209473, "cur_lr": 0.0005000000237487257, "kl": 0.012303576804697514}, "sample_time_ms": 16932.704, "load_time_ms": 7.357, "grad_time_ms": 10083.49}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 1880418, "time_this_iter_s": 26.932044982910156, "date": "2019-05-07_03-33-54", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8c048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e710f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71198>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 33.94172922307231, "cost2_max": -11.327870135974257, "outflow_rate_min": 315.659224733971, "cost1_max": 421.40817341820815, "cost1_mean": 340.00064847269294, "system_level_velocity_mean": 13.079394243140777, "cost2_min": -147.7388220930195, "system_level_velocity_min": 10.218349884604141, "outflow_rate_max": 1018.8001467942689, "system_level_velocity_max": 18.799322666608063, "outflow_rate_mean": 870.336764437779, "cost2_mean": -116.05873495939444}, "policy_reward_mean": {}, "timesteps_this_iter": 45990, "episodes_this_iter": 10, "training_iteration": 40, "episode_reward_min": 62.14416930098245, "episode_reward_mean": 1111.3500604968158, "iterations_since_restore": 40, "time_total_s": 1140.2272605895996, "timestamp": 1557200034, "pid": 300, "time_since_restore": 1140.2272605895996, "episode_len_mean": 687.02, "episode_reward_max": 1382.2854591857247, "episodes_total": 542, "timesteps_since_restore": 1880418, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.359, "num_steps_sampled": 1923628, "num_steps_trained": 1923628, "default": {"entropy": 1.072650671005249, "policy_loss": -0.0034374885726720095, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.9850510954856873, "vf_loss": 5.687841415405273, "total_loss": 5.685037612915039, "cur_lr": 0.0005000000237487257, "kl": 0.016906114295125008}, "sample_time_ms": 16945.404, "load_time_ms": 7.363, "grad_time_ms": 9950.039}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 1923628, "time_this_iter_s": 26.85050392150879, "date": "2019-05-07_03-34-21", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e837f0>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 33.94172922307231, "cost2_max": -11.327870135974257, "outflow_rate_min": 315.659224733971, "cost1_max": 421.40817341820815, "cost1_mean": 342.0062421511313, "system_level_velocity_mean": 13.23582012204061, "cost2_min": -147.7388220930195, "system_level_velocity_min": 10.218349884604141, "outflow_rate_max": 1018.8001467942689, "system_level_velocity_max": 18.799322666608063, "outflow_rate_mean": 870.8204273351716, "cost2_mean": -112.50170249884145}, "policy_reward_mean": {}, "timesteps_this_iter": 43210, "episodes_this_iter": 20, "training_iteration": 41, "episode_reward_min": 62.14416930098245, "episode_reward_mean": 1113.8817201830582, "iterations_since_restore": 41, "time_total_s": 1167.0777645111084, "timestamp": 1557200061, "pid": 300, "time_since_restore": 1167.0777645111084, "episode_len_mean": 683.38, "episode_reward_max": 1382.2854591857247, "episodes_total": 562, "timesteps_since_restore": 1923628, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.277, "num_steps_sampled": 1970110, "num_steps_trained": 1970110, "default": {"entropy": 1.0916146039962769, "policy_loss": -0.0033672661520540714, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9878950119018555, "vf_loss": 3.4396448135375977, "total_loss": 3.436728000640869, "cur_lr": 0.0005000000237487257, "kl": 0.012018621899187565}, "sample_time_ms": 16986.683, "load_time_ms": 7.381, "grad_time_ms": 9970.764}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 1970110, "time_this_iter_s": 27.56104803085327, "date": "2019-05-07_03-34-48", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e838d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e834a8>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 35.09473945974734, "cost2_max": -11.327870135974257, "outflow_rate_min": 315.659224733971, "cost1_max": 424.29459704034286, "cost1_mean": 348.9160888721948, "system_level_velocity_mean": 13.318438245059182, "cost2_min": -147.02507547235828, "system_level_velocity_min": 10.788931146200904, "outflow_rate_max": 1018.8001467942689, "system_level_velocity_max": 18.38972388987643, "outflow_rate_mean": 882.4258576775086, "cost2_mean": -110.67552158433696}, "policy_reward_mean": {}, "timesteps_this_iter": 46482, "episodes_this_iter": 15, "training_iteration": 42, "episode_reward_min": 71.93483932598107, "episode_reward_mean": 1130.009912614127, "iterations_since_restore": 42, "time_total_s": 1194.6388125419617, "timestamp": 1557200088, "pid": 300, "time_since_restore": 1194.6388125419617, "episode_len_mean": 689.88, "episode_reward_max": 1382.2854591857247, "episodes_total": 577, "timesteps_since_restore": 1970110, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.268, "num_steps_sampled": 2016274, "num_steps_trained": 2016274, "default": {"entropy": 1.0529991388320923, "policy_loss": -0.003338172798976302, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.9917677044868469, "vf_loss": 2.5851080417633057, "total_loss": 2.582296371459961, "cur_lr": 0.0005000000237487257, "kl": 0.014043653383851051}, "sample_time_ms": 17052.621, "load_time_ms": 7.721, "grad_time_ms": 9905.029}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 2016274, "time_this_iter_s": 26.525177001953125, "date": "2019-05-07_03-35-15", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e968d0>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 35.09473945974734, "cost2_max": -11.327870135974257, "outflow_rate_min": 315.659224733971, "cost1_max": 424.29459704034286, "cost1_mean": 349.79728319715434, "system_level_velocity_mean": 13.345816176111489, "cost2_min": -147.02507547235828, "system_level_velocity_min": 10.788931146200904, "outflow_rate_max": 1018.8001467942689, "system_level_velocity_max": 18.38972388987643, "outflow_rate_mean": 884.3658368280356, "cost2_mean": -109.41114850960534}, "policy_reward_mean": {}, "timesteps_this_iter": 46164, "episodes_this_iter": 9, "training_iteration": 43, "episode_reward_min": 71.93483932598107, "episode_reward_mean": 1134.3525312740992, "iterations_since_restore": 43, "time_total_s": 1221.1639895439148, "timestamp": 1557200115, "pid": 300, "time_since_restore": 1221.1639895439148, "episode_len_mean": 689.88, "episode_reward_max": 1382.2854591857247, "episodes_total": 586, "timesteps_since_restore": 2016274, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.239, "num_steps_sampled": 2062874, "num_steps_trained": 2062874, "default": {"entropy": 1.0913089513778687, "policy_loss": -0.0021336025092750788, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.9857597947120667, "vf_loss": 5.121945858001709, "total_loss": 5.120289325714111, "cur_lr": 0.0005000000237487257, "kl": 0.012726867571473122}, "sample_time_ms": 17097.337, "load_time_ms": 7.75, "grad_time_ms": 9815.575}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 2062874, "time_this_iter_s": 27.29613995552063, "date": "2019-05-07_03-35-42", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8c240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7c668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8c0f0>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 34.24612125002885, "cost2_max": -11.327870135974257, "outflow_rate_min": 315.659224733971, "cost1_max": 424.29459704034286, "cost1_mean": 351.23002081243527, "system_level_velocity_mean": 13.566908277639403, "cost2_min": -144.54540088668585, "system_level_velocity_min": 10.788931146200904, "outflow_rate_max": 1018.8001467942689, "system_level_velocity_max": 19.205220734729167, "outflow_rate_mean": 887.8383450231682, "cost2_mean": -105.81005621275966}, "policy_reward_mean": {}, "timesteps_this_iter": 46600, "episodes_this_iter": 19, "training_iteration": 44, "episode_reward_min": 70.99427163556804, "episode_reward_mean": 1134.8656404070116, "iterations_since_restore": 44, "time_total_s": 1248.4601294994354, "timestamp": 1557200142, "pid": 300, "time_since_restore": 1248.4601294994354, "episode_len_mean": 683.38, "episode_reward_max": 1382.2854591857247, "episodes_total": 605, "timesteps_since_restore": 2062874, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.103, "num_steps_sampled": 2106827, "num_steps_trained": 2106827, "default": {"entropy": 1.0920524597167969, "policy_loss": -0.002213255735114217, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9867463707923889, "vf_loss": 4.906883716583252, "total_loss": 4.9052324295043945, "cur_lr": 0.0005000000237487257, "kl": 0.014981374144554138}, "sample_time_ms": 17070.697, "load_time_ms": 7.675, "grad_time_ms": 9659.97}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 2106827, "time_this_iter_s": 25.218356132507324, "date": "2019-05-07_03-36-08", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e836a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83128>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 34.24612125002885, "cost2_max": -15.424347350185089, "outflow_rate_min": 326.3279975793562, "cost1_max": 424.29459704034286, "cost1_mean": 356.1180068569129, "system_level_velocity_mean": 13.686421158293442, "cost2_min": -144.54540088668585, "system_level_velocity_min": 11.56379600773723, "outflow_rate_max": 1019.7680918203306, "system_level_velocity_max": 19.205220734729167, "outflow_rate_mean": 895.2236519472135, "cost2_mean": -103.33356785400325}, "policy_reward_mean": {}, "timesteps_this_iter": 43953, "episodes_this_iter": 14, "training_iteration": 45, "episode_reward_min": 70.99427163556804, "episode_reward_mean": 1137.7547590730762, "iterations_since_restore": 45, "time_total_s": 1273.6784856319427, "timestamp": 1557200168, "pid": 300, "time_since_restore": 1273.6784856319427, "episode_len_mean": 685.7, "episode_reward_max": 1353.3630599571238, "episodes_total": 619, "timesteps_since_restore": 2106827, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.027, "num_steps_sampled": 2150921, "num_steps_trained": 2150921, "default": {"entropy": 1.038063406944275, "policy_loss": -0.0016526083927601576, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.9881511926651001, "vf_loss": 3.9113516807556152, "total_loss": 3.9102165699005127, "cur_lr": 0.0005000000237487257, "kl": 0.013799761421978474}, "sample_time_ms": 17054.624, "load_time_ms": 7.39, "grad_time_ms": 9455.981}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 2150921, "time_this_iter_s": 26.53961491584778, "date": "2019-05-07_03-36-34", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e834a8>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 34.24612125002885, "cost2_max": -15.424347350185089, "outflow_rate_min": 326.3279975793562, "cost1_max": 424.29459704034286, "cost1_mean": 358.1718760994933, "system_level_velocity_mean": 13.76670130201452, "cost2_min": -144.54540088668585, "system_level_velocity_min": 11.56379600773723, "outflow_rate_max": 1019.7680918203306, "system_level_velocity_max": 19.205220734729167, "outflow_rate_mean": 897.9382947555983, "cost2_mean": -100.7353811173782}, "policy_reward_mean": {}, "timesteps_this_iter": 44094, "episodes_this_iter": 14, "training_iteration": 46, "episode_reward_min": 70.99427163556804, "episode_reward_mean": 1138.5215885377456, "iterations_since_restore": 46, "time_total_s": 1300.2181005477905, "timestamp": 1557200194, "pid": 300, "time_since_restore": 1300.2181005477905, "episode_len_mean": 685.7, "episode_reward_max": 1377.0644213249925, "episodes_total": 633, "timesteps_since_restore": 2150921, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 6.979, "num_steps_sampled": 2196237, "num_steps_trained": 2196237, "default": {"entropy": 1.0502809286117554, "policy_loss": -0.0023199133574962616, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.9817696213722229, "vf_loss": 5.282939910888672, "total_loss": 5.281139373779297, "cur_lr": 0.0005000000237487257, "kl": 0.013847719877958298}, "sample_time_ms": 17287.52, "load_time_ms": 7.586, "grad_time_ms": 9315.964}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 2196237, "time_this_iter_s": 27.18038582801819, "date": "2019-05-07_03-37-01", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83358>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 34.24612125002885, "cost2_max": -15.424347350185089, "outflow_rate_min": 326.3279975793562, "cost1_max": 432.8970491518441, "cost1_mean": 362.8082766393334, "system_level_velocity_mean": 13.921971522923183, "cost2_min": -144.54540088668585, "system_level_velocity_min": 11.929962717342667, "outflow_rate_max": 1019.7680918203306, "system_level_velocity_max": 19.205220734729167, "outflow_rate_mean": 904.3425507697099, "cost2_mean": -100.14809319738043}, "policy_reward_mean": {}, "timesteps_this_iter": 45316, "episodes_this_iter": 16, "training_iteration": 47, "episode_reward_min": 70.99427163556804, "episode_reward_mean": 1157.9090117002734, "iterations_since_restore": 47, "time_total_s": 1327.3984863758087, "timestamp": 1557200221, "pid": 300, "time_since_restore": 1327.3984863758087, "episode_len_mean": 685.7, "episode_reward_max": 1403.5239355715678, "episodes_total": 649, "timesteps_since_restore": 2196237, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 6.996, "num_steps_sampled": 2242573, "num_steps_trained": 2242573, "default": {"entropy": 1.103835105895996, "policy_loss": -0.0029407732654362917, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.9859605431556702, "vf_loss": 5.051760673522949, "total_loss": 5.049400806427002, "cur_lr": 0.0005000000237487257, "kl": 0.015497753396630287}, "sample_time_ms": 17379.339, "load_time_ms": 7.408, "grad_time_ms": 9261.906}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 2242573, "time_this_iter_s": 26.24054741859436, "date": "2019-05-07_03-37-28", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e968d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e966d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96588>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 34.24612125002885, "cost2_max": -15.424347350185089, "outflow_rate_min": 326.3279975793562, "cost1_max": 432.8970491518441, "cost1_mean": 363.1628681295488, "system_level_velocity_mean": 13.915914554448388, "cost2_min": -143.1892015311913, "system_level_velocity_min": 11.27568300514378, "outflow_rate_max": 1019.7680918203306, "system_level_velocity_max": 19.205220734729167, "outflow_rate_mean": 904.828915636152, "cost2_mean": -98.97969259797311}, "policy_reward_mean": {}, "timesteps_this_iter": 46336, "episodes_this_iter": 14, "training_iteration": 48, "episode_reward_min": 70.99427163556804, "episode_reward_mean": 1159.8047000513025, "iterations_since_restore": 48, "time_total_s": 1353.639033794403, "timestamp": 1557200248, "pid": 300, "time_since_restore": 1353.639033794403, "episode_len_mean": 686.3, "episode_reward_max": 1403.5239355715678, "episodes_total": 663, "timesteps_since_restore": 2242573, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.194, "num_steps_sampled": 2288291, "num_steps_trained": 2288291, "default": {"entropy": 1.0482957363128662, "policy_loss": -0.0029953017365187407, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.9891018867492676, "vf_loss": 3.5549192428588867, "total_loss": 3.552457094192505, "cur_lr": 0.0005000000237487257, "kl": 0.01421502884477377}, "sample_time_ms": 17400.148, "load_time_ms": 7.304, "grad_time_ms": 9275.497}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 2288291, "time_this_iter_s": 27.42452335357666, "date": "2019-05-07_03-37-55", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96358>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 34.24612125002885, "cost2_max": -15.424347350185089, "outflow_rate_min": 326.3279975793562, "cost1_max": 432.8970491518441, "cost1_mean": 359.7201511442937, "system_level_velocity_mean": 13.84957220988655, "cost2_min": -143.1892015311913, "system_level_velocity_min": 10.98142904738913, "outflow_rate_max": 1019.7680918203306, "system_level_velocity_max": 19.205220734729167, "outflow_rate_mean": 898.6624814256071, "cost2_mean": -97.62614000835875}, "policy_reward_mean": {}, "timesteps_this_iter": 45718, "episodes_this_iter": 13, "training_iteration": 49, "episode_reward_min": 70.99427163556804, "episode_reward_mean": 1150.811594209267, "iterations_since_restore": 49, "time_total_s": 1381.0635571479797, "timestamp": 1557200275, "pid": 300, "time_since_restore": 1381.0635571479797, "episode_len_mean": 683.65, "episode_reward_max": 1403.5239355715678, "episodes_total": 676, "timesteps_since_restore": 2288291, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.329, "num_steps_sampled": 2332209, "num_steps_trained": 2332209, "default": {"entropy": 1.0531255006790161, "policy_loss": -0.004902584478259087, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9805617332458496, "vf_loss": 6.079893112182617, "total_loss": 6.075666427612305, "cur_lr": 0.0005000000237487257, "kl": 0.018025219440460205}, "sample_time_ms": 17356.688, "load_time_ms": 7.818, "grad_time_ms": 9182.442}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 2332209, "time_this_iter_s": 25.589328050613403, "date": "2019-05-07_03-38-21", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e714e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71f60>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 34.14678020909398, "cost2_max": -14.767322108440927, "outflow_rate_min": 326.3279975793562, "cost1_max": 432.8970491518441, "cost1_mean": 359.1029445691502, "system_level_velocity_mean": 13.827508872419953, "cost2_min": -125.31632310535582, "system_level_velocity_min": 10.98142904738913, "outflow_rate_max": 1019.7680918203306, "system_level_velocity_max": 18.991703220638456, "outflow_rate_mean": 896.6965368039521, "cost2_mean": -96.4636168590671}, "policy_reward_mean": {}, "timesteps_this_iter": 43918, "episodes_this_iter": 18, "training_iteration": 50, "episode_reward_min": 62.209051914762405, "episode_reward_mean": 1153.134574484858, "iterations_since_restore": 50, "time_total_s": 1406.6528851985931, "timestamp": 1557200301, "pid": 300, "time_since_restore": 1406.6528851985931, "episode_len_mean": 683.65, "episode_reward_max": 1403.5239355715678, "episodes_total": 694, "timesteps_since_restore": 2332209, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.461, "num_steps_sampled": 2376513, "num_steps_trained": 2376513, "default": {"entropy": 1.0522781610488892, "policy_loss": -0.004703826270997524, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9850783348083496, "vf_loss": 5.058700084686279, "total_loss": 5.054626941680908, "cur_lr": 0.0005000000237487257, "kl": 0.016804322600364685}, "sample_time_ms": 17225.361, "load_time_ms": 7.72, "grad_time_ms": 9219.897}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 2376513, "time_this_iter_s": 25.930988311767578, "date": "2019-05-07_03-38-47", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7ccc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7c160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7ca20>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 34.14678020909398, "cost2_max": -14.767322108440927, "outflow_rate_min": 326.3279975793562, "cost1_max": 432.8970491518441, "cost1_mean": 357.4219662690351, "system_level_velocity_mean": 13.915231571536397, "cost2_min": -131.02627984568625, "system_level_velocity_min": 10.98142904738913, "outflow_rate_max": 1019.7680918203306, "system_level_velocity_max": 18.991703220638456, "outflow_rate_mean": 894.3592420310468, "cost2_mean": -96.08179714483646}, "policy_reward_mean": {}, "timesteps_this_iter": 44304, "episodes_this_iter": 13, "training_iteration": 51, "episode_reward_min": 62.209051914762405, "episode_reward_mean": 1145.9907985793766, "iterations_since_restore": 51, "time_total_s": 1432.5838735103607, "timestamp": 1557200327, "pid": 300, "time_since_restore": 1432.5838735103607, "episode_len_mean": 677.82, "episode_reward_max": 1403.5239355715678, "episodes_total": 707, "timesteps_since_restore": 2376513, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.539, "num_steps_sampled": 2419370, "num_steps_trained": 2419370, "default": {"entropy": 0.993133544921875, "policy_loss": -0.004532141145318747, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9819579124450684, "vf_loss": 6.105486869812012, "total_loss": 6.101550579071045, "cur_lr": 0.0005000000237487257, "kl": 0.01590052992105484}, "sample_time_ms": 17110.347, "load_time_ms": 7.652, "grad_time_ms": 9172.63}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 2419370, "time_this_iter_s": 25.922929763793945, "date": "2019-05-07_03-39-13", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96320>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 34.14678020909398, "cost2_max": -14.767322108440927, "outflow_rate_min": 326.3279975793562, "cost1_max": 432.8970491518441, "cost1_mean": 357.28953767982216, "system_level_velocity_mean": 13.920418489243632, "cost2_min": -131.02627984568625, "system_level_velocity_min": 10.98142904738913, "outflow_rate_max": 1014.4075731957008, "system_level_velocity_max": 18.991703220638456, "outflow_rate_mean": 896.6598036174053, "cost2_mean": -97.29344515504958}, "policy_reward_mean": {}, "timesteps_this_iter": 42857, "episodes_this_iter": 18, "training_iteration": 52, "episode_reward_min": 62.209051914762405, "episode_reward_mean": 1144.6704015838097, "iterations_since_restore": 52, "time_total_s": 1458.5068032741547, "timestamp": 1557200353, "pid": 300, "time_since_restore": 1458.5068032741547, "episode_len_mean": 677.19, "episode_reward_max": 1412.6442252672273, "episodes_total": 725, "timesteps_since_restore": 2419370, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.494, "num_steps_sampled": 2464972, "num_steps_trained": 2464972, "default": {"entropy": 1.0268617868423462, "policy_loss": -0.0028230580501258373, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.984569251537323, "vf_loss": 4.457103729248047, "total_loss": 4.45481538772583, "cur_lr": 0.0005000000237487257, "kl": 0.014250902459025383}, "sample_time_ms": 17181.919, "load_time_ms": 7.951, "grad_time_ms": 9267.242}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 2464972, "time_this_iter_s": 28.191670179367065, "date": "2019-05-07_03-39-41", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7c940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7cf28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7c978>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 34.14678020909398, "cost2_max": -14.767322108440927, "outflow_rate_min": 326.3279975793562, "cost1_max": 407.9192531513488, "cost1_mean": 355.7047596587301, "system_level_velocity_mean": 13.872832364158771, "cost2_min": -131.02627984568625, "system_level_velocity_min": 10.98142904738913, "outflow_rate_max": 1018.7553358867106, "system_level_velocity_max": 18.991703220638456, "outflow_rate_mean": 896.4199411394097, "cost2_mean": -99.59005154554066}, "policy_reward_mean": {}, "timesteps_this_iter": 45602, "episodes_this_iter": 17, "training_iteration": 53, "episode_reward_min": 62.209051914762405, "episode_reward_mean": 1143.2181530819055, "iterations_since_restore": 53, "time_total_s": 1486.6984734535217, "timestamp": 1557200381, "pid": 300, "time_since_restore": 1486.6984734535217, "episode_len_mean": 677.19, "episode_reward_max": 1412.6442252672273, "episodes_total": 742, "timesteps_since_restore": 2464972, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.625, "num_steps_sampled": 2509687, "num_steps_trained": 2509687, "default": {"entropy": 0.9955257177352905, "policy_loss": -0.002284104935824871, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.982620120048523, "vf_loss": 5.056895732879639, "total_loss": 5.05515193939209, "cur_lr": 0.0005000000237487257, "kl": 0.014397009275853634}, "sample_time_ms": 16931.915, "load_time_ms": 8.053, "grad_time_ms": 9361.194}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 2509687, "time_this_iter_s": 25.749560594558716, "date": "2019-05-07_03-40-07", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8c240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8cd30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8c320>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 34.14678020909398, "cost2_max": -14.767322108440927, "outflow_rate_min": 326.3279975793562, "cost1_max": 407.9192531513488, "cost1_mean": 354.60475276125914, "system_level_velocity_mean": 13.93972152632376, "cost2_min": -131.02627984568625, "system_level_velocity_min": 10.98142904738913, "outflow_rate_max": 1018.7553358867106, "system_level_velocity_max": 18.991703220638456, "outflow_rate_mean": 896.4605696051417, "cost2_mean": -99.46164451120855}, "policy_reward_mean": {}, "timesteps_this_iter": 44715, "episodes_this_iter": 9, "training_iteration": 54, "episode_reward_min": 62.209051914762405, "episode_reward_mean": 1135.1342526143644, "iterations_since_restore": 54, "time_total_s": 1512.4480340480804, "timestamp": 1557200407, "pid": 300, "time_since_restore": 1512.4480340480804, "episode_len_mean": 672.99, "episode_reward_max": 1412.6442252672273, "episodes_total": 751, "timesteps_since_restore": 2509687, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.859, "num_steps_sampled": 2553048, "num_steps_trained": 2553048, "default": {"entropy": 1.002581000328064, "policy_loss": -0.003512987634167075, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9838021397590637, "vf_loss": 5.95980978012085, "total_loss": 5.957004070281982, "cur_lr": 0.0005000000237487257, "kl": 0.018875058740377426}, "sample_time_ms": 16927.311, "load_time_ms": 8.002, "grad_time_ms": 9438.198}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 2553048, "time_this_iter_s": 25.971593141555786, "date": "2019-05-07_03-40-33", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e835f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83e10>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 34.14678020909398, "cost2_max": -14.767322108440927, "outflow_rate_min": 326.3279975793562, "cost1_max": 409.9871292756608, "cost1_mean": 355.26279536527903, "system_level_velocity_mean": 14.045738394859763, "cost2_min": -136.67853711572099, "system_level_velocity_min": 11.379259780901808, "outflow_rate_max": 1018.7553358867106, "system_level_velocity_max": 18.991703220638456, "outflow_rate_mean": 898.8107846520714, "cost2_mean": -101.51250169741375}, "policy_reward_mean": {}, "timesteps_this_iter": 43361, "episodes_this_iter": 19, "training_iteration": 55, "episode_reward_min": 62.209051914762405, "episode_reward_mean": 1138.678025383511, "iterations_since_restore": 55, "time_total_s": 1538.4196271896362, "timestamp": 1557200433, "pid": 300, "time_since_restore": 1538.4196271896362, "episode_len_mean": 670.11, "episode_reward_max": 1412.6442252672273, "episodes_total": 770, "timesteps_since_restore": 2553048, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 8.008, "num_steps_sampled": 2597256, "num_steps_trained": 2597256, "default": {"entropy": 1.0354478359222412, "policy_loss": -0.004371604882180691, "cur_kl_coeff": 0.03749999403953552, "vf_explained_var": 0.9845714569091797, "vf_loss": 4.642599582672119, "total_loss": 4.638849258422852, "cur_lr": 0.0005000000237487257, "kl": 0.016580160707235336}, "sample_time_ms": 16704.149, "load_time_ms": 8.169, "grad_time_ms": 9536.118}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 2597256, "time_this_iter_s": 25.282517910003662, "date": "2019-05-07_03-40-58", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea19e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea1470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea1e10>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 34.14678020909398, "cost2_max": -14.767322108440927, "outflow_rate_min": 326.3279975793562, "cost1_max": 411.4538330313773, "cost1_mean": 357.42532764966506, "system_level_velocity_mean": 14.063398762633351, "cost2_min": -136.67853711572099, "system_level_velocity_min": 11.379259780901808, "outflow_rate_max": 1018.9827587088365, "system_level_velocity_max": 18.991703220638456, "outflow_rate_mean": 904.222573332958, "cost2_mean": -103.48375493360064}, "policy_reward_mean": {}, "timesteps_this_iter": 44208, "episodes_this_iter": 16, "training_iteration": 56, "episode_reward_min": 62.209051914762405, "episode_reward_mean": 1145.8888898508567, "iterations_since_restore": 56, "time_total_s": 1563.70214509964, "timestamp": 1557200458, "pid": 300, "time_since_restore": 1563.70214509964, "episode_len_mean": 672.76, "episode_reward_max": 1412.6442252672273, "episodes_total": 786, "timesteps_since_restore": 2597256, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 8.04, "num_steps_sampled": 2641372, "num_steps_trained": 2641372, "default": {"entropy": 0.9568459987640381, "policy_loss": -0.0048443530686199665, "cur_kl_coeff": 0.03749999776482582, "vf_explained_var": 0.9616566896438599, "vf_loss": 10.11451244354248, "total_loss": 10.110660552978516, "cur_lr": 0.0005000000237487257, "kl": 0.0264484491199255}, "sample_time_ms": 16430.59, "load_time_ms": 7.797, "grad_time_ms": 9668.47}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 2641372, "time_this_iter_s": 25.76240849494934, "date": "2019-05-07_03-41-24", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7cc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8cb70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8c198>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 29.036464810894763, "cost2_max": -14.91533497302042, "outflow_rate_min": 327.40452391370155, "cost1_max": 421.7010563051699, "cost1_mean": 357.7819747509942, "system_level_velocity_mean": 14.111936632780768, "cost2_min": -136.67853711572099, "system_level_velocity_min": 11.954537500784031, "outflow_rate_max": 1018.9827587088365, "system_level_velocity_max": 19.603511923857916, "outflow_rate_mean": 904.9512198273536, "cost2_mean": -103.57012046320874}, "policy_reward_mean": {}, "timesteps_this_iter": 44116, "episodes_this_iter": 12, "training_iteration": 57, "episode_reward_min": 52.058186575062756, "episode_reward_mean": 1142.2264470014152, "iterations_since_restore": 57, "time_total_s": 1589.4645535945892, "timestamp": 1557200484, "pid": 300, "time_since_restore": 1589.4645535945892, "episode_len_mean": 672.0, "episode_reward_max": 1412.6442252672273, "episodes_total": 798, "timesteps_since_restore": 2641372, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 8.091, "num_steps_sampled": 2685398, "num_steps_trained": 2685398, "default": {"entropy": 0.9610626101493835, "policy_loss": -0.0033252572175115347, "cur_kl_coeff": 0.05625000223517418, "vf_explained_var": 0.9853188395500183, "vf_loss": 4.944990634918213, "total_loss": 4.942560195922852, "cur_lr": 0.0005000000237487257, "kl": 0.015909653156995773}, "sample_time_ms": 16413.674, "load_time_ms": 7.834, "grad_time_ms": 9740.972}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 2685398, "time_this_iter_s": 26.778860092163086, "date": "2019-05-07_03-41-50", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8c128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7cc18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7c7b8>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 29.036464810894763, "cost2_max": -14.91533497302042, "outflow_rate_min": 327.40452391370155, "cost1_max": 421.7010563051699, "cost1_mean": 359.8615632124362, "system_level_velocity_mean": 14.069877031832602, "cost2_min": -136.67853711572099, "system_level_velocity_min": 11.954537500784031, "outflow_rate_max": 1018.9827587088365, "system_level_velocity_max": 19.603511923857916, "outflow_rate_mean": 908.6556531992031, "cost2_mean": -104.61531568023223}, "policy_reward_mean": {}, "timesteps_this_iter": 44026, "episodes_this_iter": 17, "training_iteration": 58, "episode_reward_min": 52.058186575062756, "episode_reward_mean": 1146.629479154256, "iterations_since_restore": 58, "time_total_s": 1616.2434136867523, "timestamp": 1557200510, "pid": 300, "time_since_restore": 1616.2434136867523, "episode_len_mean": 676.79, "episode_reward_max": 1377.3829851380087, "episodes_total": 815, "timesteps_since_restore": 2685398, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.995, "num_steps_sampled": 2730387, "num_steps_trained": 2730387, "default": {"entropy": 0.9891824126243591, "policy_loss": -0.004542010370641947, "cur_kl_coeff": 0.05625000596046448, "vf_explained_var": 0.9870734214782715, "vf_loss": 4.075722694396973, "total_loss": 4.072083950042725, "cur_lr": 0.0005000000237487257, "kl": 0.016066579148173332}, "sample_time_ms": 16238.407, "load_time_ms": 7.903, "grad_time_ms": 9760.586}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 2730387, "time_this_iter_s": 25.891117095947266, "date": "2019-05-07_03-42-16", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e711d0>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 29.036464810894763, "cost2_max": -14.91533497302042, "outflow_rate_min": 327.40452391370155, "cost1_max": 421.7010563051699, "cost1_mean": 361.3056899862685, "system_level_velocity_mean": 14.11962624779415, "cost2_min": -136.67853711572099, "system_level_velocity_min": 12.102478053365978, "outflow_rate_max": 1018.9827587088365, "system_level_velocity_max": 19.603511923857916, "outflow_rate_mean": 910.7324823299456, "cost2_mean": -104.82251956091923}, "policy_reward_mean": {}, "timesteps_this_iter": 44989, "episodes_this_iter": 16, "training_iteration": 59, "episode_reward_min": 52.058186575062756, "episode_reward_mean": 1157.7685199930763, "iterations_since_restore": 59, "time_total_s": 1642.1345307826996, "timestamp": 1557200536, "pid": 300, "time_since_restore": 1642.1345307826996, "episode_len_mean": 676.79, "episode_reward_max": 1377.3829851380087, "episodes_total": 831, "timesteps_since_restore": 2730387, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 8.058, "num_steps_sampled": 2773312, "num_steps_trained": 2773312, "default": {"entropy": 0.9796568751335144, "policy_loss": -0.0028585349209606647, "cur_kl_coeff": 0.05624999850988388, "vf_explained_var": 0.9881629347801208, "vf_loss": 4.464667320251465, "total_loss": 4.46254301071167, "cur_lr": 0.0005000000237487257, "kl": 0.013050318695604801}, "sample_time_ms": 16274.448, "load_time_ms": 7.719, "grad_time_ms": 9876.366}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 2773312, "time_this_iter_s": 27.098127841949463, "date": "2019-05-07_03-42-44", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea1550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea1c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea13c8>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 29.036464810894763, "cost2_max": -14.91533497302042, "outflow_rate_min": 327.40452391370155, "cost1_max": 421.7010563051699, "cost1_mean": 359.61167254552254, "system_level_velocity_mean": 14.061853702223091, "cost2_min": -136.67853711572099, "system_level_velocity_min": 11.715253620034018, "outflow_rate_max": 1018.9827587088365, "system_level_velocity_max": 19.603511923857916, "outflow_rate_mean": 906.8345954420146, "cost2_mean": -105.18351134222759}, "policy_reward_mean": {}, "timesteps_this_iter": 42925, "episodes_this_iter": 14, "training_iteration": 60, "episode_reward_min": 52.058186575062756, "episode_reward_mean": 1152.877570813273, "iterations_since_restore": 60, "time_total_s": 1669.232658624649, "timestamp": 1557200564, "pid": 300, "time_since_restore": 1669.232658624649, "episode_len_mean": 676.79, "episode_reward_max": 1377.3829851380087, "episodes_total": 845, "timesteps_since_restore": 2773312, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.94, "num_steps_sampled": 2817456, "num_steps_trained": 2817456, "default": {"entropy": 0.9854058623313904, "policy_loss": -0.00346999429166317, "cur_kl_coeff": 0.05624999478459358, "vf_explained_var": 0.9820994734764099, "vf_loss": 6.089207649230957, "total_loss": 6.086655616760254, "cur_lr": 0.0005000000237487257, "kl": 0.01631361059844494}, "sample_time_ms": 16349.155, "load_time_ms": 7.826, "grad_time_ms": 9920.327}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 2817456, "time_this_iter_s": 27.101288080215454, "date": "2019-05-07_03-43-11", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96f98>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 29.036464810894763, "cost2_max": -14.91533497302042, "outflow_rate_min": 327.40452391370155, "cost1_max": 421.7010563051699, "cost1_mean": 360.66945511519674, "system_level_velocity_mean": 14.075369348613307, "cost2_min": -139.1554869676581, "system_level_velocity_min": 11.715253620034018, "outflow_rate_max": 1018.9827587088365, "system_level_velocity_max": 19.603511923857916, "outflow_rate_mean": 906.5362798821166, "cost2_mean": -104.56702430030607}, "policy_reward_mean": {}, "timesteps_this_iter": 44144, "episodes_this_iter": 17, "training_iteration": 61, "episode_reward_min": 52.058186575062756, "episode_reward_mean": 1152.3266312083003, "iterations_since_restore": 61, "time_total_s": 1696.3339467048645, "timestamp": 1557200591, "pid": 300, "time_since_restore": 1696.3339467048645, "episode_len_mean": 678.08, "episode_reward_max": 1373.8638885093474, "episodes_total": 862, "timesteps_since_restore": 2817456, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 8.065, "num_steps_sampled": 2861458, "num_steps_trained": 2861458, "default": {"entropy": 0.976154625415802, "policy_loss": -0.003354583168402314, "cur_kl_coeff": 0.05625000223517418, "vf_explained_var": 0.9788898229598999, "vf_loss": 6.888518810272217, "total_loss": 6.886162281036377, "cur_lr": 0.0005000000237487257, "kl": 0.017725951969623566}, "sample_time_ms": 16317.735, "load_time_ms": 7.86, "grad_time_ms": 9973.055}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 2861458, "time_this_iter_s": 26.146992206573486, "date": "2019-05-07_03-43-37", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83518>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 29.036464810894763, "cost2_max": -14.91533497302042, "outflow_rate_min": 327.40452391370155, "cost1_max": 436.047820197243, "cost1_mean": 358.42570367229985, "system_level_velocity_mean": 14.144922110021565, "cost2_min": -139.1554869676581, "system_level_velocity_min": 11.715253620034018, "outflow_rate_max": 1023.7076245618787, "system_level_velocity_max": 19.603511923857916, "outflow_rate_mean": 903.6664616733694, "cost2_mean": -104.21458175824009}, "policy_reward_mean": {}, "timesteps_this_iter": 44002, "episodes_this_iter": 14, "training_iteration": 62, "episode_reward_min": 52.058186575062756, "episode_reward_mean": 1148.0280614528258, "iterations_since_restore": 62, "time_total_s": 1722.480938911438, "timestamp": 1557200617, "pid": 300, "time_since_restore": 1722.480938911438, "episode_len_mean": 672.49, "episode_reward_max": 1373.8638885093474, "episodes_total": 876, "timesteps_since_restore": 2861458, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 8.071, "num_steps_sampled": 2904570, "num_steps_trained": 2904570, "default": {"entropy": 0.9546788334846497, "policy_loss": -0.0043570115230977535, "cur_kl_coeff": 0.05624999850988388, "vf_explained_var": 0.9910429120063782, "vf_loss": 3.205117702484131, "total_loss": 3.201608180999756, "cur_lr": 0.0005000000237487257, "kl": 0.015072126872837543}, "sample_time_ms": 16093.464, "load_time_ms": 7.781, "grad_time_ms": 9893.568}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 2904570, "time_this_iter_s": 25.155741691589355, "date": "2019-05-07_03-44-02", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7c048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7c390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7c828>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 29.036464810894763, "cost2_max": -14.91533497302042, "outflow_rate_min": 327.40452391370155, "cost1_max": 436.047820197243, "cost1_mean": 359.50371935678, "system_level_velocity_mean": 14.185222192616056, "cost2_min": -139.1554869676581, "system_level_velocity_min": 11.715253620034018, "outflow_rate_max": 1023.7076245618787, "system_level_velocity_max": 19.603511923857916, "outflow_rate_mean": 906.4725966577425, "cost2_mean": -104.61629362587524}, "policy_reward_mean": {}, "timesteps_this_iter": 43112, "episodes_this_iter": 14, "training_iteration": 63, "episode_reward_min": 52.058186575062756, "episode_reward_mean": 1148.4863921429612, "iterations_since_restore": 63, "time_total_s": 1747.6366806030273, "timestamp": 1557200642, "pid": 300, "time_since_restore": 1747.6366806030273, "episode_len_mean": 672.49, "episode_reward_max": 1373.8638885093474, "episodes_total": 890, "timesteps_since_restore": 2904570, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 8.009, "num_steps_sampled": 2948295, "num_steps_trained": 2948295, "default": {"entropy": 0.9726496338844299, "policy_loss": -0.004517344292253256, "cur_kl_coeff": 0.05625000596046448, "vf_explained_var": 0.9841002225875854, "vf_loss": 6.080565452575684, "total_loss": 6.076890468597412, "cur_lr": 0.0005000000237487257, "kl": 0.014956778846681118}, "sample_time_ms": 16167.489, "load_time_ms": 7.59, "grad_time_ms": 9933.5}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 2948295, "time_this_iter_s": 26.87485671043396, "date": "2019-05-07_03-44-29", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e79978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e79898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea1b00>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 89.76408455299602, "cost2_max": -23.339192765669935, "outflow_rate_min": 438.22331555628153, "cost1_max": 436.047820197243, "cost1_mean": 364.8699750222349, "system_level_velocity_mean": 14.187133435908137, "cost2_min": -139.24247368021216, "system_level_velocity_min": 11.715253620034018, "outflow_rate_max": 1023.7076245618787, "system_level_velocity_max": 18.751661014150976, "outflow_rate_mean": 915.1590778547086, "cost2_mean": -105.95657521303481}, "policy_reward_mean": {}, "timesteps_this_iter": 43725, "episodes_this_iter": 20, "training_iteration": 64, "episode_reward_min": 224.84466256015662, "episode_reward_mean": 1166.5202799902931, "iterations_since_restore": 64, "time_total_s": 1774.5115373134613, "timestamp": 1557200669, "pid": 300, "time_since_restore": 1774.5115373134613, "episode_len_mean": 679.88, "episode_reward_max": 1373.8638885093474, "episodes_total": 910, "timesteps_since_restore": 2948295, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.969, "num_steps_sampled": 2992515, "num_steps_trained": 2992515, "default": {"entropy": 0.9449854493141174, "policy_loss": -0.003986671566963196, "cur_kl_coeff": 0.05624999850988388, "vf_explained_var": 0.9755452275276184, "vf_loss": 8.280970573425293, "total_loss": 8.278011322021484, "cur_lr": 0.0005000000237487257, "kl": 0.01825295016169548}, "sample_time_ms": 16095.209, "load_time_ms": 7.673, "grad_time_ms": 10029.342}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 2992515, "time_this_iter_s": 26.183098316192627, "date": "2019-05-07_03-44-55", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7c470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8c0f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7cba8>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 89.76408455299602, "cost2_max": -21.932858665878843, "outflow_rate_min": 438.22331555628153, "cost1_max": 436.047820197243, "cost1_mean": 364.13217387285897, "system_level_velocity_mean": 14.405529735943384, "cost2_min": -139.24247368021216, "system_level_velocity_min": 11.715253620034018, "outflow_rate_max": 1023.7076245618787, "system_level_velocity_max": 19.260816558269756, "outflow_rate_mean": 913.2555442604109, "cost2_mean": -104.44392299490477}, "policy_reward_mean": {}, "timesteps_this_iter": 44220, "episodes_this_iter": 12, "training_iteration": 65, "episode_reward_min": 217.77987226205298, "episode_reward_mean": 1162.2873375382144, "iterations_since_restore": 65, "time_total_s": 1800.694635629654, "timestamp": 1557200695, "pid": 300, "time_since_restore": 1800.694635629654, "episode_len_mean": 670.73, "episode_reward_max": 1373.8638885093474, "episodes_total": 922, "timesteps_since_restore": 2992515, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.903, "num_steps_sampled": 3037592, "num_steps_trained": 3037592, "default": {"entropy": 0.9494558572769165, "policy_loss": -0.004184846766293049, "cur_kl_coeff": 0.05624999850988388, "vf_explained_var": 0.9805131554603577, "vf_loss": 6.935938835144043, "total_loss": 6.932726860046387, "cur_lr": 0.0005000000237487257, "kl": 0.017296871170401573}, "sample_time_ms": 16298.764, "load_time_ms": 7.565, "grad_time_ms": 10022.234}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 3037592, "time_this_iter_s": 27.270366430282593, "date": "2019-05-07_03-45-22", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e795c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e69c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e69cc0>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 89.76408455299602, "cost2_max": -21.932858665878843, "outflow_rate_min": 438.22331555628153, "cost1_max": 438.33282967954347, "cost1_mean": 361.93750488896256, "system_level_velocity_mean": 14.436749207715856, "cost2_min": -139.24247368021216, "system_level_velocity_min": 11.715253620034018, "outflow_rate_max": 1023.7076245618787, "system_level_velocity_max": 19.260816558269756, "outflow_rate_mean": 911.230023815028, "cost2_mean": -104.24113173985947}, "policy_reward_mean": {}, "timesteps_this_iter": 45077, "episodes_this_iter": 13, "training_iteration": 66, "episode_reward_min": 217.77987226205298, "episode_reward_mean": 1153.2749431170935, "iterations_since_restore": 66, "time_total_s": 1827.9650020599365, "timestamp": 1557200722, "pid": 300, "time_since_restore": 1827.9650020599365, "episode_len_mean": 666.46, "episode_reward_max": 1450.4331004027351, "episodes_total": 935, "timesteps_since_restore": 3037592, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.832, "num_steps_sampled": 3081086, "num_steps_trained": 3081086, "default": {"entropy": 0.9171722531318665, "policy_loss": 0.0011803817469626665, "cur_kl_coeff": 0.05624999478459358, "vf_explained_var": 0.9807862639427185, "vf_loss": 6.875417709350586, "total_loss": 6.878209114074707, "cur_lr": 0.0005000000237487257, "kl": 0.028628867119550705}, "sample_time_ms": 16386.14, "load_time_ms": 7.706, "grad_time_ms": 9962.241}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 3081086, "time_this_iter_s": 26.0596866607666, "date": "2019-05-07_03-45-49", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7c668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7c1d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7ccc0>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 89.76408455299602, "cost2_max": -21.932858665878843, "outflow_rate_min": 438.22331555628153, "cost1_max": 438.33282967954347, "cost1_mean": 366.5112472177836, "system_level_velocity_mean": 14.394149054960053, "cost2_min": -139.24247368021216, "system_level_velocity_min": 12.578916975319663, "outflow_rate_max": 1023.7076245618787, "system_level_velocity_max": 19.260816558269756, "outflow_rate_mean": 920.4782915739673, "cost2_mean": -105.30513228736015}, "policy_reward_mean": {}, "timesteps_this_iter": 43494, "episodes_this_iter": 17, "training_iteration": 67, "episode_reward_min": 217.77987226205298, "episode_reward_mean": 1173.1366389981497, "iterations_since_restore": 67, "time_total_s": 1854.0246887207031, "timestamp": 1557200749, "pid": 300, "time_since_restore": 1854.0246887207031, "episode_len_mean": 675.29, "episode_reward_max": 1450.4331004027351, "episodes_total": 952, "timesteps_since_restore": 3081086, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.845, "num_steps_sampled": 3122998, "num_steps_trained": 3122998, "default": {"entropy": 0.9289520978927612, "policy_loss": -0.004449822939932346, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9841250777244568, "vf_loss": 5.3669114112854, "total_loss": 5.36362361907959, "cur_lr": 0.0005000000237487257, "kl": 0.013770882040262222}, "sample_time_ms": 16232.922, "load_time_ms": 7.724, "grad_time_ms": 9897.347}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 3122998, "time_this_iter_s": 24.608726739883423, "date": "2019-05-07_03-46-13", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea10f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea1588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea19b0>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 89.76408455299602, "cost2_max": -21.932858665878843, "outflow_rate_min": 438.22331555628153, "cost1_max": 438.33282967954347, "cost1_mean": 370.0412700815766, "system_level_velocity_mean": 14.52646230273047, "cost2_min": -139.24247368021216, "system_level_velocity_min": 12.578916975319663, "outflow_rate_max": 1023.7076245618787, "system_level_velocity_max": 19.260816558269756, "outflow_rate_mean": 926.5293718317585, "cost2_mean": -101.94989622873737}, "policy_reward_mean": {}, "timesteps_this_iter": 41912, "episodes_this_iter": 16, "training_iteration": 68, "episode_reward_min": 217.77987226205298, "episode_reward_mean": 1175.4671826358933, "iterations_since_restore": 68, "time_total_s": 1878.6334154605865, "timestamp": 1557200773, "pid": 300, "time_since_restore": 1878.6334154605865, "episode_len_mean": 675.29, "episode_reward_max": 1450.4331004027351, "episodes_total": 968, "timesteps_since_restore": 3122998, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.667, "num_steps_sampled": 3165667, "num_steps_trained": 3165667, "default": {"entropy": 0.9227986931800842, "policy_loss": -0.005338534712791443, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9698898792266846, "vf_loss": 10.423236846923828, "total_loss": 10.419299125671387, "cur_lr": 0.0005000000237487257, "kl": 0.0165970828384161}, "sample_time_ms": 16240.68, "load_time_ms": 7.589, "grad_time_ms": 9846.016}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 3165667, "time_this_iter_s": 25.426119804382324, "date": "2019-05-07_03-46-39", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e967f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96550>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 28.789066705704517, "cost2_max": -9.935597559419115, "outflow_rate_min": 327.9458014252228, "cost1_max": 438.33282967954347, "cost1_mean": 369.11426320217754, "system_level_velocity_mean": 14.533003040022447, "cost2_min": -139.24247368021216, "system_level_velocity_min": 12.578916975319663, "outflow_rate_max": 1022.8666661909307, "system_level_velocity_max": 19.292527999226117, "outflow_rate_mean": 924.2124998180857, "cost2_mean": -100.05266362238106}, "policy_reward_mean": {}, "timesteps_this_iter": 42669, "episodes_this_iter": 19, "training_iteration": 69, "episode_reward_min": 55.59101389952524, "episode_reward_mean": 1171.5583989433323, "iterations_since_restore": 69, "time_total_s": 1904.0595352649689, "timestamp": 1557200799, "pid": 300, "time_since_restore": 1904.0595352649689, "episode_len_mean": 674.31, "episode_reward_max": 1450.4331004027351, "episodes_total": 987, "timesteps_since_restore": 3165667, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.531, "num_steps_sampled": 3211025, "num_steps_trained": 3211025, "default": {"entropy": 0.930426299571991, "policy_loss": -0.003467608941718936, "cur_kl_coeff": 0.08437501639127731, "vf_explained_var": 0.9789971709251404, "vf_loss": 6.588420391082764, "total_loss": 6.586328506469727, "cur_lr": 0.0005000000237487257, "kl": 0.016301142051815987}, "sample_time_ms": 16202.369, "load_time_ms": 7.613, "grad_time_ms": 9877.208}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 3211025, "time_this_iter_s": 27.027987480163574, "date": "2019-05-07_03-47-06", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7c748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7cef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8ccc0>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 28.789066705704517, "cost2_max": -9.935597559419115, "outflow_rate_min": 327.9458014252228, "cost1_max": 438.33282967954347, "cost1_mean": 369.9955993851982, "system_level_velocity_mean": 14.548273079932239, "cost2_min": -129.2482130685036, "system_level_velocity_min": 12.534484342861475, "outflow_rate_max": 1022.8666661909307, "system_level_velocity_max": 19.292527999226117, "outflow_rate_mean": 925.5155629664977, "cost2_mean": -98.42481553716034}, "policy_reward_mean": {}, "timesteps_this_iter": 45358, "episodes_this_iter": 15, "training_iteration": 70, "episode_reward_min": 55.59101389952524, "episode_reward_mean": 1178.8810217292082, "iterations_since_restore": 70, "time_total_s": 1931.0875227451324, "timestamp": 1557200826, "pid": 300, "time_since_restore": 1931.0875227451324, "episode_len_mean": 675.11, "episode_reward_max": 1450.4331004027351, "episodes_total": 1002, "timesteps_since_restore": 3211025, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.641, "num_steps_sampled": 3254941, "num_steps_trained": 3254941, "default": {"entropy": 0.8756728172302246, "policy_loss": -0.00469144806265831, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.978542149066925, "vf_loss": 6.586337566375732, "total_loss": 6.583144664764404, "cur_lr": 0.0005000000237487257, "kl": 0.01775958202779293}, "sample_time_ms": 15999.999, "load_time_ms": 7.544, "grad_time_ms": 9869.793}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 3254941, "time_this_iter_s": 25.041396856307983, "date": "2019-05-07_03-47-31", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7ca20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7c898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7c048>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 28.789066705704517, "cost2_max": -9.935597559419115, "outflow_rate_min": 327.9458014252228, "cost1_max": 438.33282967954347, "cost1_mean": 370.5776240824341, "system_level_velocity_mean": 14.537572624169107, "cost2_min": -127.12176930467722, "system_level_velocity_min": 12.534484342861475, "outflow_rate_max": 1050.2088099262276, "system_level_velocity_max": 19.292527999226117, "outflow_rate_mean": 928.213207105893, "cost2_mean": -98.18252056185564}, "policy_reward_mean": {}, "timesteps_this_iter": 43916, "episodes_this_iter": 10, "training_iteration": 71, "episode_reward_min": 55.59101389952524, "episode_reward_mean": 1179.3596732964681, "iterations_since_restore": 71, "time_total_s": 1956.1289196014404, "timestamp": 1557200851, "pid": 300, "time_since_restore": 1956.1289196014404, "episode_len_mean": 676.02, "episode_reward_max": 1450.4331004027351, "episodes_total": 1012, "timesteps_since_restore": 3254941, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.422, "num_steps_sampled": 3298427, "num_steps_trained": 3298427, "default": {"entropy": 0.9328299164772034, "policy_loss": -0.0058815814554691315, "cur_kl_coeff": 0.08437501639127731, "vf_explained_var": 0.9752870798110962, "vf_loss": 8.964518547058105, "total_loss": 8.960070610046387, "cur_lr": 0.0005000000237487257, "kl": 0.017003776505589485}, "sample_time_ms": 16158.637, "load_time_ms": 7.357, "grad_time_ms": 9916.685}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 3298427, "time_this_iter_s": 28.213337182998657, "date": "2019-05-07_03-47-59", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea1470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea1940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea17b8>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 28.789066705704517, "cost2_max": -9.935597559419115, "outflow_rate_min": 327.9458014252228, "cost1_max": 430.90920993475277, "cost1_mean": 370.97507413170626, "system_level_velocity_mean": 14.502816053258488, "cost2_min": -127.12176930467722, "system_level_velocity_min": 12.409140526232882, "outflow_rate_max": 1050.2088099262276, "system_level_velocity_max": 19.292527999226117, "outflow_rate_mean": 931.5086385520106, "cost2_mean": -96.8970538100824}, "policy_reward_mean": {}, "timesteps_this_iter": 43486, "episodes_this_iter": 21, "training_iteration": 72, "episode_reward_min": 55.59101389952524, "episode_reward_mean": 1182.7270147333618, "iterations_since_restore": 72, "time_total_s": 1984.342256784439, "timestamp": 1557200879, "pid": 300, "time_since_restore": 1984.342256784439, "episode_len_mean": 678.66, "episode_reward_max": 1399.5630354383684, "episodes_total": 1033, "timesteps_since_restore": 3298427, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.676, "num_steps_sampled": 3341234, "num_steps_trained": 3341234, "default": {"entropy": 0.9150383472442627, "policy_loss": -0.004614855162799358, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9812443852424622, "vf_loss": 6.75016975402832, "total_loss": 6.747001647949219, "cur_lr": 0.0005000000237487257, "kl": 0.017151998355984688}, "sample_time_ms": 16096.258, "load_time_ms": 7.097, "grad_time_ms": 9935.697}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 3341234, "time_this_iter_s": 24.720845937728882, "date": "2019-05-07_03-48-24", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea1630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea1d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea1748>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 28.789066705704517, "cost2_max": -9.935597559419115, "outflow_rate_min": 327.9458014252228, "cost1_max": 436.7776166507558, "cost1_mean": 372.80724992575733, "system_level_velocity_mean": 14.579585535911107, "cost2_min": -127.12176930467722, "system_level_velocity_min": 12.409140526232882, "outflow_rate_max": 1050.2088099262276, "system_level_velocity_max": 19.292527999226117, "outflow_rate_mean": 934.3266893030519, "cost2_mean": -94.74276999246318}, "policy_reward_mean": {}, "timesteps_this_iter": 42807, "episodes_this_iter": 14, "training_iteration": 73, "episode_reward_min": 55.59101389952524, "episode_reward_mean": 1183.1180977429963, "iterations_since_restore": 73, "time_total_s": 2009.063102722168, "timestamp": 1557200904, "pid": 300, "time_since_restore": 2009.063102722168, "episode_len_mean": 678.66, "episode_reward_max": 1399.5630354383684, "episodes_total": 1047, "timesteps_since_restore": 3341234, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.601, "num_steps_sampled": 3383906, "num_steps_trained": 3383906, "default": {"entropy": 0.889839768409729, "policy_loss": -0.004275784362107515, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9870900511741638, "vf_loss": 4.516678333282471, "total_loss": 4.513634204864502, "cur_lr": 0.0005000000237487257, "kl": 0.01459165196865797}, "sample_time_ms": 16043.807, "load_time_ms": 7.209, "grad_time_ms": 9889.108}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 3383906, "time_this_iter_s": 25.890273094177246, "date": "2019-05-07_03-48-50", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7c080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7c780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7c710>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 28.789066705704517, "cost2_max": -9.935597559419115, "outflow_rate_min": 327.9458014252228, "cost1_max": 436.7776166507558, "cost1_mean": 372.86696782604463, "system_level_velocity_mean": 14.594828223030499, "cost2_min": -127.12176930467722, "system_level_velocity_min": 12.409140526232882, "outflow_rate_max": 1050.2088099262276, "system_level_velocity_max": 19.292527999226117, "outflow_rate_mean": 935.559090454441, "cost2_mean": -94.85356121507108}, "policy_reward_mean": {}, "timesteps_this_iter": 42672, "episodes_this_iter": 15, "training_iteration": 74, "episode_reward_min": 55.59101389952524, "episode_reward_mean": 1178.569900788595, "iterations_since_restore": 74, "time_total_s": 2034.9533758163452, "timestamp": 1557200930, "pid": 300, "time_since_restore": 2034.9533758163452, "episode_len_mean": 678.66, "episode_reward_max": 1379.9918776649556, "episodes_total": 1062, "timesteps_since_restore": 3383906, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.67, "num_steps_sampled": 3429267, "num_steps_trained": 3429267, "default": {"entropy": 0.9296652674674988, "policy_loss": -0.007304115686565638, "cur_kl_coeff": 0.08437501639127731, "vf_explained_var": 0.9719803929328918, "vf_loss": 9.766815185546875, "total_loss": 9.761064529418945, "cur_lr": 0.0005000000237487257, "kl": 0.018398866057395935}, "sample_time_ms": 16114.732, "load_time_ms": 7.195, "grad_time_ms": 9955.072}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 3429267, "time_this_iter_s": 27.563645601272583, "date": "2019-05-07_03-49-17", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83a90>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 29.201349191698377, "cost2_max": -13.644779896383078, "outflow_rate_min": 326.3279975793562, "cost1_max": 436.7776166507558, "cost1_mean": 369.3744040511693, "system_level_velocity_mean": 14.659140889566858, "cost2_min": -127.12176930467722, "system_level_velocity_min": 12.409140526232882, "outflow_rate_max": 1050.2088099262276, "system_level_velocity_max": 19.92236025121522, "outflow_rate_mean": 928.3341462294499, "cost2_mean": -94.51595426580774}, "policy_reward_mean": {}, "timesteps_this_iter": 45361, "episodes_this_iter": 19, "training_iteration": 75, "episode_reward_min": 52.557833084990435, "episode_reward_mean": 1173.9843205007887, "iterations_since_restore": 75, "time_total_s": 2062.517021417618, "timestamp": 1557200957, "pid": 300, "time_since_restore": 2062.517021417618, "episode_len_mean": 672.16, "episode_reward_max": 1386.9518505932062, "episodes_total": 1081, "timesteps_since_restore": 3429267, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.786, "num_steps_sampled": 3473227, "num_steps_trained": 3473227, "default": {"entropy": 0.8873627185821533, "policy_loss": -0.004795215092599392, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9766914248466492, "vf_loss": 6.910183906555176, "total_loss": 6.906746864318848, "cur_lr": 0.0005000000237487257, "kl": 0.016096243634819984}, "sample_time_ms": 15921.515, "load_time_ms": 7.181, "grad_time_ms": 9963.506}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 3473227, "time_this_iter_s": 25.39349913597107, "date": "2019-05-07_03-49-43", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96710>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 29.201349191698377, "cost2_max": -13.644779896383078, "outflow_rate_min": 326.3279975793562, "cost1_max": 443.6406794486504, "cost1_mean": 367.45474326423425, "system_level_velocity_mean": 14.712548309876485, "cost2_min": -127.12176930467722, "system_level_velocity_min": 12.409140526232882, "outflow_rate_max": 1050.2088099262276, "system_level_velocity_max": 19.92236025121522, "outflow_rate_mean": 926.147992956822, "cost2_mean": -94.07160070116464}, "policy_reward_mean": {}, "timesteps_this_iter": 43960, "episodes_this_iter": 8, "training_iteration": 76, "episode_reward_min": 52.557833084990435, "episode_reward_mean": 1169.2049369949777, "iterations_since_restore": 76, "time_total_s": 2087.910520553589, "timestamp": 1557200983, "pid": 300, "time_since_restore": 2087.910520553589, "episode_len_mean": 667.18, "episode_reward_max": 1386.9518505932062, "episodes_total": 1089, "timesteps_since_restore": 3473227, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.898, "num_steps_sampled": 3514681, "num_steps_trained": 3514681, "default": {"entropy": 0.8699692487716675, "policy_loss": -0.002913552103564143, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9532002210617065, "vf_loss": 18.473155975341797, "total_loss": 18.47174835205078, "cur_lr": 0.0005000000237487257, "kl": 0.017853256314992905}, "sample_time_ms": 15804.261, "load_time_ms": 7.079, "grad_time_ms": 9909.604}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 3514681, "time_this_iter_s": 24.323124408721924, "date": "2019-05-07_03-50-07", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7cbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7ca58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7cd68>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 29.19401370435345, "cost2_max": -13.644779896383078, "outflow_rate_min": 325.2012645303821, "cost1_max": 443.6406794486504, "cost1_mean": 362.9420922528019, "system_level_velocity_mean": 14.802755182166305, "cost2_min": -127.01584867052838, "system_level_velocity_min": 12.409140526232882, "outflow_rate_max": 1040.8185016630975, "system_level_velocity_max": 20.024997547331644, "outflow_rate_mean": 918.1393659608469, "cost2_mean": -92.30503547211042}, "policy_reward_mean": {}, "timesteps_this_iter": 41454, "episodes_this_iter": 22, "training_iteration": 77, "episode_reward_min": 52.1586638728368, "episode_reward_mean": 1145.8676982703912, "iterations_since_restore": 77, "time_total_s": 2112.233644962311, "timestamp": 1557201007, "pid": 300, "time_since_restore": 2112.233644962311, "episode_len_mean": 658.26, "episode_reward_max": 1386.9518505932062, "episodes_total": 1111, "timesteps_since_restore": 3514681, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.666, "num_steps_sampled": 3556179, "num_steps_trained": 3556179, "default": {"entropy": 0.9267511963844299, "policy_loss": -0.00479115778580308, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.977289080619812, "vf_loss": 8.092552185058594, "total_loss": 8.088930130004883, "cur_lr": 0.0005000000237487257, "kl": 0.013855726458132267}, "sample_time_ms": 15954.161, "load_time_ms": 7.099, "grad_time_ms": 9833.526}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 3556179, "time_this_iter_s": 25.315171241760254, "date": "2019-05-07_03-50-32", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71828>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 29.19401370435345, "cost2_max": -13.644779896383078, "outflow_rate_min": 325.2012645303821, "cost1_max": 443.6406794486504, "cost1_mean": 365.052106086296, "system_level_velocity_mean": 14.871148813326561, "cost2_min": -124.95012517235887, "system_level_velocity_min": 12.893179303481642, "outflow_rate_max": 1040.8185016630975, "system_level_velocity_max": 20.024997547331644, "outflow_rate_mean": 921.4800460048315, "cost2_mean": -90.12046806614697}, "policy_reward_mean": {}, "timesteps_this_iter": 41498, "episodes_this_iter": 20, "training_iteration": 78, "episode_reward_min": 52.1586638728368, "episode_reward_mean": 1151.6761559214208, "iterations_since_restore": 78, "time_total_s": 2137.548816204071, "timestamp": 1557201032, "pid": 300, "time_since_restore": 2137.548816204071, "episode_len_mean": 659.15, "episode_reward_max": 1386.9518505932062, "episodes_total": 1131, "timesteps_since_restore": 3556179, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.67, "num_steps_sampled": 3598957, "num_steps_trained": 3598957, "default": {"entropy": 0.873324990272522, "policy_loss": -0.005852524656802416, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9782119393348694, "vf_loss": 6.66828727722168, "total_loss": 6.663852214813232, "cur_lr": 0.0005000000237487257, "kl": 0.016800979152321815}, "sample_time_ms": 16019.022, "load_time_ms": 6.956, "grad_time_ms": 9801.239}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 3598957, "time_this_iter_s": 25.740269422531128, "date": "2019-05-07_03-50-58", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea19e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea1630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea1ba8>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 29.19401370435345, "cost2_max": -13.644779896383078, "outflow_rate_min": 325.2012645303821, "cost1_max": 443.6406794486504, "cost1_mean": 362.86497032170496, "system_level_velocity_mean": 14.956388942357048, "cost2_min": -124.95012517235887, "system_level_velocity_min": 12.893179303481642, "outflow_rate_max": 1040.8185016630975, "system_level_velocity_max": 20.024997547331644, "outflow_rate_mean": 917.9239233157052, "cost2_mean": -87.81188194900841}, "policy_reward_mean": {}, "timesteps_this_iter": 42778, "episodes_this_iter": 13, "training_iteration": 79, "episode_reward_min": 52.1586638728368, "episode_reward_mean": 1133.3921655558877, "iterations_since_restore": 79, "time_total_s": 2163.289085626602, "timestamp": 1557201058, "pid": 300, "time_since_restore": 2163.289085626602, "episode_len_mean": 653.56, "episode_reward_max": 1386.9518505932062, "episodes_total": 1144, "timesteps_since_restore": 3598957, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.656, "num_steps_sampled": 3642050, "num_steps_trained": 3642050, "default": {"entropy": 0.9033322930335999, "policy_loss": -0.004439238924533129, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9787595868110657, "vf_loss": 7.351634979248047, "total_loss": 7.348524570465088, "cur_lr": 0.0005000000237487257, "kl": 0.015745246782898903}, "sample_time_ms": 16131.718, "load_time_ms": 6.975, "grad_time_ms": 9682.709}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 3642050, "time_this_iter_s": 26.965086221694946, "date": "2019-05-07_03-51-25", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96e10>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 29.19401370435345, "cost2_max": -13.644779896383078, "outflow_rate_min": 325.2012645303821, "cost1_max": 443.6406794486504, "cost1_mean": 359.63470479555167, "system_level_velocity_mean": 14.9969966591483, "cost2_min": -124.95012517235887, "system_level_velocity_min": 12.893179303481642, "outflow_rate_max": 1040.8185016630975, "system_level_velocity_max": 20.024997547331644, "outflow_rate_mean": 914.063422153921, "cost2_mean": -85.86464590953626}, "policy_reward_mean": {}, "timesteps_this_iter": 43093, "episodes_this_iter": 18, "training_iteration": 80, "episode_reward_min": 52.1586638728368, "episode_reward_mean": 1117.8602856556333, "iterations_since_restore": 80, "time_total_s": 2190.254171848297, "timestamp": 1557201085, "pid": 300, "time_since_restore": 2190.254171848297, "episode_len_mean": 648.08, "episode_reward_max": 1386.9518505932062, "episodes_total": 1162, "timesteps_since_restore": 3642050, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.555, "num_steps_sampled": 3685614, "num_steps_trained": 3685614, "default": {"entropy": 0.9016491770744324, "policy_loss": -0.004652699455618858, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.987976610660553, "vf_loss": 3.882136106491089, "total_loss": 3.8787524700164795, "cur_lr": 0.0005000000237487257, "kl": 0.015045711770653725}, "sample_time_ms": 16268.152, "load_time_ms": 6.944, "grad_time_ms": 9629.376}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 3685614, "time_this_iter_s": 25.838761568069458, "date": "2019-05-07_03-51-51", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea1668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea1ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea1b70>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 29.19401370435345, "cost2_max": -13.881015339551727, "outflow_rate_min": 325.2012645303821, "cost1_max": 443.6406794486504, "cost1_mean": 361.76208757348354, "system_level_velocity_mean": 14.905458707190675, "cost2_min": -124.95012517235887, "system_level_velocity_min": 12.848480772294138, "outflow_rate_max": 1040.8185016630975, "system_level_velocity_max": 20.024997547331644, "outflow_rate_mean": 918.5835627097113, "cost2_mean": -85.1384044643076}, "policy_reward_mean": {}, "timesteps_this_iter": 43564, "episodes_this_iter": 12, "training_iteration": 81, "episode_reward_min": 52.1586638728368, "episode_reward_mean": 1118.5172351068788, "iterations_since_restore": 81, "time_total_s": 2216.0929334163666, "timestamp": 1557201111, "pid": 300, "time_since_restore": 2216.0929334163666, "episode_len_mean": 654.58, "episode_reward_max": 1340.5177040891258, "episodes_total": 1174, "timesteps_since_restore": 3685614, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.57, "num_steps_sampled": 3727357, "num_steps_trained": 3727357, "default": {"entropy": 0.884556770324707, "policy_loss": -0.004066374618560076, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9718511700630188, "vf_loss": 8.731922149658203, "total_loss": 8.72927188873291, "cur_lr": 0.0005000000237487257, "kl": 0.01678566262125969}, "sample_time_ms": 16025.413, "load_time_ms": 6.986, "grad_time_ms": 9510.491}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 3727357, "time_this_iter_s": 24.569029092788696, "date": "2019-05-07_03-52-16", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71828>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 29.19401370435345, "cost2_max": -15.900850195430298, "outflow_rate_min": 325.2012645303821, "cost1_max": 438.2043958339433, "cost1_mean": 363.63299848848675, "system_level_velocity_mean": 14.841436151038057, "cost2_min": -110.9509324060285, "system_level_velocity_min": 12.848480772294138, "outflow_rate_max": 1040.8185016630975, "system_level_velocity_max": 20.024997547331644, "outflow_rate_mean": 921.570077908905, "cost2_mean": -83.48101414631454}, "policy_reward_mean": {}, "timesteps_this_iter": 41743, "episodes_this_iter": 17, "training_iteration": 82, "episode_reward_min": 52.1586638728368, "episode_reward_mean": 1120.355947085183, "iterations_since_restore": 82, "time_total_s": 2240.6619625091553, "timestamp": 1557201136, "pid": 300, "time_since_restore": 2240.6619625091553, "episode_len_mean": 660.23, "episode_reward_max": 1343.0145025248396, "episodes_total": 1191, "timesteps_since_restore": 3727357, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.315, "num_steps_sampled": 3770145, "num_steps_trained": 3770145, "default": {"entropy": 0.9116466045379639, "policy_loss": -0.00476290425285697, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9756631255149841, "vf_loss": 7.774792194366455, "total_loss": 7.771320819854736, "cur_lr": 0.0005000000237487257, "kl": 0.015307467430830002}, "sample_time_ms": 16091.491, "load_time_ms": 7.224, "grad_time_ms": 9500.91}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 3770145, "time_this_iter_s": 25.277358293533325, "date": "2019-05-07_03-52-41", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea15c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea1630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea1da0>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 76.35277112286012, "cost2_max": -18.491507830434003, "outflow_rate_min": 407.0601242398811, "cost1_max": 438.2043958339433, "cost1_mean": 372.5245303026498, "system_level_velocity_mean": 14.679747010705771, "cost2_min": -107.23905648993507, "system_level_velocity_min": 12.848480772294138, "outflow_rate_max": 1024.7516374695356, "system_level_velocity_max": 19.046767262580715, "outflow_rate_mean": 937.4665223391934, "cost2_mean": -83.52866305361769}, "policy_reward_mean": {}, "timesteps_this_iter": 42788, "episodes_this_iter": 18, "training_iteration": 83, "episode_reward_min": 168.41087668115026, "episode_reward_mean": 1153.4265926968344, "iterations_since_restore": 83, "time_total_s": 2265.9393208026886, "timestamp": 1557201161, "pid": 300, "time_since_restore": 2265.9393208026886, "episode_len_mean": 678.84, "episode_reward_max": 1343.0145025248396, "episodes_total": 1209, "timesteps_since_restore": 3770145, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.392, "num_steps_sampled": 3811176, "num_steps_trained": 3811176, "default": {"entropy": 0.8656363487243652, "policy_loss": -0.005890629254281521, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9541686177253723, "vf_loss": 13.436853408813477, "total_loss": 13.432522773742676, "cur_lr": 0.0005000000237487257, "kl": 0.01849258318543434}, "sample_time_ms": 16073.612, "load_time_ms": 7.182, "grad_time_ms": 9455.776}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 3811176, "time_this_iter_s": 25.2635555267334, "date": "2019-05-07_03-53-06", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e965f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e969b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e968d0>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 76.35277112286012, "cost2_max": -18.491507830434003, "outflow_rate_min": 407.0601242398811, "cost1_max": 438.2043958339433, "cost1_mean": 366.2340957414017, "system_level_velocity_mean": 14.731903023305115, "cost2_min": -107.23905648993507, "system_level_velocity_min": 12.848480772294138, "outflow_rate_max": 1023.6027792427387, "system_level_velocity_max": 19.046767262580715, "outflow_rate_mean": 924.7212878918825, "cost2_mean": -80.75609831110889}, "policy_reward_mean": {}, "timesteps_this_iter": 41031, "episodes_this_iter": 15, "training_iteration": 84, "episode_reward_min": 168.41087668115026, "episode_reward_mean": 1131.2405511778397, "iterations_since_restore": 84, "time_total_s": 2291.202876329422, "timestamp": 1557201186, "pid": 300, "time_since_restore": 2291.202876329422, "episode_len_mean": 666.91, "episode_reward_max": 1388.3206106938667, "episodes_total": 1224, "timesteps_since_restore": 3811176, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.509, "num_steps_sampled": 3852641, "num_steps_trained": 3852641, "default": {"entropy": 0.8907415866851807, "policy_loss": -0.007100267801433802, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9522441625595093, "vf_loss": 13.639730453491211, "total_loss": 13.6341552734375, "cur_lr": 0.0005000000237487257, "kl": 0.018077215179800987}, "sample_time_ms": 16013.212, "load_time_ms": 7.138, "grad_time_ms": 9302.342}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 3852641, "time_this_iter_s": 25.423569917678833, "date": "2019-05-07_03-53-32", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea1ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e969e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96e80>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 76.35277112286012, "cost2_max": -18.45300758215256, "outflow_rate_min": 407.0601242398811, "cost1_max": 432.9248927275816, "cost1_mean": 367.8368410023705, "system_level_velocity_mean": 14.679310862308471, "cost2_min": -107.23905648993507, "system_level_velocity_min": 12.569939428582046, "outflow_rate_max": 1023.3664239931563, "system_level_velocity_max": 19.00079908566621, "outflow_rate_mean": 927.020337738181, "cost2_mean": -79.10119247535212}, "policy_reward_mean": {}, "timesteps_this_iter": 41465, "episodes_this_iter": 20, "training_iteration": 85, "episode_reward_min": 168.41087668115026, "episode_reward_mean": 1132.9832716819446, "iterations_since_restore": 85, "time_total_s": 2316.626446247101, "timestamp": 1557201212, "pid": 300, "time_since_restore": 2316.626446247101, "episode_len_mean": 671.17, "episode_reward_max": 1388.3206106938667, "episodes_total": 1244, "timesteps_since_restore": 3852641, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.511, "num_steps_sampled": 3895838, "num_steps_trained": 3895838, "default": {"entropy": 0.9078277945518494, "policy_loss": -0.005287813022732735, "cur_kl_coeff": 0.08437501639127731, "vf_explained_var": 0.96803879737854, "vf_loss": 10.178108215332031, "total_loss": 10.174226760864258, "cur_lr": 0.0005000000237487257, "kl": 0.016668634489178658}, "sample_time_ms": 16100.673, "load_time_ms": 7.235, "grad_time_ms": 9228.765}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 3895838, "time_this_iter_s": 25.55069923400879, "date": "2019-05-07_03-53-57", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71dd8>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 76.35277112286012, "cost2_max": -18.45300758215256, "outflow_rate_min": 407.0601242398811, "cost1_max": 432.9248927275816, "cost1_mean": 367.61395701016147, "system_level_velocity_mean": 14.63842801995999, "cost2_min": -104.1338781271417, "system_level_velocity_min": 12.569939428582046, "outflow_rate_max": 1023.3664239931563, "system_level_velocity_max": 19.00079908566621, "outflow_rate_mean": 926.0559017849281, "cost2_mean": -77.15554434433625}, "policy_reward_mean": {}, "timesteps_this_iter": 43197, "episodes_this_iter": 14, "training_iteration": 86, "episode_reward_min": 168.41087668115026, "episode_reward_mean": 1132.5202795347304, "iterations_since_restore": 86, "time_total_s": 2342.1771454811096, "timestamp": 1557201237, "pid": 300, "time_since_restore": 2342.1771454811096, "episode_len_mean": 671.98, "episode_reward_max": 1388.3206106938667, "episodes_total": 1258, "timesteps_since_restore": 3895838, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.529, "num_steps_sampled": 3938796, "num_steps_trained": 3938796, "default": {"entropy": 0.8900127410888672, "policy_loss": -0.005734129808843136, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9665115475654602, "vf_loss": 8.686904907226562, "total_loss": 8.682597160339355, "cur_lr": 0.0005000000237487257, "kl": 0.016895800828933716}, "sample_time_ms": 16166.336, "load_time_ms": 7.348, "grad_time_ms": 9267.559}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 3938796, "time_this_iter_s": 25.37485122680664, "date": "2019-05-07_03-54-23", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea1198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea1d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea19e8>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 76.35277112286012, "cost2_max": -18.45300758215256, "outflow_rate_min": 407.0601242398811, "cost1_max": 432.9248927275816, "cost1_mean": 368.43586776842017, "system_level_velocity_mean": 14.670805804148085, "cost2_min": -104.1338781271417, "system_level_velocity_min": 11.696716057183162, "outflow_rate_max": 1036.003298663348, "system_level_velocity_max": 19.00079908566621, "outflow_rate_mean": 927.2480718644507, "cost2_mean": -75.93588552363204}, "policy_reward_mean": {}, "timesteps_this_iter": 42958, "episodes_this_iter": 13, "training_iteration": 87, "episode_reward_min": 168.41087668115026, "episode_reward_mean": 1135.930834263118, "iterations_since_restore": 87, "time_total_s": 2367.5519967079163, "timestamp": 1557201263, "pid": 300, "time_since_restore": 2367.5519967079163, "episode_len_mean": 671.98, "episode_reward_max": 1388.3206106938667, "episodes_total": 1271, "timesteps_since_restore": 3938796, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.606, "num_steps_sampled": 3981337, "num_steps_trained": 3981337, "default": {"entropy": 0.9293895959854126, "policy_loss": -0.004818081855773926, "cur_kl_coeff": 0.08437501639127731, "vf_explained_var": 0.973721981048584, "vf_loss": 9.367356300354004, "total_loss": 9.363956451416016, "cur_lr": 0.0005000000237487257, "kl": 0.016803888604044914}, "sample_time_ms": 16090.247, "load_time_ms": 7.592, "grad_time_ms": 9304.793}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 3981337, "time_this_iter_s": 24.957005262374878, "date": "2019-05-07_03-54-48", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e968d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e969b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e963c8>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 92.25611478843908, "cost2_max": -18.45300758215256, "outflow_rate_min": 449.7214958099745, "cost1_max": 432.9248927275816, "cost1_mean": 368.50986931934864, "system_level_velocity_mean": 14.667350236502092, "cost2_min": -104.1338781271417, "system_level_velocity_min": 11.696716057183162, "outflow_rate_max": 1036.5028764540914, "system_level_velocity_max": 18.995835533535807, "outflow_rate_mean": 928.3659882202053, "cost2_mean": -76.00874543361802}, "policy_reward_mean": {}, "timesteps_this_iter": 42541, "episodes_this_iter": 18, "training_iteration": 88, "episode_reward_min": 214.72401322965447, "episode_reward_mean": 1137.645215180805, "iterations_since_restore": 88, "time_total_s": 2392.509001970291, "timestamp": 1557201288, "pid": 300, "time_since_restore": 2392.509001970291, "episode_len_mean": 672.22, "episode_reward_max": 1388.3206106938667, "episodes_total": 1289, "timesteps_since_restore": 3981337, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.769, "num_steps_sampled": 4022894, "num_steps_trained": 4022894, "default": {"entropy": 0.908944308757782, "policy_loss": -0.004300305154174566, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9787473082542419, "vf_loss": 7.18462610244751, "total_loss": 7.18176794052124, "cur_lr": 0.0005000000237487257, "kl": 0.017090141773223877}, "sample_time_ms": 16108.752, "load_time_ms": 7.611, "grad_time_ms": 9225.205}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 4022894, "time_this_iter_s": 25.142985105514526, "date": "2019-05-07_03-55-13", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71ef0>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 92.25611478843908, "cost2_max": -18.45300758215256, "outflow_rate_min": 449.7214958099745, "cost1_max": 432.9248927275816, "cost1_mean": 368.07798013952015, "system_level_velocity_mean": 14.663854401804892, "cost2_min": -111.85802737643498, "system_level_velocity_min": 11.696716057183162, "outflow_rate_max": 1036.5028764540914, "system_level_velocity_max": 18.995835533535807, "outflow_rate_mean": 929.3389176484318, "cost2_mean": -77.01130737192807}, "policy_reward_mean": {}, "timesteps_this_iter": 41557, "episodes_this_iter": 15, "training_iteration": 89, "episode_reward_min": 214.72401322965447, "episode_reward_mean": 1131.5780371772441, "iterations_since_restore": 89, "time_total_s": 2417.6519870758057, "timestamp": 1557201313, "pid": 300, "time_since_restore": 2417.6519870758057, "episode_len_mean": 672.22, "episode_reward_max": 1388.3206106938667, "episodes_total": 1304, "timesteps_since_restore": 4022894, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.833, "num_steps_sampled": 4064525, "num_steps_trained": 4064525, "default": {"entropy": 0.9318920969963074, "policy_loss": -0.00571720814332366, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9758974313735962, "vf_loss": 8.456003189086914, "total_loss": 8.451767921447754, "cur_lr": 0.0005000000237487257, "kl": 0.017562875524163246}, "sample_time_ms": 16078.915, "load_time_ms": 7.566, "grad_time_ms": 9159.721}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 4064525, "time_this_iter_s": 25.999677896499634, "date": "2019-05-07_03-55-39", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e98160>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 92.25611478843908, "cost2_max": -18.45300758215256, "outflow_rate_min": 449.7214958099745, "cost1_max": 442.63023822674086, "cost1_mean": 372.5533743849873, "system_level_velocity_mean": 14.634169130893001, "cost2_min": -118.62722775077391, "system_level_velocity_min": 11.696716057183162, "outflow_rate_max": 1039.293861817712, "system_level_velocity_max": 18.995835533535807, "outflow_rate_mean": 937.9260946563295, "cost2_mean": -79.42638995224905}, "policy_reward_mean": {}, "timesteps_this_iter": 41631, "episodes_this_iter": 17, "training_iteration": 90, "episode_reward_min": 214.72401322965447, "episode_reward_mean": 1135.7948231688688, "iterations_since_restore": 90, "time_total_s": 2443.6516649723053, "timestamp": 1557201339, "pid": 300, "time_since_restore": 2443.6516649723053, "episode_len_mean": 681.11, "episode_reward_max": 1334.9666675770397, "episodes_total": 1321, "timesteps_since_restore": 4064525, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.838, "num_steps_sampled": 4107191, "num_steps_trained": 4107191, "default": {"entropy": 0.9196953177452087, "policy_loss": -0.004342569038271904, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.957036554813385, "vf_loss": 13.228957176208496, "total_loss": 13.226139068603516, "cur_lr": 0.0005000000237487257, "kl": 0.018072713166475296}, "sample_time_ms": 16058.526, "load_time_ms": 7.565, "grad_time_ms": 9128.136}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 4107191, "time_this_iter_s": 25.308321475982666, "date": "2019-05-07_03-56-04", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3ea1908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e962e8>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 92.25611478843908, "cost2_max": -21.671994321456005, "outflow_rate_min": 449.7214958099745, "cost1_max": 442.63023822674086, "cost1_mean": 373.9463254932112, "system_level_velocity_mean": 14.586896468561283, "cost2_min": -118.62722775077391, "system_level_velocity_min": 11.696716057183162, "outflow_rate_max": 1039.293861817712, "system_level_velocity_max": 18.995835533535807, "outflow_rate_mean": 943.5564558706769, "cost2_mean": -80.8327310614774}, "policy_reward_mean": {}, "timesteps_this_iter": 42666, "episodes_this_iter": 15, "training_iteration": 91, "episode_reward_min": 214.72401322965447, "episode_reward_mean": 1145.9369929102147, "iterations_since_restore": 91, "time_total_s": 2468.959986448288, "timestamp": 1557201364, "pid": 300, "time_since_restore": 2468.959986448288, "episode_len_mean": 685.62, "episode_reward_max": 1334.9666675770397, "episodes_total": 1336, "timesteps_since_restore": 4107191, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.855, "num_steps_sampled": 4149280, "num_steps_trained": 4149280, "default": {"entropy": 0.8897842764854431, "policy_loss": -0.00501570850610733, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9625599384307861, "vf_loss": 11.073749542236328, "total_loss": 11.070304870605469, "cur_lr": 0.0005000000237487257, "kl": 0.0186168160289526}, "sample_time_ms": 16048.175, "load_time_ms": 7.849, "grad_time_ms": 9153.788}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 4149280, "time_this_iter_s": 24.737544536590576, "date": "2019-05-07_03-56-29", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e834a8>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 92.25611478843908, "cost2_max": -21.671994321456005, "outflow_rate_min": 449.7214958099745, "cost1_max": 442.63023822674086, "cost1_mean": 373.2113403112205, "system_level_velocity_mean": 14.713433099073427, "cost2_min": -118.62722775077391, "system_level_velocity_min": 11.696716057183162, "outflow_rate_max": 1041.3603893285897, "system_level_velocity_max": 18.995835533535807, "outflow_rate_mean": 943.6034384024896, "cost2_mean": -80.65097742133172}, "policy_reward_mean": {}, "timesteps_this_iter": 42089, "episodes_this_iter": 15, "training_iteration": 92, "episode_reward_min": 214.72401322965447, "episode_reward_mean": 1139.2694079743824, "iterations_since_restore": 92, "time_total_s": 2493.6975309848785, "timestamp": 1557201389, "pid": 300, "time_since_restore": 2493.6975309848785, "episode_len_mean": 680.64, "episode_reward_max": 1334.9666675770397, "episodes_total": 1351, "timesteps_since_restore": 4149280, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.877, "num_steps_sampled": 4190762, "num_steps_trained": 4190762, "default": {"entropy": 0.9392244219779968, "policy_loss": -0.00663271127268672, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.968829333782196, "vf_loss": 10.974345207214355, "total_loss": 10.969086647033691, "cur_lr": 0.0005000000237487257, "kl": 0.016282465308904648}, "sample_time_ms": 15999.912, "load_time_ms": 7.697, "grad_time_ms": 9153.033}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 4190762, "time_this_iter_s": 24.793718338012695, "date": "2019-05-07_03-56-54", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71940>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 92.25611478843908, "cost2_max": -21.671994321456005, "outflow_rate_min": 449.7214958099745, "cost1_max": 445.02675461379846, "cost1_mean": 374.91695008046065, "system_level_velocity_mean": 14.78856839837282, "cost2_min": -118.62722775077391, "system_level_velocity_min": 12.361201155509256, "outflow_rate_max": 1041.3603893285897, "system_level_velocity_max": 18.995835533535807, "outflow_rate_mean": 945.4561816731273, "cost2_mean": -82.20468936785366}, "policy_reward_mean": {}, "timesteps_this_iter": 41482, "episodes_this_iter": 19, "training_iteration": 93, "episode_reward_min": 214.72401322965447, "episode_reward_mean": 1145.815814444405, "iterations_since_restore": 93, "time_total_s": 2518.4912493228912, "timestamp": 1557201414, "pid": 300, "time_since_restore": 2518.4912493228912, "episode_len_mean": 680.74, "episode_reward_max": 1334.9666675770397, "episodes_total": 1370, "timesteps_since_restore": 4190762, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.809, "num_steps_sampled": 4233093, "num_steps_trained": 4233093, "default": {"entropy": 0.9311917424201965, "policy_loss": -0.008632175624370575, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9594972729682922, "vf_loss": 11.295336723327637, "total_loss": 11.28827953338623, "cur_lr": 0.0005000000237487257, "kl": 0.018664086237549782}, "sample_time_ms": 15934.522, "load_time_ms": 7.681, "grad_time_ms": 9169.666}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 4233093, "time_this_iter_s": 24.767189979553223, "date": "2019-05-07_03-57-19", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e985f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e98cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e98f98>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 35.33380271572437, "cost2_max": -12.782183794131118, "outflow_rate_min": 317.05045775182083, "cost1_max": 445.02675461379846, "cost1_mean": 375.6649271986727, "system_level_velocity_mean": 14.858015926397023, "cost2_min": -118.62722775077391, "system_level_velocity_min": 12.361201155509256, "outflow_rate_max": 1041.3603893285897, "system_level_velocity_max": 18.93990197279586, "outflow_rate_mean": 948.1050856946522, "cost2_mean": -82.02073160380255}, "policy_reward_mean": {}, "timesteps_this_iter": 42331, "episodes_this_iter": 15, "training_iteration": 94, "episode_reward_min": 72.28358345617241, "episode_reward_mean": 1148.0026236615722, "iterations_since_restore": 94, "time_total_s": 2543.2584393024445, "timestamp": 1557201439, "pid": 300, "time_since_restore": 2543.2584393024445, "episode_len_mean": 679.92, "episode_reward_max": 1326.3351137067998, "episodes_total": 1385, "timesteps_since_restore": 4233093, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.477, "num_steps_sampled": 4274905, "num_steps_trained": 4274905, "default": {"entropy": 0.9000211358070374, "policy_loss": -0.007853925228118896, "cur_kl_coeff": 0.08437500894069672, "vf_explained_var": 0.9462748169898987, "vf_loss": 15.828352928161621, "total_loss": 15.822211265563965, "cur_lr": 0.0005000000237487257, "kl": 0.02030072547495365}, "sample_time_ms": 15797.147, "load_time_ms": 7.911, "grad_time_ms": 9268.757}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 4274905, "time_this_iter_s": 25.0331711769104, "date": "2019-05-07_03-57-44", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e96b70>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 33.43496056967237, "cost2_max": -12.782183794131118, "outflow_rate_min": 317.05045775182083, "cost1_max": 445.02675461379846, "cost1_mean": 366.2232433463927, "system_level_velocity_mean": 15.048319913033279, "cost2_min": -119.01541970446728, "system_level_velocity_min": 12.361201155509256, "outflow_rate_max": 1041.3603893285897, "system_level_velocity_max": 19.15017805375037, "outflow_rate_mean": 929.0434754591629, "cost2_mean": -79.97609826240226}, "policy_reward_mean": {}, "timesteps_this_iter": 41812, "episodes_this_iter": 20, "training_iteration": 95, "episode_reward_min": 61.98897185836147, "episode_reward_mean": 1116.4778840401036, "iterations_since_restore": 95, "time_total_s": 2568.291610479355, "timestamp": 1557201464, "pid": 300, "time_since_restore": 2568.291610479355, "episode_len_mean": 659.29, "episode_reward_max": 1327.562460680496, "episodes_total": 1405, "timesteps_since_restore": 4274905, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.336, "num_steps_sampled": 4319442, "num_steps_trained": 4319442, "default": {"entropy": 0.9670715928077698, "policy_loss": -0.006369035691022873, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9734060764312744, "vf_loss": 8.9876070022583, "total_loss": 8.983501434326172, "cur_lr": 0.0005000000237487257, "kl": 0.017885562032461166}, "sample_time_ms": 15633.678, "load_time_ms": 7.813, "grad_time_ms": 9605.702}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 4319442, "time_this_iter_s": 27.265390157699585, "date": "2019-05-07_03-58-11", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e963c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8cba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e8cb38>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 33.43496056967237, "cost2_max": -12.782183794131118, "outflow_rate_min": 317.05045775182083, "cost1_max": 445.02675461379846, "cost1_mean": 364.7438516220694, "system_level_velocity_mean": 15.136371412839868, "cost2_min": -119.01541970446728, "system_level_velocity_min": 12.361201155509256, "outflow_rate_max": 1053.3645622459342, "system_level_velocity_max": 19.15017805375037, "outflow_rate_mean": 926.2316218091582, "cost2_mean": -79.41099370665891}, "policy_reward_mean": {}, "timesteps_this_iter": 44537, "episodes_this_iter": 14, "training_iteration": 96, "episode_reward_min": 61.98897185836147, "episode_reward_mean": 1114.1921391117387, "iterations_since_restore": 96, "time_total_s": 2595.5570006370544, "timestamp": 1557201491, "pid": 300, "time_since_restore": 2595.5570006370544, "episode_len_mean": 654.2, "episode_reward_max": 1373.317506567229, "episodes_total": 1419, "timesteps_since_restore": 4319442, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.485, "num_steps_sampled": 4361165, "num_steps_trained": 4361165, "default": {"entropy": 0.9440454840660095, "policy_loss": -0.006912337150424719, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.979108989238739, "vf_loss": 7.505373954772949, "total_loss": 7.500508785247803, "cur_lr": 0.0005000000237487257, "kl": 0.01617603749036789}, "sample_time_ms": 15413.814, "load_time_ms": 7.749, "grad_time_ms": 9714.417}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 4361165, "time_this_iter_s": 24.26306414604187, "date": "2019-05-07_03-58-35", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e71198>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 33.43496056967237, "cost2_max": -12.782183794131118, "outflow_rate_min": 317.05045775182083, "cost1_max": 454.8522449933833, "cost1_mean": 364.4162092899243, "system_level_velocity_mean": 15.10548227543955, "cost2_min": -119.01541970446728, "system_level_velocity_min": 12.417647655827329, "outflow_rate_max": 1053.3645622459342, "system_level_velocity_max": 19.15017805375037, "outflow_rate_mean": 922.4387499597183, "cost2_mean": -81.21245681425208}, "policy_reward_mean": {}, "timesteps_this_iter": 41723, "episodes_this_iter": 16, "training_iteration": 97, "episode_reward_min": 61.98897185836147, "episode_reward_mean": 1111.3786262676658, "iterations_since_restore": 97, "time_total_s": 2619.8200647830963, "timestamp": 1557201515, "pid": 300, "time_since_restore": 2619.8200647830963, "episode_len_mean": 654.68, "episode_reward_max": 1383.8114550085854, "episodes_total": 1435, "timesteps_since_restore": 4361165, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.661, "num_steps_sampled": 4401461, "num_steps_trained": 4401461, "default": {"entropy": 0.9582459330558777, "policy_loss": -0.006998774129897356, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9715785384178162, "vf_loss": 10.395529747009277, "total_loss": 10.390728950500488, "cur_lr": 0.0005000000237487257, "kl": 0.017366981133818626}, "sample_time_ms": 15342.863, "load_time_ms": 7.47, "grad_time_ms": 9786.678}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 4401461, "time_this_iter_s": 24.972811460494995, "date": "2019-05-07_03-59-00", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e98eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e7cd68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e984e0>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 33.43496056967237, "cost2_max": -12.782183794131118, "outflow_rate_min": 317.05045775182083, "cost1_max": 455.1255125875007, "cost1_mean": 367.24093417134844, "system_level_velocity_mean": 15.188607262739628, "cost2_min": -119.01541970446728, "system_level_velocity_min": 12.417647655827329, "outflow_rate_max": 1067.8192315209396, "system_level_velocity_max": 19.15017805375037, "outflow_rate_mean": 927.0488521920944, "cost2_mean": -82.64118322928827}, "policy_reward_mean": {}, "timesteps_this_iter": 40296, "episodes_this_iter": 21, "training_iteration": 98, "episode_reward_min": 61.98897185836147, "episode_reward_mean": 1112.2232415989085, "iterations_since_restore": 98, "time_total_s": 2644.7928762435913, "timestamp": 1557201540, "pid": 300, "time_since_restore": 2644.7928762435913, "episode_len_mean": 656.37, "episode_reward_max": 1383.8114550085854, "episodes_total": 1456, "timesteps_since_restore": 4401461, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.805, "num_steps_sampled": 4444653, "num_steps_trained": 4444653, "default": {"entropy": 0.9821581840515137, "policy_loss": -0.00534572871401906, "cur_kl_coeff": 0.12656249105930328, "vf_explained_var": 0.9725756645202637, "vf_loss": 9.088744163513184, "total_loss": 9.085363388061523, "cur_lr": 0.0005000000237487257, "kl": 0.015528122894465923}, "sample_time_ms": 15142.391, "load_time_ms": 7.525, "grad_time_ms": 9902.819}, "done": false, "num_metric_batches_dropped": 0, "timesteps_total": 4444653, "time_this_iter_s": 24.303765296936035, "date": "2019-05-07_03-59-25", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e98e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e83f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42b3e98f60>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 33.43496056967237, "cost2_max": -12.782183794131118, "outflow_rate_min": 317.05045775182083, "cost1_max": 455.1255125875007, "cost1_mean": 368.79374845440134, "system_level_velocity_mean": 15.280951684436687, "cost2_min": -119.01541970446728, "system_level_velocity_min": 12.417647655827329, "outflow_rate_max": 1087.5340260632215, "system_level_velocity_max": 19.15017805375037, "outflow_rate_mean": 931.9415902575172, "cost2_mean": -82.50404009429433}, "policy_reward_mean": {}, "timesteps_this_iter": 43192, "episodes_this_iter": 12, "training_iteration": 99, "episode_reward_min": 61.98897185836147, "episode_reward_mean": 1109.9744473187068, "iterations_since_restore": 99, "time_total_s": 2669.0966415405273, "timestamp": 1557201565, "pid": 300, "time_since_restore": 2669.0966415405273, "episode_len_mean": 656.17, "episode_reward_max": 1383.8114550085854, "episodes_total": 1468, "timesteps_since_restore": 4444653, "hostname": "flow-main", "node_ip": "10.138.0.2"}
{"info": {"update_time_ms": 7.929, "num_steps_sampled": 4487779, "num_steps_trained": 4487779, "default": {"entropy": 0.9400582313537598, "policy_loss": -0.0051577710546553135, "cur_kl_coeff": 0.1265624761581421, "vf_explained_var": 0.9733779430389404, "vf_loss": 8.649749755859375, "total_loss": 8.646530151367188, "cur_lr": 0.0005000000237487257, "kl": 0.015317370183765888}, "sample_time_ms": 15100.037, "load_time_ms": 7.578, "grad_time_ms": 9924.73}, "done": true, "num_metric_batches_dropped": 0, "timesteps_total": 4487779, "time_this_iter_s": 26.12457799911499, "date": "2019-05-07_03-59-51", "config": {"input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "straggler_mitigation": false, "num_cpus_per_worker": 1, "synchronize_filters": true, "gamma": 0.99, "sample_async": false, "sgd_minibatch_size": 128, "simple_optimizer": false, "lambda": 0.97, "num_gpus_per_worker": 0, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "input": "sampler", "batch_mode": "truncate_episodes", "train_batch_size": 30000, "lr": 0.0005, "clip_param": 0.3, "kl_target": 0.01, "sample_batch_size": 200, "compress_observations": false, "observation_filter": "NoFilter", "vf_share_layers": false, "num_cpus_for_driver": 1, "clip_rewards": null, "preprocessor_pref": "deepmind", "use_gae": true, "optimizer": {}, "output_compress_columns": ["obs", "new_obs"], "collect_metrics_timeout": 180, "kl_coeff": 0.2, "vf_clip_param": 1000000.0, "custom_resources_per_worker": {}, "callbacks": {"on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f42bfb1d4a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f42bfb1d240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f42bfb1d588>", "on_sample_end": null}, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v01000_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0", "entropy_coeff": 0.0, "monitor": false, "output": null, "lr_schedule": null, "horizon": 1500, "num_sgd_iter": 10, "output_max_file_size": 67108864, "log_level": "INFO", "num_envs_per_worker": 1, "num_gpus": 0, "clip_actions": false, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "vf_loss_coeff": 1.0, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 1000,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "num_workers": 20, "model": {"fcnet_activation": "tanh", "squash_to_range": false, "conv_filters": null, "framestack": true, "dim": 84, "lstm_cell_size": 256, "custom_options": {}, "custom_model": null, "conv_activation": "relu", "zero_mean": true, "custom_preprocessor": null, "channel_major": false, "free_log_std": false, "max_seq_len": 20, "grayscale": false, "fcnet_hiddens": [100, 50, 25], "lstm_use_prev_action_reward": false, "use_lstm": false}}, "experiment_id": "10109c3c76054855a1df33ae0249a969", "custom_metrics": {"cost1_min": 33.43496056967237, "cost2_max": -14.200046380086096, "outflow_rate_min": 317.8511585296525, "cost1_max": 462.92647171864576, "cost1_mean": 368.20516810458116, "system_level_velocity_mean": 15.239545769222357, "cost2_min": -119.01541970446728, "system_level_velocity_min": 12.417647655827329, "outflow_rate_max": 1087.5340260632215, "system_level_velocity_max": 19.15017805375037, "outflow_rate_mean": 929.7429097125097, "cost2_mean": -83.70374487886889}, "policy_reward_mean": {}, "timesteps_this_iter": 43126, "episodes_this_iter": 16, "training_iteration": 100, "episode_reward_min": 61.98897185836147, "episode_reward_mean": 1102.6437948052576, "iterations_since_restore": 100, "time_total_s": 2695.2212195396423, "timestamp": 1557201591, "pid": 300, "time_since_restore": 2695.2212195396423, "episode_len_mean": 657.14, "episode_reward_max": 1383.8114550085854, "episodes_total": 1484, "timesteps_since_restore": 4487779, "hostname": "flow-main", "node_ip": "10.138.0.2"}

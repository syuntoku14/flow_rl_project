{"timesteps_this_iter": 42290, "episodes_total": 40, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 42290, "training_iteration": 1, "episode_reward_max": -486.41980224657243, "pid": 33729, "time_this_iter_s": 31.488003730773926, "time_total_s": 31.488003730773926, "episodes_this_iter": 40, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 1, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11249.982, "update_time_ms": 715.913, "sample_time_ms": 19280.149, "num_steps_trained": 42290, "load_time_ms": 108.057, "default": {"vf_loss": 38.17383575439453, "cur_kl_coeff": 0.20000004768371582, "policy_loss": -0.0015388756291940808, "total_loss": 38.1729621887207, "cur_lr": 0.0005000000237487257, "kl": 0.003338409122079611, "entropy": 1.4105128049850464, "vf_explained_var": -3.3337057629978517e-06}, "num_steps_sampled": 42290}, "hostname": "flow-main", "date": "2019-05-24_04-43-40", "episode_reward_mean": -732.8557541548216, "timestamp": 1558673020, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb9012b0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb9014e0>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 31.488003730773926, "custom_metrics": {"system_level_velocity_max": 12.38955590379471, "cost1_mean": 121.63330416488346, "cost1_min": 105.50942366573103, "cost1_max": 153.08153136947055, "cost2_mean": -51.45328941585588, "outflow_rate_min": 635.28, "system_level_velocity_min": 8.631292315287169, "cost2_min": -89.20586749012331, "outflow_rate_max": 986.2125986308777, "cost2_max": -32.34347060106996, "system_level_velocity_mean": 10.106873944403045, "outflow_rate_mean": 744.839024790241}, "timesteps_since_restore": 42290, "episode_reward_min": -967.57141377234}
{"timesteps_this_iter": 42224, "episodes_total": 80, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 84514, "training_iteration": 2, "episode_reward_max": -486.41980224657243, "pid": 33729, "time_this_iter_s": 29.37874698638916, "time_total_s": 60.866750717163086, "episodes_this_iter": 40, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 2, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11256.526, "update_time_ms": 361.41, "sample_time_ms": 18635.632, "num_steps_trained": 84514, "load_time_ms": 63.72, "default": {"vf_loss": 59.080867767333984, "cur_kl_coeff": 0.10000000149011612, "policy_loss": -0.0012799679534509778, "total_loss": 59.079952239990234, "cur_lr": 0.0005000000237487257, "kl": 0.0036454149521887302, "entropy": 1.4030040502548218, "vf_explained_var": -2.8425438358681276e-07}, "num_steps_sampled": 84514}, "hostname": "flow-main", "date": "2019-05-24_04-44-10", "episode_reward_mean": -705.0041304846094, "timestamp": 1558673050, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c48d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4eb8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4da0>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 60.866750717163086, "custom_metrics": {"system_level_velocity_max": 12.941269486457815, "cost1_mean": 126.84761137634545, "cost1_min": 105.50942366573103, "cost1_max": 157.97346926600443, "cost2_mean": -51.76324656762305, "outflow_rate_min": 635.28, "system_level_velocity_min": 8.631292315287169, "cost2_min": -89.20586749012331, "outflow_rate_max": 1011.526786647173, "cost2_max": -30.50585685930275, "system_level_velocity_mean": 10.518364794671905, "outflow_rate_mean": 779.6910050386618}, "timesteps_since_restore": 84514, "episode_reward_min": -967.57141377234}
{"timesteps_this_iter": 43224, "episodes_total": 120, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 127738, "training_iteration": 3, "episode_reward_max": -486.41980224657243, "pid": 33729, "time_this_iter_s": 30.11003875732422, "time_total_s": 90.9767894744873, "episodes_this_iter": 40, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 3, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11355.671, "update_time_ms": 244.207, "sample_time_ms": 18566.26, "num_steps_trained": 127738, "load_time_ms": 48.882, "default": {"vf_loss": 87.81413269042969, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0014210928929969668, "total_loss": 87.81299591064453, "cur_lr": 0.0005000000237487257, "kl": 0.005574836395680904, "entropy": 1.4043241739273071, "vf_explained_var": -4.82850666116974e-08}, "num_steps_sampled": 127738}, "hostname": "flow-main", "date": "2019-05-24_04-44-40", "episode_reward_mean": -683.370895189162, "timestamp": 1558673080, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1ac8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1cc0>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 90.9767894744873, "custom_metrics": {"system_level_velocity_max": 12.941269486457815, "cost1_mean": 131.0207031495604, "cost1_min": 106.88489703389637, "cost1_max": 157.97346926600443, "cost2_mean": -52.2152053924798, "outflow_rate_min": 646.0595555555556, "system_level_velocity_min": 8.783793338301981, "cost2_min": -85.15022201671701, "outflow_rate_max": 1011.526786647173, "cost2_max": -28.395920456763985, "system_level_velocity_mean": 10.862654239920428, "outflow_rate_mean": 805.2225695478426}, "timesteps_since_restore": 127738, "episode_reward_min": -870.6560894060093}
{"timesteps_this_iter": 44177, "episodes_total": 180, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 171915, "training_iteration": 4, "episode_reward_max": -497.1083046335654, "pid": 33729, "time_this_iter_s": 32.21129655838013, "time_total_s": 123.18808603286743, "episodes_this_iter": 60, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 4, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11422.08, "update_time_ms": 185.631, "sample_time_ms": 19039.462, "num_steps_trained": 171915, "load_time_ms": 41.668, "default": {"vf_loss": 122.21512603759766, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0024462153669446707, "total_loss": 122.21306610107422, "cur_lr": 0.0005000000237487257, "kl": 0.007601462304592133, "entropy": 1.3972159624099731, "vf_explained_var": -1.3475832894016548e-08}, "num_steps_sampled": 171915}, "hostname": "flow-main", "date": "2019-05-24_04-45-12", "episode_reward_mean": -676.4726339232682, "timestamp": 1558673112, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac908>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3acc18>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 123.18808603286743, "custom_metrics": {"system_level_velocity_max": 13.840711175381365, "cost1_mean": 138.6489582768624, "cost1_min": 104.01003166738272, "cost1_max": 166.35879277899798, "cost2_mean": -60.89979035005881, "outflow_rate_min": 701.4828571428571, "system_level_velocity_min": 8.728767632128049, "cost2_min": -107.48219918978722, "outflow_rate_max": 1138.8405459820337, "cost2_max": -28.395920456763985, "system_level_velocity_mean": 11.453300172717768, "outflow_rate_mean": 879.0241529411159}, "timesteps_since_restore": 171915, "episode_reward_min": -946.3754791292947}
{"timesteps_this_iter": 42028, "episodes_total": 220, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 213943, "training_iteration": 5, "episode_reward_max": -497.1083046335654, "pid": 33729, "time_this_iter_s": 30.077319622039795, "time_total_s": 153.26540565490723, "episodes_this_iter": 40, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 5, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11611.468, "update_time_ms": 149.817, "sample_time_ms": 18749.412, "num_steps_trained": 213943, "load_time_ms": 37.273, "default": {"vf_loss": 112.38673400878906, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0022900381591171026, "total_loss": 112.38485717773438, "cur_lr": 0.0005000000237487257, "kl": 0.00820209365338087, "entropy": 1.39500892162323, "vf_explained_var": -1.272050376144307e-08}, "num_steps_sampled": 213943}, "hostname": "flow-main", "date": "2019-05-24_04-45-42", "episode_reward_mean": -651.1167144121509, "timestamp": 1558673142, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683240>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6834a8>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 153.26540565490723, "custom_metrics": {"system_level_velocity_max": 14.193483235011518, "cost1_mean": 144.2555625790501, "cost1_min": 104.01003166738272, "cost1_max": 172.99902649666427, "cost2_mean": -62.20237674211898, "outflow_rate_min": 701.4828571428571, "system_level_velocity_min": 8.728767632128049, "cost2_min": -107.48219918978722, "outflow_rate_max": 1138.8405459820337, "cost2_max": -33.369425517960565, "system_level_velocity_mean": 11.9015383221359, "outflow_rate_mean": 929.9465284114705}, "timesteps_since_restore": 213943, "episode_reward_min": -946.3754791292947}
{"timesteps_this_iter": 41632, "episodes_total": 260, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 255575, "training_iteration": 6, "episode_reward_max": -445.6201103544362, "pid": 33729, "time_this_iter_s": 28.966490745544434, "time_total_s": 182.23189640045166, "episodes_this_iter": 40, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 6, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11498.726, "update_time_ms": 126.107, "sample_time_ms": 18611.086, "num_steps_trained": 255575, "load_time_ms": 33.921, "default": {"vf_loss": 119.60177612304688, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.002501069800928235, "total_loss": 119.599853515625, "cur_lr": 0.0005000000237487257, "kl": 0.011686482466757298, "entropy": 1.3928683996200562, "vf_explained_var": -5.501967215160164e-10}, "num_steps_sampled": 255575}, "hostname": "flow-main", "date": "2019-05-24_04-46-11", "episode_reward_mean": -615.6256948556858, "timestamp": 1558673171, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c42b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4400>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4d30>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 182.23189640045166, "custom_metrics": {"system_level_velocity_max": 14.298342573276878, "cost1_mean": 147.26457098767972, "cost1_min": 104.01003166738272, "cost1_max": 174.47968285877238, "cost2_mean": -58.246472864326535, "outflow_rate_min": 701.3556647200272, "system_level_velocity_min": 8.728767632128049, "cost2_min": -91.78449535698019, "outflow_rate_max": 1145.8038298222516, "cost2_max": -32.59476631146761, "system_level_velocity_mean": 12.185094608998382, "outflow_rate_mean": 957.1936962250704}, "timesteps_since_restore": 255575, "episode_reward_min": -946.3754791292947}
{"timesteps_this_iter": 39746, "episodes_total": 320, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 295321, "training_iteration": 7, "episode_reward_max": -445.6201103544362, "pid": 33729, "time_this_iter_s": 29.97551941871643, "time_total_s": 212.2074158191681, "episodes_this_iter": 60, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 7, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11349.201, "update_time_ms": 109.406, "sample_time_ms": 18725.317, "num_steps_trained": 295321, "load_time_ms": 31.274, "default": {"vf_loss": 58.69967269897461, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.004749400075525045, "total_loss": 58.69582748413086, "cur_lr": 0.0005000000237487257, "kl": 0.018078943714499474, "entropy": 1.3892534971237183, "vf_explained_var": 0.5604846477508545}, "num_steps_sampled": 295321}, "hostname": "flow-main", "date": "2019-05-24_04-46-41", "episode_reward_mean": -576.6029706009325, "timestamp": 1558673201, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be37b9e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac8d0>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 212.2074158191681, "custom_metrics": {"system_level_velocity_max": 14.764116755880584, "cost1_mean": 151.98298644254072, "cost1_min": 112.07234965964776, "cost1_max": 177.7550699649372, "cost2_mean": -58.13264557887273, "outflow_rate_min": 701.3556647200272, "system_level_velocity_min": 9.184194121108415, "cost2_min": -91.78449535698019, "outflow_rate_max": 1145.8038298222516, "cost2_max": -32.59476631146761, "system_level_velocity_mean": 12.60008648443246, "outflow_rate_mean": 1004.478040109501}, "timesteps_since_restore": 295321, "episode_reward_min": -855.0890043560474}
{"timesteps_this_iter": 38241, "episodes_total": 360, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 333562, "training_iteration": 8, "episode_reward_max": -424.78388457195086, "pid": 33729, "time_this_iter_s": 26.75545620918274, "time_total_s": 238.96287202835083, "episodes_this_iter": 40, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 8, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11210.184, "update_time_ms": 96.792, "sample_time_ms": 18435.866, "num_steps_trained": 333562, "load_time_ms": 29.384, "default": {"vf_loss": 37.6337776184082, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.002382736885920167, "total_loss": 37.63200759887695, "cur_lr": 0.0005000000237487257, "kl": 0.012247849255800247, "entropy": 1.3682022094726562, "vf_explained_var": 0.7769738435745239}, "num_steps_sampled": 333562}, "hostname": "flow-main", "date": "2019-05-24_04-47-08", "episode_reward_mean": -536.739039410988, "timestamp": 1558673228, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac208>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac390>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 238.96287202835083, "custom_metrics": {"system_level_velocity_max": 15.4068156475219, "cost1_mean": 158.0216501453951, "cost1_min": 122.84024131531994, "cost1_max": 184.95851494409538, "cost2_mean": -57.00164602129086, "outflow_rate_min": 872.8597894736843, "system_level_velocity_min": 10.34785433691971, "cost2_min": -76.61842053796644, "outflow_rate_max": 1216.8706805439817, "cost2_max": -41.711263511784324, "system_level_velocity_mean": 13.138642216363532, "outflow_rate_mean": 1042.4750305540194}, "timesteps_since_restore": 333562, "episode_reward_min": -702.2744692065443}
{"timesteps_this_iter": 38691, "episodes_total": 400, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 372253, "training_iteration": 9, "episode_reward_max": -395.9670400288001, "pid": 33729, "time_this_iter_s": 27.807785987854004, "time_total_s": 266.77065801620483, "episodes_this_iter": 40, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 9, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11149.664, "update_time_ms": 87.038, "sample_time_ms": 18280.218, "num_steps_trained": 372253, "load_time_ms": 27.955, "default": {"vf_loss": 35.82889938354492, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0033890719059854746, "total_loss": 35.826202392578125, "cur_lr": 0.0005000000237487257, "kl": 0.013929121196269989, "entropy": 1.351818561553955, "vf_explained_var": 0.815666675567627}, "num_steps_sampled": 372253}, "hostname": "flow-main", "date": "2019-05-24_04-47-36", "episode_reward_mean": -500.9023199563876, "timestamp": 1558673256, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6836d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683a20>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683828>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 266.77065801620483, "custom_metrics": {"system_level_velocity_max": 15.700185004650423, "cost1_mean": 164.8843729554337, "cost1_min": 122.84024131531994, "cost1_max": 188.9523991692259, "cost2_mean": -58.26947942326716, "outflow_rate_min": 888.7960494909499, "system_level_velocity_min": 10.34785433691971, "cost2_min": -81.18890242936484, "outflow_rate_max": 1216.8706805439817, "cost2_max": -40.983896590536915, "system_level_velocity_mean": 13.696181838662215, "outflow_rate_mean": 1075.977892483975}, "timesteps_since_restore": 372253, "episode_reward_min": -645.3807104787845}
{"timesteps_this_iter": 37909, "episodes_total": 460, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 410162, "training_iteration": 10, "episode_reward_max": -361.41527154006377, "pid": 33729, "time_this_iter_s": 29.266027688980103, "time_total_s": 296.03668570518494, "episodes_this_iter": 60, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 10, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11109.644, "update_time_ms": 79.209, "sample_time_ms": 18293.978, "num_steps_trained": 410162, "load_time_ms": 26.724, "default": {"vf_loss": 38.462581634521484, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.002327672205865383, "total_loss": 38.46070098876953, "cur_lr": 0.0005000000237487257, "kl": 0.008938800543546677, "entropy": 1.3147673606872559, "vf_explained_var": 0.802946150302887}, "num_steps_sampled": 410162}, "hostname": "flow-main", "date": "2019-05-24_04-48-05", "episode_reward_mean": -474.024086832546, "timestamp": 1558673285, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4278>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4fd0>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 296.03668570518494, "custom_metrics": {"system_level_velocity_max": 16.301650819660573, "cost1_mean": 169.90837029083758, "cost1_min": 141.6823236793545, "cost1_max": 192.97205893807023, "cost2_mean": -60.279013964349616, "outflow_rate_min": 921.051733560332, "system_level_velocity_min": 11.683764067708838, "cost2_min": -81.18890242936484, "outflow_rate_max": 1205.6952948349178, "cost2_max": -40.983896590536915, "system_level_velocity_mean": 14.115007496458627, "outflow_rate_mean": 1104.146388838438}, "timesteps_since_restore": 410162, "episode_reward_min": -645.3807104787845}
{"timesteps_this_iter": 35390, "episodes_total": 500, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 445552, "training_iteration": 11, "episode_reward_max": -361.41527154006377, "pid": 33729, "time_this_iter_s": 26.113430500030518, "time_total_s": 322.15011620521545, "episodes_this_iter": 40, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 11, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10987.966, "update_time_ms": 8.374, "sample_time_ms": 17962.41, "num_steps_trained": 445552, "load_time_ms": 17.431, "default": {"vf_loss": 23.696273803710938, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.002171775558963418, "total_loss": 23.694568634033203, "cur_lr": 0.0005000000237487257, "kl": 0.009352797642350197, "entropy": 1.310006856918335, "vf_explained_var": 0.8562296628952026}, "num_steps_sampled": 445552}, "hostname": "flow-main", "date": "2019-05-24_04-48-31", "episode_reward_mean": -449.8982322197517, "timestamp": 1558673311, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1f60>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e16a0>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 322.15011620521545, "custom_metrics": {"system_level_velocity_max": 16.301650819660573, "cost1_mean": 172.05877100164903, "cost1_min": 142.19901415564033, "cost1_max": 192.97205893807023, "cost2_mean": -58.420415575316476, "outflow_rate_min": 941.1871953921129, "system_level_velocity_min": 11.745172318002282, "cost2_min": -72.79545869667915, "outflow_rate_max": 1205.6952948349178, "cost2_max": -43.001170728725185, "system_level_velocity_mean": 14.369652142171793, "outflow_rate_mean": 1106.9269254013507}, "timesteps_since_restore": 445552, "episode_reward_min": -604.6683850590433}
{"timesteps_this_iter": 36530, "episodes_total": 541, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 482082, "training_iteration": 12, "episode_reward_max": -24.136027668623925, "pid": 33729, "time_this_iter_s": 27.37683129310608, "time_total_s": 349.52694749832153, "episodes_this_iter": 41, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 12, "episode_len_mean": 322.02, "info": {"grad_time_ms": 10904.141, "update_time_ms": 8.531, "sample_time_ms": 17846.987, "num_steps_trained": 482082, "load_time_ms": 17.135, "default": {"vf_loss": 24.509197235107422, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0035593772772699594, "total_loss": 24.50619888305664, "cur_lr": 0.0005000000237487257, "kl": 0.011195128783583641, "entropy": 1.300048589706421, "vf_explained_var": 0.8422094583511353}, "num_steps_sampled": 482082}, "hostname": "flow-main", "date": "2019-05-24_04-48-59", "episode_reward_mean": -427.2936119833561, "timestamp": 1558673339, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6880f0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688e10>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 349.52694749832153, "custom_metrics": {"system_level_velocity_max": 17.573412380634814, "cost1_mean": 174.10450213697936, "cost1_min": 17.791197706491293, "cost1_max": 204.80268805385015, "cost2_mean": -58.74619270637713, "outflow_rate_min": 487.8590816741719, "system_level_velocity_min": 11.745172318002282, "cost2_min": -79.11301676843458, "outflow_rate_max": 1271.8886013869032, "cost2_max": -17.486174644733353, "system_level_velocity_mean": 14.727371477017915, "outflow_rate_mean": 1113.4764809354847}, "timesteps_since_restore": 482082, "episode_reward_min": -583.4287815290406}
{"timesteps_this_iter": 37231, "episodes_total": 600, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 519313, "training_iteration": 13, "episode_reward_max": -24.136027668623925, "pid": 33729, "time_this_iter_s": 28.95538902282715, "time_total_s": 378.4823365211487, "episodes_this_iter": 59, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 13, "episode_len_mean": 322.02, "info": {"grad_time_ms": 10799.476, "update_time_ms": 8.683, "sample_time_ms": 17838.739, "num_steps_trained": 519313, "load_time_ms": 16.691, "default": {"vf_loss": 32.09066390991211, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.003930442035198212, "total_loss": 32.08740234375, "cur_lr": 0.0005000000237487257, "kl": 0.013369069434702396, "entropy": 1.3046834468841553, "vf_explained_var": 0.7825828790664673}, "num_steps_sampled": 519313}, "hostname": "flow-main", "date": "2019-05-24_04-49-28", "episode_reward_mean": -419.12338756810124, "timestamp": 1558673368, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be37b9e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4c50>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 378.4823365211487, "custom_metrics": {"system_level_velocity_max": 17.573412380634814, "cost1_mean": 178.96319714378734, "cost1_min": 17.791197706491293, "cost1_max": 204.80268805385015, "cost2_mean": -62.05162223569786, "outflow_rate_min": 487.8590816741719, "system_level_velocity_min": 11.667028100453175, "cost2_min": -85.83874933516185, "outflow_rate_max": 1271.8886013869032, "cost2_max": -17.486174644733353, "system_level_velocity_mean": 15.080592793709933, "outflow_rate_mean": 1136.0492600965888}, "timesteps_since_restore": 519313, "episode_reward_min": -691.7535527508098}
{"timesteps_this_iter": 36710, "episodes_total": 641, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 556023, "training_iteration": 14, "episode_reward_max": -334.73266315675323, "pid": 33729, "time_this_iter_s": 27.611788272857666, "time_total_s": 406.09412479400635, "episodes_this_iter": 41, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 14, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10690.271, "update_time_ms": 8.433, "sample_time_ms": 17489.412, "num_steps_trained": 556023, "load_time_ms": 16.379, "default": {"vf_loss": 21.39164161682129, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0033350575249642134, "total_loss": 21.388853073120117, "cur_lr": 0.0005000000237487257, "kl": 0.010905413888394833, "entropy": 1.298352837562561, "vf_explained_var": 0.8441122174263}, "num_steps_sampled": 556023}, "hostname": "flow-main", "date": "2019-05-24_04-49-55", "episode_reward_mean": -429.85070768071296, "timestamp": 1558673395, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c49b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4400>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4fd0>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 406.09412479400635, "custom_metrics": {"system_level_velocity_max": 16.968944573753138, "cost1_mean": 179.37907580014533, "cost1_min": 141.93452864703613, "cost1_max": 203.00313458434528, "cost2_mean": -62.94065975644491, "outflow_rate_min": 909.185872441376, "system_level_velocity_min": 11.667028100453175, "cost2_min": -85.83874933516185, "outflow_rate_max": 1268.8288119863332, "cost2_max": -48.2090307631892, "system_level_velocity_mean": 14.91769385872391, "outflow_rate_mean": 1140.9010601025075}, "timesteps_since_restore": 556023, "episode_reward_min": -691.7535527508098}
{"timesteps_this_iter": 36345, "episodes_total": 681, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 592368, "training_iteration": 15, "episode_reward_max": -334.73266315675323, "pid": 33729, "time_this_iter_s": 26.88450789451599, "time_total_s": 432.97863268852234, "episodes_this_iter": 40, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 15, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10505.543, "update_time_ms": 8.863, "sample_time_ms": 17353.869, "num_steps_trained": 592368, "load_time_ms": 16.079, "default": {"vf_loss": 17.923847198486328, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0029717872384935617, "total_loss": 17.92133903503418, "cur_lr": 0.0005000000237487257, "kl": 0.009234488010406494, "entropy": 1.2910161018371582, "vf_explained_var": 0.8610326647758484}, "num_steps_sampled": 592368}, "hostname": "flow-main", "date": "2019-05-24_04-50-22", "episode_reward_mean": -425.8822459123398, "timestamp": 1558673422, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3aceb8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac2b0>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 432.97863268852234, "custom_metrics": {"system_level_velocity_max": 16.968944573753138, "cost1_mean": 178.88488573681957, "cost1_min": 144.60666086441915, "cost1_max": 203.00313458434528, "cost2_mean": -61.27854126326048, "outflow_rate_min": 991.8905450581392, "system_level_velocity_min": 12.052495263873551, "cost2_min": -85.83874933516185, "outflow_rate_max": 1268.8288119863332, "cost2_max": -45.520094692710025, "system_level_velocity_mean": 14.879306899980584, "outflow_rate_mean": 1139.7819136940154}, "timesteps_since_restore": 592368, "episode_reward_min": -602.1412484957327}
{"timesteps_this_iter": 35459, "episodes_total": 721, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 627827, "training_iteration": 16, "episode_reward_max": -335.7476129614437, "pid": 33729, "time_this_iter_s": 27.21679973602295, "time_total_s": 460.1954324245453, "episodes_this_iter": 40, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 16, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10594.046, "update_time_ms": 9.101, "sample_time_ms": 17091.147, "num_steps_trained": 627827, "load_time_ms": 15.871, "default": {"vf_loss": 15.543828964233398, "cur_kl_coeff": 0.05000000074505806, "policy_loss": -0.0036922399885952473, "total_loss": 15.540733337402344, "cur_lr": 0.0005000000237487257, "kl": 0.011898132041096687, "entropy": 1.2735602855682373, "vf_explained_var": 0.8716859221458435}, "num_steps_sampled": 627827}, "hostname": "flow-main", "date": "2019-05-24_04-50-49", "episode_reward_mean": -410.6222817387611, "timestamp": 1558673449, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688e48>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6882e8>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 460.1954324245453, "custom_metrics": {"system_level_velocity_max": 16.69352554632612, "cost1_mean": 180.68967491148112, "cost1_min": 144.60666086441915, "cost1_max": 196.95303770518655, "cost2_mean": -58.77825067985328, "outflow_rate_min": 1006.4353430821145, "system_level_velocity_min": 12.052495263873551, "cost2_min": -80.14468760149992, "outflow_rate_max": 1265.4067560531867, "cost2_max": -45.520094692710025, "system_level_velocity_mean": 15.078939537415744, "outflow_rate_mean": 1144.8282526795103}, "timesteps_since_restore": 627827, "episode_reward_min": -608.6721773162324}
{"timesteps_this_iter": 34619, "episodes_total": 782, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 662446, "training_iteration": 17, "episode_reward_max": -33.56505474586586, "pid": 33729, "time_this_iter_s": 28.399951219558716, "time_total_s": 488.595383644104, "episodes_this_iter": 61, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 17, "episode_len_mean": 321.9, "info": {"grad_time_ms": 10569.865, "update_time_ms": 9.086, "sample_time_ms": 16955.838, "num_steps_trained": 662446, "load_time_ms": 15.875, "default": {"vf_loss": 21.83638572692871, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002572679193690419, "total_loss": 21.834274291992188, "cur_lr": 0.0005000000237487257, "kl": 0.00922622624784708, "entropy": 1.266974687576294, "vf_explained_var": 0.8212898373603821}, "num_steps_sampled": 662446}, "hostname": "flow-main", "date": "2019-05-24_04-51-18", "episode_reward_mean": -395.7367860830754, "timestamp": 1558673478, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3aca58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac470>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac7b8>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 488.595383644104, "custom_metrics": {"system_level_velocity_max": 18.18828265792891, "cost1_mean": 179.20364176012183, "cost1_min": 22.632572048905782, "cost1_max": 197.97410519203066, "cost2_mean": -56.70475391912091, "outflow_rate_min": 466.74083028559994, "system_level_velocity_min": 12.359659442583434, "cost2_min": -78.19107641744715, "outflow_rate_max": 1252.3428626287666, "cost2_max": -22.85485913211046, "system_level_velocity_mean": 15.186391268904618, "outflow_rate_mean": 1133.164200556647}, "timesteps_since_restore": 662446, "episode_reward_min": -608.6721773162324}
{"timesteps_this_iter": 34599, "episodes_total": 822, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 697045, "training_iteration": 18, "episode_reward_max": -33.56505474586586, "pid": 33729, "time_this_iter_s": 25.623148202896118, "time_total_s": 514.2185318470001, "episodes_this_iter": 40, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 18, "episode_len_mean": 321.9, "info": {"grad_time_ms": 10548.085, "update_time_ms": 9.226, "sample_time_ms": 16865.062, "num_steps_trained": 697045, "load_time_ms": 15.266, "default": {"vf_loss": 13.98420524597168, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.004524590913206339, "total_loss": 13.980280876159668, "cur_lr": 0.0005000000237487257, "kl": 0.012011216022074223, "entropy": 1.2628337144851685, "vf_explained_var": 0.8870418071746826}, "num_steps_sampled": 697045}, "hostname": "flow-main", "date": "2019-05-24_04-51-43", "episode_reward_mean": -388.5366483762277, "timestamp": 1558673503, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688160>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688080>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 514.2185318470001, "custom_metrics": {"system_level_velocity_max": 18.18828265792891, "cost1_mean": 179.55979822430535, "cost1_min": 22.632572048905782, "cost1_max": 201.40971056894412, "cost2_mean": -55.178926301443745, "outflow_rate_min": 466.74083028559994, "system_level_velocity_min": 12.695700313748748, "cost2_min": -66.44694299520576, "outflow_rate_max": 1252.3428626287666, "cost2_max": -22.85485913211046, "system_level_velocity_mean": 15.274575038922293, "outflow_rate_mean": 1131.5720678624984}, "timesteps_since_restore": 697045, "episode_reward_min": -519.7391735905518}
{"timesteps_this_iter": 35026, "episodes_total": 863, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 732071, "training_iteration": 19, "episode_reward_max": -32.217899876900255, "pid": 33729, "time_this_iter_s": 27.38428497314453, "time_total_s": 541.6028168201447, "episodes_this_iter": 41, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 19, "episode_len_mean": 321.82, "info": {"grad_time_ms": 10498.339, "update_time_ms": 9.436, "sample_time_ms": 16871.431, "num_steps_trained": 732071, "load_time_ms": 15.139, "default": {"vf_loss": 14.847782135009766, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0035286752972751856, "total_loss": 14.84475040435791, "cur_lr": 0.0005000000237487257, "kl": 0.00995650514960289, "entropy": 1.2522263526916504, "vf_explained_var": 0.8787509799003601}, "num_steps_sampled": 732071}, "hostname": "flow-main", "date": "2019-05-24_04-52-11", "episode_reward_mean": -382.7902303515153, "timestamp": 1558673531, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3acef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eebe0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac2e8>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 541.6028168201447, "custom_metrics": {"system_level_velocity_max": 18.411462346953126, "cost1_mean": 181.15640171520764, "cost1_min": 22.769874037832416, "cost1_max": 201.40971056894412, "cost2_mean": -55.58967848350646, "outflow_rate_min": 502.9433862365724, "system_level_velocity_min": 12.695700313748748, "cost2_min": -68.89324291820368, "outflow_rate_max": 1252.3428626287666, "cost2_max": -20.362422352666123, "system_level_velocity_mean": 15.416240722347329, "outflow_rate_mean": 1144.3779204062287}, "timesteps_since_restore": 732071, "episode_reward_min": -520.5730548716579}
{"timesteps_this_iter": 35123, "episodes_total": 924, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 767194, "training_iteration": 20, "episode_reward_max": -24.01082051694404, "pid": 33729, "time_this_iter_s": 28.206114053726196, "time_total_s": 569.8089308738708, "episodes_this_iter": 61, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 20, "episode_len_mean": 317.67, "info": {"grad_time_ms": 10441.973, "update_time_ms": 9.591, "sample_time_ms": 16822.053, "num_steps_trained": 767194, "load_time_ms": 14.96, "default": {"vf_loss": 20.2936954498291, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0033071008510887623, "total_loss": 20.290857315063477, "cur_lr": 0.0005000000237487257, "kl": 0.00937674380838871, "entropy": 1.2478176355361938, "vf_explained_var": 0.8347629308700562}, "num_steps_sampled": 767194}, "hostname": "flow-main", "date": "2019-05-24_04-52-39", "episode_reward_mean": -379.786883820606, "timestamp": 1558673559, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac390>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6830b8>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 569.8089308738708, "custom_metrics": {"system_level_velocity_max": 18.411462346953126, "cost1_mean": 179.79933024879858, "cost1_min": 18.747007218960917, "cost1_max": 203.93229717675496, "cost2_mean": -57.11406069351115, "outflow_rate_min": 495.38848385431965, "system_level_velocity_min": 12.416569079929305, "cost2_min": -69.8831354679146, "outflow_rate_max": 1260.5223298879148, "cost2_max": -18.43217325247174, "system_level_velocity_mean": 15.471599652995367, "outflow_rate_mean": 1145.1569850073201}, "timesteps_since_restore": 767194, "episode_reward_min": -556.6282645282485}
{"timesteps_this_iter": 35318, "episodes_total": 965, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 802512, "training_iteration": 21, "episode_reward_max": -24.01082051694404, "pid": 33729, "time_this_iter_s": 26.706191539764404, "time_total_s": 596.5151224136353, "episodes_this_iter": 41, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 21, "episode_len_mean": 317.77, "info": {"grad_time_ms": 10436.124, "update_time_ms": 9.599, "sample_time_ms": 16889.012, "num_steps_trained": 802512, "load_time_ms": 14.761, "default": {"vf_loss": 16.05384063720703, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0034554379526525736, "total_loss": 16.050922393798828, "cur_lr": 0.0005000000237487257, "kl": 0.010767688974738121, "entropy": 1.2320499420166016, "vf_explained_var": 0.8600026369094849}, "num_steps_sampled": 802512}, "hostname": "flow-main", "date": "2019-05-24_04-53-06", "episode_reward_mean": -383.59969261938534, "timestamp": 1558673586, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688f60>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688cc0>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 596.5151224136353, "custom_metrics": {"system_level_velocity_max": 18.445114676772086, "cost1_mean": 179.38985741140826, "cost1_min": 18.747007218960917, "cost1_max": 203.93229717675496, "cost2_mean": -57.477398913372255, "outflow_rate_min": 474.24614310207676, "system_level_velocity_min": 12.365219390072856, "cost2_min": -69.8831354679146, "outflow_rate_max": 1260.5223298879148, "cost2_max": -18.43217325247174, "system_level_velocity_mean": 15.415051918260277, "outflow_rate_mean": 1140.9586793869903}, "timesteps_since_restore": 802512, "episode_reward_min": -556.6282645282485}
{"timesteps_this_iter": 34259, "episodes_total": 1007, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 836771, "training_iteration": 22, "episode_reward_max": -34.786533873229, "pid": 33729, "time_this_iter_s": 26.400943756103516, "time_total_s": 622.9160661697388, "episodes_this_iter": 42, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 22, "episode_len_mean": 320.84, "info": {"grad_time_ms": 10389.145, "update_time_ms": 9.564, "sample_time_ms": 16839.475, "num_steps_trained": 836771, "load_time_ms": 14.477, "default": {"vf_loss": 14.394246101379395, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0031624992843717337, "total_loss": 14.391634941101074, "cur_lr": 0.0005000000237487257, "kl": 0.011036884970963001, "entropy": 1.213486671447754, "vf_explained_var": 0.8609691262245178}, "num_steps_sampled": 836771}, "hostname": "flow-main", "date": "2019-05-24_04-53-32", "episode_reward_mean": -376.8324404819331, "timestamp": 1558673612, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6882e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6885c0>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 622.9160661697388, "custom_metrics": {"system_level_velocity_max": 18.445114676772086, "cost1_mean": 184.0656774648475, "cost1_min": 24.15429471102284, "cost1_max": 205.4596827182231, "cost2_mean": -57.75950693107585, "outflow_rate_min": 474.24614310207676, "system_level_velocity_min": 12.365219390072856, "cost2_min": -71.60769973967163, "outflow_rate_max": 1260.5223298879148, "cost2_max": -24.364828810415602, "system_level_velocity_mean": 15.705530655193689, "outflow_rate_mean": 1157.966388854484}, "timesteps_since_restore": 836771, "episode_reward_min": -556.6282645282485}
{"timesteps_this_iter": 34111, "episodes_total": 1061, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 870882, "training_iteration": 23, "episode_reward_max": -34.108108573149764, "pid": 33729, "time_this_iter_s": 26.845494031906128, "time_total_s": 649.7615602016449, "episodes_this_iter": 54, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 23, "episode_len_mean": 316.7, "info": {"grad_time_ms": 10310.756, "update_time_ms": 9.511, "sample_time_ms": 16704.698, "num_steps_trained": 870882, "load_time_ms": 14.415, "default": {"vf_loss": 14.336322784423828, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0025976209435611963, "total_loss": 14.334226608276367, "cur_lr": 0.0005000000237487257, "kl": 0.010010828264057636, "entropy": 1.1935524940490723, "vf_explained_var": 0.862655520439148}, "num_steps_sampled": 870882}, "hostname": "flow-main", "date": "2019-05-24_04-53-59", "episode_reward_mean": -358.4017050729373, "timestamp": 1558673639, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be37ba20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688898>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688080>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 649.7615602016449, "custom_metrics": {"system_level_velocity_max": 18.54361255130266, "cost1_mean": 183.89265923141102, "cost1_min": 24.15429471102284, "cost1_max": 205.4596827182231, "cost2_mean": -56.53267479246091, "outflow_rate_min": 474.24614310207676, "system_level_velocity_min": 12.125046776904124, "cost2_min": -71.60769973967163, "outflow_rate_max": 1259.5797187011785, "cost2_max": -24.18039923492144, "system_level_velocity_mean": 16.01690773796469, "outflow_rate_mean": 1156.0390769109038}, "timesteps_since_restore": 870882, "episode_reward_min": -580.5746810926644}
{"timesteps_this_iter": 34182, "episodes_total": 1106, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 905064, "training_iteration": 24, "episode_reward_max": -34.108108573149764, "pid": 33729, "time_this_iter_s": 26.644867420196533, "time_total_s": 676.4064276218414, "episodes_this_iter": 45, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 24, "episode_len_mean": 320.66, "info": {"grad_time_ms": 10213.571, "update_time_ms": 9.74, "sample_time_ms": 16707.562, "num_steps_trained": 905064, "load_time_ms": 14.077, "default": {"vf_loss": 12.281967163085938, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002696819370612502, "total_loss": 12.279890060424805, "cur_lr": 0.0005000000237487257, "kl": 0.012403090484440327, "entropy": 1.1772156953811646, "vf_explained_var": 0.8972370624542236}, "num_steps_sampled": 905064}, "hostname": "flow-main", "date": "2019-05-24_04-54-26", "episode_reward_mean": -366.30348510725264, "timestamp": 1558673666, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3acba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3acc18>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac240>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 676.4064276218414, "custom_metrics": {"system_level_velocity_max": 18.54361255130266, "cost1_mean": 183.58244726068904, "cost1_min": 24.30532656956365, "cost1_max": 202.91681199788496, "cost2_mean": -55.39342677042363, "outflow_rate_min": 488.31578922371136, "system_level_velocity_min": 12.125046776904124, "cost2_min": -72.24546023786016, "outflow_rate_max": 1247.0080457463885, "cost2_max": -24.18039923492144, "system_level_velocity_mean": 15.798048447874642, "outflow_rate_mean": 1151.0387505689137}, "timesteps_since_restore": 905064, "episode_reward_min": -580.5746810926644}
{"timesteps_this_iter": 33618, "episodes_total": 1149, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 938682, "training_iteration": 25, "episode_reward_max": -34.108108573149764, "pid": 33729, "time_this_iter_s": 26.144084453582764, "time_total_s": 702.5505120754242, "episodes_this_iter": 43, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 25, "episode_len_mean": 322.12, "info": {"grad_time_ms": 10089.306, "update_time_ms": 9.507, "sample_time_ms": 16758.739, "num_steps_trained": 938682, "load_time_ms": 13.977, "default": {"vf_loss": 9.860949516296387, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0030416178051382303, "total_loss": 9.858439445495605, "cur_lr": 0.0005000000237487257, "kl": 0.010617166757583618, "entropy": 1.1664820909500122, "vf_explained_var": 0.9127652645111084}, "num_steps_sampled": 938682}, "hostname": "flow-main", "date": "2019-05-24_04-54-52", "episode_reward_mean": -367.9302561364174, "timestamp": 1558673692, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699828>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699358>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 702.5505120754242, "custom_metrics": {"system_level_velocity_max": 18.54361255130266, "cost1_mean": 182.67246219610942, "cost1_min": 24.30532656956365, "cost1_max": 200.55628395715962, "cost2_mean": -54.04226136404464, "outflow_rate_min": 488.31578922371136, "system_level_velocity_min": 12.61291430727635, "cost2_min": -72.24546023786016, "outflow_rate_max": 1246.7541617074455, "cost2_max": -24.18039923492144, "system_level_velocity_mean": 15.648957315051241, "outflow_rate_mean": 1144.7201830202348}, "timesteps_since_restore": 938682, "episode_reward_min": -572.779172236601}
{"timesteps_this_iter": 33098, "episodes_total": 1201, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 971780, "training_iteration": 26, "episode_reward_max": -304.1384818066522, "pid": 33729, "time_this_iter_s": 26.302860260009766, "time_total_s": 728.853372335434, "episodes_this_iter": 52, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 26, "episode_len_mean": 325.0, "info": {"grad_time_ms": 9792.526, "update_time_ms": 9.387, "sample_time_ms": 16964.622, "num_steps_trained": 971780, "load_time_ms": 13.869, "default": {"vf_loss": 12.91478157043457, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.004927042871713638, "total_loss": 12.910548210144043, "cur_lr": 0.0005000000237487257, "kl": 0.013869400136172771, "entropy": 1.1557129621505737, "vf_explained_var": 0.8873112201690674}, "num_steps_sampled": 971780}, "hostname": "flow-main", "date": "2019-05-24_04-55-18", "episode_reward_mean": -366.8995318962804, "timestamp": 1558673718, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688668>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688160>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 728.853372335434, "custom_metrics": {"system_level_velocity_max": 17.137257969476973, "cost1_mean": 183.28819619943883, "cost1_min": 152.77862748632708, "cost1_max": 197.65500764225737, "cost2_mean": -52.01379943916098, "outflow_rate_min": 1037.5756527511032, "system_level_velocity_min": 12.61291430727635, "cost2_min": -68.63993229864379, "outflow_rate_max": 1202.0479233034666, "cost2_max": -38.830040081727304, "system_level_velocity_mean": 15.572083114709205, "outflow_rate_mean": 1140.7067992798125}, "timesteps_since_restore": 971780, "episode_reward_min": -542.5285699134212}
{"timesteps_this_iter": 32753, "episodes_total": 1246, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1004533, "training_iteration": 27, "episode_reward_max": -301.40474200812866, "pid": 33729, "time_this_iter_s": 25.39129114151001, "time_total_s": 754.244663476944, "episodes_this_iter": 45, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 27, "episode_len_mean": 325.0, "info": {"grad_time_ms": 9649.385, "update_time_ms": 9.487, "sample_time_ms": 16808.738, "num_steps_trained": 1004533, "load_time_ms": 13.571, "default": {"vf_loss": 10.819605827331543, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.003486514324322343, "total_loss": 10.816771507263184, "cur_lr": 0.0005000000237487257, "kl": 0.013027630746364594, "entropy": 1.1402487754821777, "vf_explained_var": 0.9016386270523071}, "num_steps_sampled": 1004533}, "hostname": "flow-main", "date": "2019-05-24_04-55-44", "episode_reward_mean": -361.78572765166274, "timestamp": 1558673744, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac6d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac860>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3acef0>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 754.244663476944, "custom_metrics": {"system_level_velocity_max": 17.077944314706222, "cost1_mean": 182.43372003858119, "cost1_min": 155.4399090890298, "cost1_max": 196.94761053859966, "cost2_mean": -49.75025980895622, "outflow_rate_min": 1037.5756527511032, "system_level_velocity_min": 12.6796119465975, "cost2_min": -63.5270605469157, "outflow_rate_max": 1198.0845292693348, "cost2_max": -38.0593032092141, "system_level_velocity_mean": 15.535896148514778, "outflow_rate_mean": 1130.0474607486294}, "timesteps_since_restore": 1004533, "episode_reward_min": -494.13923772486726}
{"timesteps_this_iter": 32263, "episodes_total": 1286, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1036796, "training_iteration": 28, "episode_reward_max": -301.40474200812866, "pid": 33729, "time_this_iter_s": 24.461251974105835, "time_total_s": 778.7059154510498, "episodes_this_iter": 40, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 28, "episode_len_mean": 324.8, "info": {"grad_time_ms": 9484.657, "update_time_ms": 9.476, "sample_time_ms": 16857.987, "num_steps_trained": 1036796, "load_time_ms": 13.948, "default": {"vf_loss": 10.718316078186035, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.003432404948398471, "total_loss": 10.715540885925293, "cur_lr": 0.0005000000237487257, "kl": 0.013175206258893013, "entropy": 1.112769365310669, "vf_explained_var": 0.8990100622177124}, "num_steps_sampled": 1036796}, "hostname": "flow-main", "date": "2019-05-24_04-56-08", "episode_reward_mean": -353.89176194402427, "timestamp": 1558673768, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69fa20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f9b0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f7b8>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 778.7059154510498, "custom_metrics": {"system_level_velocity_max": 17.011393570727886, "cost1_mean": 182.56980034110504, "cost1_min": 155.4399090890298, "cost1_max": 196.6930866586635, "cost2_mean": -47.77715009685943, "outflow_rate_min": 1037.4188186854, "system_level_velocity_min": 12.6796119465975, "cost2_min": -60.764205973920596, "outflow_rate_max": 1198.0845292693348, "cost2_max": -38.0593032092141, "system_level_velocity_mean": 15.58717445398488, "outflow_rate_mean": 1123.0049810263308}, "timesteps_since_restore": 1036796, "episode_reward_min": -474.5370303394068}
{"timesteps_this_iter": 31926, "episodes_total": 1332, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1068722, "training_iteration": 29, "episode_reward_max": -199.85024378125354, "pid": 33729, "time_this_iter_s": 25.618637084960938, "time_total_s": 804.3245525360107, "episodes_this_iter": 46, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 29, "episode_len_mean": 323.62, "info": {"grad_time_ms": 9314.264, "update_time_ms": 9.388, "sample_time_ms": 16854.488, "num_steps_trained": 1068722, "load_time_ms": 13.809, "default": {"vf_loss": 10.994132041931152, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.003364620264619589, "total_loss": 10.991389274597168, "cur_lr": 0.0005000000237487257, "kl": 0.012453218922019005, "entropy": 1.1029239892959595, "vf_explained_var": 0.8901976943016052}, "num_steps_sampled": 1068722}, "hostname": "flow-main", "date": "2019-05-24_04-56-34", "episode_reward_mean": -342.94584100100013, "timestamp": 1558673794, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688ac8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683b00>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 804.3245525360107, "custom_metrics": {"system_level_velocity_max": 17.18231295007064, "cost1_mean": 183.5771756003018, "cost1_min": 123.70701511959633, "cost1_max": 197.59319202035283, "cost2_mean": -46.18630068080192, "outflow_rate_min": 959.9473947149427, "system_level_velocity_min": 12.966698127078839, "cost2_min": -59.580250382147334, "outflow_rate_max": 1198.0845292693348, "cost2_max": -35.22345745512843, "system_level_velocity_mean": 15.783891344967524, "outflow_rate_mean": 1123.1177769614835}, "timesteps_since_restore": 1068722, "episode_reward_min": -475.0830998204623}
{"timesteps_this_iter": 32001, "episodes_total": 1386, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1100723, "training_iteration": 30, "episode_reward_max": -199.85024378125354, "pid": 33729, "time_this_iter_s": 25.59626030921936, "time_total_s": 829.9208128452301, "episodes_this_iter": 54, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 30, "episode_len_mean": 323.62, "info": {"grad_time_ms": 9120.174, "update_time_ms": 9.379, "sample_time_ms": 16787.029, "num_steps_trained": 1100723, "load_time_ms": 13.767, "default": {"vf_loss": 11.040728569030762, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002877400256693363, "total_loss": 11.038435935974121, "cur_lr": 0.0005000000237487257, "kl": 0.011700557544827461, "entropy": 1.1051437854766846, "vf_explained_var": 0.8972573280334473}, "num_steps_sampled": 1100723}, "hostname": "flow-main", "date": "2019-05-24_04-57-00", "episode_reward_mean": -336.5113194537882, "timestamp": 1558673820, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3aca58>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be37ba20>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 829.9208128452301, "custom_metrics": {"system_level_velocity_max": 17.197950155529487, "cost1_mean": 184.9355440643027, "cost1_min": 123.70701511959633, "cost1_max": 198.6681087032689, "cost2_mean": -45.51940953911524, "outflow_rate_min": 959.9473947149427, "system_level_velocity_min": 12.817967950567615, "cost2_min": -59.580250382147334, "outflow_rate_max": 1197.274938524314, "cost2_max": -35.22345745512843, "system_level_velocity_mean": 15.909550177631715, "outflow_rate_mean": 1128.5508849235976}, "timesteps_since_restore": 1100723, "episode_reward_min": -475.0830998204623}
{"timesteps_this_iter": 32587, "episodes_total": 1426, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1133310, "training_iteration": 31, "episode_reward_max": -186.4420840073377, "pid": 33729, "time_this_iter_s": 24.220423460006714, "time_total_s": 854.1412363052368, "episodes_this_iter": 40, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 31, "episode_len_mean": 321.99, "info": {"grad_time_ms": 8963.559, "update_time_ms": 9.432, "sample_time_ms": 16693.199, "num_steps_trained": 1133310, "load_time_ms": 13.817, "default": {"vf_loss": 7.325494766235352, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0035072725731879473, "total_loss": 7.322770118713379, "cur_lr": 0.0005000000237487257, "kl": 0.01566554419696331, "entropy": 1.0728827714920044, "vf_explained_var": 0.9341359734535217}, "num_steps_sampled": 1133310}, "hostname": "flow-main", "date": "2019-05-24_04-57-24", "episode_reward_mean": -333.9533306579077, "timestamp": 1558673844, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688400>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6833c8>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 854.1412363052368, "custom_metrics": {"system_level_velocity_max": 17.43959844133503, "cost1_mean": 184.21997890634768, "cost1_min": 121.84479964495324, "cost1_max": 198.95072507760852, "cost2_mean": -45.92831621430985, "outflow_rate_min": 958.4793413523475, "system_level_velocity_min": 12.817967950567615, "cost2_min": -54.47076612770238, "outflow_rate_max": 1197.274938524314, "cost2_max": -36.18067621562022, "system_level_velocity_mean": 15.893528499893648, "outflow_rate_mean": 1129.4872451126307}, "timesteps_since_restore": 1133310, "episode_reward_min": -436.41817123497606}
{"timesteps_this_iter": 32813, "episodes_total": 1472, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1166123, "training_iteration": 32, "episode_reward_max": -186.4420840073377, "pid": 33729, "time_this_iter_s": 26.06308388710022, "time_total_s": 880.204320192337, "episodes_this_iter": 46, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 32, "episode_len_mean": 322.19, "info": {"grad_time_ms": 8800.979, "update_time_ms": 9.468, "sample_time_ms": 16822.984, "num_steps_trained": 1166123, "load_time_ms": 13.662, "default": {"vf_loss": 9.99337100982666, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.004268608056008816, "total_loss": 9.989910125732422, "cur_lr": 0.0005000000237487257, "kl": 0.01615799218416214, "entropy": 1.0824463367462158, "vf_explained_var": 0.9133923053741455}, "num_steps_sampled": 1166123}, "hostname": "flow-main", "date": "2019-05-24_04-57-50", "episode_reward_mean": -344.91638560694605, "timestamp": 1558673870, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69fda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f908>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f208>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 880.204320192337, "custom_metrics": {"system_level_velocity_max": 17.43959844133503, "cost1_mean": 182.44977391603993, "cost1_min": 121.84479964495324, "cost1_max": 199.33987075008474, "cost2_mean": -47.76840850930986, "outflow_rate_min": 958.4793413523475, "system_level_velocity_min": 12.817967950567615, "cost2_min": -60.3147732476653, "outflow_rate_max": 1220.1527508542652, "cost2_max": -36.18067621562022, "system_level_velocity_mean": 15.648094622844049, "outflow_rate_mean": 1126.8268030610463}, "timesteps_since_restore": 1166123, "episode_reward_min": -479.3052622877372}
{"timesteps_this_iter": 32703, "episodes_total": 1525, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1198826, "training_iteration": 33, "episode_reward_max": -25.777506274955485, "pid": 33729, "time_this_iter_s": 25.716939210891724, "time_total_s": 905.9212594032288, "episodes_this_iter": 53, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 33, "episode_len_mean": 321.74, "info": {"grad_time_ms": 8617.513, "update_time_ms": 9.114, "sample_time_ms": 16897.188, "num_steps_trained": 1198826, "load_time_ms": 13.611, "default": {"vf_loss": 10.657760620117188, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.003896349109709263, "total_loss": 10.654608726501465, "cur_lr": 0.0005000000237487257, "kl": 0.014902830123901367, "entropy": 1.0616545677185059, "vf_explained_var": 0.9002518653869629}, "num_steps_sampled": 1198826}, "hostname": "flow-main", "date": "2019-05-24_04-58-16", "episode_reward_mean": -351.9337843948104, "timestamp": 1558673896, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c43c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683940>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c45c0>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 905.9212594032288, "custom_metrics": {"system_level_velocity_max": 17.313312426510052, "cost1_mean": 181.68979016041354, "cost1_min": 17.318786088330235, "cost1_max": 199.33987075008474, "cost2_mean": -49.31458695913757, "outflow_rate_min": 442.8785900830537, "system_level_velocity_min": 13.044434896067754, "cost2_min": -64.45354971589407, "outflow_rate_max": 1220.1527508542652, "cost2_max": -18.759796385445632, "system_level_velocity_mean": 15.582064532721706, "outflow_rate_mean": 1126.9043893877777}, "timesteps_since_restore": 1198826, "episode_reward_min": -493.8911661144093}
{"timesteps_this_iter": 32300, "episodes_total": 1567, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1231126, "training_iteration": 34, "episode_reward_max": -25.777506274955485, "pid": 33729, "time_this_iter_s": 25.2880597114563, "time_total_s": 931.2093191146851, "episodes_this_iter": 42, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 34, "episode_len_mean": 321.46, "info": {"grad_time_ms": 8429.76, "update_time_ms": 8.889, "sample_time_ms": 16948.927, "num_steps_trained": 1231126, "load_time_ms": 13.553, "default": {"vf_loss": 8.576415061950684, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0028485595248639584, "total_loss": 8.574254035949707, "cur_lr": 0.0005000000237487257, "kl": 0.013761142268776894, "entropy": 1.0456489324569702, "vf_explained_var": 0.919272780418396}, "num_steps_sampled": 1231126}, "hostname": "flow-main", "date": "2019-05-24_04-58-41", "episode_reward_mean": -341.6605820509529, "timestamp": 1558673921, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac5c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac2e8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3acef0>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 931.2093191146851, "custom_metrics": {"system_level_velocity_max": 17.419389154894173, "cost1_mean": 183.98836412210625, "cost1_min": 17.318786088330235, "cost1_max": 198.4960607404792, "cost2_mean": -48.47162567026739, "outflow_rate_min": 442.8785900830537, "system_level_velocity_min": 13.044434896067754, "cost2_min": -64.45354971589407, "outflow_rate_max": 1198.083513129465, "cost2_max": -18.759796385445632, "system_level_velocity_mean": 15.895747288970831, "outflow_rate_mean": 1135.2874042201213}, "timesteps_since_restore": 1231126, "episode_reward_min": -493.8911661144093}
{"timesteps_this_iter": 32386, "episodes_total": 1615, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1263512, "training_iteration": 35, "episode_reward_max": -25.777506274955485, "pid": 33729, "time_this_iter_s": 27.232131958007812, "time_total_s": 958.4414510726929, "episodes_this_iter": 48, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 35, "episode_len_mean": 317.38, "info": {"grad_time_ms": 8284.966, "update_time_ms": 8.875, "sample_time_ms": 17205.439, "num_steps_trained": 1263512, "load_time_ms": 13.353, "default": {"vf_loss": 10.266780853271484, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.004304113332182169, "total_loss": 10.263154983520508, "cur_lr": 0.0005000000237487257, "kl": 0.01356174610555172, "entropy": 1.0539343357086182, "vf_explained_var": 0.907203733921051}, "num_steps_sampled": 1263512}, "hostname": "flow-main", "date": "2019-05-24_04-59-08", "episode_reward_mean": -334.6737092617132, "timestamp": 1558673948, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699c18>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f9e8>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 958.4414510726929, "custom_metrics": {"system_level_velocity_max": 18.331494169141855, "cost1_mean": 182.1471228960386, "cost1_min": 17.318786088330235, "cost1_max": 199.34515639918695, "cost2_mean": -47.20909422524046, "outflow_rate_min": 442.8785900830537, "system_level_velocity_min": 12.458614314645477, "cost2_min": -58.81228140741357, "outflow_rate_max": 1194.3317556874536, "cost2_max": -18.759796385445632, "system_level_velocity_mean": 16.012117702829247, "outflow_rate_mean": 1125.7791787226065}, "timesteps_since_restore": 1263512, "episode_reward_min": -509.6013408002543}
{"timesteps_this_iter": 32894, "episodes_total": 1665, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1296406, "training_iteration": 36, "episode_reward_max": -31.503828932509084, "pid": 33729, "time_this_iter_s": 26.611783742904663, "time_total_s": 985.0532348155975, "episodes_this_iter": 50, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 36, "episode_len_mean": 317.74, "info": {"grad_time_ms": 8162.587, "update_time_ms": 8.648, "sample_time_ms": 17359.746, "num_steps_trained": 1296406, "load_time_ms": 13.414, "default": {"vf_loss": 10.374027252197266, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002630003960803151, "total_loss": 10.372081756591797, "cur_lr": 0.0005000000237487257, "kl": 0.013681724667549133, "entropy": 1.0563018321990967, "vf_explained_var": 0.9096396565437317}, "num_steps_sampled": 1296406}, "hostname": "flow-main", "date": "2019-05-24_04-59-35", "episode_reward_mean": -342.46787344669974, "timestamp": 1558673975, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f4a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69fe80>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f208>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 985.0532348155975, "custom_metrics": {"system_level_velocity_max": 18.331494169141855, "cost1_mean": 180.7532181955286, "cost1_min": 22.471742371459566, "cost1_max": 199.34515639918695, "cost2_mean": -47.49783244703752, "outflow_rate_min": 504.5827016154056, "system_level_velocity_min": 11.73299079778441, "cost2_min": -60.80555690848641, "outflow_rate_max": 1192.6546653200548, "cost2_max": -19.514090498514996, "system_level_velocity_mean": 15.829493970292233, "outflow_rate_mean": 1121.8624120484717}, "timesteps_since_restore": 1296406, "episode_reward_min": -509.6013408002543}
{"timesteps_this_iter": 32288, "episodes_total": 1711, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1328694, "training_iteration": 37, "episode_reward_max": -25.411729391289445, "pid": 33729, "time_this_iter_s": 25.39365005493164, "time_total_s": 1010.4468848705292, "episodes_this_iter": 46, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 37, "episode_len_mean": 318.09, "info": {"grad_time_ms": 7996.133, "update_time_ms": 8.424, "sample_time_ms": 17529.015, "num_steps_trained": 1328694, "load_time_ms": 13.467, "default": {"vf_loss": 9.146133422851562, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.003521083388477564, "total_loss": 9.143304824829102, "cur_lr": 0.0005000000237487257, "kl": 0.013831950724124908, "entropy": 1.0452425479888916, "vf_explained_var": 0.9149877429008484}, "num_steps_sampled": 1328694}, "hostname": "flow-main", "date": "2019-05-24_05-00-00", "episode_reward_mean": -339.35094841953344, "timestamp": 1558674000, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3acc18>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac0f0>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 1010.4468848705292, "custom_metrics": {"system_level_velocity_max": 18.2960679913374, "cost1_mean": 181.60351315263765, "cost1_min": 17.597348770957346, "cost1_max": 198.42508594322297, "cost2_mean": -46.943195444780024, "outflow_rate_min": 431.75782487237836, "system_level_velocity_min": 11.73299079778441, "cost2_min": -61.13838630065816, "outflow_rate_max": 1192.6525276479308, "cost2_max": -19.514090498514996, "system_level_velocity_mean": 15.86847829513002, "outflow_rate_mean": 1125.26434483136}, "timesteps_since_restore": 1328694, "episode_reward_min": -503.34900292100644}
{"timesteps_this_iter": 31770, "episodes_total": 1757, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1360464, "training_iteration": 38, "episode_reward_max": -25.411729391289445, "pid": 33729, "time_this_iter_s": 25.212058305740356, "time_total_s": 1035.6589431762695, "episodes_this_iter": 46, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 38, "episode_len_mean": 319.81, "info": {"grad_time_ms": 7844.932, "update_time_ms": 8.179, "sample_time_ms": 17756.41, "num_steps_trained": 1360464, "load_time_ms": 13.422, "default": {"vf_loss": 9.301604270935059, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.004431475419551134, "total_loss": 9.297845840454102, "cur_lr": 0.0005000000237487257, "kl": 0.01343176793307066, "entropy": 1.0399378538131714, "vf_explained_var": 0.9060214757919312}, "num_steps_sampled": 1360464}, "hostname": "flow-main", "date": "2019-05-24_05-00-26", "episode_reward_mean": -333.53155965704275, "timestamp": 1558674026, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6882b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3acf28>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688518>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 1035.6589431762695, "custom_metrics": {"system_level_velocity_max": 17.319828165907946, "cost1_mean": 183.43767897075463, "cost1_min": 17.597348770957346, "cost1_max": 198.42508594322297, "cost2_mean": -45.886161176425375, "outflow_rate_min": 431.75782487237836, "system_level_velocity_min": 12.851276649969547, "cost2_min": -61.13838630065816, "outflow_rate_max": 1191.2176253857472, "cost2_max": -20.189923135508213, "system_level_velocity_mean": 15.968544332729163, "outflow_rate_mean": 1130.3894237486572}, "timesteps_since_restore": 1360464, "episode_reward_min": -479.6754472310756}
{"timesteps_this_iter": 32110, "episodes_total": 1805, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1392574, "training_iteration": 39, "episode_reward_max": -188.93443259615844, "pid": 33729, "time_this_iter_s": 24.775083303451538, "time_total_s": 1060.434026479721, "episodes_this_iter": 48, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 39, "episode_len_mean": 322.36, "info": {"grad_time_ms": 7634.718, "update_time_ms": 7.819, "sample_time_ms": 17882.31, "num_steps_trained": 1392574, "load_time_ms": 13.421, "default": {"vf_loss": 7.594639778137207, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0026671395171433687, "total_loss": 7.592592716217041, "cur_lr": 0.0005000000237487257, "kl": 0.012397903017699718, "entropy": 1.0165234804153442, "vf_explained_var": 0.9255948662757874}, "num_steps_sampled": 1392574}, "hostname": "flow-main", "date": "2019-05-24_05-00-50", "episode_reward_mean": -334.43927533764247, "timestamp": 1558674050, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69fb00>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f1d0>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 1060.434026479721, "custom_metrics": {"system_level_velocity_max": 17.258904417858933, "cost1_mean": 184.92877036060946, "cost1_min": 116.42791369907961, "cost1_max": 196.70854043547817, "cost2_mean": -46.310023810911396, "outflow_rate_min": 917.9532718792065, "system_level_velocity_min": 13.758450786185772, "cost2_min": -55.65777273944833, "outflow_rate_max": 1186.291029027076, "cost2_max": -35.3407726734146, "system_level_velocity_mean": 15.983195457270549, "outflow_rate_mean": 1136.8647547249657}, "timesteps_since_restore": 1392574, "episode_reward_min": -419.6532144161066}
{"timesteps_this_iter": 33242, "episodes_total": 1852, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1425816, "training_iteration": 40, "episode_reward_max": -188.93443259615844, "pid": 33729, "time_this_iter_s": 26.07988142967224, "time_total_s": 1086.5139079093933, "episodes_this_iter": 47, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 40, "episode_len_mean": 323.54, "info": {"grad_time_ms": 7577.313, "update_time_ms": 7.465, "sample_time_ms": 17987.655, "num_steps_trained": 1425816, "load_time_ms": 13.593, "default": {"vf_loss": 9.137980461120605, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0033061986323446035, "total_loss": 9.135468482971191, "cur_lr": 0.0005000000237487257, "kl": 0.01588061824440956, "entropy": 1.006751298904419, "vf_explained_var": 0.9199037551879883}, "num_steps_sampled": 1425816}, "hostname": "flow-main", "date": "2019-05-24_05-01-17", "episode_reward_mean": -345.9645257209467, "timestamp": 1558674077, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699be0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6995f8>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 1086.5139079093933, "custom_metrics": {"system_level_velocity_max": 17.383763900548434, "cost1_mean": 184.475950607031, "cost1_min": 125.78770299190315, "cost1_max": 199.41266934021067, "cost2_mean": -48.14190367379394, "outflow_rate_min": 967.3215191899928, "system_level_velocity_min": 12.806659049115988, "cost2_min": -68.28857371985757, "outflow_rate_max": 1192.8815544332545, "cost2_max": -35.3407726734146, "system_level_velocity_mean": 15.8147874369696, "outflow_rate_mean": 1134.0222460160542}, "timesteps_since_restore": 1425816, "episode_reward_min": -536.1066695867299}
{"timesteps_this_iter": 33125, "episodes_total": 1896, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1458941, "training_iteration": 41, "episode_reward_max": -181.64967622006972, "pid": 33729, "time_this_iter_s": 26.749191284179688, "time_total_s": 1113.263099193573, "episodes_this_iter": 44, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 41, "episode_len_mean": 322.36, "info": {"grad_time_ms": 7571.659, "update_time_ms": 7.318, "sample_time_ms": 18249.213, "num_steps_trained": 1458941, "load_time_ms": 13.524, "default": {"vf_loss": 9.572805404663086, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0035149441100656986, "total_loss": 9.56998348236084, "cur_lr": 0.0005000000237487257, "kl": 0.01384695153683424, "entropy": 0.9902784824371338, "vf_explained_var": 0.9132608771324158}, "num_steps_sampled": 1458941}, "hostname": "flow-main", "date": "2019-05-24_05-01-43", "episode_reward_mean": -351.1730189656423, "timestamp": 1558674103, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f5c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f3c8>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69fac8>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 1113.263099193573, "custom_metrics": {"system_level_velocity_max": 17.64000753705124, "cost1_mean": 183.4254392972511, "cost1_min": 125.78770299190315, "cost1_max": 200.25798919663606, "cost2_mean": -48.89983188508517, "outflow_rate_min": 967.3215191899928, "system_level_velocity_min": 12.806659049115988, "cost2_min": -68.28857371985757, "outflow_rate_max": 1193.9116481077033, "cost2_max": -35.3407726734146, "system_level_velocity_mean": 15.728409441922144, "outflow_rate_mean": 1131.289958629418}, "timesteps_since_restore": 1458941, "episode_reward_min": -536.1066695867299}
{"timesteps_this_iter": 32616, "episodes_total": 1941, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1491557, "training_iteration": 42, "episode_reward_max": -181.64967622006972, "pid": 33729, "time_this_iter_s": 25.606518507003784, "time_total_s": 1138.8696177005768, "episodes_this_iter": 45, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 42, "episode_len_mean": 323.54, "info": {"grad_time_ms": 7484.089, "update_time_ms": 7.119, "sample_time_ms": 18291.916, "num_steps_trained": 1491557, "load_time_ms": 13.764, "default": {"vf_loss": 9.635136604309082, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.002436155453324318, "total_loss": 9.633366584777832, "cur_lr": 0.0005000000237487257, "kl": 0.013339471071958542, "entropy": 0.9820228815078735, "vf_explained_var": 0.9063417911529541}, "num_steps_sampled": 1491557}, "hostname": "flow-main", "date": "2019-05-24_05-02-09", "episode_reward_mean": -350.011993511669, "timestamp": 1558674129, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac6d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3acf28>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3acac8>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 1138.8696177005768, "custom_metrics": {"system_level_velocity_max": 17.64000753705124, "cost1_mean": 184.9916110586029, "cost1_min": 129.88946421773792, "cost1_max": 200.25798919663606, "cost2_mean": -48.44766088347994, "outflow_rate_min": 977.8565586374895, "system_level_velocity_min": 13.26287059604721, "cost2_min": -65.97904371529685, "outflow_rate_max": 1195.2853646246629, "cost2_max": -36.19113304952728, "system_level_velocity_mean": 15.807778871301823, "outflow_rate_mean": 1134.3702485441233}, "timesteps_since_restore": 1491557, "episode_reward_min": -470.12927265283787}
{"timesteps_this_iter": 32873, "episodes_total": 1991, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1524430, "training_iteration": 43, "episode_reward_max": -181.64967622006972, "pid": 33729, "time_this_iter_s": 26.16809606552124, "time_total_s": 1165.037713766098, "episodes_this_iter": 50, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 43, "episode_len_mean": 323.54, "info": {"grad_time_ms": 7447.306, "update_time_ms": 7.049, "sample_time_ms": 18374.001, "num_steps_trained": 1524430, "load_time_ms": 13.751, "default": {"vf_loss": 8.774250984191895, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.005945364944636822, "total_loss": 8.769214630126953, "cur_lr": 0.0005000000237487257, "kl": 0.018207907676696777, "entropy": 0.9774511456489563, "vf_explained_var": 0.9160528182983398}, "num_steps_sampled": 1524430}, "hostname": "flow-main", "date": "2019-05-24_05-02-35", "episode_reward_mean": -346.4393841716342, "timestamp": 1558674155, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69fb00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f278>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f9b0>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 1165.037713766098, "custom_metrics": {"system_level_velocity_max": 17.64000753705124, "cost1_mean": 185.87906700028307, "cost1_min": 129.88946421773792, "cost1_max": 198.6924767839991, "cost2_mean": -47.96578010588328, "outflow_rate_min": 977.8565586374895, "system_level_velocity_min": 13.41034978772261, "cost2_min": -59.842294035747, "outflow_rate_max": 1211.9779384378885, "cost2_max": -36.19113304952728, "system_level_velocity_mean": 15.894001682450776, "outflow_rate_mean": 1140.931202244703}, "timesteps_since_restore": 1524430, "episode_reward_min": -469.0088175457205}
{"timesteps_this_iter": 32703, "episodes_total": 2033, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1557133, "training_iteration": 44, "episode_reward_max": -24.12216953244258, "pid": 33729, "time_this_iter_s": 24.98908042907715, "time_total_s": 1190.0267941951752, "episodes_this_iter": 42, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 44, "episode_len_mean": 322.02, "info": {"grad_time_ms": 7394.623, "update_time_ms": 6.971, "sample_time_ms": 18397.783, "num_steps_trained": 1557133, "load_time_ms": 13.727, "default": {"vf_loss": 7.512462615966797, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.005648952908813953, "total_loss": 7.507696151733398, "cur_lr": 0.0005000000237487257, "kl": 0.017650319263339043, "entropy": 0.9595049619674683, "vf_explained_var": 0.9263150095939636}, "num_steps_sampled": 1557133}, "hostname": "flow-main", "date": "2019-05-24_05-03-00", "episode_reward_mean": -339.32588974117675, "timestamp": 1558674180, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a70f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7b38>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a79b0>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 1190.0267941951752, "custom_metrics": {"system_level_velocity_max": 17.41558834354077, "cost1_mean": 186.31089153813696, "cost1_min": 17.668826752312427, "cost1_max": 200.41421286680577, "cost2_mean": -46.894358383269406, "outflow_rate_min": 487.8590816741719, "system_level_velocity_min": 14.008599125207688, "cost2_min": -56.02156889495181, "outflow_rate_max": 1211.9779384378885, "cost2_max": -16.255246607314483, "system_level_velocity_mean": 16.069637964770113, "outflow_rate_mean": 1140.8691865618562}, "timesteps_since_restore": 1557133, "episode_reward_min": -414.88386239849314}
{"timesteps_this_iter": 33039, "episodes_total": 2082, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1590172, "training_iteration": 45, "episode_reward_max": -24.12216953244258, "pid": 33729, "time_this_iter_s": 25.769009113311768, "time_total_s": 1215.795803308487, "episodes_this_iter": 49, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 45, "episode_len_mean": 319.12, "info": {"grad_time_ms": 7365.201, "update_time_ms": 6.909, "sample_time_ms": 18280.392, "num_steps_trained": 1590172, "load_time_ms": 13.659, "default": {"vf_loss": 10.699142456054688, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0033473672810941935, "total_loss": 10.696634292602539, "cur_lr": 0.0005000000237487257, "kl": 0.016782715916633606, "entropy": 0.9560203552246094, "vf_explained_var": 0.9050136804580688}, "num_steps_sampled": 1590172}, "hostname": "flow-main", "date": "2019-05-24_05-03-26", "episode_reward_mean": -340.434892892495, "timestamp": 1558674206, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6990b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699198>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699ef0>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 1215.795803308487, "custom_metrics": {"system_level_velocity_max": 18.12641561693533, "cost1_mean": 182.99227890243853, "cost1_min": 17.668826752312427, "cost1_max": 200.41421286680577, "cost2_mean": -47.262487248425785, "outflow_rate_min": 487.8590816741719, "system_level_velocity_min": 13.526388144559302, "cost2_min": -62.17839812859826, "outflow_rate_max": 1211.9779384378885, "cost2_max": -16.255246607314483, "system_level_velocity_mean": 15.927083561878499, "outflow_rate_mean": 1133.1619320210639}, "timesteps_since_restore": 1590172, "episode_reward_min": -439.3903612521516}
{"timesteps_this_iter": 32419, "episodes_total": 2131, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1622591, "training_iteration": 46, "episode_reward_max": -31.907327151400967, "pid": 33729, "time_this_iter_s": 26.307286024093628, "time_total_s": 1242.1030893325806, "episodes_this_iter": 49, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 46, "episode_len_mean": 321.64, "info": {"grad_time_ms": 7388.224, "update_time_ms": 7.036, "sample_time_ms": 18226.757, "num_steps_trained": 1622591, "load_time_ms": 13.476, "default": {"vf_loss": 7.668949604034424, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0023941800463944674, "total_loss": 7.667255878448486, "cur_lr": 0.0005000000237487257, "kl": 0.014011243358254433, "entropy": 0.9406701922416687, "vf_explained_var": 0.925656259059906}, "num_steps_sampled": 1622591}, "hostname": "flow-main", "date": "2019-05-24_05-03-52", "episode_reward_mean": -345.8853827618407, "timestamp": 1558674232, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a76a0>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a79b0>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 1242.1030893325806, "custom_metrics": {"system_level_velocity_max": 18.12641561693533, "cost1_mean": 183.54016927245266, "cost1_min": 22.358375475692625, "cost1_max": 199.694885700038, "cost2_mean": -47.74031500645999, "outflow_rate_min": 504.5827016154056, "system_level_velocity_min": 13.463267320674808, "cost2_min": -62.17839812859826, "outflow_rate_max": 1198.1841995280724, "cost2_max": -19.39415819983219, "system_level_velocity_mean": 15.807775740862908, "outflow_rate_mean": 1135.46222369002}, "timesteps_since_restore": 1622591, "episode_reward_min": -456.94152422027076}
{"timesteps_this_iter": 32940, "episodes_total": 2176, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1655531, "training_iteration": 47, "episode_reward_max": -23.624975083143525, "pid": 33729, "time_this_iter_s": 25.484607219696045, "time_total_s": 1267.5876965522766, "episodes_this_iter": 45, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 47, "episode_len_mean": 319.02, "info": {"grad_time_ms": 7434.095, "update_time_ms": 7.018, "sample_time_ms": 18188.906, "num_steps_trained": 1655531, "load_time_ms": 13.513, "default": {"vf_loss": 7.297988414764404, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002701409161090851, "total_loss": 7.296215057373047, "cur_lr": 0.0005000000237487257, "kl": 0.01855984330177307, "entropy": 0.9295941591262817, "vf_explained_var": 0.9320291876792908}, "num_steps_sampled": 1655531}, "hostname": "flow-main", "date": "2019-05-24_05-04-18", "episode_reward_mean": -338.0269997445182, "timestamp": 1558674258, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7978>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7550>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 1267.5876965522766, "custom_metrics": {"system_level_velocity_max": 17.651268391327502, "cost1_mean": 183.33835574542155, "cost1_min": 17.7097306762869, "cost1_max": 199.81121079503328, "cost2_mean": -46.53408338333489, "outflow_rate_min": 493.8123238995481, "system_level_velocity_min": 13.463267320674808, "cost2_min": -57.076998293398795, "outflow_rate_max": 1200.9477298989991, "cost2_max": -17.35016859159022, "system_level_velocity_mean": 15.931014211917097, "outflow_rate_mean": 1131.864393633035}, "timesteps_since_restore": 1655531, "episode_reward_min": -456.94152422027076}
{"timesteps_this_iter": 33049, "episodes_total": 2221, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1688580, "training_iteration": 48, "episode_reward_max": -23.624975083143525, "pid": 33729, "time_this_iter_s": 25.623743295669556, "time_total_s": 1293.2114398479462, "episodes_this_iter": 45, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 48, "episode_len_mean": 318.92, "info": {"grad_time_ms": 7625.47, "update_time_ms": 7.293, "sample_time_ms": 18035.762, "num_steps_trained": 1688580, "load_time_ms": 13.61, "default": {"vf_loss": 8.133458137512207, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0050130621530115604, "total_loss": 8.12939453125, "cur_lr": 0.0005000000237487257, "kl": 0.018988745287060738, "entropy": 0.927333652973175, "vf_explained_var": 0.9244269728660583}, "num_steps_sampled": 1688580}, "hostname": "flow-main", "date": "2019-05-24_05-04-43", "episode_reward_mean": -337.4272607415224, "timestamp": 1558674283, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4400>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1828>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 1293.2114398479462, "custom_metrics": {"system_level_velocity_max": 17.651268391327502, "cost1_mean": 183.07762385241438, "cost1_min": 17.7097306762869, "cost1_max": 199.81121079503328, "cost2_mean": -46.21992022550359, "outflow_rate_min": 493.8123238995481, "system_level_velocity_min": 13.463267320674808, "cost2_min": -57.076998293398795, "outflow_rate_max": 1202.6667482571627, "cost2_max": -17.35016859159022, "system_level_velocity_mean": 15.888846806184677, "outflow_rate_mean": 1131.6372023854656}, "timesteps_since_restore": 1688580, "episode_reward_min": -456.94152422027076}
{"timesteps_this_iter": 32585, "episodes_total": 2272, "done": false, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1721165, "training_iteration": 49, "episode_reward_max": -266.67774189102704, "pid": 33729, "time_this_iter_s": 25.645907640457153, "time_total_s": 1318.8573474884033, "episodes_this_iter": 51, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 49, "episode_len_mean": 324.44, "info": {"grad_time_ms": 7851.967, "update_time_ms": 7.628, "sample_time_ms": 17895.346, "num_steps_trained": 1721165, "load_time_ms": 13.519, "default": {"vf_loss": 8.458009719848633, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.003680012421682477, "total_loss": 8.455151557922363, "cur_lr": 0.0005000000237487257, "kl": 0.01643098145723343, "entropy": 0.9004873633384705, "vf_explained_var": 0.9220553636550903}, "num_steps_sampled": 1721165}, "hostname": "flow-main", "date": "2019-05-24_05-05-09", "episode_reward_mean": -347.58115317506, "timestamp": 1558674309, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c45f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4780>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4470>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 1318.8573474884033, "custom_metrics": {"system_level_velocity_max": 17.255429601231953, "cost1_mean": 185.06031819856463, "cost1_min": 155.88861949612192, "cost1_max": 199.22468332314355, "cost2_mean": -47.10903507941026, "outflow_rate_min": 1032.2232088618157, "system_level_velocity_min": 12.797559635544223, "cost2_min": -61.698385884406605, "outflow_rate_max": 1202.6667482571627, "cost2_max": -35.91156518718207, "system_level_velocity_mean": 15.73579316845518, "outflow_rate_mean": 1136.5558748377634}, "timesteps_since_restore": 1721165, "episode_reward_min": -484.9437683490126}
{"timesteps_this_iter": 32832, "episodes_total": 2316, "done": true, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1753997, "training_iteration": 50, "episode_reward_max": -294.4665668194867, "pid": 33729, "time_this_iter_s": 25.673703908920288, "time_total_s": 1344.5310513973236, "episodes_this_iter": 44, "experiment_id": "bcea2f13b77c4104802ca1483aec734f", "iterations_since_restore": 50, "episode_len_mean": 325.0, "info": {"grad_time_ms": 7940.478, "update_time_ms": 8.022, "sample_time_ms": 17766.198, "num_steps_trained": 1753997, "load_time_ms": 13.291, "default": {"vf_loss": 9.279864311218262, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0034976722672581673, "total_loss": 9.27719783782959, "cur_lr": 0.0005000000237487257, "kl": 0.016628606244921684, "entropy": 0.9118168354034424, "vf_explained_var": 0.9138577580451965}, "num_steps_sampled": 1753997}, "hostname": "flow-main", "date": "2019-05-24_05-05-35", "episode_reward_mean": -349.32650267730213, "timestamp": 1558674335, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3acac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be387f98>", "on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3acb38>", "on_train_result": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "channel_major": false, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "zero_mean": true}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 3", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "node_ip": "10.138.0.2", "time_since_restore": 1344.5310513973236, "custom_metrics": {"system_level_velocity_max": 17.39964539023819, "cost1_mean": 185.57491499971002, "cost1_min": 155.88861949612192, "cost1_max": 200.15760741672403, "cost2_mean": -47.894330530318605, "outflow_rate_min": 987.560184331797, "system_level_velocity_min": 12.797559635544223, "cost2_min": -66.69878706563114, "outflow_rate_max": 1198.3944506989596, "cost2_max": -37.75412068937473, "system_level_velocity_mean": 15.765653228918673, "outflow_rate_mean": 1137.9382696849461}, "timesteps_since_restore": 1753997, "episode_reward_min": -514.0645849183244}

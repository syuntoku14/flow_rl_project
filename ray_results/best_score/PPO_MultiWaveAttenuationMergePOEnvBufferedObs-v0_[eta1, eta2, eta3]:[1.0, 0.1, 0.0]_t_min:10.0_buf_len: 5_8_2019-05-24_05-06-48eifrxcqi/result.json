{"timesteps_this_iter": 41250, "episodes_total": 40, "timesteps_since_restore": 41250, "policy_reward_mean": {}, "timesteps_total": 41250, "training_iteration": 1, "episode_reward_max": -533.0662067881095, "pid": 1094, "time_this_iter_s": 30.82190179824829, "time_total_s": 30.82190179824829, "episodes_this_iter": 40, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 1, "episode_len_mean": 325.0, "info": {"grad_time_ms": 12892.917, "update_time_ms": 782.221, "sample_time_ms": 16895.492, "num_steps_trained": 41250, "load_time_ms": 84.799, "default": {"vf_loss": 38.80410385131836, "cur_kl_coeff": 0.20000003278255463, "policy_loss": -0.0012693016324192286, "total_loss": 38.803382873535156, "cur_lr": 0.0005000000237487257, "kl": 0.0027391596231609583, "vf_explained_var": -1.5845209873077692e-06, "entropy": 1.4113273620605469}, "num_steps_sampled": 41250}, "hostname": "flow-main", "date": "2019-05-24_05-07-29", "episode_reward_mean": -716.2911257941776, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eeba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee0b8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eed68>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 30.82190179824829, "timestamp": 1558674449, "custom_metrics": {"system_level_velocity_max": 11.601524565962656, "cost1_mean": 122.12062696699972, "cost2_max": -29.758578044887642, "cost1_max": 138.29265330083794, "cost2_mean": -47.882380730784135, "outflow_rate_min": 677.391817690506, "system_level_velocity_min": 9.284659369664368, "cost2_min": -84.22124974356669, "outflow_rate_mean": 748.3736622380538, "cost1_min": 111.07850641796435, "system_level_velocity_mean": 10.174096953487725, "outflow_rate_max": 952.9289401071255}, "num_metric_batches_dropped": 0, "episode_reward_min": -876.1694980305957}
{"timesteps_this_iter": 41520, "episodes_total": 80, "timesteps_since_restore": 82770, "policy_reward_mean": {}, "timesteps_total": 82770, "training_iteration": 2, "episode_reward_max": -394.33910151837557, "pid": 1094, "time_this_iter_s": 29.761927604675293, "time_total_s": 60.583829402923584, "episodes_this_iter": 40, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 2, "episode_len_mean": 325.0, "info": {"grad_time_ms": 12555.207, "update_time_ms": 395.91, "sample_time_ms": 17151.644, "num_steps_trained": 82770, "load_time_ms": 56.876, "default": {"vf_loss": 63.1653938293457, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0016522880177944899, "total_loss": 63.16416931152344, "cur_lr": 0.0005000000237487257, "kl": 0.004281165543943644, "vf_explained_var": 2.954477054117888e-07, "entropy": 1.4182578325271606}, "num_steps_sampled": 82770}, "hostname": "flow-main", "date": "2019-05-24_05-07-59", "episode_reward_mean": -706.6016937719069, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6994a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699358>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699780>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 60.583829402923584, "timestamp": 1558674479, "custom_metrics": {"system_level_velocity_max": 11.91023404933049, "cost1_mean": 123.01706967831743, "cost2_max": -24.92127093399141, "cost1_max": 142.933978282451, "cost2_mean": -48.98738295522503, "outflow_rate_min": 534.2371653543308, "system_level_velocity_min": 8.739493588055543, "cost2_min": -91.68633204466607, "outflow_rate_mean": 747.1317802281046, "cost1_min": 105.92139851337063, "system_level_velocity_mean": 10.26259271904092, "outflow_rate_max": 952.9289401071255}, "num_metric_batches_dropped": 0, "episode_reward_min": -985.8369421747763}
{"timesteps_this_iter": 39233, "episodes_total": 120, "timesteps_since_restore": 122003, "policy_reward_mean": {}, "timesteps_total": 122003, "training_iteration": 3, "episode_reward_max": -394.33910151837557, "pid": 1094, "time_this_iter_s": 27.940955638885498, "time_total_s": 88.52478504180908, "episodes_this_iter": 40, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 3, "episode_len_mean": 325.0, "info": {"grad_time_ms": 12132.859, "update_time_ms": 267.577, "sample_time_ms": 16945.175, "num_steps_trained": 122003, "load_time_ms": 45.186, "default": {"vf_loss": 98.10819244384766, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002051077550277114, "total_loss": 98.10649871826172, "cur_lr": 0.0005000000237487257, "kl": 0.006949199363589287, "vf_explained_var": -6.291601550856285e-08, "entropy": 1.4067953824996948}, "num_steps_sampled": 122003}, "hostname": "flow-main", "date": "2019-05-24_05-08-27", "episode_reward_mean": -685.3695788159374, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8dab00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8daac8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da978>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 88.52478504180908, "timestamp": 1558674507, "custom_metrics": {"system_level_velocity_max": 12.931671730455312, "cost1_mean": 125.47592869132741, "cost2_max": -24.92127093399141, "cost1_max": 154.7994755328961, "cost2_mean": -48.82158738948815, "outflow_rate_min": 534.2371653543308, "system_level_velocity_min": 8.679565731267742, "cost2_min": -91.68633204466607, "outflow_rate_mean": 764.0480858601272, "cost1_min": 105.60009549062578, "system_level_velocity_mean": 10.490868633964284, "outflow_rate_max": 965.1022959183674}, "num_metric_batches_dropped": 0, "episode_reward_min": -985.8369421747763}
{"timesteps_this_iter": 37261, "episodes_total": 180, "timesteps_since_restore": 159264, "policy_reward_mean": {}, "timesteps_total": 159264, "training_iteration": 4, "episode_reward_max": -388.2868860992905, "pid": 1094, "time_this_iter_s": 28.94418978691101, "time_total_s": 117.46897482872009, "episodes_this_iter": 60, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 4, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11698.379, "update_time_ms": 202.365, "sample_time_ms": 17318.622, "num_steps_trained": 159264, "load_time_ms": 39.926, "default": {"vf_loss": 141.6182861328125, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0019539152272045612, "total_loss": 141.61676025390625, "cur_lr": 0.0005000000237487257, "kl": 0.008619735948741436, "vf_explained_var": 3.0724043309504623e-09, "entropy": 1.3799538612365723}, "num_steps_sampled": 159264}, "hostname": "flow-main", "date": "2019-05-24_05-08-56", "episode_reward_mean": -629.339366032337, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae780>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae550>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 117.46897482872009, "timestamp": 1558674536, "custom_metrics": {"system_level_velocity_max": 14.98911543949046, "cost1_mean": 130.27601937323612, "cost2_max": -30.23902369534262, "cost1_max": 178.67820863176064, "cost2_mean": -50.6793116094552, "outflow_rate_min": 412.69520610687033, "system_level_velocity_min": 8.06090414357506, "cost2_min": -79.91739079290042, "outflow_rate_mean": 808.967370234036, "cost1_min": 98.77617747782288, "system_level_velocity_mean": 10.992735320080776, "outflow_rate_max": 1144.6206949806951}, "num_metric_batches_dropped": 0, "episode_reward_min": -924.1450888590438}
{"timesteps_this_iter": 36658, "episodes_total": 220, "timesteps_since_restore": 195922, "policy_reward_mean": {}, "timesteps_total": 195922, "training_iteration": 5, "episode_reward_max": -388.2868860992905, "pid": 1094, "time_this_iter_s": 26.70696496963501, "time_total_s": 144.1759397983551, "episodes_this_iter": 40, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 5, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11359.625, "update_time_ms": 163.646, "sample_time_ms": 17171.82, "num_steps_trained": 195922, "load_time_ms": 37.124, "default": {"vf_loss": 56.57481002807617, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0012155207805335522, "total_loss": 56.57395935058594, "cur_lr": 0.0005000000237487257, "kl": 0.007342036813497543, "vf_explained_var": 0.5690955519676208, "entropy": 1.3874242305755615}, "num_steps_sampled": 195922}, "hostname": "flow-main", "date": "2019-05-24_05-09-23", "episode_reward_mean": -587.2784039787298, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688c88>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688630>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 144.1759397983551, "timestamp": 1558674563, "custom_metrics": {"system_level_velocity_max": 14.98911543949046, "cost1_mean": 136.6308545472793, "cost2_max": -30.23902369534262, "cost1_max": 178.67820863176064, "cost2_mean": -53.4056721481614, "outflow_rate_min": 412.69520610687033, "system_level_velocity_min": 8.06090414357506, "cost2_min": -85.88566776305407, "outflow_rate_mean": 856.9095266419079, "cost1_min": 98.77617747782288, "system_level_velocity_mean": 11.574256575518396, "outflow_rate_max": 1145.6436400133825}, "num_metric_batches_dropped": 0, "episode_reward_min": -924.1450888590438}
{"timesteps_this_iter": 37899, "episodes_total": 261, "timesteps_since_restore": 233821, "policy_reward_mean": {}, "timesteps_total": 233821, "training_iteration": 6, "episode_reward_max": -23.4053721166842, "pid": 1094, "time_this_iter_s": 27.139085054397583, "time_total_s": 171.31502485275269, "episodes_this_iter": 41, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 6, "episode_len_mean": 322.02, "info": {"grad_time_ms": 11108.888, "update_time_ms": 137.732, "sample_time_ms": 17170.187, "num_steps_trained": 233821, "load_time_ms": 33.33, "default": {"vf_loss": 64.6023178100586, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0025702393613755703, "total_loss": 64.6002197265625, "cur_lr": 0.0005000000237487257, "kl": 0.009435496293008327, "vf_explained_var": 0.6870713233947754, "entropy": 1.3587603569030762}, "num_steps_sampled": 233821}, "hostname": "flow-main", "date": "2019-05-24_05-09-50", "episode_reward_mean": -558.9887137951738, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3acc88>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6997f0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 171.31502485275269, "timestamp": 1558674590, "custom_metrics": {"system_level_velocity_max": 17.845983979483837, "cost1_mean": 140.80083512602826, "cost2_max": -18.09349570146462, "cost1_max": 176.39066463419994, "cost2_mean": -54.77210015434005, "outflow_rate_min": 492.0625426222078, "system_level_velocity_min": 8.72170632521025, "cost2_min": -94.92643074424139, "outflow_rate_mean": 895.691334288011, "cost1_min": 17.877989948885048, "system_level_velocity_mean": 12.090954518399155, "outflow_rate_max": 1164.1953161592508}, "num_metric_batches_dropped": 0, "episode_reward_min": -821.1954155955378}
{"timesteps_this_iter": 39532, "episodes_total": 321, "timesteps_since_restore": 273353, "policy_reward_mean": {}, "timesteps_total": 273353, "training_iteration": 7, "episode_reward_max": -23.4053721166842, "pid": 1094, "time_this_iter_s": 30.91586685180664, "time_total_s": 202.23089170455933, "episodes_this_iter": 60, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 7, "episode_len_mean": 322.02, "info": {"grad_time_ms": 11108.493, "update_time_ms": 119.542, "sample_time_ms": 17530.758, "num_steps_trained": 273353, "load_time_ms": 32.269, "default": {"vf_loss": 59.59092330932617, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0032388309482485056, "total_loss": 59.58816909790039, "cur_lr": 0.0005000000237487257, "kl": 0.0097059840336442, "vf_explained_var": 0.7423871755599976, "entropy": 1.3421920537948608}, "num_steps_sampled": 273353}, "hostname": "flow-main", "date": "2019-05-24_05-10-21", "episode_reward_mean": -534.2941723791762, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8dab00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da3c8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da550>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 202.23089170455933, "timestamp": 1558674621, "custom_metrics": {"system_level_velocity_max": 17.845983979483837, "cost1_mean": 154.52797781287748, "cost2_max": -18.09349570146462, "cost1_max": 198.05310962517183, "cost2_mean": -65.69987111022529, "outflow_rate_min": 492.0625426222078, "system_level_velocity_min": 9.234009127685875, "cost2_min": -105.69646680844578, "outflow_rate_mean": 998.3966517679596, "cost1_min": 17.877989948885048, "system_level_velocity_mean": 13.149486516283169, "outflow_rate_max": 1260.42505489777}, "num_metric_batches_dropped": 0, "episode_reward_min": -956.4912980625699}
{"timesteps_this_iter": 39521, "episodes_total": 361, "timesteps_since_restore": 312874, "policy_reward_mean": {}, "timesteps_total": 312874, "training_iteration": 8, "episode_reward_max": -359.2908333734155, "pid": 1094, "time_this_iter_s": 28.083240032196045, "time_total_s": 230.31413173675537, "episodes_this_iter": 40, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 8, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11051.596, "update_time_ms": 105.526, "sample_time_ms": 17505.416, "num_steps_trained": 312874, "load_time_ms": 30.097, "default": {"vf_loss": 39.40382766723633, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.004189531318843365, "total_loss": 39.400142669677734, "cur_lr": 0.0005000000237487257, "kl": 0.010042576119303703, "vf_explained_var": 0.8074735403060913, "entropy": 1.3352373838424683}, "num_steps_sampled": 312874}, "hostname": "flow-main", "date": "2019-05-24_05-10-49", "episode_reward_mean": -506.0585235548754, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae668>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6aec50>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 230.31413173675537, "timestamp": 1558674649, "custom_metrics": {"system_level_velocity_max": 17.146352414620964, "cost1_mean": 169.4208769009362, "cost2_max": -33.035394727856506, "cost1_max": 206.09006265000613, "cost2_mean": -77.35850728911187, "outflow_rate_min": 725.4374761399788, "system_level_velocity_min": 9.234009127685875, "cost2_min": -109.5387924223063, "outflow_rate_mean": 1099.4693168483582, "cost1_min": 110.8048930492022, "system_level_velocity_mean": 14.14888795216169, "outflow_rate_max": 1332.9826277140476}, "num_metric_batches_dropped": 0, "episode_reward_min": -956.4912980625699}
{"timesteps_this_iter": 41375, "episodes_total": 403, "timesteps_since_restore": 354249, "policy_reward_mean": {}, "timesteps_total": 354249, "training_iteration": 9, "episode_reward_max": -115.63099264584127, "pid": 1094, "time_this_iter_s": 29.893589973449707, "time_total_s": 260.2077217102051, "episodes_this_iter": 42, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 9, "episode_len_mean": 321.94, "info": {"grad_time_ms": 11041.17, "update_time_ms": 94.914, "sample_time_ms": 17650.745, "num_steps_trained": 354249, "load_time_ms": 28.505, "default": {"vf_loss": 38.69617462158203, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0019534467719495296, "total_loss": 38.694583892822266, "cur_lr": 0.0005000000237487257, "kl": 0.007287685293704271, "vf_explained_var": 0.7884156107902527, "entropy": 1.3264976739883423}, "num_steps_sampled": 354249}, "hostname": "flow-main", "date": "2019-05-24_05-11-19", "episode_reward_mean": -486.5827086755812, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69fba8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f4a8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 260.2077217102051, "timestamp": 1558674679, "custom_metrics": {"system_level_velocity_max": 18.498959537198882, "cost1_mean": 176.90688291019885, "cost2_max": -33.36593368249253, "cost1_max": 211.1688072023902, "cost2_mean": -87.90489420808294, "outflow_rate_min": 725.4374761399788, "system_level_velocity_min": 10.192138317360616, "cost2_min": -130.26945443730935, "outflow_rate_mean": 1152.9378025940093, "cost1_min": 85.35770457286566, "system_level_velocity_mean": 14.90175366333245, "outflow_rate_max": 1361.0241390824622}, "num_metric_batches_dropped": 0, "episode_reward_min": -766.6242826170288}
{"timesteps_this_iter": 42978, "episodes_total": 460, "timesteps_since_restore": 397227, "policy_reward_mean": {}, "timesteps_total": 397227, "training_iteration": 10, "episode_reward_max": -115.63099264584127, "pid": 1094, "time_this_iter_s": 33.312315940856934, "time_total_s": 293.520037651062, "episodes_this_iter": 57, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 10, "episode_len_mean": 321.94, "info": {"grad_time_ms": 11099.037, "update_time_ms": 86.458, "sample_time_ms": 18042.13, "num_steps_trained": 397227, "load_time_ms": 28.135, "default": {"vf_loss": 44.24217987060547, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.002169019775465131, "total_loss": 44.24034118652344, "cur_lr": 0.0005000000237487257, "kl": 0.006458526011556387, "vf_explained_var": 0.7461680173873901, "entropy": 1.332883358001709}, "num_steps_sampled": 397227}, "hostname": "flow-main", "date": "2019-05-24_05-11-52", "episode_reward_mean": -496.71069842145107, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699b70>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a74a8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 293.520037651062, "timestamp": 1558674712, "custom_metrics": {"system_level_velocity_max": 18.498959537198882, "cost1_mean": 182.8790431800383, "cost2_max": -50.918781806654984, "cost1_max": 211.1688072023902, "cost2_mean": -102.78184987994582, "outflow_rate_min": 806.2798721749537, "system_level_velocity_min": 11.344957086466557, "cost2_min": -130.26945443730935, "outflow_rate_mean": 1201.415417790896, "cost1_min": 85.35770457286566, "system_level_velocity_mean": 15.323756362670276, "outflow_rate_max": 1366.0395204735626}, "num_metric_batches_dropped": 0, "episode_reward_min": -884.9070229295654}
{"timesteps_this_iter": 41251, "episodes_total": 501, "timesteps_since_restore": 438478, "policy_reward_mean": {}, "timesteps_total": 438478, "training_iteration": 11, "episode_reward_max": -331.5400217389635, "pid": 1094, "time_this_iter_s": 30.173280239105225, "time_total_s": 323.69331789016724, "episodes_this_iter": 41, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 11, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10915.469, "update_time_ms": 9.082, "sample_time_ms": 18253.06, "num_steps_trained": 438478, "load_time_ms": 21.011, "default": {"vf_loss": 29.788549423217773, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002844126895070076, "total_loss": 29.78618812561035, "cur_lr": 0.0005000000237487257, "kl": 0.009623776189982891, "vf_explained_var": 0.8142629861831665, "entropy": 1.3171911239624023}, "num_steps_sampled": 438478}, "hostname": "flow-main", "date": "2019-05-24_05-12-23", "episode_reward_mean": -503.42073569166985, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1828>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f14e0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 323.69331789016724, "timestamp": 1558674743, "custom_metrics": {"system_level_velocity_max": 18.0863500035578, "cost1_mean": 186.10437075823694, "cost2_max": -86.75276522366823, "cost1_max": 215.13428056518856, "cost2_mean": -107.41521462656561, "outflow_rate_min": 926.3464767941005, "system_level_velocity_min": 11.088261248793655, "cost2_min": -131.58733483732027, "outflow_rate_mean": 1223.4524757451009, "cost1_min": 134.05431901795856, "system_level_velocity_mean": 15.403505947485653, "outflow_rate_max": 1397.1415067136252}, "num_metric_batches_dropped": 0, "episode_reward_min": -884.9070229295654}
{"timesteps_this_iter": 42623, "episodes_total": 543, "timesteps_since_restore": 481101, "policy_reward_mean": {}, "timesteps_total": 481101, "training_iteration": 12, "episode_reward_max": -331.5400217389635, "pid": 1094, "time_this_iter_s": 32.448057889938354, "time_total_s": 356.1413757801056, "episodes_this_iter": 42, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 12, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10806.576, "update_time_ms": 9.059, "sample_time_ms": 18631.831, "num_steps_trained": 481101, "load_time_ms": 19.677, "default": {"vf_loss": 31.080001831054688, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.004461521282792091, "total_loss": 31.07600212097168, "cur_lr": 0.0005000000237487257, "kl": 0.00923697929829359, "vf_explained_var": 0.8125039339065552, "entropy": 1.293735384941101}, "num_steps_sampled": 481101}, "hostname": "flow-main", "date": "2019-05-24_05-12-55", "episode_reward_mean": -510.1701643957809, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6887f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688630>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688780>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 356.1413757801056, "timestamp": 1558674775, "custom_metrics": {"system_level_velocity_max": 18.0863500035578, "cost1_mean": 186.000929001122, "cost2_max": -87.96715373066706, "cost1_max": 215.13428056518856, "cost2_mean": -109.65993251170039, "outflow_rate_min": 981.100694473272, "system_level_velocity_min": 11.088261248793655, "cost2_min": -131.58733483732027, "outflow_rate_mean": 1227.704323217432, "cost1_min": 134.05431901795856, "system_level_velocity_mean": 15.415227630701018, "outflow_rate_max": 1397.1415067136252}, "num_metric_batches_dropped": 0, "episode_reward_min": -848.6455687593138}
{"timesteps_this_iter": 44176, "episodes_total": 600, "timesteps_since_restore": 525277, "policy_reward_mean": {}, "timesteps_total": 525277, "training_iteration": 13, "episode_reward_max": -314.8416694561912, "pid": 1094, "time_this_iter_s": 33.039984941482544, "time_total_s": 389.18136072158813, "episodes_this_iter": 57, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 13, "episode_len_mean": 324.8, "info": {"grad_time_ms": 10848.611, "update_time_ms": 8.809, "sample_time_ms": 19098.333, "num_steps_trained": 525277, "load_time_ms": 19.895, "default": {"vf_loss": 36.6000862121582, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.00312311970628798, "total_loss": 36.59736633300781, "cur_lr": 0.0005000000237487257, "kl": 0.008050184696912766, "vf_explained_var": 0.7777160406112671, "entropy": 1.279097318649292}, "num_steps_sampled": 525277}, "hostname": "flow-main", "date": "2019-05-24_05-13-28", "episode_reward_mean": -529.1214385397654, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae198>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae780>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 389.18136072158813, "timestamp": 1558674808, "custom_metrics": {"system_level_velocity_max": 17.784385998939424, "cost1_mean": 183.80633437546214, "cost2_max": -90.8388368155072, "cost1_max": 213.66079277137072, "cost2_mean": -113.73329535328055, "outflow_rate_min": 982.030479719447, "system_level_velocity_min": 11.318171610739675, "cost2_min": -140.01103599049117, "outflow_rate_mean": 1225.1474040910657, "cost1_min": 138.00127772222157, "system_level_velocity_mean": 15.265399253924606, "outflow_rate_max": 1407.7064626357253}, "num_metric_batches_dropped": 0, "episode_reward_min": -848.6455687593138}
{"timesteps_this_iter": 42706, "episodes_total": 641, "timesteps_since_restore": 567983, "policy_reward_mean": {}, "timesteps_total": 567983, "training_iteration": 14, "episode_reward_max": -314.8416694561912, "pid": 1094, "time_this_iter_s": 30.269656896591187, "time_total_s": 419.4510176181793, "episodes_this_iter": 41, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 14, "episode_len_mean": 324.8, "info": {"grad_time_ms": 10870.469, "update_time_ms": 8.926, "sample_time_ms": 19205.652, "num_steps_trained": 567983, "load_time_ms": 20.324, "default": {"vf_loss": 29.419326782226562, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.003578387200832367, "total_loss": 29.416227340698242, "cur_lr": 0.0005000000237487257, "kl": 0.009527169167995453, "vf_explained_var": 0.8308722972869873, "entropy": 1.2741177082061768}, "num_steps_sampled": 567983}, "hostname": "flow-main", "date": "2019-05-24_05-13-58", "episode_reward_mean": -537.2488804853823, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f240>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69fb00>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 419.4510176181793, "timestamp": 1558674838, "custom_metrics": {"system_level_velocity_max": 18.058888060276995, "cost1_mean": 184.04440581796908, "cost2_max": -91.75598352088875, "cost1_max": 217.28958583711326, "cost2_mean": -116.62470803831258, "outflow_rate_min": 1004.0807872264725, "system_level_velocity_min": 11.318171610739675, "cost2_min": -142.0610604774925, "outflow_rate_mean": 1225.5096024704146, "cost1_min": 139.56855157048687, "system_level_velocity_mean": 15.300107857833869, "outflow_rate_max": 1424.9640864314192}, "num_metric_batches_dropped": 0, "episode_reward_min": -803.7160023054616}
{"timesteps_this_iter": 43142, "episodes_total": 682, "timesteps_since_restore": 611125, "policy_reward_mean": {}, "timesteps_total": 611125, "training_iteration": 15, "episode_reward_max": -314.8416694561912, "pid": 1094, "time_this_iter_s": 31.05528736114502, "time_total_s": 450.50630497932434, "episodes_this_iter": 41, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 15, "episode_len_mean": 324.8, "info": {"grad_time_ms": 10980.995, "update_time_ms": 8.895, "sample_time_ms": 19527.951, "num_steps_trained": 611125, "load_time_ms": 20.664, "default": {"vf_loss": 27.356969833374023, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.003675097832456231, "total_loss": 27.35367202758789, "cur_lr": 0.0005000000237487257, "kl": 0.007544554304331541, "vf_explained_var": 0.8459477424621582, "entropy": 1.2656742334365845}, "num_steps_sampled": 611125}, "hostname": "flow-main", "date": "2019-05-24_05-14-30", "episode_reward_mean": -538.3862972072835, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69ff60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da588>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69ff98>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 450.50630497932434, "timestamp": 1558674870, "custom_metrics": {"system_level_velocity_max": 18.155054840615513, "cost1_mean": 184.8843811280228, "cost2_max": -100.5364633996949, "cost1_max": 217.29857458797994, "cost2_mean": -118.07799541620177, "outflow_rate_min": 1004.0807872264725, "system_level_velocity_min": 12.185209500129517, "cost2_min": -142.0610604774925, "outflow_rate_mean": 1229.6350161031037, "cost1_min": 145.8373853058692, "system_level_velocity_mean": 15.397057925949095, "outflow_rate_max": 1424.9640864314192}, "num_metric_batches_dropped": 0, "episode_reward_min": -825.522401502626}
{"timesteps_this_iter": 44604, "episodes_total": 723, "timesteps_since_restore": 655729, "policy_reward_mean": {}, "timesteps_total": 655729, "training_iteration": 16, "episode_reward_max": -311.1030769313483, "pid": 1094, "time_this_iter_s": 31.496016263961792, "time_total_s": 482.00232124328613, "episodes_this_iter": 41, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 16, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11113.377, "update_time_ms": 8.77, "sample_time_ms": 19830.741, "num_steps_trained": 655729, "load_time_ms": 21.946, "default": {"vf_loss": 30.10944175720215, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.004493203479796648, "total_loss": 30.105493545532227, "cur_lr": 0.0005000000237487257, "kl": 0.010916400700807571, "vf_explained_var": 0.8256869316101074, "entropy": 1.2575914859771729}, "num_steps_sampled": 655729}, "hostname": "flow-main", "date": "2019-05-24_05-15-01", "episode_reward_mean": -531.0729421708899, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699f60>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7908>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 482.00232124328613, "timestamp": 1558674901, "custom_metrics": {"system_level_velocity_max": 18.409645205205944, "cost1_mean": 186.298167210675, "cost2_max": -100.5364633996949, "cost1_max": 218.95367643064588, "cost2_mean": -117.50694268609557, "outflow_rate_min": 1027.5047065859721, "system_level_velocity_min": 12.066712905720344, "cost2_min": -145.74052158008192, "outflow_rate_mean": 1241.1591669145982, "cost1_min": 143.39603981399912, "system_level_velocity_mean": 15.51829990596391, "outflow_rate_max": 1429.7539393840964}, "num_metric_batches_dropped": 0, "episode_reward_min": -825.522401502626}
{"timesteps_this_iter": 42149, "episodes_total": 781, "timesteps_since_restore": 697878, "policy_reward_mean": {}, "timesteps_total": 697878, "training_iteration": 17, "episode_reward_max": -311.1030769313483, "pid": 1094, "time_this_iter_s": 32.458486557006836, "time_total_s": 514.460807800293, "episodes_this_iter": 58, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 17, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11127.357, "update_time_ms": 8.547, "sample_time_ms": 19967.789, "num_steps_trained": 697878, "load_time_ms": 21.777, "default": {"vf_loss": 36.740264892578125, "cur_kl_coeff": 0.05000000074505806, "policy_loss": -0.004585602320730686, "total_loss": 36.73623275756836, "cur_lr": 0.0005000000237487257, "kl": 0.011040342040359974, "vf_explained_var": 0.7894036769866943, "entropy": 1.266919493675232}, "num_steps_sampled": 697878}, "hostname": "flow-main", "date": "2019-05-24_05-15-34", "episode_reward_mean": -537.874972429933, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3834e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f160>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699da0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 514.460807800293, "timestamp": 1558674934, "custom_metrics": {"system_level_velocity_max": 18.409645205205944, "cost1_mean": 184.5880566990345, "cost2_max": -99.07759019785675, "cost1_max": 218.95367643064588, "cost2_mean": -117.23692431733825, "outflow_rate_min": 1027.5047065859721, "system_level_velocity_min": 12.066712905720344, "cost2_min": -145.74052158008192, "outflow_rate_mean": 1229.926518542712, "cost1_min": 143.39603981399912, "system_level_velocity_mean": 15.358472184368438, "outflow_rate_max": 1429.7539393840964}, "num_metric_batches_dropped": 0, "episode_reward_min": -820.1892656459539}
{"timesteps_this_iter": 42614, "episodes_total": 822, "timesteps_since_restore": 740492, "policy_reward_mean": {}, "timesteps_total": 740492, "training_iteration": 18, "episode_reward_max": -320.10347633921924, "pid": 1094, "time_this_iter_s": 31.1594340801239, "time_total_s": 545.6202418804169, "episodes_this_iter": 41, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 18, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11237.547, "update_time_ms": 8.771, "sample_time_ms": 20161.021, "num_steps_trained": 740492, "load_time_ms": 22.558, "default": {"vf_loss": 25.99798011779785, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.004097484517842531, "total_loss": 25.994380950927734, "cur_lr": 0.0005000000237487257, "kl": 0.010005732998251915, "vf_explained_var": 0.840610921382904, "entropy": 1.2383826971054077}, "num_steps_sampled": 740492}, "hostname": "flow-main", "date": "2019-05-24_05-16-05", "episode_reward_mean": -529.059762354215, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6aef28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae550>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae390>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 545.6202418804169, "timestamp": 1558674965, "custom_metrics": {"system_level_velocity_max": 18.30112935401223, "cost1_mean": 185.9543426094002, "cost2_max": -99.07759019785675, "cost1_max": 218.51154557009343, "cost2_mean": -118.2309070376671, "outflow_rate_min": 1041.1980616132662, "system_level_velocity_min": 10.4167505647378, "cost2_min": -142.13578933624592, "outflow_rate_mean": 1234.6480805504239, "cost1_min": 127.68471043351128, "system_level_velocity_mean": 15.478247807019287, "outflow_rate_max": 1424.2824039938562}, "num_metric_batches_dropped": 0, "episode_reward_min": -843.1113031737128}
{"timesteps_this_iter": 44684, "episodes_total": 863, "timesteps_since_restore": 785176, "policy_reward_mean": {}, "timesteps_total": 785176, "training_iteration": 19, "episode_reward_max": -305.8810561521139, "pid": 1094, "time_this_iter_s": 33.86455178260803, "time_total_s": 579.4847936630249, "episodes_this_iter": 41, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 19, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11489.295, "update_time_ms": 8.879, "sample_time_ms": 20301.597, "num_steps_trained": 785176, "load_time_ms": 23.903, "default": {"vf_loss": 23.714645385742188, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.005280432291328907, "total_loss": 23.709823608398438, "cur_lr": 0.0005000000237487257, "kl": 0.009218912571668625, "vf_explained_var": 0.8639867305755615, "entropy": 1.242253303527832}, "num_steps_sampled": 785176}, "hostname": "flow-main", "date": "2019-05-24_05-16-39", "episode_reward_mean": -545.4678153404656, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f5f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69fa20>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69fdd8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 579.4847936630249, "timestamp": 1558674999, "custom_metrics": {"system_level_velocity_max": 18.453519728580794, "cost1_mean": 183.7886449820676, "cost2_max": -100.91878790500584, "cost1_max": 220.09605713809543, "cost2_mean": -119.55151786930637, "outflow_rate_min": 1041.1980616132662, "system_level_velocity_min": 10.4167505647378, "cost2_min": -142.13578933624592, "outflow_rate_mean": 1227.8737657481877, "cost1_min": 127.68471043351128, "system_level_velocity_mean": 15.307185537508422, "outflow_rate_max": 1426.8865193973866}, "num_metric_batches_dropped": 0, "episode_reward_min": -843.1113031737128}
{"timesteps_this_iter": 43075, "episodes_total": 921, "timesteps_since_restore": 828251, "policy_reward_mean": {}, "timesteps_total": 828251, "training_iteration": 20, "episode_reward_max": -305.8810561521139, "pid": 1094, "time_this_iter_s": 32.85462164878845, "time_total_s": 612.3394153118134, "episodes_this_iter": 58, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 20, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11572.809, "update_time_ms": 9.014, "sample_time_ms": 20173.789, "num_steps_trained": 828251, "load_time_ms": 22.732, "default": {"vf_loss": 35.37193298339844, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.004607171751558781, "total_loss": 35.36783218383789, "cur_lr": 0.0005000000237487257, "kl": 0.01006729993969202, "vf_explained_var": 0.8060208559036255, "entropy": 1.238511562347412}, "num_steps_sampled": 828251}, "hostname": "flow-main", "date": "2019-05-24_05-17-12", "episode_reward_mean": -553.9077441835791, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae2b0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae240>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 612.3394153118134, "timestamp": 1558675032, "custom_metrics": {"system_level_velocity_max": 18.51463339519673, "cost1_mean": 182.6640540078524, "cost2_max": -101.81661703889257, "cost1_max": 220.09605713809543, "cost2_mean": -119.61259610042303, "outflow_rate_min": 1046.9904132231404, "system_level_velocity_min": 12.00963149468223, "cost2_min": -141.14217063970466, "outflow_rate_mean": 1224.318946371335, "cost1_min": 144.25111434633584, "system_level_velocity_mean": 15.249112413106564, "outflow_rate_max": 1427.1830725623593}, "num_metric_batches_dropped": 0, "episode_reward_min": -826.5127040884331}
{"timesteps_this_iter": 42702, "episodes_total": 963, "timesteps_since_restore": 870953, "policy_reward_mean": {}, "timesteps_total": 870953, "training_iteration": 21, "episode_reward_max": -32.33427184380799, "pid": 1094, "time_this_iter_s": 31.162898302078247, "time_total_s": 643.5023136138916, "episodes_this_iter": 42, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 21, "episode_len_mean": 322.1, "info": {"grad_time_ms": 11590.105, "update_time_ms": 8.948, "sample_time_ms": 20254.084, "num_steps_trained": 870953, "load_time_ms": 23.907, "default": {"vf_loss": 30.417205810546875, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.004302117042243481, "total_loss": 30.413455963134766, "cur_lr": 0.0005000000237487257, "kl": 0.011082551442086697, "vf_explained_var": 0.8362532258033752, "entropy": 1.2269729375839233}, "num_steps_sampled": 870953}, "hostname": "flow-main", "date": "2019-05-24_05-17-43", "episode_reward_mean": -528.7929222704043, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699da0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699748>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 643.5023136138916, "timestamp": 1558675063, "custom_metrics": {"system_level_velocity_max": 18.646936415872123, "cost1_mean": 183.95007086082956, "cost2_max": -21.672798703082456, "cost1_max": 222.35311102954387, "cost2_mean": -118.0334190019306, "outflow_rate_min": 491.0341917764782, "system_level_velocity_min": 12.105815616909307, "cost2_min": -143.62674408651387, "outflow_rate_mean": 1228.68556464668, "cost1_min": 23.00205930462967, "system_level_velocity_mean": 15.532920611341233, "outflow_rate_max": 1440.3389975133969}, "num_metric_batches_dropped": 0, "episode_reward_min": -831.6353173940881}
{"timesteps_this_iter": 42288, "episodes_total": 1004, "timesteps_since_restore": 913241, "policy_reward_mean": {}, "timesteps_total": 913241, "training_iteration": 22, "episode_reward_max": -32.33427184380799, "pid": 1094, "time_this_iter_s": 30.217884063720703, "time_total_s": 673.7201976776123, "episodes_this_iter": 41, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 22, "episode_len_mean": 321.74, "info": {"grad_time_ms": 11479.338, "update_time_ms": 8.914, "sample_time_ms": 20141.808, "num_steps_trained": 913241, "load_time_ms": 24.93, "default": {"vf_loss": 26.27936553955078, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.005641141906380653, "total_loss": 26.274383544921875, "cur_lr": 0.0005000000237487257, "kl": 0.013237242586910725, "vf_explained_var": 0.8507767915725708, "entropy": 1.2191226482391357}, "num_steps_sampled": 913241}, "hostname": "flow-main", "date": "2019-05-24_05-18-13", "episode_reward_mean": -517.5535449438995, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5518>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b56d8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 673.7201976776123, "timestamp": 1558675093, "custom_metrics": {"system_level_velocity_max": 18.646936415872123, "cost1_mean": 184.16158008939436, "cost2_max": -21.672798703082456, "cost1_max": 222.35311102954387, "cost2_mean": -116.92733109250949, "outflow_rate_min": 491.0341917764782, "system_level_velocity_min": 11.96509272930189, "cost2_min": -143.62674408651387, "outflow_rate_mean": 1229.433527340613, "cost1_min": 23.00205930462967, "system_level_velocity_mean": 15.541567912650686, "outflow_rate_max": 1440.3389975133969}, "num_metric_batches_dropped": 0, "episode_reward_min": -831.6353173940881}
{"timesteps_this_iter": 42062, "episodes_total": 1061, "timesteps_since_restore": 955303, "policy_reward_mean": {}, "timesteps_total": 955303, "training_iteration": 23, "episode_reward_max": -307.47850074801926, "pid": 1094, "time_this_iter_s": 31.583938121795654, "time_total_s": 705.304135799408, "episodes_this_iter": 57, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 23, "episode_len_mean": 324.64, "info": {"grad_time_ms": 11357.6, "update_time_ms": 8.965, "sample_time_ms": 20119.591, "num_steps_trained": 955303, "load_time_ms": 24.761, "default": {"vf_loss": 29.090328216552734, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.004804800730198622, "total_loss": 29.086181640625, "cur_lr": 0.0005000000237487257, "kl": 0.013147342950105667, "vf_explained_var": 0.8350211381912231, "entropy": 1.2283835411071777}, "num_steps_sampled": 955303}, "hostname": "flow-main", "date": "2019-05-24_05-18-45", "episode_reward_mean": -508.610921377879, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699c50>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da0b8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 705.304135799408, "timestamp": 1558675125, "custom_metrics": {"system_level_velocity_max": 18.303461914929816, "cost1_mean": 186.3306915701552, "cost2_max": -91.43475005582536, "cost1_max": 216.14741045190988, "cost2_mean": -115.39093165609093, "outflow_rate_min": 1028.4868549776852, "system_level_velocity_min": 11.96509272930189, "cost2_min": -136.88688800463973, "outflow_rate_mean": 1233.9647771558427, "cost1_min": 144.83331080293254, "system_level_velocity_mean": 15.5209190440867, "outflow_rate_max": 1412.5616342837175}, "num_metric_batches_dropped": 0, "episode_reward_min": -805.9892954105885}
{"timesteps_this_iter": 42183, "episodes_total": 1103, "timesteps_since_restore": 997486, "policy_reward_mean": {}, "timesteps_total": 997486, "training_iteration": 24, "episode_reward_max": -23.95272013110203, "pid": 1094, "time_this_iter_s": 31.787529230117798, "time_total_s": 737.0916650295258, "episodes_this_iter": 42, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 24, "episode_len_mean": 322.02, "info": {"grad_time_ms": 11374.982, "update_time_ms": 8.87, "sample_time_ms": 20254.914, "num_steps_trained": 997486, "load_time_ms": 24.528, "default": {"vf_loss": 23.942842483520508, "cur_kl_coeff": 0.05000000074505806, "policy_loss": -0.006727582309395075, "total_loss": 23.93680191040039, "cur_lr": 0.0005000000237487257, "kl": 0.013741310685873032, "vf_explained_var": 0.8535864949226379, "entropy": 1.2162716388702393}, "num_steps_sampled": 997486}, "hostname": "flow-main", "date": "2019-05-24_05-19-16", "episode_reward_mean": -510.2660094670596, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bb198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bb160>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bb1d0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 737.0916650295258, "timestamp": 1558675156, "custom_metrics": {"system_level_velocity_max": 18.303461914929816, "cost1_mean": 184.16919757972641, "cost2_max": -17.623386551573475, "cost1_max": 216.14741045190988, "cost2_mean": -115.88541738146938, "outflow_rate_min": 474.3699846082663, "system_level_velocity_min": 11.558652898340377, "cost2_min": -137.25849005930144, "outflow_rate_mean": 1222.5624236342362, "cost1_min": 17.891019864663182, "system_level_velocity_mean": 15.457412297071501, "outflow_rate_max": 1414.5169875697682}, "num_metric_batches_dropped": 0, "episode_reward_min": -819.2998515582269}
{"timesteps_this_iter": 43102, "episodes_total": 1146, "timesteps_since_restore": 1040588, "policy_reward_mean": {}, "timesteps_total": 1040588, "training_iteration": 25, "episode_reward_max": -23.95272013110203, "pid": 1094, "time_this_iter_s": 31.79547429084778, "time_total_s": 768.8871393203735, "episodes_this_iter": 43, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 25, "episode_len_mean": 317.94, "info": {"grad_time_ms": 11367.35, "update_time_ms": 9.037, "sample_time_ms": 20338.071, "num_steps_trained": 1040588, "load_time_ms": 24.222, "default": {"vf_loss": 25.400020599365234, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.006529056467115879, "total_loss": 25.394229888916016, "cur_lr": 0.0005000000237487257, "kl": 0.014737321063876152, "vf_explained_var": 0.8458853960037231, "entropy": 1.2177175283432007}, "num_steps_sampled": 1040588}, "hostname": "flow-main", "date": "2019-05-24_05-19-48", "episode_reward_mean": -509.9299420459872, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69fa20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69ff98>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f358>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 768.8871393203735, "timestamp": 1558675188, "custom_metrics": {"system_level_velocity_max": 18.560612685440795, "cost1_mean": 181.6656830612007, "cost2_max": -17.623386551573475, "cost1_max": 218.74007921548179, "cost2_mean": -114.91686223590986, "outflow_rate_min": 442.8785900830537, "system_level_velocity_min": 11.558652898340377, "cost2_min": -137.25849005930144, "outflow_rate_mean": 1213.3997471507275, "cost1_min": 17.890295964205098, "system_level_velocity_mean": 15.491625950116424, "outflow_rate_max": 1429.4371860282572}, "num_metric_batches_dropped": 0, "episode_reward_min": -819.2998515582269}
{"timesteps_this_iter": 43037, "episodes_total": 1201, "timesteps_since_restore": 1083625, "policy_reward_mean": {}, "timesteps_total": 1083625, "training_iteration": 26, "episode_reward_max": -24.66049293383245, "pid": 1094, "time_this_iter_s": 32.662869691848755, "time_total_s": 801.5500090122223, "episodes_this_iter": 55, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 26, "episode_len_mean": 320.92, "info": {"grad_time_ms": 11326.56, "update_time_ms": 9.097, "sample_time_ms": 20496.125, "num_steps_trained": 1083625, "load_time_ms": 23.537, "default": {"vf_loss": 28.245012283325195, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.006121631246060133, "total_loss": 28.239553451538086, "cur_lr": 0.0005000000237487257, "kl": 0.013290302827954292, "vf_explained_var": 0.8169230222702026, "entropy": 1.2114821672439575}, "num_steps_sampled": 1083625}, "hostname": "flow-main", "date": "2019-05-24_05-20-21", "episode_reward_mean": -519.9353184519275, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bb208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bb128>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bb1d0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 801.5500090122223, "timestamp": 1558675221, "custom_metrics": {"system_level_velocity_max": 18.560612685440795, "cost1_mean": 183.66327414023075, "cost2_max": -20.399906349771012, "cost1_max": 218.74007921548179, "cost2_mean": -115.57569455524586, "outflow_rate_min": 442.8785900830537, "system_level_velocity_min": 12.122426067714775, "cost2_min": -137.25849005930144, "outflow_rate_mean": 1221.3678275308018, "cost1_min": 17.890295964205098, "system_level_velocity_mean": 15.561031983452857, "outflow_rate_max": 1429.4371860282572}, "num_metric_batches_dropped": 0, "episode_reward_min": -807.3540040695997}
{"timesteps_this_iter": 42103, "episodes_total": 1245, "timesteps_since_restore": 1125728, "policy_reward_mean": {}, "timesteps_total": 1125728, "training_iteration": 27, "episode_reward_max": -314.0107998409011, "pid": 1094, "time_this_iter_s": 30.156999588012695, "time_total_s": 831.707008600235, "episodes_this_iter": 44, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 27, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11115.134, "update_time_ms": 8.992, "sample_time_ms": 20480.599, "num_steps_trained": 1125728, "load_time_ms": 22.492, "default": {"vf_loss": 22.259632110595703, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.006758697330951691, "total_loss": 22.253610610961914, "cur_lr": 0.0005000000237487257, "kl": 0.014748817309737206, "vf_explained_var": 0.8624491095542908, "entropy": 1.1850160360336304}, "num_steps_sampled": 1125728}, "hostname": "flow-main", "date": "2019-05-24_05-20-51", "episode_reward_mean": -527.9899812771927, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b57b8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5128>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 831.707008600235, "timestamp": 1558675251, "custom_metrics": {"system_level_velocity_max": 18.29187799058774, "cost1_mean": 185.93830268972167, "cost2_max": -96.63801307005329, "cost1_max": 216.9249218316975, "cost2_mean": -117.63224851901427, "outflow_rate_min": 1032.3084863628203, "system_level_velocity_min": 12.122426067714775, "cost2_min": -136.69867984185154, "outflow_rate_mean": 1231.2658843284912, "cost1_min": 144.92378149057043, "system_level_velocity_mean": 15.53041251284211, "outflow_rate_max": 1409.033374384236}, "num_metric_batches_dropped": 0, "episode_reward_min": -807.3540040695997}
{"timesteps_this_iter": 42865, "episodes_total": 1286, "timesteps_since_restore": 1168593, "policy_reward_mean": {}, "timesteps_total": 1168593, "training_iteration": 28, "episode_reward_max": -33.22718539868827, "pid": 1094, "time_this_iter_s": 31.59134030342102, "time_total_s": 863.298348903656, "episodes_this_iter": 41, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 28, "episode_len_mean": 322.1, "info": {"grad_time_ms": 10987.885, "update_time_ms": 8.76, "sample_time_ms": 20653.359, "num_steps_trained": 1168593, "load_time_ms": 22.665, "default": {"vf_loss": 20.127479553222656, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.005944764707237482, "total_loss": 20.122272491455078, "cur_lr": 0.0005000000237487257, "kl": 0.014748547226190567, "vf_explained_var": 0.8791013360023499, "entropy": 1.1921985149383545}, "num_steps_sampled": 1168593}, "hostname": "flow-main", "date": "2019-05-24_05-21-23", "episode_reward_mean": -534.5687130798487, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1748>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5b70>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 863.298348903656, "timestamp": 1558675283, "custom_metrics": {"system_level_velocity_max": 18.428196413175886, "cost1_mean": 182.58718728473204, "cost2_max": -24.78332926610315, "cost1_max": 217.96352890796194, "cost2_mean": -117.01313875490737, "outflow_rate_min": 471.0354357222381, "system_level_velocity_min": 12.122426067714775, "cost2_min": -142.7746855011416, "outflow_rate_mean": 1218.5350246777027, "cost1_min": 22.972706541571625, "system_level_velocity_mean": 15.402695928737607, "outflow_rate_max": 1437.4782813585607}, "num_metric_batches_dropped": 0, "episode_reward_min": -807.3540040695997}
{"timesteps_this_iter": 42733, "episodes_total": 1328, "timesteps_since_restore": 1211326, "policy_reward_mean": {}, "timesteps_total": 1211326, "training_iteration": 29, "episode_reward_max": -33.22718539868827, "pid": 1094, "time_this_iter_s": 32.97515654563904, "time_total_s": 896.273505449295, "episodes_this_iter": 42, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 29, "episode_len_mean": 320.02, "info": {"grad_time_ms": 10818.569, "update_time_ms": 8.569, "sample_time_ms": 20736.917, "num_steps_trained": 1211326, "load_time_ms": 22.176, "default": {"vf_loss": 23.07058334350586, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.00619343901053071, "total_loss": 23.065086364746094, "cur_lr": 0.0005000000237487257, "kl": 0.013913961127400398, "vf_explained_var": 0.8622300624847412, "entropy": 1.1994339227676392}, "num_steps_sampled": 1211326}, "hostname": "flow-main", "date": "2019-05-24_05-21-56", "episode_reward_mean": -520.9150405200327, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b58d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69ff60>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5438>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 896.273505449295, "timestamp": 1558675316, "custom_metrics": {"system_level_velocity_max": 18.428196413175886, "cost1_mean": 183.4718078318928, "cost2_max": -24.78332926610315, "cost1_max": 218.33523135103695, "cost2_mean": -116.76943184044161, "outflow_rate_min": 471.0354357222381, "system_level_velocity_min": 12.345961705774787, "cost2_min": -142.7746855011416, "outflow_rate_mean": 1224.676334899397, "cost1_min": 22.972706541571625, "system_level_velocity_mean": 15.586670661382891, "outflow_rate_max": 1437.4782813585607}, "num_metric_batches_dropped": 0, "episode_reward_min": -787.3330778208074}
{"timesteps_this_iter": 43136, "episodes_total": 1387, "timesteps_since_restore": 1254462, "policy_reward_mean": {}, "timesteps_total": 1254462, "training_iteration": 30, "episode_reward_max": -34.20124856758538, "pid": 1094, "time_this_iter_s": 35.117104291915894, "time_total_s": 931.3906097412109, "episodes_this_iter": 59, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 30, "episode_len_mean": 320.04, "info": {"grad_time_ms": 10804.721, "update_time_ms": 8.301, "sample_time_ms": 20976.241, "num_steps_trained": 1254462, "load_time_ms": 23.106, "default": {"vf_loss": 26.385202407836914, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.00664370646700263, "total_loss": 26.37938117980957, "cur_lr": 0.0005000000237487257, "kl": 0.01640772819519043, "vf_explained_var": 0.8494329452514648, "entropy": 1.2022768259048462}, "num_steps_sampled": 1254462}, "hostname": "flow-main", "date": "2019-05-24_05-22-31", "episode_reward_mean": -519.8384432058212, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bb9b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bbef0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bb518>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 931.3906097412109, "timestamp": 1558675351, "custom_metrics": {"system_level_velocity_max": 18.744664657071215, "cost1_mean": 183.18167800014982, "cost2_max": -25.33601393971989, "cost1_max": 218.33523135103695, "cost2_mean": -117.23806420306828, "outflow_rate_min": 481.55774239171393, "system_level_velocity_min": 11.866984651189389, "cost2_min": -138.6592241027779, "outflow_rate_mean": 1228.1962460107309, "cost1_min": 24.508829829498065, "system_level_velocity_mean": 15.54233674038808, "outflow_rate_max": 1430.4593321376033}, "num_metric_batches_dropped": 0, "episode_reward_min": -780.4828006306117}
{"timesteps_this_iter": 41448, "episodes_total": 1429, "timesteps_since_restore": 1295910, "policy_reward_mean": {}, "timesteps_total": 1295910, "training_iteration": 31, "episode_reward_max": -23.99300371429828, "pid": 1094, "time_this_iter_s": 31.61326766014099, "time_total_s": 963.0038774013519, "episodes_this_iter": 42, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 31, "episode_len_mean": 319.15, "info": {"grad_time_ms": 10919.942, "update_time_ms": 8.534, "sample_time_ms": 20904.965, "num_steps_trained": 1295910, "load_time_ms": 23.402, "default": {"vf_loss": 19.26187515258789, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.006824628449976444, "total_loss": 19.255775451660156, "cur_lr": 0.0005000000237487257, "kl": 0.014516563154757023, "vf_explained_var": 0.8832969069480896, "entropy": 1.1991053819656372}, "num_steps_sampled": 1295910}, "hostname": "flow-main", "date": "2019-05-24_05-23-03", "episode_reward_mean": -513.9188346366143, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da588>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da0b8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 963.0038774013519, "timestamp": 1558675383, "custom_metrics": {"system_level_velocity_max": 18.744664657071215, "cost1_mean": 182.9476327706602, "cost2_max": -19.471243725950302, "cost1_max": 218.6795817700979, "cost2_mean": -116.54447301655209, "outflow_rate_min": 481.55774239171393, "system_level_velocity_min": 11.54547385405625, "cost2_min": -138.73313017989082, "outflow_rate_mean": 1227.552454618359, "cost1_min": 18.73878370209433, "system_level_velocity_mean": 15.588043374096172, "outflow_rate_max": 1433.0167547318938}, "num_metric_batches_dropped": 0, "episode_reward_min": -844.1956512295031}
{"timesteps_this_iter": 43931, "episodes_total": 1470, "timesteps_since_restore": 1339841, "policy_reward_mean": {}, "timesteps_total": 1339841, "training_iteration": 32, "episode_reward_max": -23.99300371429828, "pid": 1094, "time_this_iter_s": 31.0314199924469, "time_total_s": 994.0352973937988, "episodes_this_iter": 41, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 32, "episode_len_mean": 322.03, "info": {"grad_time_ms": 11175.358, "update_time_ms": 8.581, "sample_time_ms": 20732.521, "num_steps_trained": 1339841, "load_time_ms": 22.145, "default": {"vf_loss": 17.74681854248047, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.007498652208596468, "total_loss": 17.74004364013672, "cur_lr": 0.0005000000237487257, "kl": 0.014511825516819954, "vf_explained_var": 0.8959788084030151, "entropy": 1.1902438402175903}, "num_steps_sampled": 1339841}, "hostname": "flow-main", "date": "2019-05-24_05-23-34", "episode_reward_mean": -519.4460411531169, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6994e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699f60>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6996d8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 994.0352973937988, "timestamp": 1558675414, "custom_metrics": {"system_level_velocity_max": 18.50615257078539, "cost1_mean": 185.18326991423513, "cost2_max": -19.471243725950302, "cost1_max": 218.6795817700979, "cost2_mean": -117.50629258483559, "outflow_rate_min": 497.50056700217027, "system_level_velocity_min": 11.54547385405625, "cost2_min": -138.73313017989082, "outflow_rate_mean": 1241.188772856314, "cost1_min": 18.73878370209433, "system_level_velocity_mean": 15.60867743708858, "outflow_rate_max": 1433.0167547318938}, "num_metric_batches_dropped": 0, "episode_reward_min": -844.1956512295031}
{"timesteps_this_iter": 43593, "episodes_total": 1529, "timesteps_since_restore": 1383434, "policy_reward_mean": {}, "timesteps_total": 1383434, "training_iteration": 33, "episode_reward_max": -32.21021238403762, "pid": 1094, "time_this_iter_s": 33.33560872077942, "time_total_s": 1027.3709061145782, "episodes_this_iter": 59, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 33, "episode_len_mean": 322.12, "info": {"grad_time_ms": 11312.241, "update_time_ms": 8.674, "sample_time_ms": 20769.046, "num_steps_trained": 1383434, "load_time_ms": 22.952, "default": {"vf_loss": 26.985977172851562, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.006068624556064606, "total_loss": 26.98065757751465, "cur_lr": 0.0005000000237487257, "kl": 0.01503041386604309, "vf_explained_var": 0.8414089679718018, "entropy": 1.172485113143921}, "num_steps_sampled": 1383434}, "hostname": "flow-main", "date": "2019-05-24_05-24-07", "episode_reward_mean": -540.2196817388626, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b57b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5da0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5f28>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1027.3709061145782, "timestamp": 1558675447, "custom_metrics": {"system_level_velocity_max": 18.782722932522677, "cost1_mean": 182.453407642348, "cost2_max": -24.32016554992093, "cost1_max": 218.47888295642753, "cost2_mean": -117.98111973418366, "outflow_rate_min": 514.3578770283524, "system_level_velocity_min": 10.57053252089395, "cost2_min": -139.34214311755403, "outflow_rate_mean": 1229.295266724176, "cost1_min": 24.404538472942722, "system_level_velocity_mean": 15.375846685778276, "outflow_rate_max": 1431.3946440136538}, "num_metric_batches_dropped": 0, "episode_reward_min": -878.9636265177865}
{"timesteps_this_iter": 43124, "episodes_total": 1570, "timesteps_since_restore": 1426558, "policy_reward_mean": {}, "timesteps_total": 1426558, "training_iteration": 34, "episode_reward_max": -32.21021238403762, "pid": 1094, "time_this_iter_s": 31.81369376182556, "time_total_s": 1059.1845998764038, "episodes_this_iter": 41, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 34, "episode_len_mean": 322.12, "info": {"grad_time_ms": 11375.021, "update_time_ms": 8.722, "sample_time_ms": 20708.757, "num_steps_trained": 1426558, "load_time_ms": 23.242, "default": {"vf_loss": 17.292810440063477, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.007650891784578562, "total_loss": 17.285945892333984, "cur_lr": 0.0005000000237487257, "kl": 0.015750011429190636, "vf_explained_var": 0.8997446894645691, "entropy": 1.1483317613601685}, "num_steps_sampled": 1426558}, "hostname": "flow-main", "date": "2019-05-24_05-24-39", "episode_reward_mean": -545.4685149282483, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b54e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5748>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5f98>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1059.1845998764038, "timestamp": 1558675479, "custom_metrics": {"system_level_velocity_max": 18.782722932522677, "cost1_mean": 181.5006963244024, "cost2_max": -24.32016554992093, "cost1_max": 219.11841860035847, "cost2_mean": -119.16106650076931, "outflow_rate_min": 514.3578770283524, "system_level_velocity_min": 10.57053252089395, "cost2_min": -139.34214311755403, "outflow_rate_mean": 1222.8756566126501, "cost1_min": 24.404538472942722, "system_level_velocity_mean": 15.279006248837968, "outflow_rate_max": 1436.238483011153}, "num_metric_batches_dropped": 0, "episode_reward_min": -878.9636265177865}
{"timesteps_this_iter": 42595, "episodes_total": 1612, "timesteps_since_restore": 1469153, "policy_reward_mean": {}, "timesteps_total": 1469153, "training_iteration": 35, "episode_reward_max": -32.21021238403762, "pid": 1094, "time_this_iter_s": 31.5304753780365, "time_total_s": 1090.7150752544403, "episodes_this_iter": 42, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 35, "episode_len_mean": 320.04, "info": {"grad_time_ms": 11447.793, "update_time_ms": 8.724, "sample_time_ms": 20608.989, "num_steps_trained": 1469153, "load_time_ms": 23.236, "default": {"vf_loss": 21.47385597229004, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.008095636032521725, "total_loss": 21.466705322265625, "cur_lr": 0.0005000000237487257, "kl": 0.018892895430326462, "vf_explained_var": 0.8813554048538208, "entropy": 1.155094027519226}, "num_steps_sampled": 1469153}, "hostname": "flow-main", "date": "2019-05-24_05-25-10", "episode_reward_mean": -532.4312785663183, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bbe10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bbbe0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bbef0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1090.7150752544403, "timestamp": 1558675510, "custom_metrics": {"system_level_velocity_max": 18.782722932522677, "cost1_mean": 180.7217991059817, "cost2_max": -24.32016554992093, "cost1_max": 222.2640932746925, "cost2_mean": -118.7685525157398, "outflow_rate_min": 514.3578770283524, "system_level_velocity_min": 11.86346404471719, "cost2_min": -144.3374403470931, "outflow_rate_mean": 1218.1596237897365, "cost1_min": 24.404538472942722, "system_level_velocity_mean": 15.3179170825719, "outflow_rate_max": 1445.6112930085326}, "num_metric_batches_dropped": 0, "episode_reward_min": -768.6872559860433}
{"timesteps_this_iter": 43775, "episodes_total": 1665, "timesteps_since_restore": 1512928, "policy_reward_mean": {}, "timesteps_total": 1512928, "training_iteration": 36, "episode_reward_max": -104.64011523445606, "pid": 1094, "time_this_iter_s": 33.346832036972046, "time_total_s": 1124.0619072914124, "episodes_this_iter": 53, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 36, "episode_len_mean": 319.74, "info": {"grad_time_ms": 11646.012, "update_time_ms": 8.77, "sample_time_ms": 20480.039, "num_steps_trained": 1512928, "load_time_ms": 22.54, "default": {"vf_loss": 22.214277267456055, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.00872131809592247, "total_loss": 22.2065372467041, "cur_lr": 0.0005000000237487257, "kl": 0.019664615392684937, "vf_explained_var": 0.8713089227676392, "entropy": 1.1564972400665283}, "num_steps_sampled": 1512928}, "hostname": "flow-main", "date": "2019-05-24_05-25-44", "episode_reward_mean": -524.688954017635, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f5c0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69fc88>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1124.0619072914124, "timestamp": 1558675544, "custom_metrics": {"system_level_velocity_max": 18.79836201173243, "cost1_mean": 182.16479939672297, "cost2_max": -54.059061935609876, "cost1_max": 222.2640932746925, "cost2_mean": -119.94612003869504, "outflow_rate_min": 766.6399594722118, "system_level_velocity_min": 11.86346404471719, "cost2_min": -144.3374403470931, "outflow_rate_mean": 1230.0019423382746, "cost1_min": 79.16344421792616, "system_level_velocity_mean": 15.470085057351849, "outflow_rate_max": 1446.0961711502785}, "num_metric_batches_dropped": 0, "episode_reward_min": -865.6265663908862}
{"timesteps_this_iter": 43158, "episodes_total": 1711, "timesteps_since_restore": 1556086, "policy_reward_mean": {}, "timesteps_total": 1556086, "training_iteration": 37, "episode_reward_max": -113.67981446148622, "pid": 1094, "time_this_iter_s": 31.487648010253906, "time_total_s": 1155.5495553016663, "episodes_this_iter": 46, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 37, "episode_len_mean": 321.82, "info": {"grad_time_ms": 11872.66, "update_time_ms": 8.896, "sample_time_ms": 20385.299, "num_steps_trained": 1556086, "load_time_ms": 24.102, "default": {"vf_loss": 19.04500961303711, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.008966541849076748, "total_loss": 19.03708267211914, "cur_lr": 0.0005000000237487257, "kl": 0.020815160125494003, "vf_explained_var": 0.8924915790557861, "entropy": 1.1515765190124512}, "num_steps_sampled": 1556086}, "hostname": "flow-main", "date": "2019-05-24_05-26-15", "episode_reward_mean": -542.5819391629166, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5240>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b56d8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1155.5495553016663, "timestamp": 1558675575, "custom_metrics": {"system_level_velocity_max": 18.79836201173243, "cost1_mean": 182.19086593644133, "cost2_max": -58.59889242916413, "cost1_max": 222.04895439072286, "cost2_mean": -121.00423771057599, "outflow_rate_min": 817.4203366729187, "system_level_velocity_min": 11.959654669967218, "cost2_min": -139.28459572965392, "outflow_rate_mean": 1229.3803802167565, "cost1_min": 84.62585801462866, "system_level_velocity_mean": 15.364564036895466, "outflow_rate_max": 1446.0961711502785}, "num_metric_batches_dropped": 0, "episode_reward_min": -865.6265663908862}
{"timesteps_this_iter": 43293, "episodes_total": 1753, "timesteps_since_restore": 1599379, "policy_reward_mean": {}, "timesteps_total": 1599379, "training_iteration": 38, "episode_reward_max": -301.6716450003562, "pid": 1094, "time_this_iter_s": 32.23495674133301, "time_total_s": 1187.7845120429993, "episodes_this_iter": 42, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 38, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11945.135, "update_time_ms": 8.842, "sample_time_ms": 20377.544, "num_steps_trained": 1599379, "load_time_ms": 24.199, "default": {"vf_loss": 25.454490661621094, "cur_kl_coeff": 0.07499998807907104, "policy_loss": -0.00765072088688612, "total_loss": 25.448213577270508, "cur_lr": 0.0005000000237487257, "kl": 0.01827218197286129, "vf_explained_var": 0.8564413189888, "entropy": 1.1476764678955078}, "num_steps_sampled": 1599379}, "hostname": "flow-main", "date": "2019-05-24_05-26-48", "episode_reward_mean": -547.1898162446722, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5080>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5208>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1187.7845120429993, "timestamp": 1558675608, "custom_metrics": {"system_level_velocity_max": 18.766117933478775, "cost1_mean": 184.54289004932474, "cost2_max": -58.59889242916413, "cost1_max": 222.0183040014391, "cost2_mean": -122.16588015381595, "outflow_rate_min": 922.6490454545456, "system_level_velocity_min": 11.941167545196807, "cost2_min": -139.28459572965392, "outflow_rate_mean": 1235.9404724399562, "cost1_min": 141.0559521015491, "system_level_velocity_mean": 15.37137795609344, "outflow_rate_max": 1442.5899112300363}, "num_metric_batches_dropped": 0, "episode_reward_min": -829.2935553226962}
{"timesteps_this_iter": 43578, "episodes_total": 1802, "timesteps_since_restore": 1642957, "policy_reward_mean": {}, "timesteps_total": 1642957, "training_iteration": 39, "episode_reward_max": -189.67154743872533, "pid": 1094, "time_this_iter_s": 33.465574741363525, "time_total_s": 1221.2500867843628, "episodes_this_iter": 49, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 39, "episode_len_mean": 323.82, "info": {"grad_time_ms": 11991.259, "update_time_ms": 8.74, "sample_time_ms": 20381.974, "num_steps_trained": 1642957, "load_time_ms": 24.61, "default": {"vf_loss": 25.35779571533203, "cur_kl_coeff": 0.07499998807907104, "policy_loss": -0.0083213085308671, "total_loss": 25.35076332092285, "cur_lr": 0.0005000000237487257, "kl": 0.017201803624629974, "vf_explained_var": 0.8586027026176453, "entropy": 1.1497317552566528}, "num_steps_sampled": 1642957}, "hostname": "flow-main", "date": "2019-05-24_05-27-21", "episode_reward_mean": -545.1779993217667, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6430f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb643f98>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb643240>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1221.2500867843628, "timestamp": 1558675641, "custom_metrics": {"system_level_velocity_max": 18.747114478790145, "cost1_mean": 182.47273772447843, "cost2_max": -54.59876301330213, "cost1_max": 222.23011773044024, "cost2_mean": -119.68241604132304, "outflow_rate_min": 888.3604415465759, "system_level_velocity_min": 11.710451544460918, "cost2_min": -138.99387207836463, "outflow_rate_mean": 1224.7605785353412, "cost1_min": 139.2850530201538, "system_level_velocity_mean": 15.283562755658725, "outflow_rate_max": 1449.654676332072}, "num_metric_batches_dropped": 0, "episode_reward_min": -885.7700027562648}
{"timesteps_this_iter": 42688, "episodes_total": 1850, "timesteps_since_restore": 1685645, "policy_reward_mean": {}, "timesteps_total": 1685645, "training_iteration": 40, "episode_reward_max": -189.67154743872533, "pid": 1094, "time_this_iter_s": 31.347374200820923, "time_total_s": 1252.5974609851837, "episodes_this_iter": 48, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 40, "episode_len_mean": 323.82, "info": {"grad_time_ms": 11846.536, "update_time_ms": 8.804, "sample_time_ms": 20150.085, "num_steps_trained": 1685645, "load_time_ms": 24.844, "default": {"vf_loss": 22.46637535095215, "cur_kl_coeff": 0.07499999552965164, "policy_loss": -0.008070945739746094, "total_loss": 22.45960235595703, "cur_lr": 0.0005000000237487257, "kl": 0.017309464514255524, "vf_explained_var": 0.8772742748260498, "entropy": 1.1297147274017334}, "num_steps_sampled": 1685645}, "hostname": "flow-main", "date": "2019-05-24_05-27-52", "episode_reward_mean": -543.6184750919031, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb643e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da588>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb643630>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1252.5974609851837, "timestamp": 1558675672, "custom_metrics": {"system_level_velocity_max": 18.79470030368973, "cost1_mean": 182.6491696002417, "cost2_max": -54.59876301330213, "cost1_max": 222.98070456964234, "cost2_mean": -119.20740948233153, "outflow_rate_min": 888.3604415465759, "system_level_velocity_min": 11.518816533623582, "cost2_min": -138.309187597914, "outflow_rate_mean": 1225.6531233117457, "cost1_min": 136.55753245545202, "system_level_velocity_mean": 15.299905550310129, "outflow_rate_max": 1449.654676332072}, "num_metric_batches_dropped": 0, "episode_reward_min": -896.8110096876783}
{"timesteps_this_iter": 43668, "episodes_total": 1894, "timesteps_since_restore": 1729313, "policy_reward_mean": {}, "timesteps_total": 1729313, "training_iteration": 41, "episode_reward_max": -31.0154461579426, "pid": 1094, "time_this_iter_s": 32.27267026901245, "time_total_s": 1284.8701312541962, "episodes_this_iter": 44, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 41, "episode_len_mean": 320.92, "info": {"grad_time_ms": 11672.479, "update_time_ms": 8.457, "sample_time_ms": 20391.691, "num_steps_trained": 1729313, "load_time_ms": 24.577, "default": {"vf_loss": 23.33126449584961, "cur_kl_coeff": 0.07499998807907104, "policy_loss": -0.008277363143861294, "total_loss": 23.324386596679688, "cur_lr": 0.0005000000237487257, "kl": 0.018669357523322105, "vf_explained_var": 0.8754143714904785, "entropy": 1.1193983554840088}, "num_steps_sampled": 1729313}, "hostname": "flow-main", "date": "2019-05-24_05-28-25", "episode_reward_mean": -541.4618670898516, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb643550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb643d68>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb643cf8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1284.8701312541962, "timestamp": 1558675705, "custom_metrics": {"system_level_velocity_max": 18.79470030368973, "cost1_mean": 181.90335355455386, "cost2_max": -23.334669186800408, "cost1_max": 222.98070456964234, "cost2_mean": -119.56691234250673, "outflow_rate_min": 509.94648962732464, "system_level_velocity_min": 11.518816533623582, "cost2_min": -138.309187597914, "outflow_rate_mean": 1225.9519805804632, "cost1_min": 23.065103441320392, "system_level_velocity_mean": 15.405214186361098, "outflow_rate_max": 1447.497633688841}, "num_metric_batches_dropped": 0, "episode_reward_min": -896.8110096876783}
{"timesteps_this_iter": 42781, "episodes_total": 1937, "timesteps_since_restore": 1772094, "policy_reward_mean": {}, "timesteps_total": 1772094, "training_iteration": 42, "episode_reward_max": -31.0154461579426, "pid": 1094, "time_this_iter_s": 32.153440952301025, "time_total_s": 1317.0235722064972, "episodes_this_iter": 43, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 42, "episode_len_mean": 318.84, "info": {"grad_time_ms": 11511.308, "update_time_ms": 8.269, "sample_time_ms": 20663.617, "num_steps_trained": 1772094, "load_time_ms": 25.753, "default": {"vf_loss": 21.60500144958496, "cur_kl_coeff": 0.07499998807907104, "policy_loss": -0.009359155781567097, "total_loss": 21.597206115722656, "cur_lr": 0.0005000000237487257, "kl": 0.02086016722023487, "vf_explained_var": 0.886256992816925, "entropy": 1.09490168094635}, "num_steps_sampled": 1772094}, "hostname": "flow-main", "date": "2019-05-24_05-28-57", "episode_reward_mean": -523.3910109101209, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8dab00>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da080>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1317.0235722064972, "timestamp": 1558675737, "custom_metrics": {"system_level_velocity_max": 18.788214903728765, "cost1_mean": 182.0359396659162, "cost2_max": -23.334669186800408, "cost1_max": 223.1600161155663, "cost2_mean": -117.79368181256923, "outflow_rate_min": 509.94648962732464, "system_level_velocity_min": 12.206161794487441, "cost2_min": -137.51920062602397, "outflow_rate_mean": 1224.6903515482609, "cost1_min": 23.065103441320392, "system_level_velocity_mean": 15.537307251402021, "outflow_rate_max": 1447.497633688841}, "num_metric_batches_dropped": 0, "episode_reward_min": -812.5226221317189}
{"timesteps_this_iter": 44598, "episodes_total": 1993, "timesteps_since_restore": 1816692, "policy_reward_mean": {}, "timesteps_total": 1816692, "training_iteration": 43, "episode_reward_max": -31.63891965901662, "pid": 1094, "time_this_iter_s": 34.60960793495178, "time_total_s": 1351.633180141449, "episodes_this_iter": 56, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 43, "episode_len_mean": 317.12, "info": {"grad_time_ms": 11479.84, "update_time_ms": 8.088, "sample_time_ms": 20822.248, "num_steps_trained": 1816692, "load_time_ms": 25.429, "default": {"vf_loss": 23.177352905273438, "cur_kl_coeff": 0.11250000447034836, "policy_loss": -0.00709629338234663, "total_loss": 23.172161102294922, "cur_lr": 0.0005000000237487257, "kl": 0.01693565957248211, "vf_explained_var": 0.8802269101142883, "entropy": 1.0935325622558594}, "num_steps_sampled": 1816692}, "hostname": "flow-main", "date": "2019-05-24_05-29-32", "episode_reward_mean": -546.7718315491884, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac5c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac2e8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3aceb8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1351.633180141449, "timestamp": 1558675772, "custom_metrics": {"system_level_velocity_max": 18.774148052362932, "cost1_mean": 177.84813594906623, "cost2_max": -22.529824690543332, "cost1_max": 223.1600161155663, "cost2_mean": -119.49881962449705, "outflow_rate_min": 487.083028155039, "system_level_velocity_min": 12.076402470352733, "cost2_min": -140.32426922504206, "outflow_rate_mean": 1205.915677188397, "cost1_min": 22.846580976389962, "system_level_velocity_mean": 15.275484066949065, "outflow_rate_max": 1446.3178327442427}, "num_metric_batches_dropped": 0, "episode_reward_min": -847.2274235616205}
{"timesteps_this_iter": 43377, "episodes_total": 2036, "timesteps_since_restore": 1860069, "policy_reward_mean": {}, "timesteps_total": 1860069, "training_iteration": 44, "episode_reward_max": -31.63891965901662, "pid": 1094, "time_this_iter_s": 26.410666704177856, "time_total_s": 1378.0438468456268, "episodes_this_iter": 43, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 44, "episode_len_mean": 318.02, "info": {"grad_time_ms": 11330.39, "update_time_ms": 8.053, "sample_time_ms": 20433.801, "num_steps_trained": 1860069, "load_time_ms": 24.807, "default": {"vf_loss": 24.907438278198242, "cur_kl_coeff": 0.11250000447034836, "policy_loss": -0.007128843106329441, "total_loss": 24.902259826660156, "cur_lr": 0.0005000000237487257, "kl": 0.017353253439068794, "vf_explained_var": 0.8724177479743958, "entropy": 1.0937433242797852}, "num_steps_sampled": 1860069}, "hostname": "flow-main", "date": "2019-05-24_05-29-58", "episode_reward_mean": -560.8560210701105, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c45c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4438>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4550>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1378.0438468456268, "timestamp": 1558675798, "custom_metrics": {"system_level_velocity_max": 18.84145432160515, "cost1_mean": 178.59237695744588, "cost2_max": -22.529824690543332, "cost1_max": 223.69973297985902, "cost2_mean": -121.68114962579759, "outflow_rate_min": 487.083028155039, "system_level_velocity_min": 12.076402470352733, "cost2_min": -140.32426922504206, "outflow_rate_mean": 1209.313850608775, "cost1_min": 22.846580976389962, "system_level_velocity_mean": 15.31777215114492, "outflow_rate_max": 1446.3178327442427}, "num_metric_batches_dropped": 0, "episode_reward_min": -847.2274235616205}
{"timesteps_this_iter": 44214, "episodes_total": 2081, "timesteps_since_restore": 1904283, "policy_reward_mean": {}, "timesteps_total": 1904283, "training_iteration": 45, "episode_reward_max": -31.63891965901662, "pid": 1094, "time_this_iter_s": 28.0957510471344, "time_total_s": 1406.1395978927612, "episodes_this_iter": 45, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 45, "episode_len_mean": 318.75, "info": {"grad_time_ms": 11214.288, "update_time_ms": 7.707, "sample_time_ms": 20207.797, "num_steps_trained": 1904283, "load_time_ms": 24.805, "default": {"vf_loss": 23.776554107666016, "cur_kl_coeff": 0.11249999701976776, "policy_loss": -0.0064225466921925545, "total_loss": 23.771947860717773, "cur_lr": 0.0005000000237487257, "kl": 0.01614261046051979, "vf_explained_var": 0.8749462366104126, "entropy": 1.0843161344528198}, "num_steps_sampled": 1904283}, "hostname": "flow-main", "date": "2019-05-24_05-30-26", "episode_reward_mean": -550.1008782846832, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6836d8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3acdd8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1406.1395978927612, "timestamp": 1558675826, "custom_metrics": {"system_level_velocity_max": 18.849989616903734, "cost1_mean": 181.69106594218053, "cost2_max": -23.9717744862927, "cost1_max": 223.7415932342286, "cost2_mean": -121.92658354154253, "outflow_rate_min": 509.9464896273245, "system_level_velocity_min": 12.080836563352179, "cost2_min": -142.9527706269064, "outflow_rate_mean": 1226.210434534572, "cost1_min": 22.846580976389962, "system_level_velocity_mean": 15.553029569378047, "outflow_rate_max": 1447.287419350305}, "num_metric_batches_dropped": 0, "episode_reward_min": -847.2274235616205}
{"timesteps_this_iter": 44400, "episodes_total": 2132, "timesteps_since_restore": 1948683, "policy_reward_mean": {}, "timesteps_total": 1948683, "training_iteration": 46, "episode_reward_max": -189.32868405329697, "pid": 1094, "time_this_iter_s": 28.292301416397095, "time_total_s": 1434.4318993091583, "episodes_this_iter": 51, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 46, "episode_len_mean": 321.65, "info": {"grad_time_ms": 11025.66, "update_time_ms": 7.585, "sample_time_ms": 19890.796, "num_steps_trained": 1948683, "load_time_ms": 25.83, "default": {"vf_loss": 18.512571334838867, "cur_kl_coeff": 0.11249999701976776, "policy_loss": -0.008798660710453987, "total_loss": 18.505769729614258, "cur_lr": 0.0005000000237487257, "kl": 0.01776552014052868, "vf_explained_var": 0.8987866640090942, "entropy": 1.0801697969436646}, "num_steps_sampled": 1948683}, "hostname": "flow-main", "date": "2019-05-24_05-30-54", "episode_reward_mean": -564.8242424223823, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c47f0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4c18>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1434.4318993091583, "timestamp": 1558675854, "custom_metrics": {"system_level_velocity_max": 18.849989616903734, "cost1_mean": 181.01656636875788, "cost2_max": -82.42878378087255, "cost1_max": 223.7415932342286, "cost2_mean": -122.82450281705016, "outflow_rate_min": 1059.828092769366, "system_level_velocity_min": 11.827005047731406, "cost2_min": -142.9527706269064, "outflow_rate_mean": 1226.7233150271077, "cost1_min": 137.72275747958096, "system_level_velocity_mean": 15.313512508793291, "outflow_rate_max": 1447.287419350305}, "num_metric_batches_dropped": 0, "episode_reward_min": -826.0326580239051}
{"timesteps_this_iter": 42866, "episodes_total": 2178, "timesteps_since_restore": 1991549, "policy_reward_mean": {}, "timesteps_total": 1991549, "training_iteration": 47, "episode_reward_max": -25.00254092600104, "pid": 1094, "time_this_iter_s": 27.179473876953125, "time_total_s": 1461.6113731861115, "episodes_this_iter": 46, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 47, "episode_len_mean": 316.76, "info": {"grad_time_ms": 10928.341, "update_time_ms": 7.508, "sample_time_ms": 19558.423, "num_steps_trained": 1991549, "load_time_ms": 25.561, "default": {"vf_loss": 19.939754486083984, "cur_kl_coeff": 0.11250000447034836, "policy_loss": -0.009123759344220161, "total_loss": 19.932491302490234, "cur_lr": 0.0005000000237487257, "kl": 0.016542792320251465, "vf_explained_var": 0.8960171937942505, "entropy": 1.0641674995422363}, "num_steps_sampled": 1991549}, "hostname": "flow-main", "date": "2019-05-24_05-31-22", "episode_reward_mean": -551.9437614250116, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da3c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da630>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4470>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1461.6113731861115, "timestamp": 1558675882, "custom_metrics": {"system_level_velocity_max": 18.71112243131618, "cost1_mean": 176.61539004664795, "cost2_max": -21.36922750820708, "cost1_max": 221.93004743621384, "cost2_mean": -119.18207933631862, "outflow_rate_min": 437.2949997643919, "system_level_velocity_min": 11.827005047731406, "cost2_min": -139.2548178123402, "outflow_rate_mean": 1204.6986245076384, "cost1_min": 17.850344127477378, "system_level_velocity_mean": 15.207651559364926, "outflow_rate_max": 1448.2407109909122}, "num_metric_batches_dropped": 0, "episode_reward_min": -830.1790501224264}
{"timesteps_this_iter": 42126, "episodes_total": 2225, "timesteps_since_restore": 2033675, "policy_reward_mean": {}, "timesteps_total": 2033675, "training_iteration": 48, "episode_reward_max": -25.00254092600104, "pid": 1094, "time_this_iter_s": 27.50685477256775, "time_total_s": 1489.1182279586792, "episodes_this_iter": 47, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 48, "episode_len_mean": 316.85, "info": {"grad_time_ms": 10834.6, "update_time_ms": 7.579, "sample_time_ms": 19179.886, "num_steps_trained": 2033675, "load_time_ms": 25.325, "default": {"vf_loss": 24.141456604003906, "cur_kl_coeff": 0.11250000447034836, "policy_loss": -0.008319389075040817, "total_loss": 24.13511085510254, "cur_lr": 0.0005000000237487257, "kl": 0.0175431240350008, "vf_explained_var": 0.8740208148956299, "entropy": 1.0765981674194336}, "num_steps_sampled": 2033675}, "hostname": "flow-main", "date": "2019-05-24_05-31-49", "episode_reward_mean": -523.8839168700531, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4668>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4160>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1489.1182279586792, "timestamp": 1558675909, "custom_metrics": {"system_level_velocity_max": 18.729064200923784, "cost1_mean": 179.97805525359706, "cost2_max": -21.36922750820708, "cost1_max": 222.45899130286057, "cost2_mean": -116.46695245185244, "outflow_rate_min": 437.2949997643919, "system_level_velocity_min": 11.709009531830782, "cost2_min": -138.7831614228622, "outflow_rate_mean": 1216.7212642732434, "cost1_min": 17.850344127477378, "system_level_velocity_mean": 15.500515740557107, "outflow_rate_max": 1448.2407109909122}, "num_metric_batches_dropped": 0, "episode_reward_min": -830.1790501224264}
{"timesteps_this_iter": 42343, "episodes_total": 2270, "timesteps_since_restore": 2076018, "policy_reward_mean": {}, "timesteps_total": 2076018, "training_iteration": 49, "episode_reward_max": -31.06543242574056, "pid": 1094, "time_this_iter_s": 27.977524042129517, "time_total_s": 1517.0957520008087, "episodes_this_iter": 45, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 49, "episode_len_mean": 321.01, "info": {"grad_time_ms": 10732.143, "update_time_ms": 7.527, "sample_time_ms": 18734.041, "num_steps_trained": 2076018, "load_time_ms": 25.031, "default": {"vf_loss": 24.591106414794922, "cur_kl_coeff": 0.11249999701976776, "policy_loss": -0.010443029925227165, "total_loss": 24.5826416015625, "cur_lr": 0.0005000000237487257, "kl": 0.017582708969712257, "vf_explained_var": 0.8716234564781189, "entropy": 1.081377387046814}, "num_steps_sampled": 2076018}, "hostname": "flow-main", "date": "2019-05-24_05-32-17", "episode_reward_mean": -521.6075375634686, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c47b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c45f8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c46d8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1517.0957520008087, "timestamp": 1558675937, "custom_metrics": {"system_level_velocity_max": 18.961675163817407, "cost1_mean": 181.77964694644413, "cost2_max": -24.095599367557348, "cost1_max": 222.45899130286057, "cost2_mean": -114.47326017730133, "outflow_rate_min": 503.0853896324088, "system_level_velocity_min": 9.937400394560166, "cost2_min": -138.03198740882425, "outflow_rate_mean": 1221.7077598230148, "cost1_min": 23.285612863545573, "system_level_velocity_mean": 15.42025485683827, "outflow_rate_max": 1446.397633688841}, "num_metric_batches_dropped": 0, "episode_reward_min": -812.7752821397014}
{"timesteps_this_iter": 41684, "episodes_total": 2320, "timesteps_since_restore": 2117702, "policy_reward_mean": {}, "timesteps_total": 2117702, "training_iteration": 50, "episode_reward_max": -31.06543242574056, "pid": 1094, "time_this_iter_s": 27.053587198257446, "time_total_s": 1544.1493391990662, "episodes_this_iter": 50, "experiment_id": "8b0c13efdf3a4f87bed501524f3d31a2", "iterations_since_restore": 50, "episode_len_mean": 320.02, "info": {"grad_time_ms": 10665.66, "update_time_ms": 7.32, "sample_time_ms": 18371.382, "num_steps_trained": 2117702, "load_time_ms": 25.209, "default": {"vf_loss": 24.921756744384766, "cur_kl_coeff": 0.11249999701976776, "policy_loss": -0.009907174855470657, "total_loss": 24.91390609741211, "cur_lr": 0.0005000000237487257, "kl": 0.018284503370523453, "vf_explained_var": 0.868824303150177, "entropy": 1.080336570739746}, "num_steps_sampled": 2117702}, "hostname": "flow-main", "date": "2019-05-24_05-32-44", "episode_reward_mean": -520.7936506089545, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4748>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c40b8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "output": null, "num_workers": 20, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "lambda": 0.97, "tf_session_args": {"inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "allow_soft_placement": true, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2}, "log_level": "INFO", "use_gae": true, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "straggler_mitigation": false, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": true, "node_ip": "10.138.0.2", "time_since_restore": 1544.1493391990662, "timestamp": 1558675964, "custom_metrics": {"system_level_velocity_max": 18.961675163817407, "cost1_mean": 179.80970626476812, "cost2_max": -24.095599367557348, "cost1_max": 218.46103595549982, "cost2_mean": -113.00277431749775, "outflow_rate_min": 503.0853896324088, "system_level_velocity_min": 9.937400394560166, "cost2_min": -138.03198740882425, "outflow_rate_mean": 1214.510728150379, "cost1_min": 23.285612863545573, "system_level_velocity_mean": 15.287008751377936, "outflow_rate_max": 1440.7147371400683}, "num_metric_batches_dropped": 0, "episode_reward_min": -821.1909179906145}

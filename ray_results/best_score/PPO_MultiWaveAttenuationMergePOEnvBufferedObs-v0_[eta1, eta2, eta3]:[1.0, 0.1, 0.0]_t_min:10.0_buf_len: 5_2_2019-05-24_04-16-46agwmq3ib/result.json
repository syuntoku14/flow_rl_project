{"timesteps_this_iter": 42173, "episodes_total": 40, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 42173, "training_iteration": 1, "episode_reward_max": -521.9401390970106, "pid": 314, "time_this_iter_s": 57.931254386901855, "time_total_s": 57.931254386901855, "episodes_this_iter": 40, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 1, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11802.884, "update_time_ms": 1230.215, "sample_time_ms": 44655.875, "num_steps_trained": 42173, "load_time_ms": 82.077, "default": {"vf_loss": 35.75212478637695, "cur_kl_coeff": 0.20000000298023224, "entropy": 1.4196327924728394, "total_loss": 35.75271224975586, "cur_lr": 0.0005000000237487257, "kl": 0.000308448652504012, "vf_explained_var": -1.1553155445653829e-06, "policy_loss": 0.0005255340365692973}, "num_steps_sampled": 42173}, "hostname": "flow-main", "date": "2019-05-24_04-18-24", "episode_reward_mean": -724.8753953565489, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c46d8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8c4710>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 57.931254386901855, "timestamp": 1558671504, "custom_metrics": {"system_level_velocity_max": 11.57886273390252, "cost1_mean": 122.87170664041214, "cost1_min": 100.09539454682627, "outflow_rate_min": 415.46557377049197, "cost2_mean": -48.043806260004075, "cost1_max": 141.15580375320894, "system_level_velocity_min": 8.49067352257823, "cost2_min": -82.61189148486076, "outflow_rate_mean": 726.9518025676673, "cost2_max": -26.17387836350525, "system_level_velocity_mean": 10.194761175908122, "outflow_rate_max": 914.0607122774131}, "timesteps_since_restore": 42173, "episode_reward_min": -1007.4261295011333}
{"timesteps_this_iter": 42162, "episodes_total": 80, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 84335, "training_iteration": 2, "episode_reward_max": -464.00723919041263, "pid": 314, "time_this_iter_s": 29.39739489555359, "time_total_s": 87.32864928245544, "episodes_this_iter": 40, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 2, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10258.23, "update_time_ms": 619.349, "sample_time_ms": 32615.3, "num_steps_trained": 84335, "load_time_ms": 49.417, "default": {"vf_loss": 61.47340393066406, "cur_kl_coeff": 0.10000000149011612, "entropy": 1.422907829284668, "total_loss": 61.47274398803711, "cur_lr": 0.0005000000237487257, "kl": 0.0032281947787851095, "vf_explained_var": 0.0018236972391605377, "policy_loss": -0.0009842863073572516}, "num_steps_sampled": 84335}, "hostname": "flow-main", "date": "2019-05-24_04-18-53", "episode_reward_mean": -713.05335274325, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e14a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1438>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1470>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 87.32864928245544, "timestamp": 1558671533, "custom_metrics": {"system_level_velocity_max": 12.932502920906439, "cost1_mean": 124.56426313128945, "cost1_min": 100.09539454682627, "outflow_rate_min": 415.46557377049197, "cost2_mean": -48.17606224847189, "cost1_max": 155.45796420571153, "system_level_velocity_min": 8.460750772285293, "cost2_min": -82.61189148486076, "outflow_rate_mean": 734.0556159917978, "cost2_max": -26.17387836350525, "system_level_velocity_mean": 10.346108458077271, "outflow_rate_max": 957.4753320683111}, "timesteps_since_restore": 84335, "episode_reward_min": -1084.8502145844875}
{"timesteps_this_iter": 43577, "episodes_total": 120, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 127912, "training_iteration": 3, "episode_reward_max": -410.370356492631, "pid": 314, "time_this_iter_s": 30.090461254119873, "time_total_s": 117.41911053657532, "episodes_this_iter": 40, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 3, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10237.178, "update_time_ms": 415.599, "sample_time_ms": 28321.623, "num_steps_trained": 127912, "load_time_ms": 42.414, "default": {"vf_loss": 88.5445327758789, "cur_kl_coeff": 0.050000011920928955, "entropy": 1.408096194267273, "total_loss": 88.54356384277344, "cur_lr": 0.0005000000237487257, "kl": 0.004965202417224646, "vf_explained_var": -2.2965318535739243e-08, "policy_loss": -0.0012155798031017184}, "num_steps_sampled": 127912}, "hostname": "flow-main", "date": "2019-05-24_04-19-23", "episode_reward_mean": -692.0752897319118, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8daa90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8daef0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8daa58>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 117.41911053657532, "timestamp": 1558671563, "custom_metrics": {"system_level_velocity_max": 14.361534165737321, "cost1_mean": 132.26134110938168, "cost1_min": 100.97758956249302, "outflow_rate_min": 415.46557377049197, "cost2_mean": -55.072573601720066, "cost1_max": 175.91776905634526, "system_level_velocity_min": 8.460750772285293, "cost2_min": -107.28430597943952, "outflow_rate_mean": 793.1946336708107, "cost2_max": -27.328081537105046, "system_level_velocity_mean": 10.95463463655474, "outflow_rate_max": 1162.0516809055334}, "timesteps_since_restore": 127912, "episode_reward_min": -1084.8502145844875}
{"timesteps_this_iter": 41666, "episodes_total": 180, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 169578, "training_iteration": 4, "episode_reward_max": -410.370356492631, "pid": 314, "time_this_iter_s": 33.036738872528076, "time_total_s": 150.4558494091034, "episodes_this_iter": 60, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 4, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10428.843, "update_time_ms": 314.201, "sample_time_ms": 26715.311, "num_steps_trained": 169578, "load_time_ms": 38.176, "default": {"vf_loss": 110.5842514038086, "cur_kl_coeff": 0.025000005960464478, "entropy": 1.4010581970214844, "total_loss": 110.58255767822266, "cur_lr": 0.0005000000237487257, "kl": 0.007453506346791983, "vf_explained_var": -2.5125650893187412e-08, "policy_loss": -0.0018846038728952408}, "num_steps_sampled": 169578}, "hostname": "flow-main", "date": "2019-05-24_04-19-56", "episode_reward_mean": -608.3398725495471, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1b00>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e15c0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 150.4558494091034, "timestamp": 1558671596, "custom_metrics": {"system_level_velocity_max": 14.969195898935144, "cost1_mean": 152.49261426179157, "cost1_min": 107.38297779781637, "outflow_rate_min": 701.2329350649353, "cost2_mean": -68.79315343628787, "cost1_max": 183.5131427785342, "system_level_velocity_min": 8.778224028401683, "cost2_min": -118.64963758954718, "outflow_rate_mean": 970.0766636378166, "cost2_max": -32.11471961418795, "system_level_velocity_mean": 12.586133849066314, "outflow_rate_max": 1174.9990030759025}, "timesteps_since_restore": 169578, "episode_reward_min": -979.3301708190918}
{"timesteps_this_iter": 39688, "episodes_total": 220, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 209266, "training_iteration": 5, "episode_reward_max": -415.5508858959478, "pid": 314, "time_this_iter_s": 29.639865159988403, "time_total_s": 180.0957145690918, "episodes_this_iter": 40, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 5, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10584.42, "update_time_ms": 253.527, "sample_time_ms": 25036.4, "num_steps_trained": 209266, "load_time_ms": 35.268, "default": {"vf_loss": 96.5162582397461, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.3918403387069702, "total_loss": 96.51577758789062, "cur_lr": 0.0005000000237487257, "kl": 0.004946972709149122, "vf_explained_var": -2.1150035056649585e-09, "policy_loss": -0.0006021734443493187}, "num_steps_sampled": 209266}, "hostname": "flow-main", "date": "2019-05-24_04-20-26", "episode_reward_mean": -553.2933497686258, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb550>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb1d0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 180.0957145690918, "timestamp": 1558671626, "custom_metrics": {"system_level_velocity_max": 15.35251515674806, "cost1_mean": 162.088137049927, "cost1_min": 108.18437995090832, "outflow_rate_min": 749.0302834008096, "cost2_mean": -69.76357175582878, "cost1_max": 184.30022558630912, "system_level_velocity_min": 8.778224028401683, "cost2_min": -118.64963758954718, "outflow_rate_mean": 1049.1006251612805, "cost2_max": -41.501908774180855, "system_level_velocity_mean": 13.390906069113209, "outflow_rate_max": 1188.2252257308494}, "timesteps_since_restore": 209266, "episode_reward_min": -979.3301708190918}
{"timesteps_this_iter": 42208, "episodes_total": 260, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 251474, "training_iteration": 6, "episode_reward_max": -411.5999499317813, "pid": 314, "time_this_iter_s": 31.04708957672119, "time_total_s": 211.142804145813, "episodes_this_iter": 40, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 6, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10907.359, "update_time_ms": 212.91, "sample_time_ms": 23929.718, "num_steps_trained": 251474, "load_time_ms": 34.444, "default": {"vf_loss": 37.23052215576172, "cur_kl_coeff": 0.012500000186264515, "entropy": 1.3832160234451294, "total_loss": 37.22871017456055, "cur_lr": 0.0005000000237487257, "kl": 0.010489131323993206, "vf_explained_var": 0.6140804290771484, "policy_loss": -0.0019397677388042212}, "num_steps_sampled": 251474}, "hostname": "flow-main", "date": "2019-05-24_04-20-57", "episode_reward_mean": -534.8649187485017, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1be0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1cf8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 211.142804145813, "timestamp": 1558671657, "custom_metrics": {"system_level_velocity_max": 16.059494908957678, "cost1_mean": 166.61217787374414, "cost1_min": 108.34456129372907, "outflow_rate_min": 749.0302834008096, "cost2_mean": -74.31966173529567, "cost1_max": 195.10399798537003, "system_level_velocity_min": 8.900300560187496, "cost2_min": -118.64963758954718, "outflow_rate_mean": 1086.2595513345484, "cost2_max": -42.43208804396488, "system_level_velocity_mean": 13.746881554723156, "outflow_rate_max": 1257.716393728223}, "timesteps_since_restore": 251474, "episode_reward_min": -860.2366636288527}
{"timesteps_this_iter": 40722, "episodes_total": 320, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 292196, "training_iteration": 7, "episode_reward_max": -411.5999499317813, "pid": 314, "time_this_iter_s": 31.25840735435486, "time_total_s": 242.40121150016785, "episodes_this_iter": 60, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 7, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11025.948, "update_time_ms": 183.994, "sample_time_ms": 23280.497, "num_steps_trained": 292196, "load_time_ms": 33.285, "default": {"vf_loss": 41.89638137817383, "cur_kl_coeff": 0.012500002980232239, "entropy": 1.366429090499878, "total_loss": 41.8942756652832, "cur_lr": 0.0005000000237487257, "kl": 0.012535957619547844, "vf_explained_var": 0.7199203968048096, "policy_loss": -0.0022616859059780836}, "num_steps_sampled": 292196}, "hostname": "flow-main", "date": "2019-05-24_04-21-28", "episode_reward_mean": -518.3843919411349, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da978>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da748>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 242.40121150016785, "timestamp": 1558671688, "custom_metrics": {"system_level_velocity_max": 16.107501209797263, "cost1_mean": 172.00537052647218, "cost1_min": 138.1735669021287, "outflow_rate_min": 872.5885714285713, "cost2_mean": -81.04485671198101, "cost1_max": 195.10399798537003, "system_level_velocity_min": 11.34195958766997, "cost2_min": -116.30838343571372, "outflow_rate_mean": 1132.2226740138494, "cost2_max": -45.60162217311759, "system_level_velocity_mean": 14.165698682951142, "outflow_rate_max": 1257.716393728223}, "timesteps_since_restore": 292196, "episode_reward_min": -860.2366636288527}
{"timesteps_this_iter": 41377, "episodes_total": 360, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 333573, "training_iteration": 8, "episode_reward_max": -356.21181143292233, "pid": 314, "time_this_iter_s": 29.71607780456543, "time_total_s": 272.1172893047333, "episodes_this_iter": 40, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 8, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11076.348, "update_time_ms": 162.152, "sample_time_ms": 22640.054, "num_steps_trained": 333573, "load_time_ms": 32.602, "default": {"vf_loss": 29.126251220703125, "cur_kl_coeff": 0.01250000111758709, "entropy": 1.359568476676941, "total_loss": 29.123376846313477, "cur_lr": 0.0005000000237487257, "kl": 0.012175100855529308, "vf_explained_var": 0.8157160878181458, "policy_loss": -0.0030262754298746586}, "num_steps_sampled": 333573}, "hostname": "flow-main", "date": "2019-05-24_04-21-58", "episode_reward_mean": -508.97377697899867, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1278>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e17f0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 272.1172893047333, "timestamp": 1558671718, "custom_metrics": {"system_level_velocity_max": 17.02062577533933, "cost1_mean": 175.49246699043198, "cost1_min": 119.5793669611917, "outflow_rate_min": 875.6110041407869, "cost2_mean": -85.49923377090576, "cost1_max": 203.5837072786179, "system_level_velocity_min": 9.772002926843788, "cost2_min": -114.99502764100322, "outflow_rate_mean": 1160.6981499743406, "cost2_max": -48.84278410993008, "system_level_velocity_mean": 14.463694474420725, "outflow_rate_max": 1321.272092300906}, "timesteps_since_restore": 333573, "episode_reward_min": -901.3603367285398}
{"timesteps_this_iter": 41399, "episodes_total": 400, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 374972, "training_iteration": 9, "episode_reward_max": -356.21181143292233, "pid": 314, "time_this_iter_s": 30.26428532600403, "time_total_s": 302.3815746307373, "episodes_this_iter": 40, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 9, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11128.501, "update_time_ms": 145.329, "sample_time_ms": 22190.19, "num_steps_trained": 374972, "load_time_ms": 30.836, "default": {"vf_loss": 28.26665687561035, "cur_kl_coeff": 0.01250000111758709, "entropy": 1.3578603267669678, "total_loss": 28.26434326171875, "cur_lr": 0.0005000000237487257, "kl": 0.009219761937856674, "vf_explained_var": 0.8203397989273071, "policy_loss": -0.002429539803415537}, "num_steps_sampled": 374972}, "hostname": "flow-main", "date": "2019-05-24_04-22-28", "episode_reward_mean": -501.8089018976516, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb4a8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb978>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 302.3815746307373, "timestamp": 1558671748, "custom_metrics": {"system_level_velocity_max": 17.063255749754024, "cost1_mean": 178.84487627255947, "cost1_min": 119.5793669611917, "outflow_rate_min": 875.6110041407869, "cost2_mean": -90.8597837321255, "cost1_max": 203.5837072786179, "system_level_velocity_min": 9.772002926843788, "cost2_min": -123.79415990456954, "outflow_rate_mean": 1182.5856805764124, "cost2_max": -48.84278410993008, "system_level_velocity_mean": 14.76251820956145, "outflow_rate_max": 1323.0741703601839}, "timesteps_since_restore": 374972, "episode_reward_min": -901.3603367285398}
{"timesteps_this_iter": 41385, "episodes_total": 460, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 416357, "training_iteration": 10, "episode_reward_max": -339.71765941789494, "pid": 314, "time_this_iter_s": 31.96110725402832, "time_total_s": 334.3426818847656, "episodes_this_iter": 60, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 10, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11213.164, "update_time_ms": 131.901, "sample_time_ms": 21956.343, "num_steps_trained": 416357, "load_time_ms": 29.734, "default": {"vf_loss": 30.926679611206055, "cur_kl_coeff": 0.01250000111758709, "entropy": 1.3521353006362915, "total_loss": 30.923791885375977, "cur_lr": 0.0005000000237487257, "kl": 0.008351453579962254, "vf_explained_var": 0.7924384474754333, "policy_loss": -0.0029907538555562496}, "num_steps_sampled": 416357}, "hostname": "flow-main", "date": "2019-05-24_04-23-00", "episode_reward_mean": -494.5699420258603, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8daf28>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da470>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 334.3426818847656, "timestamp": 1558671780, "custom_metrics": {"system_level_velocity_max": 17.38896902063215, "cost1_mean": 180.92160543427698, "cost1_min": 143.89230919030467, "outflow_rate_min": 1007.6023949279065, "cost2_mean": -95.33956058209675, "cost1_max": 207.70722868809747, "system_level_velocity_min": 11.800664965163994, "cost2_min": -132.19424484047605, "outflow_rate_mean": 1196.938618013491, "cost2_max": -54.920547965072174, "system_level_velocity_mean": 14.962235190049789, "outflow_rate_max": 1334.5557685064464}, "timesteps_since_restore": 416357, "episode_reward_min": -776.9119790728104}
{"timesteps_this_iter": 39400, "episodes_total": 500, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 455757, "training_iteration": 11, "episode_reward_max": -339.71765941789494, "pid": 314, "time_this_iter_s": 28.961127996444702, "time_total_s": 363.3038098812103, "episodes_this_iter": 40, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 11, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11196.02, "update_time_ms": 9.931, "sample_time_ms": 19211.554, "num_steps_trained": 455757, "load_time_ms": 24.522, "default": {"vf_loss": 19.218793869018555, "cur_kl_coeff": 0.012500002048909664, "entropy": 1.3346976041793823, "total_loss": 19.215524673461914, "cur_lr": 0.0005000000237487257, "kl": 0.01110709086060524, "vf_explained_var": 0.8602452278137207, "policy_loss": -0.003407250391319394}, "num_steps_sampled": 455757}, "hostname": "flow-main", "date": "2019-05-24_04-23-29", "episode_reward_mean": -485.9074902697861, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e12b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1470>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1198>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 363.3038098812103, "timestamp": 1558671809, "custom_metrics": {"system_level_velocity_max": 17.38896902063215, "cost1_mean": 181.08685853440224, "cost1_min": 144.39017331885617, "outflow_rate_min": 1011.3055175908308, "cost2_mean": -93.44254253326852, "cost1_max": 207.70722868809747, "system_level_velocity_min": 11.800664965163994, "cost2_min": -132.19424484047605, "outflow_rate_mean": 1201.6350361544698, "cost2_max": -53.376618725093955, "system_level_velocity_mean": 15.000583182797891, "outflow_rate_max": 1343.1611266161842}, "timesteps_since_restore": 455757, "episode_reward_min": -776.9119790728104}
{"timesteps_this_iter": 38063, "episodes_total": 541, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 493820, "training_iteration": 12, "episode_reward_max": -223.8052864944759, "pid": 314, "time_this_iter_s": 28.060957431793213, "time_total_s": 391.36476731300354, "episodes_this_iter": 41, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 12, "episode_len_mean": 323.93, "info": {"grad_time_ms": 11448.678, "update_time_ms": 9.96, "sample_time_ms": 18824.188, "num_steps_trained": 493820, "load_time_ms": 25.291, "default": {"vf_loss": 19.45941925048828, "cur_kl_coeff": 0.012500002048909664, "entropy": 1.3117218017578125, "total_loss": 19.455432891845703, "cur_lr": 0.0005000000237487257, "kl": 0.012108035385608673, "vf_explained_var": 0.8490291833877563, "policy_loss": -0.00413788016885519}, "num_steps_sampled": 493820}, "hostname": "flow-main", "date": "2019-05-24_04-23-57", "episode_reward_mean": -462.6538583989131, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebb70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1550>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e10f0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 391.36476731300354, "timestamp": 1558671837, "custom_metrics": {"system_level_velocity_max": 17.648066005971778, "cost1_mean": 181.1243931502421, "cost1_min": 138.1005788251465, "outflow_rate_min": 1011.3055175908308, "cost2_mean": -85.79238681919139, "cost1_max": 202.71813169025825, "system_level_velocity_min": 11.800664965163994, "cost2_min": -128.67702643646618, "outflow_rate_mean": 1193.3966932280894, "cost2_max": -53.376618725093955, "system_level_velocity_mean": 15.156327911690525, "outflow_rate_max": 1343.1611266161842}, "timesteps_since_restore": 493820, "episode_reward_min": -776.9119790728104}
{"timesteps_this_iter": 37440, "episodes_total": 600, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 531260, "training_iteration": 13, "episode_reward_max": -223.8052864944759, "pid": 314, "time_this_iter_s": 29.56537914276123, "time_total_s": 420.93014645576477, "episodes_this_iter": 59, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 13, "episode_len_mean": 323.93, "info": {"grad_time_ms": 11547.077, "update_time_ms": 10.116, "sample_time_ms": 18675.852, "num_steps_trained": 531260, "load_time_ms": 24.841, "default": {"vf_loss": 25.41358184814453, "cur_kl_coeff": 0.01250000111758709, "entropy": 1.3079699277877808, "total_loss": 25.411680221557617, "cur_lr": 0.0005000000237487257, "kl": 0.009453292936086655, "vf_explained_var": 0.798038125038147, "policy_loss": -0.0020182442385703325}, "num_steps_sampled": 531260}, "hostname": "flow-main", "date": "2019-05-24_04-24-27", "episode_reward_mean": -431.30400791289605, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eeef0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eec18>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 420.93014645576477, "timestamp": 1558671867, "custom_metrics": {"system_level_velocity_max": 17.648066005971778, "cost1_mean": 182.05426467665598, "cost1_min": 138.1005788251465, "outflow_rate_min": 1038.3941451990631, "cost2_mean": -76.65563929493436, "cost1_max": 202.48891203530215, "system_level_velocity_min": 12.777543174322918, "cost2_min": -108.74436950065132, "outflow_rate_mean": 1191.4829288927783, "cost2_max": -58.777185345975646, "system_level_velocity_mean": 15.3477547799582, "outflow_rate_max": 1313.34455489872}, "timesteps_since_restore": 531260, "episode_reward_min": -603.0274769628222}
{"timesteps_this_iter": 34770, "episodes_total": 641, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 566030, "training_iteration": 14, "episode_reward_max": -35.42337483429332, "pid": 314, "time_this_iter_s": 27.617308855056763, "time_total_s": 448.54745531082153, "episodes_this_iter": 41, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 14, "episode_len_mean": 318.76, "info": {"grad_time_ms": 11517.225, "update_time_ms": 10.12, "sample_time_ms": 18164.366, "num_steps_trained": 566030, "load_time_ms": 24.566, "default": {"vf_loss": 15.714594841003418, "cur_kl_coeff": 0.01250000111758709, "entropy": 1.2864991426467896, "total_loss": 15.7099609375, "cur_lr": 0.0005000000237487257, "kl": 0.010599041357636452, "vf_explained_var": 0.8630298972129822, "policy_loss": -0.00476567167788744}, "num_steps_sampled": 566030}, "hostname": "flow-main", "date": "2019-05-24_04-24-55", "episode_reward_mean": -409.0312358091294, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da860>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8dac88>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 448.54745531082153, "timestamp": 1558671895, "custom_metrics": {"system_level_velocity_max": 18.163883074329704, "cost1_mean": 178.08916700659938, "cost1_min": 23.850089739627748, "outflow_rate_min": 472.1492185913593, "cost2_mean": -69.48773279201458, "cost1_max": 201.6564415690765, "system_level_velocity_min": 12.409245470366843, "cost2_min": -108.74436950065132, "outflow_rate_mean": 1165.0420169783097, "cost2_max": -23.72068014143998, "system_level_velocity_mean": 15.359960729734146, "outflow_rate_max": 1294.9380004057227}, "timesteps_since_restore": 566030, "episode_reward_min": -583.8884078976484}
{"timesteps_this_iter": 34102, "episodes_total": 681, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 600132, "training_iteration": 15, "episode_reward_max": -35.42337483429332, "pid": 314, "time_this_iter_s": 25.073201417922974, "time_total_s": 473.6206567287445, "episodes_this_iter": 40, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 15, "episode_len_mean": 318.59, "info": {"grad_time_ms": 11269.915, "update_time_ms": 10.168, "sample_time_ms": 17955.81, "num_steps_trained": 600132, "load_time_ms": 24.357, "default": {"vf_loss": 14.603322982788086, "cur_kl_coeff": 0.01250000111758709, "entropy": 1.2668870687484741, "total_loss": 14.600486755371094, "cur_lr": 0.0005000000237487257, "kl": 0.010476508177816868, "vf_explained_var": 0.8641975522041321, "policy_loss": -0.0029684677720069885}, "num_steps_sampled": 600132}, "hostname": "flow-main", "date": "2019-05-24_04-25-20", "episode_reward_mean": -393.6702302306778, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1fd0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1cc0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 473.6206567287445, "timestamp": 1558671920, "custom_metrics": {"system_level_velocity_max": 18.163883074329704, "cost1_mean": 176.8594317245404, "cost1_min": 23.850089739627748, "outflow_rate_min": 472.1492185913593, "cost2_mean": -62.45877142978916, "cost1_max": 197.84551589365088, "system_level_velocity_min": 12.409245470366843, "cost2_min": -92.93734130229926, "outflow_rate_mean": 1143.5504487485591, "cost2_max": -23.72068014143998, "system_level_velocity_mean": 15.329072230496578, "outflow_rate_max": 1284.8546839310081}, "timesteps_since_restore": 600132, "episode_reward_min": -581.6392471453952}
{"timesteps_this_iter": 33520, "episodes_total": 725, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 633652, "training_iteration": 16, "episode_reward_max": -35.42337483429332, "pid": 314, "time_this_iter_s": 26.407475471496582, "time_total_s": 500.0281322002411, "episodes_this_iter": 44, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 16, "episode_len_mean": 318.59, "info": {"grad_time_ms": 10801.187, "update_time_ms": 10.247, "sample_time_ms": 17963.649, "num_steps_trained": 633652, "load_time_ms": 23.309, "default": {"vf_loss": 15.368094444274902, "cur_kl_coeff": 0.01250000111758709, "entropy": 1.2456080913543701, "total_loss": 15.363442420959473, "cur_lr": 0.0005000000237487257, "kl": 0.011300378479063511, "vf_explained_var": 0.8688376545906067, "policy_loss": -0.004793380852788687}, "num_steps_sampled": 633652}, "hostname": "flow-main", "date": "2019-05-24_04-25-46", "episode_reward_mean": -384.25488105563113, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e11d0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e12e8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 500.0281322002411, "timestamp": 1558671946, "custom_metrics": {"system_level_velocity_max": 18.163883074329704, "cost1_mean": 174.54106570892063, "cost1_min": 23.850089739627748, "outflow_rate_min": 472.1492185913593, "cost2_mean": -57.68610955034671, "cost1_max": 197.84551589365088, "system_level_velocity_min": 12.090130868376791, "cost2_min": -78.73753353910615, "outflow_rate_mean": 1120.4734443809991, "cost2_max": -23.72068014143998, "system_level_velocity_mean": 15.202762956094292, "outflow_rate_max": 1250.550802098377}, "timesteps_since_restore": 633652, "episode_reward_min": -581.6392471453952}
{"timesteps_this_iter": 33277, "episodes_total": 781, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 666929, "training_iteration": 17, "episode_reward_max": -318.5903309156233, "pid": 314, "time_this_iter_s": 27.384932041168213, "time_total_s": 527.4130642414093, "episodes_this_iter": 56, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 17, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10417.397, "update_time_ms": 9.943, "sample_time_ms": 17962.252, "num_steps_trained": 666929, "load_time_ms": 22.906, "default": {"vf_loss": 15.0576810836792, "cur_kl_coeff": 0.01250000111758709, "entropy": 1.2422971725463867, "total_loss": 15.05631160736084, "cur_lr": 0.0005000000237487257, "kl": 0.009730321355164051, "vf_explained_var": 0.8703947067260742, "policy_loss": -0.0014907608274370432}, "num_steps_sampled": 666929}, "hostname": "flow-main", "date": "2019-05-24_04-26-14", "episode_reward_mean": -384.8880470747622, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee710>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eef28>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 527.4130642414093, "timestamp": 1558671974, "custom_metrics": {"system_level_velocity_max": 16.88687381425415, "cost1_mean": 177.97295896026736, "cost1_min": 144.34833823688106, "outflow_rate_min": 972.1551753758051, "cost2_mean": -55.88352320735242, "cost1_max": 194.46938711439338, "system_level_velocity_min": 12.090130868376791, "cost2_min": -74.11107119382359, "outflow_rate_mean": 1126.2025151129885, "cost2_max": -45.71583717487151, "system_level_velocity_mean": 15.206149513532205, "outflow_rate_max": 1242.1775500169724}, "timesteps_since_restore": 666929, "episode_reward_min": -519.8228696503073}
{"timesteps_this_iter": 33199, "episodes_total": 822, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 700128, "training_iteration": 18, "episode_reward_max": -208.33117709608337, "pid": 314, "time_this_iter_s": 26.23822331428528, "time_total_s": 553.6512875556946, "episodes_this_iter": 41, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 18, "episode_len_mean": 322.64, "info": {"grad_time_ms": 10151.795, "update_time_ms": 9.743, "sample_time_ms": 17884.276, "num_steps_trained": 700128, "load_time_ms": 21.797, "default": {"vf_loss": 13.572877883911133, "cur_kl_coeff": 0.01250000111758709, "entropy": 1.2356760501861572, "total_loss": 13.570090293884277, "cur_lr": 0.0005000000237487257, "kl": 0.011896771378815174, "vf_explained_var": 0.8871865272521973, "policy_loss": -0.002935123862698674}, "num_steps_sampled": 700128}, "hostname": "flow-main", "date": "2019-05-24_04-26-40", "episode_reward_mean": -373.4266401272227, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1cc0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb0b8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 553.6512875556946, "timestamp": 1558672000, "custom_metrics": {"system_level_velocity_max": 16.92682901721749, "cost1_mean": 178.30227432601794, "cost1_min": 113.00973401802983, "outflow_rate_min": 905.7891895167973, "cost2_mean": -54.42376576586442, "cost1_max": 194.46938711439338, "system_level_velocity_min": 12.154792276129468, "cost2_min": -67.1302647512029, "outflow_rate_mean": 1126.3708526054825, "cost2_max": -44.32762545870145, "system_level_velocity_mean": 15.37167638589872, "outflow_rate_max": 1242.1775500169724}, "timesteps_since_restore": 700128, "episode_reward_min": -516.6526056025803}
{"timesteps_this_iter": 33691, "episodes_total": 866, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 733819, "training_iteration": 19, "episode_reward_max": -208.33117709608337, "pid": 314, "time_this_iter_s": 26.538336038589478, "time_total_s": 580.1896235942841, "episodes_this_iter": 44, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 19, "episode_len_mean": 322.44, "info": {"grad_time_ms": 9971.524, "update_time_ms": 9.415, "sample_time_ms": 17690.96, "num_steps_trained": 733819, "load_time_ms": 23.056, "default": {"vf_loss": 14.478760719299316, "cur_kl_coeff": 0.01250000111758709, "entropy": 1.2396389245986938, "total_loss": 14.475190162658691, "cur_lr": 0.0005000000237487257, "kl": 0.013358180411159992, "vf_explained_var": 0.8841464519500732, "policy_loss": -0.003736965823918581}, "num_steps_sampled": 733819}, "hostname": "flow-main", "date": "2019-05-24_04-27-06", "episode_reward_mean": -370.31553818099326, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eeda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee6d8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee438>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 580.1896235942841, "timestamp": 1558672026, "custom_metrics": {"system_level_velocity_max": 17.06252488889342, "cost1_mean": 179.00894954117567, "cost1_min": 113.00973401802983, "outflow_rate_min": 905.7891895167973, "cost2_mean": -53.94852462963409, "cost1_max": 194.86255664125582, "system_level_velocity_min": 12.865028822480449, "cost2_min": -67.7804839470257, "outflow_rate_mean": 1126.318263612868, "cost2_max": -38.3635041483108, "system_level_velocity_mean": 15.429436789309342, "outflow_rate_max": 1200.068298992231}, "timesteps_since_restore": 733819, "episode_reward_min": -481.5293099047739}
{"timesteps_this_iter": 33771, "episodes_total": 922, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 767590, "training_iteration": 20, "episode_reward_max": -33.18266498540245, "pid": 314, "time_this_iter_s": 27.928727865219116, "time_total_s": 608.1183514595032, "episodes_this_iter": 56, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 20, "episode_len_mean": 319.62, "info": {"grad_time_ms": 9763.672, "update_time_ms": 9.154, "sample_time_ms": 17500.003, "num_steps_trained": 767590, "load_time_ms": 22.449, "default": {"vf_loss": 14.08679485321045, "cur_kl_coeff": 0.01250000111758709, "entropy": 1.2326428890228271, "total_loss": 14.084907531738281, "cur_lr": 0.0005000000237487257, "kl": 0.012124394997954369, "vf_explained_var": 0.8852139711380005, "policy_loss": -0.0020388115663081408}, "num_steps_sampled": 767590}, "hostname": "flow-main", "date": "2019-05-24_04-27-34", "episode_reward_mean": -368.526235935795, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebba8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb860>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 608.1183514595032, "timestamp": 1558672054, "custom_metrics": {"system_level_velocity_max": 18.412531275354542, "cost1_mean": 179.00900432257131, "cost1_min": 22.907051869035303, "outflow_rate_min": 471.084583467557, "cost2_mean": -56.190703344270105, "cost1_max": 197.49048555674122, "system_level_velocity_min": 12.865028822480449, "cost2_min": -69.4765499940921, "outflow_rate_mean": 1131.0506141399703, "cost2_max": -24.016203480798353, "system_level_velocity_mean": 15.52294189921653, "outflow_rate_max": 1231.6256719717064}, "timesteps_since_restore": 767590, "episode_reward_min": -499.8070249808067}
{"timesteps_this_iter": 33976, "episodes_total": 963, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 801566, "training_iteration": 21, "episode_reward_max": -33.18266498540245, "pid": 314, "time_this_iter_s": 25.728784561157227, "time_total_s": 633.8471360206604, "episodes_this_iter": 41, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 21, "episode_len_mean": 319.62, "info": {"grad_time_ms": 9594.985, "update_time_ms": 9.048, "sample_time_ms": 17347.44, "num_steps_trained": 801566, "load_time_ms": 21.656, "default": {"vf_loss": 12.944785118103027, "cur_kl_coeff": 0.012500002048909664, "entropy": 1.2217313051223755, "total_loss": 12.940505981445312, "cur_lr": 0.0005000000237487257, "kl": 0.013136929832398891, "vf_explained_var": 0.8933645486831665, "policy_loss": -0.004444004036486149}, "num_steps_sampled": 801566}, "hostname": "flow-main", "date": "2019-05-24_04-28-00", "episode_reward_mean": -365.7935192167898, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e15c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e16a0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1b38>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 633.8471360206604, "timestamp": 1558672080, "custom_metrics": {"system_level_velocity_max": 18.412531275354542, "cost1_mean": 181.50953879312357, "cost1_min": 22.907051869035303, "outflow_rate_min": 471.084583467557, "cost2_mean": -58.123719941166144, "cost1_max": 199.4430286764714, "system_level_velocity_min": 12.39590857938401, "cost2_min": -73.7470822935172, "outflow_rate_mean": 1145.246705967188, "cost2_max": -24.016203480798353, "system_level_velocity_mean": 15.718026997990638, "outflow_rate_max": 1253.4655320833813}, "timesteps_since_restore": 801566, "episode_reward_min": -568.0332221945037}
{"timesteps_this_iter": 33395, "episodes_total": 1010, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 834961, "training_iteration": 22, "episode_reward_max": -31.08640064488473, "pid": 314, "time_this_iter_s": 28.283051013946533, "time_total_s": 662.1301870346069, "episodes_this_iter": 47, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 22, "episode_len_mean": 320.72, "info": {"grad_time_ms": 9396.629, "update_time_ms": 9.033, "sample_time_ms": 17568.59, "num_steps_trained": 834961, "load_time_ms": 21.324, "default": {"vf_loss": 11.644757270812988, "cur_kl_coeff": 0.012500002048909664, "entropy": 1.2168834209442139, "total_loss": 11.641566276550293, "cur_lr": 0.0005000000237487257, "kl": 0.01191583089530468, "vf_explained_var": 0.8945250511169434, "policy_loss": -0.003340688766911626}, "num_steps_sampled": 834961}, "hostname": "flow-main", "date": "2019-05-24_04-28-28", "episode_reward_mean": -364.3125301630485, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1f28>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e18d0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 662.1301870346069, "timestamp": 1558672108, "custom_metrics": {"system_level_velocity_max": 18.511857152583282, "cost1_mean": 182.4493738991947, "cost1_min": 22.86550953813094, "outflow_rate_min": 506.5568824271422, "cost2_mean": -58.39252556538534, "cost1_max": 199.4430286764714, "system_level_velocity_min": 12.39590857938401, "cost2_min": -73.7470822935172, "outflow_rate_mean": 1152.3591617879697, "cost2_max": -21.640841592457246, "system_level_velocity_mean": 15.746125581632294, "outflow_rate_max": 1253.4655320833813}, "timesteps_since_restore": 834961, "episode_reward_min": -568.0332221945037}
{"timesteps_this_iter": 33231, "episodes_total": 1063, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 868192, "training_iteration": 23, "episode_reward_max": -31.08640064488473, "pid": 314, "time_this_iter_s": 26.726970195770264, "time_total_s": 688.8571572303772, "episodes_this_iter": 53, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 23, "episode_len_mean": 318.74, "info": {"grad_time_ms": 9112.97, "update_time_ms": 9.129, "sample_time_ms": 17572.102, "num_steps_trained": 868192, "load_time_ms": 21.006, "default": {"vf_loss": 12.592487335205078, "cur_kl_coeff": 0.01250000111758709, "entropy": 1.1932579278945923, "total_loss": 12.587905883789062, "cur_lr": 0.0005000000237487257, "kl": 0.013483851216733456, "vf_explained_var": 0.8844586610794067, "policy_loss": -0.004749006126075983}, "num_steps_sampled": 868192}, "hostname": "flow-main", "date": "2019-05-24_04-28-55", "episode_reward_mean": -354.0442615017455, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e14e0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1358>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 688.8571572303772, "timestamp": 1558672135, "custom_metrics": {"system_level_velocity_max": 18.511857152583282, "cost1_mean": 182.15794022145835, "cost1_min": 22.86550953813094, "outflow_rate_min": 506.5568824271422, "cost2_mean": -57.21384079221219, "cost1_max": 199.9947568645239, "system_level_velocity_min": 12.44487202877019, "cost2_min": -76.95315450711611, "outflow_rate_mean": 1150.4210870540855, "cost2_max": -21.640841592457246, "system_level_velocity_mean": 15.853517111952407, "outflow_rate_max": 1258.289434413314}, "timesteps_since_restore": 868192, "episode_reward_min": -563.2930424161494}
{"timesteps_this_iter": 33140, "episodes_total": 1105, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 901332, "training_iteration": 24, "episode_reward_max": -197.46630560868243, "pid": 314, "time_this_iter_s": 25.831647157669067, "time_total_s": 714.6888043880463, "episodes_this_iter": 42, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 24, "episode_len_mean": 320.54, "info": {"grad_time_ms": 8828.022, "update_time_ms": 9.026, "sample_time_ms": 17679.628, "num_steps_trained": 901332, "load_time_ms": 21.16, "default": {"vf_loss": 9.974136352539062, "cur_kl_coeff": 0.01250000111758709, "entropy": 1.1818939447402954, "total_loss": 9.968992233276367, "cur_lr": 0.0005000000237487257, "kl": 0.011110461317002773, "vf_explained_var": 0.9120464324951172, "policy_loss": -0.005282423458993435}, "num_steps_sampled": 901332}, "hostname": "flow-main", "date": "2019-05-24_04-29-21", "episode_reward_mean": -352.91459034887123, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eeb70>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee9b0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 714.6888043880463, "timestamp": 1558672161, "custom_metrics": {"system_level_velocity_max": 17.484913750623907, "cost1_mean": 184.01272758510058, "cost1_min": 120.90537227044761, "outflow_rate_min": 929.0493138646373, "cost2_mean": -57.74154989808614, "cost1_max": 200.40271075859934, "system_level_velocity_min": 12.44487202877019, "cost2_min": -76.95315450711611, "outflow_rate_mean": 1157.3607288974038, "cost2_max": -41.58112730206082, "system_level_velocity_mean": 15.921838741746397, "outflow_rate_max": 1258.289434413314}, "timesteps_since_restore": 901332, "episode_reward_min": -563.2930424161494}
{"timesteps_this_iter": 32740, "episodes_total": 1151, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 934072, "training_iteration": 25, "episode_reward_max": -197.46630560868243, "pid": 314, "time_this_iter_s": 26.390294313430786, "time_total_s": 741.079098701477, "episodes_this_iter": 46, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 25, "episode_len_mean": 322.29, "info": {"grad_time_ms": 8731.047, "update_time_ms": 8.701, "sample_time_ms": 17909.574, "num_steps_trained": 934072, "load_time_ms": 21.086, "default": {"vf_loss": 10.730788230895996, "cur_kl_coeff": 0.01250000111758709, "entropy": 1.170038104057312, "total_loss": 10.725973129272461, "cur_lr": 0.0005000000237487257, "kl": 0.011889304034411907, "vf_explained_var": 0.8970012664794922, "policy_loss": -0.004965274129062891}, "num_steps_sampled": 934072}, "hostname": "flow-main", "date": "2019-05-24_04-29-48", "episode_reward_mean": -355.41749355514315, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb400>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebc18>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 741.079098701477, "timestamp": 1558672188, "custom_metrics": {"system_level_velocity_max": 17.484913750623907, "cost1_mean": 184.4998620335256, "cost1_min": 127.1959349188881, "outflow_rate_min": 952.3456012179066, "cost2_mean": -57.585183969609815, "cost1_max": 200.40271075859934, "system_level_velocity_min": 12.051872064249348, "cost2_min": -76.95315450711611, "outflow_rate_mean": 1156.583093342655, "cost2_max": -41.58112730206082, "system_level_velocity_mean": 15.900577328447, "outflow_rate_max": 1254.57242159722}, "timesteps_since_restore": 934072, "episode_reward_min": -563.2930424161494}
{"timesteps_this_iter": 32906, "episodes_total": 1204, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 966978, "training_iteration": 26, "episode_reward_max": -243.11471895829806, "pid": 314, "time_this_iter_s": 27.334080457687378, "time_total_s": 768.4131791591644, "episodes_this_iter": 53, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 26, "episode_len_mean": 323.39, "info": {"grad_time_ms": 8850.086, "update_time_ms": 8.303, "sample_time_ms": 17881.016, "num_steps_trained": 966978, "load_time_ms": 21.663, "default": {"vf_loss": 10.790873527526855, "cur_kl_coeff": 0.012500002048909664, "entropy": 1.141038417816162, "total_loss": 10.786409378051758, "cur_lr": 0.0005000000237487257, "kl": 0.014699515886604786, "vf_explained_var": 0.9032288789749146, "policy_loss": -0.004647970199584961}, "num_steps_sampled": 966978}, "hostname": "flow-main", "date": "2019-05-24_04-30-15", "episode_reward_mean": -357.5157031897313, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da6d8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e10f0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 768.4131791591644, "timestamp": 1558672215, "custom_metrics": {"system_level_velocity_max": 17.31405576909881, "cost1_mean": 183.35683404894175, "cost1_min": 115.1097105263975, "outflow_rate_min": 891.8984120731993, "cost2_mean": -56.17538686044987, "cost1_max": 197.68777732747984, "system_level_velocity_min": 12.051872064249348, "cost2_min": -68.63172663847119, "outflow_rate_mean": 1149.7125546647712, "cost2_max": -44.81707252233939, "system_level_velocity_mean": 15.741402683848193, "outflow_rate_max": 1232.5374039938554}, "timesteps_since_restore": 966978, "episode_reward_min": -559.0391816712139}
{"timesteps_this_iter": 33119, "episodes_total": 1245, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1000097, "training_iteration": 27, "episode_reward_max": -209.37643538948691, "pid": 314, "time_this_iter_s": 25.887352228164673, "time_total_s": 794.3005313873291, "episodes_this_iter": 41, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 27, "episode_len_mean": 322.72, "info": {"grad_time_ms": 9002.52, "update_time_ms": 8.378, "sample_time_ms": 17578.996, "num_steps_trained": 1000097, "load_time_ms": 21.809, "default": {"vf_loss": 9.213464736938477, "cur_kl_coeff": 0.01250000111758709, "entropy": 1.1418125629425049, "total_loss": 9.20996379852295, "cur_lr": 0.0005000000237487257, "kl": 0.013446791097521782, "vf_explained_var": 0.917323887348175, "policy_loss": -0.0036699394695460796}, "num_steps_sampled": 1000097}, "hostname": "flow-main", "date": "2019-05-24_04-30-41", "episode_reward_mean": -354.77400543738264, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eed30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee4a8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eefd0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 794.3005313873291, "timestamp": 1558672241, "custom_metrics": {"system_level_velocity_max": 17.6708518053079, "cost1_mean": 183.31382254695384, "cost1_min": 115.1097105263975, "outflow_rate_min": 891.8984120731993, "cost2_mean": -56.24424677880881, "cost1_max": 202.2201294149997, "system_level_velocity_min": 13.057839393932328, "cost2_min": -66.2141428146333, "outflow_rate_mean": 1152.1565027563274, "cost2_max": -44.81707252233939, "system_level_velocity_mean": 15.754958430122866, "outflow_rate_max": 1239.1459713986744}, "timesteps_since_restore": 1000097, "episode_reward_min": -469.58277586284345}
{"timesteps_this_iter": 33209, "episodes_total": 1287, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1033306, "training_iteration": 28, "episode_reward_max": -209.37643538948691, "pid": 314, "time_this_iter_s": 25.67028546333313, "time_total_s": 819.9708168506622, "episodes_this_iter": 42, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 28, "episode_len_mean": 323.9, "info": {"grad_time_ms": 9082.926, "update_time_ms": 8.426, "sample_time_ms": 17439.27, "num_steps_trained": 1033306, "load_time_ms": 22.431, "default": {"vf_loss": 10.242137908935547, "cur_kl_coeff": 0.01250000111758709, "entropy": 1.1229205131530762, "total_loss": 10.238377571105957, "cur_lr": 0.0005000000237487257, "kl": 0.012013625353574753, "vf_explained_var": 0.9114825129508972, "policy_loss": -0.00391099788248539}, "num_steps_sampled": 1033306}, "hostname": "flow-main", "date": "2019-05-24_04-31-07", "episode_reward_mean": -357.6833020806796, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb9012e8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901320>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 819.9708168506622, "timestamp": 1558672267, "custom_metrics": {"system_level_velocity_max": 17.6708518053079, "cost1_mean": 184.22950434009275, "cost1_min": 130.39914433893586, "outflow_rate_min": 995.8010249188234, "cost2_mean": -56.818279872054354, "cost1_max": 202.2201294149997, "system_level_velocity_min": 12.794679009746002, "cost2_min": -68.6014313594747, "outflow_rate_mean": 1157.7762336484911, "cost2_max": -44.81707252233939, "system_level_velocity_mean": 15.767821367949011, "outflow_rate_max": 1239.1459713986744}, "timesteps_since_restore": 1033306, "episode_reward_min": -503.41011738592977}
{"timesteps_this_iter": 32832, "episodes_total": 1335, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1066138, "training_iteration": 29, "episode_reward_max": -194.23998125021728, "pid": 314, "time_this_iter_s": 25.894531965255737, "time_total_s": 845.865348815918, "episodes_this_iter": 48, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 29, "episode_len_mean": 323.9, "info": {"grad_time_ms": 8994.639, "update_time_ms": 8.591, "sample_time_ms": 17464.562, "num_steps_trained": 1066138, "load_time_ms": 22.013, "default": {"vf_loss": 9.93775749206543, "cur_kl_coeff": 0.012500002048909664, "entropy": 1.1037895679473877, "total_loss": 9.934112548828125, "cur_lr": 0.0005000000237487257, "kl": 0.014364916831254959, "vf_explained_var": 0.908501148223877, "policy_loss": -0.0038242642767727375}, "num_steps_sampled": 1066138}, "hostname": "flow-main", "date": "2019-05-24_04-31-32", "episode_reward_mean": -354.09878709002083, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1780>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1710>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 845.865348815918, "timestamp": 1558672292, "custom_metrics": {"system_level_velocity_max": 17.559164748995723, "cost1_mean": 185.49809426475474, "cost1_min": 134.80127928838564, "outflow_rate_min": 1006.3497395565278, "cost2_mean": -56.46307890052697, "cost1_max": 200.87263879233535, "system_level_velocity_min": 12.728413794854221, "cost2_min": -69.53229222179459, "outflow_rate_mean": 1160.4392798507563, "cost2_max": -44.94558789617484, "system_level_velocity_mean": 15.892220961778701, "outflow_rate_max": 1239.0865342584248}, "timesteps_since_restore": 1066138, "episode_reward_min": -503.41011738592977}
{"timesteps_this_iter": 32403, "episodes_total": 1385, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1098541, "training_iteration": 30, "episode_reward_max": -194.23998125021728, "pid": 314, "time_this_iter_s": 26.120256185531616, "time_total_s": 871.9856050014496, "episodes_this_iter": 50, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 30, "episode_len_mean": 323.9, "info": {"grad_time_ms": 8866.691, "update_time_ms": 8.604, "sample_time_ms": 17409.948, "num_steps_trained": 1098541, "load_time_ms": 22.746, "default": {"vf_loss": 8.306191444396973, "cur_kl_coeff": 0.01250000111758709, "entropy": 1.0855380296707153, "total_loss": 8.300152778625488, "cur_lr": 0.0005000000237487257, "kl": 0.01763843186199665, "vf_explained_var": 0.9193515777587891, "policy_loss": -0.006259309593588114}, "num_steps_sampled": 1098541}, "hostname": "flow-main", "date": "2019-05-24_04-31-59", "episode_reward_mean": -347.2530797398904, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee198>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eee48>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 871.9856050014496, "timestamp": 1558672319, "custom_metrics": {"system_level_velocity_max": 17.615537405560445, "cost1_mean": 186.96150154880132, "cost1_min": 134.80127928838564, "outflow_rate_min": 1006.3497395565278, "cost2_mean": -55.88462081723534, "cost1_max": 200.87263879233535, "system_level_velocity_min": 12.728413794854221, "cost2_min": -69.53229222179459, "outflow_rate_mean": 1163.1408648162762, "cost2_max": -44.94558789617484, "system_level_velocity_mean": 16.03750843477047, "outflow_rate_max": 1239.0865342584248}, "timesteps_since_restore": 1098541, "episode_reward_min": -497.35980796085374}
{"timesteps_this_iter": 32829, "episodes_total": 1426, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1131370, "training_iteration": 31, "episode_reward_max": -194.23998125021728, "pid": 314, "time_this_iter_s": 26.112345218658447, "time_total_s": 898.097950220108, "episodes_this_iter": 41, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 31, "episode_len_mean": 323.9, "info": {"grad_time_ms": 8762.347, "update_time_ms": 8.443, "sample_time_ms": 17552.255, "num_steps_trained": 1131370, "load_time_ms": 22.594, "default": {"vf_loss": 7.27531623840332, "cur_kl_coeff": 0.012500002048909664, "entropy": 1.0680903196334839, "total_loss": 7.269740104675293, "cur_lr": 0.0005000000237487257, "kl": 0.015037975274026394, "vf_explained_var": 0.9297479391098022, "policy_loss": -0.005763988941907883}, "num_steps_sampled": 1131370}, "hostname": "flow-main", "date": "2019-05-24_04-32-25", "episode_reward_mean": -347.2516906348184, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb9019e8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901da0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 898.097950220108, "timestamp": 1558672345, "custom_metrics": {"system_level_velocity_max": 17.62870826314912, "cost1_mean": 186.87324978640183, "cost1_min": 134.80127928838564, "outflow_rate_min": 1017.0861734999143, "cost2_mean": -56.25939650612168, "cost1_max": 200.96273201386379, "system_level_velocity_min": 13.352082849719292, "cost2_min": -67.35566549639081, "outflow_rate_mean": 1162.170766325949, "cost2_max": -45.22671171236774, "system_level_velocity_mean": 16.025014676111496, "outflow_rate_max": 1226.234892004547}, "timesteps_since_restore": 1131370, "episode_reward_min": -467.8994023052542}
{"timesteps_this_iter": 32811, "episodes_total": 1477, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1164181, "training_iteration": 32, "episode_reward_max": -31.783320469934548, "pid": 314, "time_this_iter_s": 26.283634662628174, "time_total_s": 924.3815848827362, "episodes_this_iter": 51, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 32, "episode_len_mean": 320.72, "info": {"grad_time_ms": 8732.304, "update_time_ms": 8.358, "sample_time_ms": 17384.981, "num_steps_trained": 1164181, "load_time_ms": 21.822, "default": {"vf_loss": 10.174556732177734, "cur_kl_coeff": 0.012500002048909664, "entropy": 1.0717322826385498, "total_loss": 10.169695854187012, "cur_lr": 0.0005000000237487257, "kl": 0.01683088205754757, "vf_explained_var": 0.9066703915596008, "policy_loss": -0.005070494022220373}, "num_steps_sampled": 1164181}, "hostname": "flow-main", "date": "2019-05-24_04-32-51", "episode_reward_mean": -343.80332616950227, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ebb70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb550>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb1d0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 924.3815848827362, "timestamp": 1558672371, "custom_metrics": {"system_level_velocity_max": 18.48780251797422, "cost1_mean": 185.23186519696097, "cost1_min": 22.704859896386427, "outflow_rate_min": 503.0853896324088, "cost2_mean": -56.08870278023935, "cost1_max": 201.77033019903652, "system_level_velocity_min": 13.352082849719292, "cost2_min": -67.35566549639081, "outflow_rate_mean": 1156.7356598799697, "cost2_max": -21.400130587149533, "system_level_velocity_mean": 16.081409185318243, "outflow_rate_max": 1246.0608374384235}, "timesteps_since_restore": 1164181, "episode_reward_min": -468.4533806307141}
{"timesteps_this_iter": 31919, "episodes_total": 1526, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1196100, "training_iteration": 33, "episode_reward_max": -31.783320469934548, "pid": 314, "time_this_iter_s": 25.43040633201599, "time_total_s": 949.8119912147522, "episodes_this_iter": 49, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 33, "episode_len_mean": 320.72, "info": {"grad_time_ms": 8766.516, "update_time_ms": 8.117, "sample_time_ms": 17220.937, "num_steps_trained": 1196100, "load_time_ms": 21.966, "default": {"vf_loss": 7.097843647003174, "cur_kl_coeff": 0.012500002048909664, "entropy": 1.063602328300476, "total_loss": 7.094244003295898, "cur_lr": 0.0005000000237487257, "kl": 0.01577633060514927, "vf_explained_var": 0.9268893003463745, "policy_loss": -0.0037970298435539007}, "num_steps_sampled": 1196100}, "hostname": "flow-main", "date": "2019-05-24_04-33-17", "episode_reward_mean": -334.205261666334, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1748>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1908>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 949.8119912147522, "timestamp": 1558672397, "custom_metrics": {"system_level_velocity_max": 18.48780251797422, "cost1_mean": 187.03229481394573, "cost1_min": 22.704859896386427, "outflow_rate_min": 503.0853896324088, "cost2_mean": -54.33779364649435, "cost1_max": 201.77033019903652, "system_level_velocity_min": 13.361053692557501, "cost2_min": -67.16310020258857, "outflow_rate_mean": 1161.1254024590605, "cost2_max": -21.400130587149533, "system_level_velocity_mean": 16.290947231655085, "outflow_rate_max": 1246.0608374384235}, "timesteps_since_restore": 1196100, "episode_reward_min": -468.4533806307141}
{"timesteps_this_iter": 32621, "episodes_total": 1568, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1228721, "training_iteration": 34, "episode_reward_max": -25.176103958347596, "pid": 314, "time_this_iter_s": 25.82370090484619, "time_total_s": 975.6356921195984, "episodes_this_iter": 42, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 34, "episode_len_mean": 321.74, "info": {"grad_time_ms": 8834.64, "update_time_ms": 8.109, "sample_time_ms": 17153.702, "num_steps_trained": 1228721, "load_time_ms": 21.853, "default": {"vf_loss": 7.588759422302246, "cur_kl_coeff": 0.01250000111758709, "entropy": 1.0404475927352905, "total_loss": 7.583572864532471, "cur_lr": 0.0005000000237487257, "kl": 0.019034145399928093, "vf_explained_var": 0.9297950863838196, "policy_loss": -0.00542421406134963}, "num_steps_sampled": 1228721}, "hostname": "flow-main", "date": "2019-05-24_04-33-42", "episode_reward_mean": -336.6778910259857, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb9010f0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901198>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 975.6356921195984, "timestamp": 1558672422, "custom_metrics": {"system_level_velocity_max": 17.713685172631635, "cost1_mean": 186.4904145625661, "cost1_min": 17.6082492759616, "outflow_rate_min": 451.264202181489, "cost2_mean": -53.89535602698629, "cost1_max": 201.77033019903652, "system_level_velocity_min": 13.361053692557501, "cost2_min": -67.16310020258857, "outflow_rate_mean": 1154.8280913823528, "cost2_max": -19.38714100808141, "system_level_velocity_mean": 16.140102000835668, "outflow_rate_max": 1235.9825519061508}, "timesteps_since_restore": 1228721, "episode_reward_min": -466.62389212148076}
{"timesteps_this_iter": 31645, "episodes_total": 1617, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1260366, "training_iteration": 35, "episode_reward_max": -25.176103958347596, "pid": 314, "time_this_iter_s": 25.123674154281616, "time_total_s": 1000.75936627388, "episodes_this_iter": 49, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 35, "episode_len_mean": 321.54, "info": {"grad_time_ms": 8799.261, "update_time_ms": 8.14, "sample_time_ms": 17061.168, "num_steps_trained": 1260366, "load_time_ms": 22.058, "default": {"vf_loss": 8.371939659118652, "cur_kl_coeff": 0.012500002980232239, "entropy": 1.0327469110488892, "total_loss": 8.367840766906738, "cur_lr": 0.0005000000237487257, "kl": 0.018718892708420753, "vf_explained_var": 0.913981556892395, "policy_loss": -0.004332120530307293}, "num_steps_sampled": 1260366}, "hostname": "flow-main", "date": "2019-05-24_04-34-08", "episode_reward_mean": -334.00316745513834, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee6a0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eef98>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1000.75936627388, "timestamp": 1558672448, "custom_metrics": {"system_level_velocity_max": 17.78111250617986, "cost1_mean": 186.47990814094751, "cost1_min": 17.6082492759616, "outflow_rate_min": 451.264202181489, "cost2_mean": -52.94610989289051, "cost1_max": 201.9390573478661, "system_level_velocity_min": 13.385253467963073, "cost2_min": -63.891721857220546, "outflow_rate_mean": 1149.8781985053183, "cost2_max": -19.38714100808141, "system_level_velocity_mean": 16.149268227644097, "outflow_rate_max": 1224.4259523809521}, "timesteps_since_restore": 1260366, "episode_reward_min": -465.27527133058203}
{"timesteps_this_iter": 32035, "episodes_total": 1667, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1292401, "training_iteration": 36, "episode_reward_max": -269.2838740063023, "pid": 314, "time_this_iter_s": 26.300427436828613, "time_total_s": 1027.0597937107086, "episodes_this_iter": 50, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 36, "episode_len_mean": 324.8, "info": {"grad_time_ms": 8679.159, "update_time_ms": 8.287, "sample_time_ms": 17080.735, "num_steps_trained": 1292401, "load_time_ms": 21.656, "default": {"vf_loss": 8.001009941101074, "cur_kl_coeff": 0.012500002048909664, "entropy": 1.0134965181350708, "total_loss": 7.997668266296387, "cur_lr": 0.0005000000237487257, "kl": 0.015497326850891113, "vf_explained_var": 0.9195458889007568, "policy_loss": -0.0035350359976291656}, "num_steps_sampled": 1292401}, "hostname": "flow-main", "date": "2019-05-24_04-34-34", "episode_reward_mean": -333.7683650846509, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f14e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f12b0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1400>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1027.0597937107086, "timestamp": 1558672474, "custom_metrics": {"system_level_velocity_max": 17.78111250617986, "cost1_mean": 188.53077733150621, "cost1_min": 159.39046920594083, "outflow_rate_min": 1021.2790520256516, "cost2_mean": -52.60133577547425, "cost1_max": 201.9390573478661, "system_level_velocity_min": 12.977829770977486, "cost2_min": -63.932998137764336, "outflow_rate_mean": 1155.2316273826189, "cost2_max": -43.24459186533163, "system_level_velocity_mean": 16.163504222575508, "outflow_rate_max": 1220.295012434374}, "timesteps_since_restore": 1292401, "episode_reward_min": -463.4787045470428}
{"timesteps_this_iter": 31576, "episodes_total": 1709, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1323977, "training_iteration": 37, "episode_reward_max": -191.2336235771027, "pid": 314, "time_this_iter_s": 25.461978673934937, "time_total_s": 1052.5217723846436, "episodes_this_iter": 42, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 37, "episode_len_mean": 322.57, "info": {"grad_time_ms": 8561.779, "update_time_ms": 8.287, "sample_time_ms": 17156.623, "num_steps_trained": 1323977, "load_time_ms": 21.756, "default": {"vf_loss": 7.5731072425842285, "cur_kl_coeff": 0.012500002980232239, "entropy": 0.9984442591667175, "total_loss": 7.567479610443115, "cur_lr": 0.0005000000237487257, "kl": 0.019650854170322418, "vf_explained_var": 0.919730544090271, "policy_loss": -0.005873472895473242}, "num_steps_sampled": 1323977}, "hostname": "flow-main", "date": "2019-05-24_04-34-59", "episode_reward_mean": -328.7875646000594, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901b00>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901630>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1052.5217723846436, "timestamp": 1558672499, "custom_metrics": {"system_level_velocity_max": 17.823508560369216, "cost1_mean": 187.48214873535625, "cost1_min": 117.34907708828092, "outflow_rate_min": 894.4041760685842, "cost2_mean": -52.74998247897418, "cost1_max": 202.42794644517517, "system_level_velocity_min": 12.977829770977486, "cost2_min": -63.932998137764336, "outflow_rate_mean": 1156.075154961247, "cost2_max": -42.89404905180939, "system_level_velocity_mean": 16.191222723126945, "outflow_rate_max": 1225.4335360763266}, "timesteps_since_restore": 1323977, "episode_reward_min": -463.4787045470428}
{"timesteps_this_iter": 32414, "episodes_total": 1756, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1356391, "training_iteration": 38, "episode_reward_max": -191.2336235771027, "pid": 314, "time_this_iter_s": 26.36199116706848, "time_total_s": 1078.883763551712, "episodes_this_iter": 47, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 38, "episode_len_mean": 322.57, "info": {"grad_time_ms": 8557.738, "update_time_ms": 8.17, "sample_time_ms": 17229.579, "num_steps_trained": 1356391, "load_time_ms": 22.207, "default": {"vf_loss": 7.725430965423584, "cur_kl_coeff": 0.01250000111758709, "entropy": 0.9657918214797974, "total_loss": 7.71860933303833, "cur_lr": 0.0005000000237487257, "kl": 0.021875817328691483, "vf_explained_var": 0.9252743721008301, "policy_loss": -0.007096177898347378}, "num_steps_sampled": 1356391}, "hostname": "flow-main", "date": "2019-05-24_04-35-26", "episode_reward_mean": -332.0564248549435, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee6d8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee208>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1078.883763551712, "timestamp": 1558672526, "custom_metrics": {"system_level_velocity_max": 17.823508560369216, "cost1_mean": 187.288392941748, "cost1_min": 117.34907708828092, "outflow_rate_min": 894.4041760685842, "cost2_mean": -53.369251370380816, "cost1_max": 202.42794644517517, "system_level_velocity_min": 12.869814489027183, "cost2_min": -63.932998137764336, "outflow_rate_mean": 1154.6856212257765, "cost2_max": -42.89404905180939, "system_level_velocity_mean": 16.17422965817771, "outflow_rate_max": 1225.4335360763266}, "timesteps_since_restore": 1356391, "episode_reward_min": -463.4787045470428}
{"timesteps_this_iter": 31923, "episodes_total": 1807, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1388314, "training_iteration": 39, "episode_reward_max": -33.091523894925345, "pid": 314, "time_this_iter_s": 25.06019377708435, "time_total_s": 1103.9439573287964, "episodes_this_iter": 51, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 39, "episode_len_mean": 322.1, "info": {"grad_time_ms": 8612.383, "update_time_ms": 8.205, "sample_time_ms": 17092.875, "num_steps_trained": 1388314, "load_time_ms": 21.755, "default": {"vf_loss": 7.997483253479004, "cur_kl_coeff": 0.01874999888241291, "entropy": 0.9689905643463135, "total_loss": 7.991602420806885, "cur_lr": 0.0005000000237487257, "kl": 0.02050505019724369, "vf_explained_var": 0.9189196825027466, "policy_loss": -0.006265185307711363}, "num_steps_sampled": 1388314}, "hostname": "flow-main", "date": "2019-05-24_04-35-51", "episode_reward_mean": -333.064346976948, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8dad30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f14e0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8daac8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1103.9439573287964, "timestamp": 1558672551, "custom_metrics": {"system_level_velocity_max": 18.250939328205074, "cost1_mean": 186.64550750289465, "cost1_min": 22.585721039196926, "outflow_rate_min": 482.0446921392789, "cost2_mean": -53.25430570547609, "cost1_max": 203.14486853973065, "system_level_velocity_min": 12.869814489027183, "cost2_min": -61.054280828620065, "outflow_rate_mean": 1151.9621849814664, "cost2_max": -20.530998214236043, "system_level_velocity_mean": 16.127801415643713, "outflow_rate_max": 1227.1336400399323}, "timesteps_since_restore": 1388314, "episode_reward_min": -445.33170174245214}
{"timesteps_this_iter": 31754, "episodes_total": 1848, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1420068, "training_iteration": 40, "episode_reward_max": -33.091523894925345, "pid": 314, "time_this_iter_s": 25.65428900718689, "time_total_s": 1129.5982463359833, "episodes_this_iter": 41, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 40, "episode_len_mean": 322.1, "info": {"grad_time_ms": 8659.52, "update_time_ms": 8.3, "sample_time_ms": 16999.403, "num_steps_trained": 1420068, "load_time_ms": 21.706, "default": {"vf_loss": 7.866502285003662, "cur_kl_coeff": 0.028124995529651642, "entropy": 0.9749769568443298, "total_loss": 7.861754417419434, "cur_lr": 0.0005000000237487257, "kl": 0.015403841622173786, "vf_explained_var": 0.9194322228431702, "policy_loss": -0.005181607790291309}, "num_steps_sampled": 1420068}, "hostname": "flow-main", "date": "2019-05-24_04-36-17", "episode_reward_mean": -331.25089429900413, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901b00>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eb7f0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1129.5982463359833, "timestamp": 1558672577, "custom_metrics": {"system_level_velocity_max": 18.250939328205074, "cost1_mean": 186.92292845697165, "cost1_min": 22.585721039196926, "outflow_rate_min": 482.0446921392789, "cost2_mean": -52.67025147726514, "cost1_max": 203.40759546376654, "system_level_velocity_min": 12.869814489027183, "cost2_min": -60.196475867876934, "outflow_rate_mean": 1148.6959468680695, "cost2_max": -20.530998214236043, "system_level_velocity_mean": 16.152938796005543, "outflow_rate_max": 1229.2417373103083}, "timesteps_since_restore": 1420068, "episode_reward_min": -429.7108013915152}
{"timesteps_this_iter": 31501, "episodes_total": 1893, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1451569, "training_iteration": 41, "episode_reward_max": -180.83075145131713, "pid": 314, "time_this_iter_s": 25.570822715759277, "time_total_s": 1155.1690690517426, "episodes_this_iter": 45, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 41, "episode_len_mean": 322.77, "info": {"grad_time_ms": 8580.639, "update_time_ms": 8.467, "sample_time_ms": 17023.57, "num_steps_trained": 1451569, "load_time_ms": 21.556, "default": {"vf_loss": 7.5926594734191895, "cur_kl_coeff": 0.02812499739229679, "entropy": 0.9580963850021362, "total_loss": 7.587809085845947, "cur_lr": 0.0005000000237487257, "kl": 0.01912652887403965, "vf_explained_var": 0.9206570386886597, "policy_loss": -0.005388282239437103}, "num_steps_sampled": 1451569}, "hostname": "flow-main", "date": "2019-05-24_04-36-42", "episode_reward_mean": -328.4232133945529, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb9012e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb9011d0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901828>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1155.1690690517426, "timestamp": 1558672602, "custom_metrics": {"system_level_velocity_max": 17.95144277154165, "cost1_mean": 187.84359823609856, "cost1_min": 124.70910203317877, "outflow_rate_min": 920.8903709237397, "cost2_mean": -53.02328516900681, "cost1_max": 203.61308377235835, "system_level_velocity_min": 13.256400890551696, "cost2_min": -63.221907140676585, "outflow_rate_mean": 1152.00961020733, "cost2_max": -41.6931517235694, "system_level_velocity_mean": 16.209933518331482, "outflow_rate_max": 1229.2417373103083}, "timesteps_since_restore": 1451569, "episode_reward_min": -436.73120563921185}
{"timesteps_this_iter": 31819, "episodes_total": 1942, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1483388, "training_iteration": 42, "episode_reward_max": -180.83075145131713, "pid": 314, "time_this_iter_s": 25.67841148376465, "time_total_s": 1180.8474805355072, "episodes_this_iter": 49, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 42, "episode_len_mean": 322.77, "info": {"grad_time_ms": 8417.34, "update_time_ms": 8.546, "sample_time_ms": 17124.722, "num_steps_trained": 1483388, "load_time_ms": 22.315, "default": {"vf_loss": 7.442748546600342, "cur_kl_coeff": 0.028124995529651642, "entropy": 0.9553659558296204, "total_loss": 7.438307285308838, "cur_lr": 0.0005000000237487257, "kl": 0.015536698512732983, "vf_explained_var": 0.9230511784553528, "policy_loss": -0.004877816420048475}, "num_steps_sampled": 1483388}, "hostname": "flow-main", "date": "2019-05-24_04-37-08", "episode_reward_mean": -326.06872426093435, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6835c0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683630>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1180.8474805355072, "timestamp": 1558672628, "custom_metrics": {"system_level_velocity_max": 17.95144277154165, "cost1_mean": 189.2674518480245, "cost1_min": 124.70910203317877, "outflow_rate_min": 920.8903709237397, "cost2_mean": -53.72246486082615, "cost1_max": 203.7665962212184, "system_level_velocity_min": 13.256400890551696, "cost2_min": -63.422068295251705, "outflow_rate_mean": 1156.2742733855869, "cost2_max": -41.6931517235694, "system_level_velocity_mean": 16.354787161840854, "outflow_rate_max": 1230.1514959648498}, "timesteps_since_restore": 1483388, "episode_reward_min": -436.73120563921185}
{"timesteps_this_iter": 31805, "episodes_total": 1988, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1515193, "training_iteration": 43, "episode_reward_max": -187.13652849990746, "pid": 314, "time_this_iter_s": 26.019810676574707, "time_total_s": 1206.867291212082, "episodes_this_iter": 46, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 43, "episode_len_mean": 322.85, "info": {"grad_time_ms": 8305.752, "update_time_ms": 8.58, "sample_time_ms": 17295.978, "num_steps_trained": 1515193, "load_time_ms": 21.589, "default": {"vf_loss": 7.390626430511475, "cur_kl_coeff": 0.028124995529651642, "entropy": 0.945859968662262, "total_loss": 7.385552406311035, "cur_lr": 0.0005000000237487257, "kl": 0.021168788895010948, "vf_explained_var": 0.9249177575111389, "policy_loss": -0.005669828504323959}, "num_steps_sampled": 1515193}, "hostname": "flow-main", "date": "2019-05-24_04-37-34", "episode_reward_mean": -324.2585681207906, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eec50>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eeb38>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1206.867291212082, "timestamp": 1558672654, "custom_metrics": {"system_level_velocity_max": 17.928726790907323, "cost1_mean": 190.4191949230936, "cost1_min": 124.70910203317877, "outflow_rate_min": 920.8903709237397, "cost2_mean": -54.123749047069985, "cost1_max": 203.7665962212184, "system_level_velocity_min": 13.577646101746023, "cost2_min": -63.422068295251705, "outflow_rate_mean": 1162.647825293304, "cost2_max": -45.62274022012487, "system_level_velocity_mean": 16.48677369258775, "outflow_rate_max": 1230.1514959648498}, "timesteps_since_restore": 1515193, "episode_reward_min": -426.54492707765434}
{"timesteps_this_iter": 32238, "episodes_total": 2033, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1547431, "training_iteration": 44, "episode_reward_max": -187.13652849990746, "pid": 314, "time_this_iter_s": 26.208564281463623, "time_total_s": 1233.0758554935455, "episodes_this_iter": 45, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 44, "episode_len_mean": 322.57, "info": {"grad_time_ms": 8370.779, "update_time_ms": 8.397, "sample_time_ms": 17270.333, "num_steps_trained": 1547431, "load_time_ms": 21.43, "default": {"vf_loss": 8.749475479125977, "cur_kl_coeff": 0.04218750447034836, "entropy": 0.9528096318244934, "total_loss": 8.745275497436523, "cur_lr": 0.0005000000237487257, "kl": 0.018781719729304314, "vf_explained_var": 0.9170196652412415, "policy_loss": -0.0049925572238862514}, "num_steps_sampled": 1547431}, "hostname": "flow-main", "date": "2019-05-24_04-38-00", "episode_reward_mean": -332.1819430864195, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb9012b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f12e8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901860>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1233.0758554935455, "timestamp": 1558672680, "custom_metrics": {"system_level_velocity_max": 18.0877996635549, "cost1_mean": 188.13082066597283, "cost1_min": 135.1035887354086, "outflow_rate_min": 1008.2576858726857, "cost2_mean": -54.573157514540156, "cost1_max": 203.57723102173816, "system_level_velocity_min": 13.160772013932183, "cost2_min": -65.76971537780132, "outflow_rate_mean": 1154.2921108316366, "cost2_max": -42.36210542273972, "system_level_velocity_mean": 16.262349342506596, "outflow_rate_max": 1226.3025863498203}, "timesteps_since_restore": 1547431, "episode_reward_min": -455.2644341953529}
{"timesteps_this_iter": 32146, "episodes_total": 2081, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1579577, "training_iteration": 45, "episode_reward_max": -190.23318936366212, "pid": 314, "time_this_iter_s": 25.483893394470215, "time_total_s": 1258.5597488880157, "episodes_this_iter": 48, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 45, "episode_len_mean": 322.49, "info": {"grad_time_ms": 8585.989, "update_time_ms": 8.281, "sample_time_ms": 17092.196, "num_steps_trained": 1579577, "load_time_ms": 20.68, "default": {"vf_loss": 7.4257636070251465, "cur_kl_coeff": 0.04218750447034836, "entropy": 0.951741635799408, "total_loss": 7.422263145446777, "cur_lr": 0.0005000000237487257, "kl": 0.015553761273622513, "vf_explained_var": 0.9351823329925537, "policy_loss": -0.004157664719969034}, "num_steps_sampled": 1579577}, "hostname": "flow-main", "date": "2019-05-24_04-38-26", "episode_reward_mean": -334.12833866015177, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683a20>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683f98>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1258.5597488880157, "timestamp": 1558672706, "custom_metrics": {"system_level_velocity_max": 18.0877996635549, "cost1_mean": 187.00445155878543, "cost1_min": 117.81664875616623, "outflow_rate_min": 891.6288668915804, "cost2_mean": -54.30201611874339, "cost1_max": 204.04110774346725, "system_level_velocity_min": 13.160772013932183, "cost2_min": -65.76971537780132, "outflow_rate_mean": 1149.6202139268617, "cost2_max": -42.36210542273972, "system_level_velocity_mean": 16.135174635663315, "outflow_rate_max": 1226.0396841991437}, "timesteps_since_restore": 1579577, "episode_reward_min": -455.2644341953529}
{"timesteps_this_iter": 32649, "episodes_total": 2128, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1612226, "training_iteration": 46, "episode_reward_max": -178.8668438435142, "pid": 314, "time_this_iter_s": 26.231215000152588, "time_total_s": 1284.7909638881683, "episodes_this_iter": 47, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 46, "episode_len_mean": 322.44, "info": {"grad_time_ms": 8784.419, "update_time_ms": 8.529, "sample_time_ms": 16885.438, "num_steps_trained": 1612226, "load_time_ms": 20.452, "default": {"vf_loss": 9.334104537963867, "cur_kl_coeff": 0.04218750447034836, "entropy": 0.93404221534729, "total_loss": 9.330273628234863, "cur_lr": 0.0005000000237487257, "kl": 0.015397017821669579, "vf_explained_var": 0.9233006238937378, "policy_loss": -0.004480171948671341}, "num_steps_sampled": 1612226}, "hostname": "flow-main", "date": "2019-05-24_04-38-52", "episode_reward_mean": -338.8383994275891, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6834e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683d68>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6837f0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1284.7909638881683, "timestamp": 1558672732, "custom_metrics": {"system_level_velocity_max": 18.012903978288254, "cost1_mean": 186.34983217577172, "cost1_min": 117.81664875616623, "outflow_rate_min": 891.6288668915804, "cost2_mean": -54.61672038930198, "cost1_max": 204.29718343723022, "system_level_velocity_min": 12.851198422078731, "cost2_min": -67.77830551444751, "outflow_rate_mean": 1142.8081012110133, "cost2_max": -38.01385984719772, "system_level_velocity_mean": 16.066998441734114, "outflow_rate_max": 1226.0396841991437}, "timesteps_since_restore": 1612226, "episode_reward_min": -499.12332927730296}
{"timesteps_this_iter": 32294, "episodes_total": 2174, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1644520, "training_iteration": 47, "episode_reward_max": -178.8668438435142, "pid": 314, "time_this_iter_s": 25.914995193481445, "time_total_s": 1310.7059590816498, "episodes_this_iter": 46, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 47, "episode_len_mean": 319.88, "info": {"grad_time_ms": 8853.856, "update_time_ms": 8.698, "sample_time_ms": 16861.422, "num_steps_trained": 1644520, "load_time_ms": 19.934, "default": {"vf_loss": 9.020218849182129, "cur_kl_coeff": 0.04218750447034836, "entropy": 0.9179627895355225, "total_loss": 9.015840530395508, "cur_lr": 0.0005000000237487257, "kl": 0.015769634395837784, "vf_explained_var": 0.9142765402793884, "policy_loss": -0.005045687314122915}, "num_steps_sampled": 1644520}, "hostname": "flow-main", "date": "2019-05-24_04-39-18", "episode_reward_mean": -340.90783380221086, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eedd8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8e1b00>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1310.7059590816498, "timestamp": 1558672758, "custom_metrics": {"system_level_velocity_max": 17.860934926891833, "cost1_mean": 183.39694274928308, "cost1_min": 116.96583900635738, "outflow_rate_min": 884.6514005654426, "cost2_mean": -53.80762647529299, "cost1_max": 204.29718343723022, "system_level_velocity_min": 12.851198422078731, "cost2_min": -67.77830551444751, "outflow_rate_mean": 1130.8279683273024, "cost2_max": -38.01385984719772, "system_level_velocity_mean": 15.91772042253259, "outflow_rate_max": 1225.3565543402706}, "timesteps_since_restore": 1644520, "episode_reward_min": -499.12332927730296}
{"timesteps_this_iter": 31431, "episodes_total": 2224, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1675951, "training_iteration": 48, "episode_reward_max": -31.301808880242838, "pid": 314, "time_this_iter_s": 26.067699432373047, "time_total_s": 1336.7736585140228, "episodes_this_iter": 50, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 48, "episode_len_mean": 317.18, "info": {"grad_time_ms": 8663.91, "update_time_ms": 9.109, "sample_time_ms": 17023.471, "num_steps_trained": 1675951, "load_time_ms": 19.315, "default": {"vf_loss": 8.539048194885254, "cur_kl_coeff": 0.042187511920928955, "entropy": 0.9160807728767395, "total_loss": 8.533329010009766, "cur_lr": 0.0005000000237487257, "kl": 0.021659893915057182, "vf_explained_var": 0.9177852869033813, "policy_loss": -0.006632387172430754}, "num_steps_sampled": 1675951}, "hostname": "flow-main", "date": "2019-05-24_04-39-44", "episode_reward_mean": -329.1417830162645, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb901a20>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb9016d8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1336.7736585140228, "timestamp": 1558672784, "custom_metrics": {"system_level_velocity_max": 18.687045219679913, "cost1_mean": 183.24518383415815, "cost1_min": 22.849755818693037, "outflow_rate_min": 509.94648962732464, "cost2_mean": -51.625767733568225, "cost1_max": 204.1418076258704, "system_level_velocity_min": 12.686738071065752, "cost2_min": -66.97113781303412, "outflow_rate_mean": 1129.4830973745877, "cost2_max": -22.140347581610573, "system_level_velocity_mean": 16.132610445530876, "outflow_rate_max": 1217.4347830462357}, "timesteps_since_restore": 1675951, "episode_reward_min": -503.3069822753368}
{"timesteps_this_iter": 31768, "episodes_total": 2271, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1707719, "training_iteration": 49, "episode_reward_max": -31.301808880242838, "pid": 314, "time_this_iter_s": 25.17147421836853, "time_total_s": 1361.9451327323914, "episodes_this_iter": 47, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 49, "episode_len_mean": 319.29, "info": {"grad_time_ms": 8438.717, "update_time_ms": 8.906, "sample_time_ms": 17260.905, "num_steps_trained": 1707719, "load_time_ms": 19.555, "default": {"vf_loss": 8.22451114654541, "cur_kl_coeff": 0.06328124552965164, "entropy": 0.8937740325927734, "total_loss": 8.219853401184082, "cur_lr": 0.0005000000237487257, "kl": 0.016846826300024986, "vf_explained_var": 0.9178324341773987, "policy_loss": -0.005724351853132248}, "num_steps_sampled": 1707719}, "hostname": "flow-main", "date": "2019-05-24_04-40-09", "episode_reward_mean": -322.6108273427545, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6838d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683d68>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6836a0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1361.9451327323914, "timestamp": 1558672809, "custom_metrics": {"system_level_velocity_max": 18.687045219679913, "cost1_mean": 187.03128916188655, "cost1_min": 22.849755818693037, "outflow_rate_min": 509.94648962732464, "cost2_mean": -50.96294256648383, "cost1_max": 204.1418076258704, "system_level_velocity_min": 12.686738071065752, "cost2_min": -66.97113781303412, "outflow_rate_mean": 1137.9159304413756, "cost2_max": -22.140347581610573, "system_level_velocity_mean": 16.404401569789865, "outflow_rate_max": 1218.8921003506027}, "timesteps_since_restore": 1707719, "episode_reward_min": -503.3069822753368}
{"timesteps_this_iter": 32116, "episodes_total": 2315, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1739835, "training_iteration": 50, "episode_reward_max": -183.5122737578855, "pid": 314, "time_this_iter_s": 26.31750249862671, "time_total_s": 1388.262635231018, "episodes_this_iter": 44, "experiment_id": "31b4b9ee77ae465d989e2c35a3f628e4", "iterations_since_restore": 50, "episode_len_mean": 322.19, "info": {"grad_time_ms": 8322.797, "update_time_ms": 8.851, "sample_time_ms": 17443.452, "num_steps_trained": 1739835, "load_time_ms": 19.929, "default": {"vf_loss": 7.51170539855957, "cur_kl_coeff": 0.06328124552965164, "entropy": 0.9077877998352051, "total_loss": 7.507071495056152, "cur_lr": 0.0005000000237487257, "kl": 0.020070880651474, "vf_explained_var": 0.9315231442451477, "policy_loss": -0.005904229357838631}, "num_steps_sampled": 1739835}, "hostname": "flow-main", "date": "2019-05-24_04-40-36", "episode_reward_mean": -330.7332577193099, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "lr": 0.0005, "sgd_minibatch_size": 128, "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683048>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6837b8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "custom_preprocessor": null, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "grayscale": false, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false, "monitor": false, "input_evaluation": null, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 5", "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "num_cpus_for_driver": 1, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "clip_rewards": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": true, "node_ip": "10.138.0.2", "time_since_restore": 1388.262635231018, "timestamp": 1558672836, "custom_metrics": {"system_level_velocity_max": 18.01869828208537, "cost1_mean": 187.8969240637493, "cost1_min": 126.40470752389594, "outflow_rate_min": 946.6408064725854, "cost2_mean": -53.149315958761605, "cost1_max": 205.233463772738, "system_level_velocity_min": 12.686738071065752, "cost2_min": -66.97113781303412, "outflow_rate_mean": 1144.0085160084932, "cost2_max": -35.91890494603095, "system_level_velocity_mean": 16.23495882242602, "outflow_rate_max": 1227.2709089249831}, "timesteps_since_restore": 1739835, "episode_reward_min": -503.3069822753368}

{"timesteps_this_iter": 40370, "episodes_total": 40, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 40370, "training_iteration": 1, "episode_reward_max": -490.7149530544404, "pid": 29533, "time_this_iter_s": 28.796260833740234, "time_total_s": 28.796260833740234, "episodes_this_iter": 40, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 1, "episode_len_mean": 325.0, "info": {"grad_time_ms": 11169.505, "update_time_ms": 520.949, "sample_time_ms": 16913.942, "num_steps_trained": 40370, "load_time_ms": 68.513, "default": {"vf_loss": 37.81254577636719, "cur_kl_coeff": 0.20000001788139343, "policy_loss": -0.0005317461327649653, "total_loss": 37.81233215332031, "cur_lr": 0.0005000000237487257, "kl": 0.0015972465043887496, "entropy": 1.4229378700256348, "vf_explained_var": -4.089635694981553e-06}, "num_steps_sampled": 40370}, "hostname": "flow-main", "date": "2019-05-24_05-05-01", "episode_reward_mean": -697.2129006715732, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6a7eb8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3aca58>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 28.796260833740234, "timestamp": 1558674301, "custom_metrics": {"system_level_velocity_max": 11.733138346463956, "cost1_mean": 122.1240296013461, "cost1_min": 107.18291967871276, "outflow_rate_min": 420.36668852459013, "cost2_mean": -44.779049634300314, "cost1_max": 142.5620229567069, "system_level_velocity_min": 8.942254156549144, "cost2_min": -65.04410018216429, "outflow_rate_mean": 739.7816853283546, "cost2_max": -23.83296366697332, "system_level_velocity_mean": 10.177834532700395, "outflow_rate_max": 951.4587948350071}, "timesteps_since_restore": 40370, "episode_reward_min": -905.6739740406181}
{"timesteps_this_iter": 40519, "episodes_total": 80, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 80889, "training_iteration": 2, "episode_reward_max": -488.4339100124424, "pid": 29533, "time_this_iter_s": 27.794841051101685, "time_total_s": 56.59110188484192, "episodes_this_iter": 40, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 2, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10128.669, "update_time_ms": 264.62, "sample_time_ms": 17761.543, "num_steps_trained": 80889, "load_time_ms": 38.08, "default": {"vf_loss": 61.178470611572266, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0011623018654063344, "total_loss": 61.17753601074219, "cur_lr": 0.0005000000237487257, "kl": 0.0022726876195520163, "entropy": 1.4192451238632202, "vf_explained_var": -4.27418115123146e-07}, "num_steps_sampled": 80889}, "hostname": "flow-main", "date": "2019-05-24_05-05-29", "episode_reward_mean": -684.2524600182044, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb683240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688b70>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688ac8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 56.59110188484192, "timestamp": 1558674329, "custom_metrics": {"system_level_velocity_max": 12.584584100812377, "cost1_mean": 123.0019883806287, "cost1_min": 94.21971237361726, "outflow_rate_min": 388.0617096774193, "cost2_mean": -44.73615856565491, "cost1_max": 153.43577246928334, "system_level_velocity_min": 7.9774614703045605, "cost2_min": -76.33352522570272, "outflow_rate_mean": 740.9735401010132, "cost2_max": -20.488383982917064, "system_level_velocity_mean": 10.26320339778104, "outflow_rate_max": 976.393125}, "timesteps_since_restore": 80889, "episode_reward_min": -905.6739740406181}
{"timesteps_this_iter": 40067, "episodes_total": 120, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 120956, "training_iteration": 3, "episode_reward_max": -488.4339100124424, "pid": 29533, "time_this_iter_s": 40.516266107559204, "time_total_s": 97.10736799240112, "episodes_this_iter": 40, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 3, "episode_len_mean": 325.0, "info": {"grad_time_ms": 12244.448, "update_time_ms": 179.179, "sample_time_ms": 19737.602, "num_steps_trained": 120956, "load_time_ms": 28.083, "default": {"vf_loss": 92.34961700439453, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0008384398533962667, "total_loss": 92.34893035888672, "cur_lr": 0.0005000000237487257, "kl": 0.00319856870919466, "entropy": 1.4191097021102905, "vf_explained_var": -1.0130885641501663e-07}, "num_steps_sampled": 120956}, "hostname": "flow-main", "date": "2019-05-24_05-06-10", "episode_reward_mean": -661.4967201182345, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6999b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699278>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6997f0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 97.10736799240112, "timestamp": 1558674370, "custom_metrics": {"system_level_velocity_max": 12.584584100812377, "cost1_mean": 125.18115497110506, "cost1_min": 94.21971237361726, "outflow_rate_min": 388.0617096774193, "cost2_mean": -43.832896742518066, "cost1_max": 153.43577246928334, "system_level_velocity_min": 7.9774614703045605, "cost2_min": -76.33352522570272, "outflow_rate_mean": 755.3091172721414, "cost2_max": -20.488383982917064, "system_level_velocity_mean": 10.455274052052523, "outflow_rate_max": 976.393125}, "timesteps_since_restore": 120956, "episode_reward_min": -905.6739740406181}
{"timesteps_this_iter": 37903, "episodes_total": 181, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 158859, "training_iteration": 4, "episode_reward_max": -31.885732326482056, "pid": 29533, "time_this_iter_s": 40.973501443862915, "time_total_s": 138.08086943626404, "episodes_this_iter": 61, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 4, "episode_len_mean": 322.1, "info": {"grad_time_ms": 11517.705, "update_time_ms": 144.28, "sample_time_ms": 22682.083, "num_steps_trained": 158859, "load_time_ms": 23.011, "default": {"vf_loss": 71.37897491455078, "cur_kl_coeff": 0.02500000223517418, "policy_loss": -0.00022381362214218825, "total_loss": 71.37881469726562, "cur_lr": 0.0005000000237487257, "kl": 0.002668514847755432, "entropy": 1.409140944480896, "vf_explained_var": 0.4533158838748932}, "num_steps_sampled": 158859}, "hostname": "flow-main", "date": "2019-05-24_05-06-51", "episode_reward_mean": -612.1334854281057, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac7b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac160>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8ee7b8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 138.08086943626404, "timestamp": 1558674411, "custom_metrics": {"system_level_velocity_max": 17.966419791868823, "cost1_mean": 131.8386346546231, "cost1_min": 22.17108733512686, "outflow_rate_min": 432.16490322580654, "cost2_mean": -44.7350752192104, "cost1_max": 156.90521598716614, "system_level_velocity_min": 8.423483074715206, "cost2_min": -69.15831499450579, "outflow_rate_mean": 810.5860837067873, "cost2_max": -18.501418226525132, "system_level_velocity_mean": 11.18483865655584, "outflow_rate_max": 1078.8916139491444}, "timesteps_since_restore": 158859, "episode_reward_min": -921.9841256292531}
{"timesteps_this_iter": 36980, "episodes_total": 221, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 195839, "training_iteration": 5, "episode_reward_max": -31.885732326482056, "pid": 29533, "time_this_iter_s": 25.35789179801941, "time_total_s": 163.43876123428345, "episodes_this_iter": 40, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 5, "episode_len_mean": 322.1, "info": {"grad_time_ms": 11070.29, "update_time_ms": 117.441, "sample_time_ms": 21342.555, "num_steps_trained": 195839, "load_time_ms": 19.435, "default": {"vf_loss": 56.95954132080078, "cur_kl_coeff": 0.01250000111758709, "policy_loss": -0.002742447890341282, "total_loss": 56.95693588256836, "cur_lr": 0.0005000000237487257, "kl": 0.011339668184518814, "entropy": 1.3842082023620605, "vf_explained_var": 0.6727790832519531}, "num_steps_sampled": 195839}, "hostname": "flow-main", "date": "2019-05-24_05-07-16", "episode_reward_mean": -582.080613153591, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da588>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da550>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 163.43876123428345, "timestamp": 1558674436, "custom_metrics": {"system_level_velocity_max": 17.966419791868823, "cost1_mean": 134.39713597849018, "cost1_min": 22.17108733512686, "outflow_rate_min": 432.16490322580654, "cost2_mean": -43.96173784293605, "cost1_max": 158.81833703176568, "system_level_velocity_min": 8.423483074715206, "cost2_min": -69.15831499450579, "outflow_rate_mean": 820.2879361106276, "cost2_max": -18.501418226525132, "system_level_velocity_mean": 11.424960883951325, "outflow_rate_max": 1078.8916139491444}, "timesteps_since_restore": 195839, "episode_reward_min": -921.9841256292531}
{"timesteps_this_iter": 37517, "episodes_total": 261, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 233356, "training_iteration": 6, "episode_reward_max": -431.8185846517688, "pid": 29533, "time_this_iter_s": 26.037222385406494, "time_total_s": 189.47598361968994, "episodes_this_iter": 40, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 6, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10758.107, "update_time_ms": 99.304, "sample_time_ms": 20577.641, "num_steps_trained": 233356, "load_time_ms": 17.07, "default": {"vf_loss": 50.78477478027344, "cur_kl_coeff": 0.01250000111758709, "policy_loss": -0.005567796994000673, "total_loss": 50.77943420410156, "cur_lr": 0.0005000000237487257, "kl": 0.018159160390496254, "entropy": 1.3673676252365112, "vf_explained_var": 0.7869073152542114}, "num_steps_sampled": 233356}, "hostname": "flow-main", "date": "2019-05-24_05-07-42", "episode_reward_mean": -561.678477776863, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6aee48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae9e8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae0b8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 189.47598361968994, "timestamp": 1558674462, "custom_metrics": {"system_level_velocity_max": 14.797572790193147, "cost1_mean": 139.6186353505608, "cost1_min": 108.78370352263829, "outflow_rate_min": 697.1818609383835, "cost2_mean": -45.10614066975904, "cost1_max": 176.69546826322176, "system_level_velocity_min": 9.125213069829472, "cost2_min": -67.3977904193562, "outflow_rate_mean": 856.430576599797, "cost2_max": -27.886908857874637, "system_level_velocity_mean": 11.698068268799297, "outflow_rate_max": 1122.120097937659}, "timesteps_since_restore": 233356, "episode_reward_min": -726.6723990871649}
{"timesteps_this_iter": 37904, "episodes_total": 321, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 271260, "training_iteration": 7, "episode_reward_max": -374.8501135470608, "pid": 29533, "time_this_iter_s": 28.292187213897705, "time_total_s": 217.76817083358765, "episodes_this_iter": 60, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 7, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10562.319, "update_time_ms": 86.426, "sample_time_ms": 20325.851, "num_steps_trained": 271260, "load_time_ms": 15.479, "default": {"vf_loss": 51.10599899291992, "cur_kl_coeff": 0.01250000111758709, "policy_loss": -0.003025187412276864, "total_loss": 51.10313034057617, "cur_lr": 0.0005000000237487257, "kl": 0.012220409698784351, "entropy": 1.3389697074890137, "vf_explained_var": 0.7912468910217285}, "num_steps_sampled": 271260}, "hostname": "flow-main", "date": "2019-05-24_05-08-11", "episode_reward_mean": -507.1431392845327, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6880f0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688ac8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 217.76817083358765, "timestamp": 1558674491, "custom_metrics": {"system_level_velocity_max": 16.81488757276149, "cost1_mean": 158.51692342076132, "cost1_min": 123.42323343830827, "outflow_rate_min": 702.3505475775266, "cost2_mean": -56.53616641473094, "cost1_max": 199.2941022630971, "system_level_velocity_min": 10.409465485394227, "cost2_min": -81.42026681372886, "outflow_rate_mean": 1010.1008202133285, "cost2_max": -31.809859735590166, "system_level_velocity_mean": 13.223570483527135, "outflow_rate_max": 1284.9841772047337}, "timesteps_since_restore": 271260, "episode_reward_min": -663.3878634542759}
{"timesteps_this_iter": 38717, "episodes_total": 361, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 309977, "training_iteration": 8, "episode_reward_max": -348.29667346278, "pid": 29533, "time_this_iter_s": 28.01176381111145, "time_total_s": 245.7799346446991, "episodes_this_iter": 40, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 8, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10570.787, "update_time_ms": 76.874, "sample_time_ms": 19946.319, "num_steps_trained": 309977, "load_time_ms": 14.31, "default": {"vf_loss": 36.72577667236328, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.002165933372452855, "total_loss": 36.72377395629883, "cur_lr": 0.0005000000237487257, "kl": 0.013172204606235027, "entropy": 1.3394575119018555, "vf_explained_var": 0.8270604610443115}, "num_steps_sampled": 309977}, "hostname": "flow-main", "date": "2019-05-24_05-08-39", "episode_reward_mean": -470.62186661961556, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6990f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699f60>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699a20>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 245.7799346446991, "timestamp": 1558674519, "custom_metrics": {"system_level_velocity_max": 17.099614744158625, "cost1_mean": 172.97095129707367, "cost1_min": 140.82922133445174, "outflow_rate_min": 867.4970542409902, "cost2_mean": -68.44634385876626, "cost1_max": 204.92582683136524, "system_level_velocity_min": 11.692705619105753, "cost2_min": -95.09196991950475, "outflow_rate_mean": 1118.838750687756, "cost2_max": -35.6194363971298, "system_level_velocity_mean": 14.377222774341124, "outflow_rate_max": 1309.7688485031663}, "timesteps_since_restore": 309977, "episode_reward_min": -645.4862761716416}
{"timesteps_this_iter": 38084, "episodes_total": 401, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 348061, "training_iteration": 9, "episode_reward_max": -331.96138213946386, "pid": 29533, "time_this_iter_s": 26.97758984565735, "time_total_s": 272.75752449035645, "episodes_this_iter": 40, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 9, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10572.588, "update_time_ms": 69.41, "sample_time_ms": 19540.725, "num_steps_trained": 348061, "load_time_ms": 13.374, "default": {"vf_loss": 29.27019500732422, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0024654981680214405, "total_loss": 29.267881393432617, "cur_lr": 0.0005000000237487257, "kl": 0.012139787897467613, "entropy": 1.343827724456787, "vf_explained_var": 0.8264064788818359}, "num_steps_sampled": 348061}, "hostname": "flow-main", "date": "2019-05-24_05-09-06", "episode_reward_mean": -450.6858579868196, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da240>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da550>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 272.75752449035645, "timestamp": 1558674546, "custom_metrics": {"system_level_velocity_max": 17.496443838583357, "cost1_mean": 180.7970829957155, "cost1_min": 129.00804270293506, "outflow_rate_min": 867.4970542409902, "cost2_mean": -74.97169328630254, "cost1_max": 208.7329946673122, "system_level_velocity_min": 10.224634229655214, "cost2_min": -107.97701811904079, "outflow_rate_mean": 1168.6674802508805, "cost2_max": -41.72560065908419, "system_level_velocity_mean": 15.04778323558784, "outflow_rate_max": 1337.804289460539}, "timesteps_since_restore": 348061, "episode_reward_min": -738.1659606315037}
{"timesteps_this_iter": 41085, "episodes_total": 460, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 389146, "training_iteration": 10, "episode_reward_max": -316.535363176564, "pid": 29533, "time_this_iter_s": 31.07076120376587, "time_total_s": 303.8282856941223, "episodes_this_iter": 59, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 10, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10653.817, "update_time_ms": 63.386, "sample_time_ms": 19544.001, "num_steps_trained": 389146, "load_time_ms": 12.743, "default": {"vf_loss": 42.92133712768555, "cur_kl_coeff": 0.01250000111758709, "policy_loss": -0.0014653023099526763, "total_loss": 42.919960021972656, "cur_lr": 0.0005000000237487257, "kl": 0.006902465131133795, "entropy": 1.340653419494629, "vf_explained_var": 0.7666680216789246}, "num_steps_sampled": 389146}, "hostname": "flow-main", "date": "2019-05-24_05-09-37", "episode_reward_mean": -467.42112860579743, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae978>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae048>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 303.8282856941223, "timestamp": 1558674577, "custom_metrics": {"system_level_velocity_max": 18.094395696810572, "cost1_mean": 183.65607567608657, "cost1_min": 129.00804270293506, "outflow_rate_min": 900.867272727273, "cost2_mean": -86.87833474488504, "cost1_max": 217.24600364935395, "system_level_velocity_min": 10.224634229655214, "cost2_min": -119.37015257729746, "outflow_rate_mean": 1193.7933900859653, "cost2_max": -59.53550265680629, "system_level_velocity_mean": 15.291570184470315, "outflow_rate_max": 1392.534206349207}, "timesteps_since_restore": 389146, "episode_reward_min": -798.8827721595683}
{"timesteps_this_iter": 37772, "episodes_total": 502, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 426918, "training_iteration": 11, "episode_reward_max": -104.52042439282103, "pid": 29533, "time_this_iter_s": 28.264400482177734, "time_total_s": 332.09268617630005, "episodes_this_iter": 42, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 11, "episode_len_mean": 322.92, "info": {"grad_time_ms": 10618.634, "update_time_ms": 12.123, "sample_time_ms": 19586.463, "num_steps_trained": 426918, "load_time_ms": 6.525, "default": {"vf_loss": 24.00145149230957, "cur_kl_coeff": 0.01250000111758709, "policy_loss": -0.0022750687785446644, "total_loss": 23.999271392822266, "cur_lr": 0.0005000000237487257, "kl": 0.007510982919484377, "entropy": 1.328908085823059, "vf_explained_var": 0.8356497883796692}, "num_steps_sampled": 426918}, "hostname": "flow-main", "date": "2019-05-24_05-10-05", "episode_reward_mean": -473.140626252258, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56be3ac240>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f0f0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 332.09268617630005, "timestamp": 1558674605, "custom_metrics": {"system_level_velocity_max": 18.440615394985453, "cost1_mean": 180.68600905381356, "cost1_min": 79.29870790464162, "outflow_rate_min": 770.711709322507, "cost2_mean": -87.64983076439954, "cost1_max": 217.24600364935395, "system_level_velocity_min": 10.947458249583132, "cost2_min": -119.37015257729746, "outflow_rate_mean": 1180.0782567721865, "cost2_max": -53.839480971547474, "system_level_velocity_mean": 15.179343663459536, "outflow_rate_max": 1392.534206349207}, "timesteps_since_restore": 426918, "episode_reward_min": -798.8827721595683}
{"timesteps_this_iter": 38645, "episodes_total": 542, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 465563, "training_iteration": 12, "episode_reward_max": -104.52042439282103, "pid": 29533, "time_this_iter_s": 27.75208306312561, "time_total_s": 359.84476923942566, "episodes_this_iter": 40, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 12, "episode_len_mean": 322.92, "info": {"grad_time_ms": 10811.15, "update_time_ms": 12.249, "sample_time_ms": 19389.629, "num_steps_trained": 465563, "load_time_ms": 6.316, "default": {"vf_loss": 26.894258499145508, "cur_kl_coeff": 0.012500002980232239, "policy_loss": -0.0015856892568990588, "total_loss": 26.89278221130371, "cur_lr": 0.0005000000237487257, "kl": 0.008902154862880707, "entropy": 1.329017996788025, "vf_explained_var": 0.8301317095756531}, "num_steps_sampled": 465563}, "hostname": "flow-main", "date": "2019-05-24_05-10-33", "episode_reward_mean": -465.9584378670976, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6992b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699550>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8daf60>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 359.84476923942566, "timestamp": 1558674633, "custom_metrics": {"system_level_velocity_max": 18.440615394985453, "cost1_mean": 178.50197104272752, "cost1_min": 79.29870790464162, "outflow_rate_min": 770.711709322507, "cost2_mean": -83.43113609623006, "cost1_max": 214.5747189551239, "system_level_velocity_min": 10.042896911753532, "cost2_min": -119.37015257729746, "outflow_rate_mean": 1166.8752592280478, "cost2_max": -53.839480971547474, "system_level_velocity_mean": 14.984781684921563, "outflow_rate_max": 1366.8797270006908}, "timesteps_since_restore": 465563, "episode_reward_min": -711.986663905879}
{"timesteps_this_iter": 36648, "episodes_total": 600, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 502211, "training_iteration": 13, "episode_reward_max": -306.35225519743466, "pid": 29533, "time_this_iter_s": 28.09104061126709, "time_total_s": 387.93580985069275, "episodes_this_iter": 58, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 13, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10200.832, "update_time_ms": 12.207, "sample_time_ms": 18782.674, "num_steps_trained": 502211, "load_time_ms": 6.237, "default": {"vf_loss": 26.014652252197266, "cur_kl_coeff": 0.01250000111758709, "policy_loss": -0.0013802885077893734, "total_loss": 26.01337432861328, "cur_lr": 0.0005000000237487257, "kl": 0.00841700378805399, "entropy": 1.324505090713501, "vf_explained_var": 0.8054212927818298}, "num_steps_sampled": 502211}, "hostname": "flow-main", "date": "2019-05-24_05-11-01", "episode_reward_mean": -436.37720271290794, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69fe48>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f390>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 387.93580985069275, "timestamp": 1558674661, "custom_metrics": {"system_level_velocity_max": 17.658183108211755, "cost1_mean": 183.31977369443456, "cost1_min": 123.89245694306734, "outflow_rate_min": 896.9151300979116, "cost2_mean": -78.4945994695687, "cost1_max": 209.34071920637084, "system_level_velocity_min": 10.042896911753532, "cost2_min": -113.2635771556348, "outflow_rate_mean": 1186.7982427171453, "cost2_max": -58.32709502388416, "system_level_velocity_mean": 15.312375832862761, "outflow_rate_max": 1329.7409864161812}, "timesteps_since_restore": 502211, "episode_reward_min": -711.986663905879}
{"timesteps_this_iter": 37581, "episodes_total": 642, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 539792, "training_iteration": 14, "episode_reward_max": -32.505809714411534, "pid": 29533, "time_this_iter_s": 29.08556342124939, "time_total_s": 417.02137327194214, "episodes_this_iter": 42, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 14, "episode_len_mean": 322.1, "info": {"grad_time_ms": 10415.177, "update_time_ms": 9.099, "sample_time_ms": 17380.517, "num_steps_trained": 539792, "load_time_ms": 6.024, "default": {"vf_loss": 27.514244079589844, "cur_kl_coeff": 0.01250000111758709, "policy_loss": -0.0006096115102991462, "total_loss": 27.513710021972656, "cur_lr": 0.0005000000237487257, "kl": 0.005962570197880268, "entropy": 1.320190668106079, "vf_explained_var": 0.8039171695709229}, "num_steps_sampled": 539792}, "hostname": "flow-main", "date": "2019-05-24_05-11-30", "episode_reward_mean": -414.86329434763286, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6aec50>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae320>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 417.02137327194214, "timestamp": 1558674690, "custom_metrics": {"system_level_velocity_max": 18.492599176776345, "cost1_mean": 186.56211593691918, "cost1_min": 23.019629390660807, "outflow_rate_min": 482.8201534989533, "cost2_mean": -79.27859691966489, "cost1_max": 210.90170441132182, "system_level_velocity_min": 12.277025407796204, "cost2_min": -100.34275737991935, "outflow_rate_mean": 1203.2218021602048, "cost2_max": -23.47550537324429, "system_level_velocity_mean": 15.773251843265028, "outflow_rate_max": 1329.7409864161812}, "timesteps_since_restore": 539792, "episode_reward_min": -652.4402681790666}
{"timesteps_this_iter": 37937, "episodes_total": 683, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 577729, "training_iteration": 15, "episode_reward_max": -32.505809714411534, "pid": 29533, "time_this_iter_s": 28.767977714538574, "time_total_s": 445.7893509864807, "episodes_this_iter": 41, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 15, "episode_len_mean": 322.1, "info": {"grad_time_ms": 10541.588, "update_time_ms": 9.082, "sample_time_ms": 17594.908, "num_steps_trained": 577729, "load_time_ms": 6.126, "default": {"vf_loss": 20.541635513305664, "cur_kl_coeff": 0.01250000111758709, "policy_loss": -0.0008798022172413766, "total_loss": 20.54083251953125, "cur_lr": 0.0005000000237487257, "kl": 0.006081406492739916, "entropy": 1.3101695775985718, "vf_explained_var": 0.8442846536636353}, "num_steps_sampled": 577729}, "hostname": "flow-main", "date": "2019-05-24_05-11-59", "episode_reward_mean": -427.5233095672952, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69fdd8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f550>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 445.7893509864807, "timestamp": 1558674719, "custom_metrics": {"system_level_velocity_max": 18.492599176776345, "cost1_mean": 185.75991019362235, "cost1_min": 23.019629390660807, "outflow_rate_min": 482.8201534989533, "cost2_mean": -83.31074124106604, "cost1_max": 210.90170441132182, "system_level_velocity_min": 12.277025407796204, "cost2_min": -115.5179702089344, "outflow_rate_mean": 1203.8717831353197, "cost2_max": -23.47550537324429, "system_level_velocity_mean": 15.687230468534178, "outflow_rate_max": 1340.9631499350203}, "timesteps_since_restore": 577729, "episode_reward_min": -671.6025662406942}
{"timesteps_this_iter": 37928, "episodes_total": 724, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 615657, "training_iteration": 16, "episode_reward_max": -32.505809714411534, "pid": 29533, "time_this_iter_s": 27.59805154800415, "time_total_s": 473.38740253448486, "episodes_this_iter": 41, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 16, "episode_len_mean": 320.92, "info": {"grad_time_ms": 10631.415, "update_time_ms": 9.281, "sample_time_ms": 17660.229, "num_steps_trained": 615657, "load_time_ms": 5.905, "default": {"vf_loss": 22.201385498046875, "cur_kl_coeff": 0.01250000111758709, "policy_loss": -0.003809622721746564, "total_loss": 22.197704315185547, "cur_lr": 0.0005000000237487257, "kl": 0.010163016617298126, "entropy": 1.3097690343856812, "vf_explained_var": 0.8236326575279236}, "num_steps_sampled": 615657}, "hostname": "flow-main", "date": "2019-05-24_05-12-27", "episode_reward_mean": -431.0628852111771, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8eeef0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688f60>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 473.38740253448486, "timestamp": 1558674747, "custom_metrics": {"system_level_velocity_max": 18.492599176776345, "cost1_mean": 183.2143720250009, "cost1_min": 23.019629390660807, "outflow_rate_min": 482.8201534989533, "cost2_mean": -82.89413728961064, "cost1_max": 210.3421106868655, "system_level_velocity_min": 12.311611980070351, "cost2_min": -115.5179702089344, "outflow_rate_mean": 1196.9491779388754, "cost2_max": -23.47550537324429, "system_level_velocity_mean": 15.529833145420607, "outflow_rate_max": 1345.0388645747312}, "timesteps_since_restore": 615657, "episode_reward_min": -671.6025662406942}
{"timesteps_this_iter": 37736, "episodes_total": 782, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 653393, "training_iteration": 17, "episode_reward_max": -207.1648558942154, "pid": 29533, "time_this_iter_s": 28.0273916721344, "time_total_s": 501.41479420661926, "episodes_this_iter": 58, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 17, "episode_len_mean": 323.82, "info": {"grad_time_ms": 10625.427, "update_time_ms": 9.166, "sample_time_ms": 17637.459, "num_steps_trained": 653393, "load_time_ms": 5.985, "default": {"vf_loss": 24.53101348876953, "cur_kl_coeff": 0.012500000186264515, "policy_loss": -0.0029866148252040148, "total_loss": 24.528127670288086, "cur_lr": 0.0005000000237487257, "kl": 0.007901033386588097, "entropy": 1.297041893005371, "vf_explained_var": 0.8058568239212036}, "num_steps_sampled": 653393}, "hostname": "flow-main", "date": "2019-05-24_05-12-55", "episode_reward_mean": -432.40223387367786, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae358>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae780>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 501.41479420661926, "timestamp": 1558674775, "custom_metrics": {"system_level_velocity_max": 17.72912444688046, "cost1_mean": 183.5952499547758, "cost1_min": 131.56474889299844, "outflow_rate_min": 984.4170099667774, "cost2_mean": -80.7291445812678, "cost1_max": 211.34137099634253, "system_level_velocity_min": 11.752662959699792, "cost2_min": -96.17945133299942, "outflow_rate_mean": 1201.8086164613137, "cost2_max": -64.45483859780748, "system_level_velocity_mean": 15.351567534827334, "outflow_rate_max": 1345.0388645747312}, "timesteps_since_restore": 653393, "episode_reward_min": -646.4410734495589}
{"timesteps_this_iter": 39375, "episodes_total": 823, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 692768, "training_iteration": 18, "episode_reward_max": -319.4890886964821, "pid": 29533, "time_this_iter_s": 28.560614585876465, "time_total_s": 529.9754087924957, "episodes_this_iter": 41, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 18, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10526.479, "update_time_ms": 9.141, "sample_time_ms": 17790.853, "num_steps_trained": 692768, "load_time_ms": 6.036, "default": {"vf_loss": 26.213220596313477, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0018079574219882488, "total_loss": 26.211515426635742, "cur_lr": 0.0005000000237487257, "kl": 0.008076319471001625, "entropy": 1.2759337425231934, "vf_explained_var": 0.8131508827209473}, "num_steps_sampled": 692768}, "hostname": "flow-main", "date": "2019-05-24_05-13-23", "episode_reward_mean": -442.22737594671327, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f6a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69fba8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f5c0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 529.9754087924957, "timestamp": 1558674803, "custom_metrics": {"system_level_velocity_max": 17.742274555734536, "cost1_mean": 184.56916885130642, "cost1_min": 140.48793837313946, "outflow_rate_min": 995.7395241690677, "cost2_mean": -84.86454442459684, "cost1_max": 211.34137099634253, "system_level_velocity_min": 11.752662959699792, "cost2_min": -104.32714990118632, "outflow_rate_mean": 1207.3718980180308, "cost2_max": -68.3341752431644, "system_level_velocity_mean": 15.318106876526242, "outflow_rate_max": 1350.6339795918366}, "timesteps_since_restore": 692768, "episode_reward_min": -646.4410734495589}
{"timesteps_this_iter": 40734, "episodes_total": 865, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 733502, "training_iteration": 19, "episode_reward_max": -25.126465659127486, "pid": 29533, "time_this_iter_s": 30.533007860183716, "time_total_s": 560.5084166526794, "episodes_this_iter": 42, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 19, "episode_len_mean": 322.02, "info": {"grad_time_ms": 10507.821, "update_time_ms": 8.955, "sample_time_ms": 18165.074, "num_steps_trained": 733502, "load_time_ms": 6.1, "default": {"vf_loss": 29.35384178161621, "cur_kl_coeff": 0.012500002980232239, "policy_loss": -0.002542793285101652, "total_loss": 29.351396560668945, "cur_lr": 0.0005000000237487257, "kl": 0.00793476216495037, "entropy": 1.2682299613952637, "vf_explained_var": 0.8389424085617065}, "num_steps_sampled": 733502}, "hostname": "flow-main", "date": "2019-05-24_05-13-54", "episode_reward_mean": -461.812194636974, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8f1828>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69fe48>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 560.5084166526794, "timestamp": 1558674834, "custom_metrics": {"system_level_velocity_max": 17.77618690676572, "cost1_mean": 182.71184431105812, "cost1_min": 17.95229379121769, "outflow_rate_min": 458.7643428802759, "cost2_mean": -92.19458460256016, "cost1_max": 210.98747789946293, "system_level_velocity_min": 11.832711099941125, "cost2_min": -117.8403679308627, "outflow_rate_mean": 1199.3034942106324, "cost2_max": -19.34004995308636, "system_level_velocity_mean": 15.322570861655867, "outflow_rate_max": 1353.9084404161156}, "timesteps_since_restore": 733502, "episode_reward_min": -736.8877550506871}
{"timesteps_this_iter": 41426, "episodes_total": 923, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 774928, "training_iteration": 20, "episode_reward_max": -25.126465659127486, "pid": 29533, "time_this_iter_s": 30.749784231185913, "time_total_s": 591.2582008838654, "episodes_this_iter": 58, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 20, "episode_len_mean": 322.02, "info": {"grad_time_ms": 10384.523, "update_time_ms": 8.703, "sample_time_ms": 18257.124, "num_steps_trained": 774928, "load_time_ms": 6.045, "default": {"vf_loss": 32.41476821899414, "cur_kl_coeff": 0.01250000111758709, "policy_loss": -0.003191800322383642, "total_loss": 32.41172409057617, "cur_lr": 0.0005000000237487257, "kl": 0.01152225211262703, "entropy": 1.2585819959640503, "vf_explained_var": 0.8253517746925354}, "num_steps_sampled": 774928}, "hostname": "flow-main", "date": "2019-05-24_05-14-25", "episode_reward_mean": -494.20596682892443, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6884a8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688e80>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 591.2582008838654, "timestamp": 1558674865, "custom_metrics": {"system_level_velocity_max": 17.89661180552703, "cost1_mean": 181.8589511952466, "cost1_min": 17.95229379121769, "outflow_rate_min": 458.7643428802759, "cost2_mean": -102.06553229050624, "cost1_max": 212.34102339702207, "system_level_velocity_min": 11.832711099941125, "cost2_min": -123.92225545328517, "outflow_rate_mean": 1198.3013678965276, "cost2_max": -19.34004995308636, "system_level_velocity_mean": 15.25363459346805, "outflow_rate_max": 1376.6488386203966}, "timesteps_since_restore": 774928, "episode_reward_min": -736.8877550506871}
{"timesteps_this_iter": 39722, "episodes_total": 964, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 814650, "training_iteration": 21, "episode_reward_max": -207.0326726126563, "pid": 29533, "time_this_iter_s": 29.736619472503662, "time_total_s": 620.994820356369, "episodes_this_iter": 41, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 21, "episode_len_mean": 323.82, "info": {"grad_time_ms": 10292.988, "update_time_ms": 8.612, "sample_time_ms": 18498.021, "num_steps_trained": 814650, "load_time_ms": 5.989, "default": {"vf_loss": 23.651512145996094, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0026619296986609697, "total_loss": 23.648969650268555, "cur_lr": 0.0005000000237487257, "kl": 0.009638618677854538, "entropy": 1.2581614255905151, "vf_explained_var": 0.8551821112632751}, "num_steps_sampled": 814650}, "hostname": "flow-main", "date": "2019-05-24_05-14-54", "episode_reward_mean": -486.80139278606873, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae2e8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae780>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 620.994820356369, "timestamp": 1558674894, "custom_metrics": {"system_level_velocity_max": 17.89661180552703, "cost1_mean": 184.6912368668866, "cost1_min": 131.66319155186957, "outflow_rate_min": 1030.2384530813388, "cost2_mean": -103.21439889245033, "cost1_max": 213.4184553153497, "system_level_velocity_min": 12.186831995824736, "cost2_min": -123.92225545328517, "outflow_rate_mean": 1215.2543452067193, "cost2_max": -63.15147581397763, "system_level_velocity_mean": 15.413687883024831, "outflow_rate_max": 1391.8068310657598}, "timesteps_since_restore": 814650, "episode_reward_min": -654.0037060409455}
{"timesteps_this_iter": 40553, "episodes_total": 1006, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 855203, "training_iteration": 22, "episode_reward_max": -207.0326726126563, "pid": 29533, "time_this_iter_s": 28.907047033309937, "time_total_s": 649.901867389679, "episodes_this_iter": 42, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 22, "episode_len_mean": 323.82, "info": {"grad_time_ms": 10261.952, "update_time_ms": 8.447, "sample_time_ms": 18644.115, "num_steps_trained": 855203, "load_time_ms": 6.027, "default": {"vf_loss": 25.472272872924805, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.002662251004949212, "total_loss": 25.469711303710938, "cur_lr": 0.0005000000237487257, "kl": 0.008055112324655056, "entropy": 1.2565253973007202, "vf_explained_var": 0.8432649970054626}, "num_steps_sampled": 855203}, "hostname": "flow-main", "date": "2019-05-24_05-15-23", "episode_reward_mean": -481.66674582960064, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69fb00>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f320>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 649.901867389679, "timestamp": 1558674923, "custom_metrics": {"system_level_velocity_max": 17.89661180552703, "cost1_mean": 183.85085851305735, "cost1_min": 131.66319155186957, "outflow_rate_min": 961.230630364013, "cost2_mean": -100.88749439054614, "cost1_max": 213.4184553153497, "system_level_velocity_min": 11.75379976641983, "cost2_min": -123.55716499348352, "outflow_rate_mean": 1211.107151454554, "cost2_max": -63.15147581397763, "system_level_velocity_mean": 15.36561171776478, "outflow_rate_max": 1391.8068310657598}, "timesteps_since_restore": 855203, "episode_reward_min": -654.0037060409455}
{"timesteps_this_iter": 41252, "episodes_total": 1060, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 896455, "training_iteration": 23, "episode_reward_max": -207.0326726126563, "pid": 29533, "time_this_iter_s": 30.18298029899597, "time_total_s": 680.0848476886749, "episodes_this_iter": 54, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 23, "episode_len_mean": 323.82, "info": {"grad_time_ms": 10280.9, "update_time_ms": 8.474, "sample_time_ms": 18835.128, "num_steps_trained": 896455, "load_time_ms": 5.959, "default": {"vf_loss": 27.49821662902832, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0019844218622893095, "total_loss": 27.49637222290039, "cur_lr": 0.0005000000237487257, "kl": 0.011208318173885345, "entropy": 1.2287516593933105, "vf_explained_var": 0.8379889726638794}, "num_steps_sampled": 896455}, "hostname": "flow-main", "date": "2019-05-24_05-15-53", "episode_reward_mean": -493.72702366638566, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688f60>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688da0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 680.0848476886749, "timestamp": 1558674953, "custom_metrics": {"system_level_velocity_max": 18.110495651643124, "cost1_mean": 182.53220787024736, "cost1_min": 131.66319155186957, "outflow_rate_min": 961.230630364013, "cost2_mean": -103.68552861271908, "cost1_max": 215.2157701553375, "system_level_velocity_min": 11.75379976641983, "cost2_min": -126.6717173991578, "outflow_rate_mean": 1204.0488532842558, "cost2_max": -63.15147581397763, "system_level_velocity_mean": 15.252041988471703, "outflow_rate_max": 1388.6369575945125}, "timesteps_since_restore": 896455, "episode_reward_min": -659.5341111850947}
{"timesteps_this_iter": 39394, "episodes_total": 1104, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 935849, "training_iteration": 24, "episode_reward_max": -322.61686001234693, "pid": 29533, "time_this_iter_s": 29.221992254257202, "time_total_s": 709.3068399429321, "episodes_this_iter": 44, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 24, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10195.724, "update_time_ms": 8.304, "sample_time_ms": 18935.429, "num_steps_trained": 935849, "load_time_ms": 6.034, "default": {"vf_loss": 24.956890106201172, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0022235254291445017, "total_loss": 24.954792022705078, "cur_lr": 0.0005000000237487257, "kl": 0.00997079722583294, "entropy": 1.2331863641738892, "vf_explained_var": 0.8349235653877258}, "num_steps_sampled": 935849}, "hostname": "flow-main", "date": "2019-05-24_05-16-23", "episode_reward_mean": -486.6391492705955, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da7b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da160>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da550>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 709.3068399429321, "timestamp": 1558674983, "custom_metrics": {"system_level_velocity_max": 18.110495651643124, "cost1_mean": 184.80692793951133, "cost1_min": 141.08342683659725, "outflow_rate_min": 961.230630364013, "cost2_mean": -103.0878063025903, "cost1_max": 215.2157701553375, "system_level_velocity_min": 11.75379976641983, "cost2_min": -126.6717173991578, "outflow_rate_mean": 1214.5127122250178, "cost2_max": -81.20943410445437, "system_level_velocity_mean": 15.359350148636242, "outflow_rate_max": 1388.6369575945125}, "timesteps_since_restore": 935849, "episode_reward_min": -659.5341111850947}
{"timesteps_this_iter": 39847, "episodes_total": 1146, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 975696, "training_iteration": 25, "episode_reward_max": -327.3778893653144, "pid": 29533, "time_this_iter_s": 29.942012310028076, "time_total_s": 739.2488522529602, "episodes_this_iter": 42, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 25, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10209.144, "update_time_ms": 8.094, "sample_time_ms": 19039.084, "num_steps_trained": 975696, "load_time_ms": 6.138, "default": {"vf_loss": 23.904550552368164, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0025801616720855236, "total_loss": 23.9020938873291, "cur_lr": 0.0005000000237487257, "kl": 0.009669486433267593, "entropy": 1.2255100011825562, "vf_explained_var": 0.835324764251709}, "num_steps_sampled": 975696}, "hostname": "flow-main", "date": "2019-05-24_05-16-53", "episode_reward_mean": -474.20780304037913, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae710>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae588>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 739.2488522529602, "timestamp": 1558675013, "custom_metrics": {"system_level_velocity_max": 17.748582965845866, "cost1_mean": 185.6411410017833, "cost1_min": 147.12038938836017, "outflow_rate_min": 1047.1707333492195, "cost2_mean": -99.35931949082942, "cost1_max": 212.06670741306962, "system_level_velocity_min": 12.022246402134046, "cost2_min": -126.6717173991578, "outflow_rate_mean": 1218.847178501956, "cost2_max": -80.62245422752194, "system_level_velocity_mean": 15.40896318863744, "outflow_rate_max": 1386.7018324975843}, "timesteps_since_restore": 975696, "episode_reward_min": -679.3611965698029}
{"timesteps_this_iter": 38931, "episodes_total": 1200, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1014627, "training_iteration": 26, "episode_reward_max": -326.09430826384363, "pid": 29533, "time_this_iter_s": 28.839816331863403, "time_total_s": 768.0886685848236, "episodes_this_iter": 54, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 26, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10174.482, "update_time_ms": 7.815, "sample_time_ms": 19197.34, "num_steps_trained": 1014627, "load_time_ms": 6.447, "default": {"vf_loss": 26.078149795532227, "cur_kl_coeff": 0.01250000111758709, "policy_loss": -0.004082459956407547, "total_loss": 26.074234008789062, "cur_lr": 0.0005000000237487257, "kl": 0.013316000811755657, "entropy": 1.2214287519454956, "vf_explained_var": 0.8118759989738464}, "num_steps_sampled": 1014627}, "hostname": "flow-main", "date": "2019-05-24_05-17-22", "episode_reward_mean": -466.4726340926838, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6992e8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6ae9e8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 768.0886685848236, "timestamp": 1558675042, "custom_metrics": {"system_level_velocity_max": 18.048112315509417, "cost1_mean": 183.58943786120236, "cost1_min": 125.57384402623137, "outflow_rate_min": 894.7060647206445, "cost2_mean": -94.55886962162343, "cost1_max": 214.56626148138466, "system_level_velocity_min": 10.706826351845196, "cost2_min": -124.48531836145096, "outflow_rate_mean": 1208.1403279447577, "cost2_max": -59.13504401033801, "system_level_velocity_mean": 15.269508463537182, "outflow_rate_max": 1387.9882623130281}, "timesteps_since_restore": 1014627, "episode_reward_min": -679.3611965698029}
{"timesteps_this_iter": 39893, "episodes_total": 1243, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1054520, "training_iteration": 27, "episode_reward_max": -316.6142918736524, "pid": 29533, "time_this_iter_s": 29.568469762802124, "time_total_s": 797.6571383476257, "episodes_this_iter": 43, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 27, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10227.958, "update_time_ms": 7.928, "sample_time_ms": 19299.525, "num_steps_trained": 1054520, "load_time_ms": 6.366, "default": {"vf_loss": 23.95871925354004, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.002204802120104432, "total_loss": 23.956642150878906, "cur_lr": 0.0005000000237487257, "kl": 0.01020026858896017, "entropy": 1.2064346075057983, "vf_explained_var": 0.8385374546051025}, "num_steps_sampled": 1054520}, "hostname": "flow-main", "date": "2019-05-24_05-17-51", "episode_reward_mean": -468.82965557670525, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb699c50>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb688780>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 797.6571383476257, "timestamp": 1558675071, "custom_metrics": {"system_level_velocity_max": 18.205624342359524, "cost1_mean": 184.14767172283544, "cost1_min": 125.57384402623137, "outflow_rate_min": 894.7060647206445, "cost2_mean": -96.32223161708484, "cost1_max": 214.8780950080713, "system_level_velocity_min": 10.706826351845196, "cost2_min": -124.48531836145096, "outflow_rate_mean": 1210.0477930008294, "cost2_max": -59.13504401033801, "system_level_velocity_mean": 15.34079284460838, "outflow_rate_max": 1390.2564347557206}, "timesteps_since_restore": 1054520, "episode_reward_min": -707.8256635178867}
{"timesteps_this_iter": 39910, "episodes_total": 1285, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1094430, "training_iteration": 28, "episode_reward_max": -114.05287023128741, "pid": 29533, "time_this_iter_s": 29.599855661392212, "time_total_s": 827.256994009018, "episodes_this_iter": 42, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 28, "episode_len_mean": 323.0, "info": {"grad_time_ms": 10276.295, "update_time_ms": 7.873, "sample_time_ms": 19355.546, "num_steps_trained": 1094430, "load_time_ms": 6.131, "default": {"vf_loss": 23.009523391723633, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0034842940513044596, "total_loss": 23.006166458129883, "cur_lr": 0.0005000000237487257, "kl": 0.010086647234857082, "entropy": 1.221067190170288, "vf_explained_var": 0.8477320075035095}, "num_steps_sampled": 1094430}, "hostname": "flow-main", "date": "2019-05-24_05-18-21", "episode_reward_mean": -480.31449760069177, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6994e0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f668>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 827.256994009018, "timestamp": 1558675101, "custom_metrics": {"system_level_velocity_max": 18.45725305159131, "cost1_mean": 181.58125344045095, "cost1_min": 83.59818005074605, "outflow_rate_min": 800.9691794227127, "cost2_mean": -97.70284073798604, "cost1_max": 214.8780950080713, "system_level_velocity_min": 10.706826351845196, "cost2_min": -122.24826689742163, "outflow_rate_mean": 1201.8016932202854, "cost2_max": -55.54269075157329, "system_level_velocity_mean": 15.208809752007177, "outflow_rate_max": 1390.2564347557206}, "timesteps_since_restore": 1094430, "episode_reward_min": -707.8256635178867}
{"timesteps_this_iter": 39333, "episodes_total": 1327, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1133763, "training_iteration": 29, "episode_reward_max": -114.05287023128741, "pid": 29533, "time_this_iter_s": 28.588610887527466, "time_total_s": 855.8456048965454, "episodes_this_iter": 42, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 29, "episode_len_mean": 323.0, "info": {"grad_time_ms": 10230.259, "update_time_ms": 7.956, "sample_time_ms": 19206.471, "num_steps_trained": 1133763, "load_time_ms": 5.97, "default": {"vf_loss": 23.783123016357422, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.002963524078950286, "total_loss": 23.780284881591797, "cur_lr": 0.0005000000237487257, "kl": 0.010018585249781609, "entropy": 1.1946182250976562, "vf_explained_var": 0.8495346307754517}, "num_steps_sampled": 1133763}, "hostname": "flow-main", "date": "2019-05-24_05-18-49", "episode_reward_mean": -479.03305937217027, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5c50>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5518>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 855.8456048965454, "timestamp": 1558675129, "custom_metrics": {"system_level_velocity_max": 18.45725305159131, "cost1_mean": 181.21008205797375, "cost1_min": 83.59818005074605, "outflow_rate_min": 800.9691794227127, "cost2_mean": -96.91910709003416, "cost1_max": 217.76885108404173, "system_level_velocity_min": 11.38286121772464, "cost2_min": -121.29648133836956, "outflow_rate_mean": 1197.0369861497345, "cost2_max": -55.54269075157329, "system_level_velocity_mean": 15.19696711070389, "outflow_rate_max": 1417.9680144375004}, "timesteps_since_restore": 1133763, "episode_reward_min": -686.7731728066688}
{"timesteps_this_iter": 40478, "episodes_total": 1383, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1174241, "training_iteration": 30, "episode_reward_max": -314.6183452068547, "pid": 29533, "time_this_iter_s": 30.819762706756592, "time_total_s": 886.665367603302, "episodes_this_iter": 56, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 30, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10304.311, "update_time_ms": 8.289, "sample_time_ms": 19140.602, "num_steps_trained": 1174241, "load_time_ms": 5.871, "default": {"vf_loss": 32.41714096069336, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0037425842601805925, "total_loss": 32.41353225708008, "cur_lr": 0.0005000000237487257, "kl": 0.010973836295306683, "entropy": 1.186150074005127, "vf_explained_var": 0.8183279037475586}, "num_steps_sampled": 1174241}, "hostname": "flow-main", "date": "2019-05-24_05-19-20", "episode_reward_mean": -488.12761882900793, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f8d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f160>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f240>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 886.665367603302, "timestamp": 1558675160, "custom_metrics": {"system_level_velocity_max": 18.36725972472518, "cost1_mean": 183.20873097247764, "cost1_min": 136.26136537187546, "outflow_rate_min": 947.9857500000002, "cost2_mean": -102.28339285691762, "cost1_max": 218.466100530642, "system_level_velocity_min": 11.38286121772464, "cost2_min": -131.1079087523877, "outflow_rate_mean": 1208.8966264491455, "cost2_max": -66.51350901754397, "system_level_velocity_mean": 15.279870307074878, "outflow_rate_max": 1423.969311769735}, "timesteps_since_restore": 1174241, "episode_reward_min": -671.8640983649645}
{"timesteps_this_iter": 41667, "episodes_total": 1426, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1215908, "training_iteration": 31, "episode_reward_max": -24.950019379982635, "pid": 29533, "time_this_iter_s": 30.83217763900757, "time_total_s": 917.4975452423096, "episodes_this_iter": 43, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 31, "episode_len_mean": 322.02, "info": {"grad_time_ms": 10365.401, "update_time_ms": 8.497, "sample_time_ms": 19188.334, "num_steps_trained": 1215908, "load_time_ms": 5.965, "default": {"vf_loss": 26.291072845458984, "cur_kl_coeff": 0.012500002980232239, "policy_loss": -0.00248567177914083, "total_loss": 26.2887020111084, "cur_lr": 0.0005000000237487257, "kl": 0.009234392084181309, "entropy": 1.168405294418335, "vf_explained_var": 0.8556033968925476}, "num_steps_sampled": 1215908}, "hostname": "flow-main", "date": "2019-05-24_05-19-51", "episode_reward_mean": -507.7648763920518, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bb3c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bb588>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bb160>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 917.4975452423096, "timestamp": 1558675191, "custom_metrics": {"system_level_velocity_max": 18.36725972472518, "cost1_mean": 180.2647234205698, "cost1_min": 17.559345247387398, "outflow_rate_min": 462.7169295230079, "cost2_mean": -107.2680753960869, "cost1_max": 218.466100530642, "system_level_velocity_min": 11.831288372068853, "cost2_min": -133.95924168951157, "outflow_rate_mean": 1201.0214026716362, "cost2_max": -18.15130671278218, "system_level_velocity_mean": 15.184332910877801, "outflow_rate_max": 1423.969311769735}, "timesteps_since_restore": 1215908, "episode_reward_min": -696.2808394627104}
{"timesteps_this_iter": 40266, "episodes_total": 1468, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1256174, "training_iteration": 32, "episode_reward_max": -24.950019379982635, "pid": 29533, "time_this_iter_s": 28.550229787826538, "time_total_s": 946.0477750301361, "episodes_this_iter": 42, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 32, "episode_len_mean": 322.02, "info": {"grad_time_ms": 10245.478, "update_time_ms": 8.474, "sample_time_ms": 19273.816, "num_steps_trained": 1256174, "load_time_ms": 5.906, "default": {"vf_loss": 29.032854080200195, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0042137871496379375, "total_loss": 29.028823852539062, "cur_lr": 0.0005000000237487257, "kl": 0.014973695389926434, "entropy": 1.1411899328231812, "vf_explained_var": 0.8364992737770081}, "num_steps_sampled": 1256174}, "hostname": "flow-main", "date": "2019-05-24_05-20-20", "episode_reward_mean": -507.6753623280897, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b57b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5208>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5748>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 946.0477750301361, "timestamp": 1558675220, "custom_metrics": {"system_level_velocity_max": 18.36725972472518, "cost1_mean": 179.99462555304999, "cost1_min": 17.559345247387398, "outflow_rate_min": 462.7169295230079, "cost2_mean": -106.60097244077392, "cost1_max": 218.93972112857637, "system_level_velocity_min": 11.773892336004103, "cost2_min": -134.07422934242788, "outflow_rate_mean": 1196.9416525191746, "cost2_max": -18.15130671278218, "system_level_velocity_mean": 15.185455859533247, "outflow_rate_max": 1423.969311769735}, "timesteps_since_restore": 1256174, "episode_reward_min": -739.657844431357}
{"timesteps_this_iter": 39508, "episodes_total": 1525, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1295682, "training_iteration": 33, "episode_reward_max": -24.950019379982635, "pid": 29533, "time_this_iter_s": 30.222856998443604, "time_total_s": 976.2706320285797, "episodes_this_iter": 57, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 33, "episode_len_mean": 319.12, "info": {"grad_time_ms": 10081.189, "update_time_ms": 8.333, "sample_time_ms": 19442.774, "num_steps_trained": 1295682, "load_time_ms": 5.804, "default": {"vf_loss": 32.64228820800781, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.003483937820419669, "total_loss": 32.63894271850586, "cur_lr": 0.0005000000237487257, "kl": 0.011187218129634857, "entropy": 1.1121623516082764, "vf_explained_var": 0.8306660056114197}, "num_steps_sampled": 1295682}, "hostname": "flow-main", "date": "2019-05-24_05-20-50", "episode_reward_mean": -478.2114660591456, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da7b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da390>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da6d8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 976.2706320285797, "timestamp": 1558675250, "custom_metrics": {"system_level_velocity_max": 18.560347711356723, "cost1_mean": 180.22668606947755, "cost1_min": 17.559345247387398, "outflow_rate_min": 462.43348918263234, "cost2_mean": -102.46295001121982, "cost1_max": 218.93972112857637, "system_level_velocity_min": 11.486977853516978, "cost2_min": -134.07422934242788, "outflow_rate_mean": 1196.9394821816977, "cost2_max": -18.15130671278218, "system_level_velocity_mean": 15.381879483518766, "outflow_rate_max": 1423.588079625293}, "timesteps_since_restore": 1295682, "episode_reward_min": -739.657844431357}
{"timesteps_this_iter": 39475, "episodes_total": 1567, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1335157, "training_iteration": 34, "episode_reward_max": -33.11813300585418, "pid": 29533, "time_this_iter_s": 29.21342897415161, "time_total_s": 1005.4840610027313, "episodes_this_iter": 42, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 34, "episode_len_mean": 320.1, "info": {"grad_time_ms": 9884.205, "update_time_ms": 8.329, "sample_time_ms": 19640.05, "num_steps_trained": 1335157, "load_time_ms": 5.63, "default": {"vf_loss": 27.463848114013672, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0032424889504909515, "total_loss": 27.460737228393555, "cur_lr": 0.0005000000237487257, "kl": 0.010664978064596653, "entropy": 1.0980156660079956, "vf_explained_var": 0.8458625674247742}, "num_steps_sampled": 1335157}, "hostname": "flow-main", "date": "2019-05-24_05-21-19", "episode_reward_mean": -471.85943509833817, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bb7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bb898>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bbba8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1005.4840610027313, "timestamp": 1558675279, "custom_metrics": {"system_level_velocity_max": 18.560347711356723, "cost1_mean": 181.3338825075055, "cost1_min": 23.113450306289444, "outflow_rate_min": 462.43348918263234, "cost2_mean": -102.96329773354782, "cost1_max": 217.95343248097737, "system_level_velocity_min": 10.62931921557796, "cost2_min": -131.00616822141956, "outflow_rate_mean": 1205.0866975020106, "cost2_max": -25.691937709546817, "system_level_velocity_mean": 15.414087524515926, "outflow_rate_max": 1411.7442165785571}, "timesteps_since_restore": 1335157, "episode_reward_min": -665.0535858997513}
{"timesteps_this_iter": 40999, "episodes_total": 1611, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1376156, "training_iteration": 35, "episode_reward_max": -115.87677849794441, "pid": 29533, "time_this_iter_s": 29.975335121154785, "time_total_s": 1035.459396123886, "episodes_this_iter": 44, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 35, "episode_len_mean": 321.9, "info": {"grad_time_ms": 9776.675, "update_time_ms": 8.274, "sample_time_ms": 19750.688, "num_steps_trained": 1376156, "load_time_ms": 5.502, "default": {"vf_loss": 28.035297393798828, "cur_kl_coeff": 0.01250000111758709, "policy_loss": -0.005877151619642973, "total_loss": 28.02960777282715, "cur_lr": 0.0005000000237487257, "kl": 0.015067815780639648, "entropy": 1.094026803970337, "vf_explained_var": 0.8465410470962524}, "num_steps_sampled": 1376156}, "hostname": "flow-main", "date": "2019-05-24_05-21-49", "episode_reward_mean": -484.22202808398185, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5320>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5b38>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1035.459396123886, "timestamp": 1558675309, "custom_metrics": {"system_level_velocity_max": 18.579149704962944, "cost1_mean": 182.9018811585611, "cost1_min": 83.25732167846073, "outflow_rate_min": 814.7636093988301, "cost2_mean": -106.92554827436918, "cost1_max": 221.04521057908715, "system_level_velocity_min": 10.62931921557796, "cost2_min": -136.09117868644591, "outflow_rate_mean": 1213.5636368133837, "cost2_max": -55.39687225278565, "system_level_velocity_mean": 15.450551561342648, "outflow_rate_max": 1431.0880297783517}, "timesteps_since_restore": 1376156, "episode_reward_min": -676.540002821795}
{"timesteps_this_iter": 41359, "episodes_total": 1662, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1417515, "training_iteration": 36, "episode_reward_max": -208.2278810275932, "pid": 29533, "time_this_iter_s": 31.000932216644287, "time_total_s": 1066.4603283405304, "episodes_this_iter": 51, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 36, "episode_len_mean": 323.9, "info": {"grad_time_ms": 9760.882, "update_time_ms": 8.249, "sample_time_ms": 19983.469, "num_steps_trained": 1417515, "load_time_ms": 5.499, "default": {"vf_loss": 30.94105339050293, "cur_kl_coeff": 0.01250000111758709, "policy_loss": -0.004659406375139952, "total_loss": 30.936534881591797, "cur_lr": 0.0005000000237487257, "kl": 0.011420792900025845, "entropy": 1.0842710733413696, "vf_explained_var": 0.8224191665649414}, "num_steps_sampled": 1417515}, "hostname": "flow-main", "date": "2019-05-24_05-22-20", "episode_reward_mean": -504.5846567846674, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5908>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b59e8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1066.4603283405304, "timestamp": 1558675340, "custom_metrics": {"system_level_velocity_max": 18.579149704962944, "cost1_mean": 183.9125051556046, "cost1_min": 128.809847409901, "outflow_rate_min": 903.2447248448781, "cost2_mean": -112.02889048164668, "cost1_max": 221.93256213503508, "system_level_velocity_min": 10.62931921557796, "cost2_min": -138.88822438846938, "outflow_rate_mean": 1220.0381139771887, "cost2_max": -63.2260271589813, "system_level_velocity_mean": 15.44003085170268, "outflow_rate_max": 1439.526897880539}, "timesteps_since_restore": 1417515, "episode_reward_min": -713.5976838045439}
{"timesteps_this_iter": 42725, "episodes_total": 1707, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1460240, "training_iteration": 37, "episode_reward_max": -308.18838967471356, "pid": 29533, "time_this_iter_s": 31.33694815635681, "time_total_s": 1097.7972764968872, "episodes_this_iter": 45, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 37, "episode_len_mean": 325.0, "info": {"grad_time_ms": 9840.128, "update_time_ms": 8.012, "sample_time_ms": 20080.142, "num_steps_trained": 1460240, "load_time_ms": 5.517, "default": {"vf_loss": 28.77369499206543, "cur_kl_coeff": 0.01250000111758709, "policy_loss": -0.004396746400743723, "total_loss": 28.769472122192383, "cur_lr": 0.0005000000237487257, "kl": 0.013971216045320034, "entropy": 1.0766570568084717, "vf_explained_var": 0.8418648838996887}, "num_steps_sampled": 1460240}, "hostname": "flow-main", "date": "2019-05-24_05-22-52", "episode_reward_mean": -527.6257210390729, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bb6d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bb908>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bb5f8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1097.7972764968872, "timestamp": 1558675372, "custom_metrics": {"system_level_velocity_max": 18.592537462684835, "cost1_mean": 184.63029238607447, "cost1_min": 137.67373689850507, "outflow_rate_min": 909.0374999999997, "cost2_mean": -117.0635713253779, "cost1_max": 221.93256213503508, "system_level_velocity_min": 11.80990667747741, "cost2_min": -141.53421304936728, "outflow_rate_mean": 1225.5393039313747, "cost2_max": -63.2260271589813, "system_level_velocity_mean": 15.44697188290327, "outflow_rate_max": 1439.526897880539}, "timesteps_since_restore": 1460240, "episode_reward_min": -763.9745256616877}
{"timesteps_this_iter": 43021, "episodes_total": 1750, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1503261, "training_iteration": 38, "episode_reward_max": -113.990756807142, "pid": 29533, "time_this_iter_s": 30.6401846408844, "time_total_s": 1128.4374611377716, "episodes_this_iter": 43, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 38, "episode_len_mean": 322.72, "info": {"grad_time_ms": 9910.767, "update_time_ms": 7.822, "sample_time_ms": 20112.291, "num_steps_trained": 1503261, "load_time_ms": 5.589, "default": {"vf_loss": 25.17447853088379, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.003469806397333741, "total_loss": 25.171159744262695, "cur_lr": 0.0005000000237487257, "kl": 0.011849671602249146, "entropy": 1.0623643398284912, "vf_explained_var": 0.8654522895812988}, "num_steps_sampled": 1503261}, "hostname": "flow-main", "date": "2019-05-24_05-23-22", "episode_reward_mean": -539.9002240079676, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b51d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b56d8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5f60>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1128.4374611377716, "timestamp": 1558675402, "custom_metrics": {"system_level_velocity_max": 18.731069837817675, "cost1_mean": 182.48245715266756, "cost1_min": 84.84777323810727, "outflow_rate_min": 811.2482240550761, "cost2_mean": -118.88800293213862, "cost1_max": 221.93256213503508, "system_level_velocity_min": 11.05223557565643, "cost2_min": -141.53421304936728, "outflow_rate_mean": 1220.370244933977, "cost2_max": -61.83003520345787, "system_level_velocity_mean": 15.414726843428097, "outflow_rate_max": 1448.0743584745069}, "timesteps_since_restore": 1503261, "episode_reward_min": -787.7959268636789}
{"timesteps_this_iter": 43380, "episodes_total": 1803, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1546641, "training_iteration": 39, "episode_reward_max": -113.990756807142, "pid": 29533, "time_this_iter_s": 32.214986085891724, "time_total_s": 1160.6524472236633, "episodes_this_iter": 53, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 39, "episode_len_mean": 320.77, "info": {"grad_time_ms": 10073.216, "update_time_ms": 7.938, "sample_time_ms": 20312.941, "num_steps_trained": 1546641, "load_time_ms": 5.536, "default": {"vf_loss": 29.704875946044922, "cur_kl_coeff": 0.012500002980232239, "policy_loss": -0.003144806018099189, "total_loss": 29.701852798461914, "cur_lr": 0.0005000000237487257, "kl": 0.009879956021904945, "entropy": 1.0513442754745483, "vf_explained_var": 0.8490253686904907}, "num_steps_sampled": 1546641}, "hostname": "flow-main", "date": "2019-05-24_05-23-55", "episode_reward_mean": -546.3951175689192, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bb5c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bbb70>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bbeb8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1160.6524472236633, "timestamp": 1558675435, "custom_metrics": {"system_level_velocity_max": 18.731069837817675, "cost1_mean": 179.60701951414947, "cost1_min": 84.84777323810727, "outflow_rate_min": 811.2482240550761, "cost2_mean": -118.58516820210662, "cost1_max": 221.2474815105478, "system_level_velocity_min": 11.05223557565643, "cost2_min": -141.12384183377367, "outflow_rate_mean": 1206.1503099123286, "cost2_max": -58.22664860131228, "system_level_velocity_mean": 15.288076100322346, "outflow_rate_max": 1448.0743584745069}, "timesteps_since_restore": 1546641, "episode_reward_min": -787.7959268636789}
{"timesteps_this_iter": 41626, "episodes_total": 1848, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1588267, "training_iteration": 40, "episode_reward_max": -23.555517447755648, "pid": 29533, "time_this_iter_s": 30.351276874542236, "time_total_s": 1191.0037240982056, "episodes_this_iter": 45, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 40, "episode_len_mean": 315.09, "info": {"grad_time_ms": 10151.018, "update_time_ms": 7.708, "sample_time_ms": 20185.645, "num_steps_trained": 1588267, "load_time_ms": 5.567, "default": {"vf_loss": 27.49445915222168, "cur_kl_coeff": 0.012500002980232239, "policy_loss": -0.004084440413862467, "total_loss": 27.490541458129883, "cur_lr": 0.0005000000237487257, "kl": 0.013236911036074162, "entropy": 1.0787310600280762, "vf_explained_var": 0.8566581606864929}, "num_steps_sampled": 1588267}, "hostname": "flow-main", "date": "2019-05-24_05-24-25", "episode_reward_mean": -538.6755487513865, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69fdd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f5c0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb69f160>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1191.0037240982056, "timestamp": 1558675465, "custom_metrics": {"system_level_velocity_max": 18.584070660675625, "cost1_mean": 173.1952491578285, "cost1_min": 17.870950723658584, "outflow_rate_min": 431.75782487237836, "cost2_mean": -112.91423501908292, "cost1_max": 220.4484831430334, "system_level_velocity_min": 12.03491951008705, "cost2_min": -138.86059980402464, "outflow_rate_mean": 1171.070492445622, "cost2_max": -18.768334987176765, "system_level_velocity_mean": 15.058643357545506, "outflow_rate_max": 1435.6279559406585}, "timesteps_since_restore": 1588267, "episode_reward_min": -757.7790154322058}
{"timesteps_this_iter": 40148, "episodes_total": 1893, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1628415, "training_iteration": 41, "episode_reward_max": -23.555517447755648, "pid": 29533, "time_this_iter_s": 29.498229503631592, "time_total_s": 1220.5019536018372, "episodes_this_iter": 45, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 41, "episode_len_mean": 315.04, "info": {"grad_time_ms": 10218.588, "update_time_ms": 7.569, "sample_time_ms": 19984.131, "num_steps_trained": 1628415, "load_time_ms": 5.469, "default": {"vf_loss": 26.23094940185547, "cur_kl_coeff": 0.01250000111758709, "policy_loss": -0.00472344970330596, "total_loss": 26.22638511657715, "cur_lr": 0.0005000000237487257, "kl": 0.012608973309397697, "entropy": 1.0799789428710938, "vf_explained_var": 0.8651400804519653}, "num_steps_sampled": 1628415}, "hostname": "flow-main", "date": "2019-05-24_05-24-54", "episode_reward_mean": -513.478536967186, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb643be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb643cc0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb643208>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1220.5019536018372, "timestamp": 1558675494, "custom_metrics": {"system_level_velocity_max": 18.88781330873468, "cost1_mean": 173.81246523590835, "cost1_min": 17.870950723658584, "outflow_rate_min": 431.75782487237836, "cost2_mean": -108.28885363981803, "cost1_max": 220.4484831430334, "system_level_velocity_min": 11.222988300766195, "cost2_min": -136.1601075253953, "outflow_rate_mean": 1170.1587310368761, "cost2_max": -18.768334987176765, "system_level_velocity_mean": 15.127124120001106, "outflow_rate_max": 1435.6279559406585}, "timesteps_since_restore": 1628415, "episode_reward_min": -760.1098249910829}
{"timesteps_this_iter": 41050, "episodes_total": 1938, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1669465, "training_iteration": 42, "episode_reward_max": -103.97661952109883, "pid": 29533, "time_this_iter_s": 30.106885194778442, "time_total_s": 1250.6088387966156, "episodes_this_iter": 45, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 42, "episode_len_mean": 318.92, "info": {"grad_time_ms": 10359.236, "update_time_ms": 7.629, "sample_time_ms": 19997.935, "num_steps_trained": 1669465, "load_time_ms": 5.49, "default": {"vf_loss": 29.252918243408203, "cur_kl_coeff": 0.01250000111758709, "policy_loss": -0.0030868896283209324, "total_loss": 29.249963760375977, "cur_lr": 0.0005000000237487257, "kl": 0.010802654549479485, "entropy": 1.059064507484436, "vf_explained_var": 0.8647323846817017}, "num_steps_sampled": 1669465}, "hostname": "flow-main", "date": "2019-05-24_05-25-25", "episode_reward_mean": -503.7595307862195, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b55c0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5f98>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1250.6088387966156, "timestamp": 1558675525, "custom_metrics": {"system_level_velocity_max": 18.88781330873468, "cost1_mean": 177.93883183451345, "cost1_min": 79.39656323155148, "outflow_rate_min": 766.9995775757661, "cost2_mean": -108.04314046321034, "cost1_max": 220.3627331065475, "system_level_velocity_min": 11.222988300766195, "cost2_min": -136.6240665668329, "outflow_rate_mean": 1188.6302249782866, "cost2_max": -56.31668367031523, "system_level_velocity_mean": 15.294917895811238, "outflow_rate_max": 1436.5568175302594}, "timesteps_since_restore": 1669465, "episode_reward_min": -760.1098249910829}
{"timesteps_this_iter": 41567, "episodes_total": 1989, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1711032, "training_iteration": 43, "episode_reward_max": -103.97661952109883, "pid": 29533, "time_this_iter_s": 30.58784508705139, "time_total_s": 1281.196683883667, "episodes_this_iter": 51, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 43, "episode_len_mean": 320.94, "info": {"grad_time_ms": 10519.823, "update_time_ms": 7.68, "sample_time_ms": 19871.42, "num_steps_trained": 1711032, "load_time_ms": 5.414, "default": {"vf_loss": 34.73393249511719, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.003742248984053731, "total_loss": 34.7303352355957, "cur_lr": 0.0005000000237487257, "kl": 0.011611735448241234, "entropy": 1.0454471111297607, "vf_explained_var": 0.8334006667137146}, "num_steps_sampled": 1711032}, "hostname": "flow-main", "date": "2019-05-24_05-25-55", "episode_reward_mean": -513.1949633858316, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb643160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6430f0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6436d8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1281.196683883667, "timestamp": 1558675555, "custom_metrics": {"system_level_velocity_max": 18.929137643835823, "cost1_mean": 181.71774395539043, "cost1_min": 79.39656323155148, "outflow_rate_min": 766.9995775757661, "cost2_mean": -112.17249546578908, "cost1_max": 222.83284539088214, "system_level_velocity_min": 11.222988300766195, "cost2_min": -136.6240665668329, "outflow_rate_mean": 1208.7986662980693, "cost2_max": -56.31668367031523, "system_level_velocity_mean": 15.516294849092656, "outflow_rate_max": 1444.1400476695528}, "timesteps_since_restore": 1711032, "episode_reward_min": -785.3013801536134}
{"timesteps_this_iter": 43966, "episodes_total": 2036, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1754998, "training_iteration": 44, "episode_reward_max": -25.069857157822803, "pid": 29533, "time_this_iter_s": 31.927326917648315, "time_total_s": 1313.1240108013153, "episodes_this_iter": 47, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 44, "episode_len_mean": 320.04, "info": {"grad_time_ms": 10853.715, "update_time_ms": 7.951, "sample_time_ms": 19807.175, "num_steps_trained": 1754998, "load_time_ms": 5.51, "default": {"vf_loss": 28.654787063598633, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0027338266372680664, "total_loss": 28.652177810668945, "cur_lr": 0.0005000000237487257, "kl": 0.010380401276051998, "entropy": 1.0263125896453857, "vf_explained_var": 0.8671365976333618}, "num_steps_sampled": 1754998}, "hostname": "flow-main", "date": "2019-05-24_05-26-27", "episode_reward_mean": -546.2040468476812, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb643898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb643390>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6438d0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1313.1240108013153, "timestamp": 1558675587, "custom_metrics": {"system_level_velocity_max": 18.929137643835823, "cost1_mean": 178.60587945665537, "cost1_min": 17.862187011790358, "outflow_rate_min": 431.75782487237836, "cost2_mean": -116.49972251298263, "cost1_max": 222.83284539088214, "system_level_velocity_min": 11.527665838157095, "cost2_min": -140.72176475101895, "outflow_rate_mean": 1204.7782593202992, "cost2_max": -21.752032678210508, "system_level_velocity_mean": 15.284612988380884, "outflow_rate_max": 1444.1400476695528}, "timesteps_since_restore": 1754998, "episode_reward_min": -829.1911685107257}
{"timesteps_this_iter": 42351, "episodes_total": 2078, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1797349, "training_iteration": 45, "episode_reward_max": -25.069857157822803, "pid": 29533, "time_this_iter_s": 31.640196561813354, "time_total_s": 1344.7642073631287, "episodes_this_iter": 42, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 45, "episode_len_mean": 322.02, "info": {"grad_time_ms": 11152.525, "update_time_ms": 8.108, "sample_time_ms": 19675.251, "num_steps_trained": 1797349, "load_time_ms": 5.514, "default": {"vf_loss": 29.803186416625977, "cur_kl_coeff": 0.012500002980232239, "policy_loss": -0.0033732124138623476, "total_loss": 29.79996681213379, "cur_lr": 0.0005000000237487257, "kl": 0.012336869724094868, "entropy": 0.999679684638977, "vf_explained_var": 0.870278000831604}, "num_steps_sampled": 1797349}, "hostname": "flow-main", "date": "2019-05-24_05-26-59", "episode_reward_mean": -545.2538585696639, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bb198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da588>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bb0f0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1344.7642073631287, "timestamp": 1558675619, "custom_metrics": {"system_level_velocity_max": 18.94162834558511, "cost1_mean": 181.81748449044284, "cost1_min": 17.862187011790358, "outflow_rate_min": 431.75782487237836, "cost2_mean": -118.03880879921883, "cost1_max": 224.64405116412982, "system_level_velocity_min": 11.527665838157095, "cost2_min": -140.72176475101895, "outflow_rate_mean": 1223.1272961638929, "cost2_max": -21.752032678210508, "system_level_velocity_mean": 15.42824313913036, "outflow_rate_max": 1453.6787393640843}, "timesteps_since_restore": 1797349, "episode_reward_min": -829.1911685107257}
{"timesteps_this_iter": 39182, "episodes_total": 2131, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1836531, "training_iteration": 46, "episode_reward_max": -35.3760975675018, "pid": 29533, "time_this_iter_s": 30.326276779174805, "time_total_s": 1375.0904841423035, "episodes_this_iter": 53, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 46, "episode_len_mean": 321.86, "info": {"grad_time_ms": 11197.551, "update_time_ms": 8.121, "sample_time_ms": 19563.072, "num_steps_trained": 1836531, "load_time_ms": 5.406, "default": {"vf_loss": 27.68975257873535, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0054235863499343395, "total_loss": 27.68450927734375, "cur_lr": 0.0005000000237487257, "kl": 0.01435177493840456, "entropy": 1.008669137954712, "vf_explained_var": 0.8480685353279114}, "num_steps_sampled": 1836531}, "hostname": "flow-main", "date": "2019-05-24_05-27-29", "episode_reward_mean": -498.36079096866064, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5978>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b54a8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1375.0904841423035, "timestamp": 1558675649, "custom_metrics": {"system_level_velocity_max": 18.94162834558511, "cost1_mean": 185.56751332961522, "cost1_min": 25.712687095857376, "outflow_rate_min": 504.81243995311814, "cost2_mean": -113.17146654519793, "cost1_max": 224.64405116412982, "system_level_velocity_min": 12.00800536659986, "cost2_min": -140.54430255009524, "outflow_rate_mean": 1231.3761011609076, "cost2_max": -26.403456238722452, "system_level_velocity_mean": 15.743505320656773, "outflow_rate_max": 1453.6787393640843}, "timesteps_since_restore": 1836531, "episode_reward_min": -770.573440116566}
{"timesteps_this_iter": 38270, "episodes_total": 2177, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1874801, "training_iteration": 47, "episode_reward_max": -35.3760975675018, "pid": 29533, "time_this_iter_s": 28.930721759796143, "time_total_s": 1404.0212059020996, "episodes_this_iter": 46, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 47, "episode_len_mean": 321.86, "info": {"grad_time_ms": 11053.337, "update_time_ms": 8.374, "sample_time_ms": 19468.134, "num_steps_trained": 1874801, "load_time_ms": 5.259, "default": {"vf_loss": 25.720043182373047, "cur_kl_coeff": 0.01250000111758709, "policy_loss": -0.007108891382813454, "total_loss": 25.71319580078125, "cur_lr": 0.0005000000237487257, "kl": 0.020822595804929733, "entropy": 1.0130306482315063, "vf_explained_var": 0.8489118814468384}, "num_steps_sampled": 1874801}, "hostname": "flow-main", "date": "2019-05-24_05-27-58", "episode_reward_mean": -472.08234569208753, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bb198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bbba8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6bbda0>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1404.0212059020996, "timestamp": 1558675678, "custom_metrics": {"system_level_velocity_max": 18.78759493331038, "cost1_mean": 182.07458859707913, "cost1_min": 25.712687095857376, "outflow_rate_min": 504.81243995311814, "cost2_mean": -103.93884675685422, "cost1_max": 223.52263607371628, "system_level_velocity_min": 11.897536853928033, "cost2_min": -140.54430255009524, "outflow_rate_mean": 1200.0749853884904, "cost2_max": -26.403456238722452, "system_level_velocity_mean": 15.44171041558257, "outflow_rate_max": 1446.2043427924204}, "timesteps_since_restore": 1874801, "episode_reward_min": -760.3913745914124}
{"timesteps_this_iter": 37982, "episodes_total": 2220, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1912783, "training_iteration": 48, "episode_reward_max": -24.9360649839317, "pid": 29533, "time_this_iter_s": 27.759930849075317, "time_total_s": 1431.781136751175, "episodes_this_iter": 43, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 48, "episode_len_mean": 317.66, "info": {"grad_time_ms": 10823.859, "update_time_ms": 8.564, "sample_time_ms": 19408.7, "num_steps_trained": 1912783, "load_time_ms": 5.166, "default": {"vf_loss": 21.388328552246094, "cur_kl_coeff": 0.01874999888241291, "policy_loss": -0.006891096010804176, "total_loss": 21.381793975830078, "cur_lr": 0.0005000000237487257, "kl": 0.018850622698664665, "entropy": 0.9943383932113647, "vf_explained_var": 0.8757219314575195}, "num_steps_sampled": 1912783}, "hostname": "flow-main", "date": "2019-05-24_05-28-26", "episode_reward_mean": -449.91066252039326, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6438d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb643a90>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6432e8>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1431.781136751175, "timestamp": 1558675706, "custom_metrics": {"system_level_velocity_max": 18.814340225938608, "cost1_mean": 179.78683598505282, "cost1_min": 17.77288607671032, "outflow_rate_min": 431.75782487237836, "cost2_mean": -98.52185605399822, "cost1_max": 222.63743158930737, "system_level_velocity_min": 11.897536853928033, "cost2_min": -130.32201303783432, "outflow_rate_mean": 1184.4173155922063, "cost2_max": -21.15782365912864, "system_level_velocity_mean": 15.47294036760148, "outflow_rate_max": 1441.6855938697327}, "timesteps_since_restore": 1912783, "episode_reward_min": -760.3913745914124}
{"timesteps_this_iter": 40640, "episodes_total": 2268, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1953423, "training_iteration": 49, "episode_reward_max": -24.9360649839317, "pid": 29533, "time_this_iter_s": 31.235650300979614, "time_total_s": 1463.0167870521545, "episodes_this_iter": 48, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 49, "episode_len_mean": 317.94, "info": {"grad_time_ms": 10667.49, "update_time_ms": 8.589, "sample_time_ms": 19467.427, "num_steps_trained": 1953423, "load_time_ms": 5.353, "default": {"vf_loss": 28.712310791015625, "cur_kl_coeff": 0.01874999888241291, "policy_loss": -0.004654898773878813, "total_loss": 28.707902908325195, "cur_lr": 0.0005000000237487257, "kl": 0.013172008097171783, "entropy": 0.9818136692047119, "vf_explained_var": 0.8518595099449158}, "num_steps_sampled": 1953423}, "hostname": "flow-main", "date": "2019-05-24_05-28-57", "episode_reward_mean": -464.20519943189305, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb643b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb643f60>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb643358>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": false, "node_ip": "10.138.0.2", "time_since_restore": 1463.0167870521545, "timestamp": 1558675737, "custom_metrics": {"system_level_velocity_max": 18.814340225938608, "cost1_mean": 179.01793748378205, "cost1_min": 17.77288607671032, "outflow_rate_min": 431.75782487237836, "cost2_mean": -99.87557351650739, "cost1_max": 220.9535272413202, "system_level_velocity_min": 11.931511744898872, "cost2_min": -127.1574397581549, "outflow_rate_mean": 1183.1371013191674, "cost2_max": -21.15782365912864, "system_level_velocity_mean": 15.412179293714324, "outflow_rate_max": 1439.794044178365}, "timesteps_since_restore": 1953423, "episode_reward_min": -694.7788871993588}
{"timesteps_this_iter": 40047, "episodes_total": 2318, "num_metric_batches_dropped": 0, "policy_reward_mean": {}, "timesteps_total": 1993470, "training_iteration": 50, "episode_reward_max": -293.7105438889379, "pid": 29533, "time_this_iter_s": 30.00629734992981, "time_total_s": 1493.0230844020844, "episodes_this_iter": 50, "experiment_id": "03d13d7b853443b1afba1eb9858e4263", "iterations_since_restore": 50, "episode_len_mean": 325.0, "info": {"grad_time_ms": 10490.958, "update_time_ms": 8.878, "sample_time_ms": 19612.057, "num_steps_trained": 1993470, "load_time_ms": 5.325, "default": {"vf_loss": 27.109760284423828, "cur_kl_coeff": 0.01874999888241291, "policy_loss": -0.003518208861351013, "total_loss": 27.106475830078125, "cur_lr": 0.0005000000237487257, "kl": 0.012513422407209873, "entropy": 0.9884873628616333, "vf_explained_var": 0.8638572692871094}, "num_steps_sampled": 1993470}, "hostname": "flow-main", "date": "2019-05-24_05-29-27", "episode_reward_mean": -499.78201623285497, "config": {"entropy_coeff": 0.0, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 5,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 10.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "observation_filter": "NoFilter", "vf_share_layers": false, "synchronize_filters": true, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b5240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb6b55c0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f56bb8da588>", "on_sample_end": null}, "train_batch_size": 15000, "compress_observations": false, "optimizer": {}, "model": {"fcnet_hiddens": [128, 64, 32], "squash_to_range": false, "framestack": true, "free_log_std": false, "dim": 84, "grayscale": false, "custom_model": null, "lstm_cell_size": 256, "conv_filters": null, "max_seq_len": 20, "custom_options": {}, "zero_mean": true, "use_lstm": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "custom_preprocessor": null, "channel_major": false}, "lr_schedule": null, "vf_clip_param": 1000000.0, "lambda": 0.97, "straggler_mitigation": false, "lr": 0.0005, "sample_async": false, "num_cpus_for_driver": 1, "multiagent": {"policies_to_train": null, "policy_graphs": {}, "policy_mapping_fn": null}, "num_envs_per_worker": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "collect_metrics_timeout": 180, "horizon": 750, "input_evaluation": null, "tf_session_args": {"inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "log_level": "INFO", "use_gae": true, "output": null, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "num_workers": 20, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "kl_target": 0.01, "clip_rewards": null, "monitor": false, "num_gpus": 0, "simple_optimizer": false, "num_cpus_per_worker": 1, "sample_batch_size": 750, "clip_param": 0.3, "gamma": 0.99, "clip_actions": false, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "input": "sampler"}, "done": true, "node_ip": "10.138.0.2", "time_since_restore": 1493.0230844020844, "timestamp": 1558675767, "custom_metrics": {"system_level_velocity_max": 18.80267088489716, "cost1_mean": 183.09859841682865, "cost1_min": 140.48318996229733, "outflow_rate_min": 930.2114433139536, "cost2_mean": -107.82599718379898, "cost1_max": 223.9424517749378, "system_level_velocity_min": 11.931511744898872, "cost2_min": -128.8587595142712, "outflow_rate_mean": 1211.32074252593, "cost2_max": -65.3273826641761, "system_level_velocity_mean": 15.37230848428804, "outflow_rate_max": 1449.267866989371}, "timesteps_since_restore": 1993470, "episode_reward_min": -703.3480539224197}
